\section{齐次线性方程组的解集的结构}
\begin{proposition}\label{theorem:线性方程组.齐次线性方程组的解的线性组合也是解}
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质1
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质2
%@see: 《线性代数》（张慎语、周厚隆） P80 性质1
%@see: 《线性代数》（张慎语、周厚隆） P81 推论
齐次线性方程组\(\A\x=\z\)的解的任意线性组合也是解.
\begin{proof}
设\(\X1\)与\(\X2\)是齐次线性方程组\(\A\x=\z\)的任意两个解，
即\[
	\A\X1=\z, \qquad
	\A\X2=\z.
\]
又设\(k\)是任意常数，那么有\[
	\A (\X1 + \X2) = \A \X1 + \A \X2 = \z + \z = \z,
\]\[
	\A (k \X1) = k (\A \X1) = k \z = \z,
\]
所以\(\X1 + \X2\)与\(k \X1\)都是\(\A \x = \z\)的解.
\end{proof}
\end{proposition}

\cref{theorem:线性方程组.齐次线性方程组的解的线性组合也是解} 表明，
\(n\)元齐次线性方程组\(x_1\a_1+x_2\a_2+\dotsb+x_n\a_n=\z\)的解集\(W\)是\(K^n\)的一个子空间.
我们把它称为这个方程组的\DefineConcept{解空间}（space of solution）.
如果这个方程组只有零解，那么\(W\)是零子空间.
如果这个方程组有非零解，那么\(W\)是非零子空间，从而\(W\)有基.
我们把解空间\(W\)的一个基称为这个方程组的一个\DefineConcept{基础解系}（basic set of solutions）.

如果我们找到了齐次线性方程组的一个基础解系\(\{\AutoTuple{\x}{t}\}\)，
\def\tongjie{k_1\x_1+k_2\x_2+\dotsb+k_t\x_t}%
那么这个方程组的解集为\[
	W = \Set{ \tongjie \given \AutoTuple{k}{t} \in K }.
\]
我们把表达式\((\tongjie)\)称为这个方程组的\DefineConcept{通解}（general solution）.

如何找出齐次线性方程组的一个基础解系？
解空间\(W\)的维数是多少？

\begin{theorem}\label{theorem:线性方程组.齐次线性方程组的解向量个数}
%@see: 《高等代数（第三版 上册）》（丘维声） P91 定理1
数域\(K\)上\(n\)元齐次线性方程组\(\A\x=\vb0\)的解空间\(W\)的维数为\begin{equation}
	\dim W = n - r,
\end{equation}
其中\(r\)是方程组的系数矩阵\(\A\)的秩\(\rank\A\).
当方程组有非零解时，它的每一个基础解系所含的解向量的数目都等于\(\dim W\).
\begin{proof}
设\(\A\)经一系列初等行变换化为阶梯形矩阵\(\B\)，
那么由\cref{theorem:线性方程组.初等变换不变秩} 可知\[
	\rank\B = \rank\A = r,
\]
也就是说\(\B\)的前\(r\)行向量不为零.

不失一般性，
设\(\B\)的第\(i\)行非零首元为\(b_{ii}\ (i=1,2,\dotsc,r)\)，则\[
	\A \to \B = \begin{bmatrix}
		\B_1 & \B_2 \\
		\z & \z
	\end{bmatrix},
\]
其中\[
	\B_1 = \begin{bmatrix}
		b_{11} & b_{12} & \dots & b_{1r} \\
		& b_{22} & \dots & b_{2r} \\
		& & \ddots & \vdots \\
		& & & b_{rr}
	\end{bmatrix},
	\qquad
	\B_2 = \begin{bmatrix}
		b_{1,r+1} & \dots & b_{1n} \\
		b_{2,r+1} & \dots & b_{2n} \\
		\vdots & & \vdots \\
		b_{r,r+1} & \dots & b_{rn}
	\end{bmatrix}.
\]

记\[
	\x = (x_1,x_2,\dotsc,x_r,x_{r+1},\dotsc,x_n)^T,
\]
将自由未知量\(x_{r+1},x_{r+2},\dotsc,x_n\)的一组值\((1,0,\dotsc,0)\)代入\[
	\B \x = \z,
\]
去掉\(0 = 0\)的等式，
移项得线性方程组\[
	\begin{bmatrix}
		b_{11} & b_{12} & \dots & b_{1r} \\
		& b_{22} & \dots & b_{2r} \\
		& & \ddots & \vdots \\
		& & & b_{rr}
	\end{bmatrix}
	\begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_r
	\end{bmatrix}
	= \begin{bmatrix}
		-b_{1,r+1} \\
		-b_{2,r+1} \\
		\vdots \\
		-b_{r,r+1}
	\end{bmatrix}.
	\eqno(1)
\]
系数行列式\(D = b_{11} b_{22} \dotsm b_{rr} \neq 0\).

由克拉默法则，(1)式有唯一解，于是得\(\A\x=\z\)的一个解\[
\X1 = (c_{11},c_{21},\dotsc,c_{r1},1,0,\dotsc,0)^T.
\]

同理，分别将\(x_{r+1},x_{r+2},\dotsc,x_n\)的值\((0,1,\dotsc,0),\dotsc,(0,0,\dotsc,1)\)代入\[
	\B \x = \z,
\]
求出\(\A\x=\z\)的相应的解\[
	\begin{array}{rcl}
		\X2 &=& (c_{12},c_{22},\dotsc,c_{r2},0,1,\dotsc,0)^T, \\
		&\vdots& \\
		\X{n-r} &=& (c_{1,n-r},c_{2,n-r},\dotsc,c_{r,n-r},0,0,\dotsc,1)^T.
	\end{array}
\]

易见，\begin{enumerate}
	\item \(\AutoTuple{\x}{n-r}\)是\(\A\x=\z\)的解；

	\item 考虑向量方程\(k_1\X1+k_2\X2+\dotsb+k_{n-r}\X{n-r}=\z\)，即\[
		(l_1,l_2,\dotsc,l_r,k_1,k_2,\dotsc,k_{n-r})^T
		= (0,0,\dotsc,0,0,\dotsc,0)^T,
	\]
	有\[
		k_1 = k_2 = \dotsb = k_{n-r} = 0,
	\]
	即\(\AutoTuple{\x}{n-r}\)线性无关；

	\item 设\(\x=(c_1,c_2,\dotsc,c_r,k_1,k_2,\dotsc,k_{n-r})^T\)是方程组\(\A\x=\z\)的任意一个解，
	则\[
		\x - (k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r})
		= (d_1,d_2,\dotsc,d_r,0,0,\dotsc,0)^T
	\]是齐次方程组的解，
	代入\(\B\x=\z\)，去掉\(0 = 0\)的等式，得\[
		\begin{bmatrix}
			b_{11} & b_{12} & \dots & b_{1r} \\
			& b_{22} & \dots & b_{2r} \\
			& & \ddots & \vdots \\
			& & & b_{rr}
		\end{bmatrix}
		\begin{bmatrix}
			d_1 \\ d_2 \\ \vdots \\ d_r
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ 0 \\ \vdots \\ 0
		\end{bmatrix}.
	\]
	因为系数行列式\(\abs{\B_1} \neq 0\)，
	所以\(d_1 = d_2 = \dotsb = d_r = 0\).
	于是\[
		\x - (k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r}) = \z,
	\]或\[
		\x = k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r}.
	\]
\end{enumerate}

综上所述，\(\AutoTuple{\x}{n-r}\)是\(\A\x=\z\)的一个基础解系，含有\(n-r\)个解向量.
\end{proof}
\end{theorem}

\begin{corollary}
设齐次线性方程组\(\A\x=\z\)的系数矩阵\(\A\)是\(s \times n\)矩阵，若\(\rank\A = r < n\)，
则\begin{enumerate}
	\item \(\A\x=\z\)的每个基础解系都含有\(n-r\)个解向量；
	\item \(\A\x=\z\)的任意\(n-r+1\)个解向量线性相关；
	\item \(\A\x=\z\)的任意\(n-r\)个线性无关的解都是它的一个基础解系.
\end{enumerate}
\end{corollary}

\begin{proposition}\label{theorem:线性方程组.同解方程组的系数矩阵的秩相同}
设\(\A,\B \in M_{s \times n}(K)\)，
则“方程组\(\A\x=\vb0\)与\(\B\x=\vb0\)同解”
是“\(\rank\A=\rank\B\)”的充分不必要条件.
\begin{proof}
假设\(\A\x=\vb0\)与\(\B\x=\vb0\)同解，
那么方程\(\A\x=\vb0\)的解空间与\(\B\x=\vb0\)的解空间相同，
那么由\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
有\(n-\rank\A=n-\rank\B\)，\(\rank\A=\rank\B\).

反过来，取\(\A = (1,0)\)，\(\B = (0,1)\).
显然\(\rank\A = \rank\B = 1\).
但是线性方程组\(\A\x=\vb0\)的解是\(k(0,1)^T\ (\text{$k$是常数})\)，
而\(\B\x=\vb0\)的解是\(k(1,0)^T\ (\text{$k$是常数})\).
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:线性方程组.同解方程组.特例1}
设\(\A \in M_{s \times n}(K),
\B \in M_{n \times m}(K)\)，
则\[
	\text{$(\A\B)\x=\vb0$与$\B\x=\vb0$同解}
	\iff
	\rank(\A\B)=\rank\B.
\]
\begin{proof}
充分性.
由\cref{theorem:线性方程组.同解方程组的系数矩阵的秩相同} 可知\[
	\text{$(\A\B)\x=\vb0$与$\B\x=\vb0$同解}
	\implies
	\rank(\A\B)=\rank\B.
\]

必要性.
设\(\vb\xi\)是\(\B\x=\vb0\)的一个解，
即\(\B\vb\xi=\vb0\)，
那么左乘\(\A\)便得\(\A\B\vb\xi=\vb0\)，
这就说明\(\vb\xi\)也是\((\A\B)\x=\vb0\)的一个解.
由于\(\vb\xi\)的任意性，
所以\(\B\x=\vb0\)的解都是\((\A\B)\x=\vb0\)的解，
也就是说\[
	(\text{$\B\x=\vb0$的解空间})
	\subseteq(\text{$(\A\B)\x=\vb0$的解空间}).
\]
因为\(\rank(\A\B)=\rank\B\)，
所以由\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 可知\[
	\dim(\text{$(\A\B)\x=\vb0$的解空间})
	=\dim(\text{$\B\x=\vb0$的解空间}).
\]
因此由\cref{theorem:向量空间.两个非零子空间的关系2} 可知\[
	(\text{$\B\x=\vb0$的解空间})
	=(\text{$(\A\B)\x=\vb0$的解空间}),
\]
也就是说\(\A\x=\vb0\)与\(\B\x=\vb0\)同解.
\end{proof}
\end{proposition}

\begin{example}
求齐次线性方程组\[
	\left\{ \begin{array}{*{11}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &+& 4 x_5 &=& 0 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &+& 2 x_5 &=& 0 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &-& 2 x_5 &=& 0
	\end{array} \right.
\]的通解.
\begin{solution}
写出系数矩阵\(\A\)，并作初等行变换化简
\begin{align*}
	\A &= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-2\times\text{(1行)}+\text{(2行)} \\
		-4\times\text{(1行)}+\text{(3行)}
	\end{array}}
	\begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-3\times\text{(2行)}+\text{(3行)} \\
		1\times\text{(2行)}+\text{(1行)}
	\end{array}}
	\begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \B,
\end{align*}
因为\(\rank\A=\rank\B=2\)，所以基础解系含\(5-2=3\)个向量.
分别将\(x_3,x_4,x_5\)的3组值\((2,0,0),(0,1,0),(0,0,1)\)代入\(\B\x=\z\)，
得基础解系：\[
	\X1 = (4,1,2,0,0)^T, \quad
	\X2 = (2,2,0,1,0)^T, \quad
	\X3 = (2,3,0,0,1)^T.
\]
原方程组的通解为\(k_1 \X1 + k_2 \X2 + k_3 \X3\)，其中\(k_1,k_2,k_3\)为任意常数.
\end{solution}
\end{example}

\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
揭示矩阵\(\A\)的秩与方程\(\A\x=\z\)的基础解系所含向量个数的关系.
它不仅对\(\A\x=\z\)的求解有重要意义，而且可以用来解决矩阵的秩的一些问题.
\begin{example}
设\(\A\)为\(s \times n\)矩阵，\(\B\)为\(n \times m\)矩阵，\(\A\B=\z\).
证明：\(\rank\A + \rank\B \leq n\).
\begin{proof}
设矩阵\(\B\)与\(\A\B=\z\)右端的零矩阵列分块矩阵分别为\[
	\B=(\AutoTuple{\b}{m}),
	\quad
	\z=(\z,\dotsc,\z)
\]
那么\[
	\A(\AutoTuple{\b}{m})
	= (\A\b_1,\A\b_2,\dotsc,\A\b_m)
	= (\z,\z,\dotsc,\z)
\]或\[
	\A\b_j = \z \quad(j=1,2,\dotsc,m)
\]
即\(\beta=\{\AutoTuple{\b}{m}\}\)是齐次线性方程组\(\A\x=\z\)解向量组.

若\(\rank\A=n\)，则\(\A\x=\z\)只有零解，\(\B=\z\)，\(\rank\B=0=n-\rank\A\).

若\(\rank\A<n\)，则\(X=\{\AutoTuple{\x}{n-r}\}\)是\(\A\x=\z\)的一个基础解系，
则\(\beta\)可由\(X\)线性表出，\(\rank\beta \leq \rank X\).
而\(\rank\beta=\rank\B\)，\(\rank X=n-\rank\A\).

综上所述，\(\rank\A+\rank\B \leq n\)成立.
\end{proof}
\end{example}

\begin{example}
已知向量\(\a_1 = \begin{bmatrix}
	1 \\ 2 \\ 3
\end{bmatrix},
\a_2 = \begin{bmatrix}
	2 \\ 1 \\ 1
\end{bmatrix},
\b_1 = \begin{bmatrix}
	2 \\ 5 \\ 9
\end{bmatrix},
\b_2 = \begin{bmatrix}
	1 \\ 0 \\ 1
\end{bmatrix}\).
若向量\(\g\)既可由\(\a_1,\a_2\)线性表出，
也可由\(\b_1,\b_2\)线性表出，求\(\g\).
\begin{solution}
设\(\g = x_1 \a_1 + x_2 \a_2 = x_3 \b_1 + x_4 \b_2\)，
则\(x_1 \a_1 + x_2 \a_2 - x_3 \b_1 - x_4 \b_2 = \z\).
又由于\[
	(\a_1,\a_2,-\b_1,-\b_2) = \begin{bmatrix}
		1 & 2 & -2 & -1 \\
		2 & 1 & -5 & 0 \\
		3 & 1 & -9 & -1
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & 0 & 0 & 3 \\
		0 & 1 & 0 & -1 \\
		0 & 0 & 1 & 1
	\end{bmatrix},
\]
解得\((x_1,x_2,x_3,x_4)^T = c (-3,1,-1,1)^T\ (c\in\mathbb{R})\).
因此\[
	\g = c (x_3 \b_1 + x_4 \b_2)
	= c \begin{bmatrix}
		-1 \\ -5 \\ -8
	\end{bmatrix}
	= k \begin{bmatrix}
		1 \\ 5 \\ 8
	\end{bmatrix}
	\quad(k\in\mathbb{R}).
\]
\end{solution}
\end{example}
