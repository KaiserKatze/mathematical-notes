\section{齐次线性方程组的解集的结构}
\subsection{解空间的概念}
\begin{proposition}\label{theorem:线性方程组.齐次线性方程组的解的线性组合也是解}
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质1
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质2
%@see: 《线性代数》（张慎语、周厚隆） P80 性质1
%@see: 《线性代数》（张慎语、周厚隆） P81 推论
齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的解的任意线性组合也是解.
\begin{proof}
设\(\vb{x}_1\)与\(\vb{x}_2\)是齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的任意两个解，
即\begin{equation*}
	\vb{A}\vb{x}_1=\vb0, \qquad
	\vb{A}\vb{x}_2=\vb0.
\end{equation*}
又设\(k\)是任意常数，那么有\begin{equation*}
	\vb{A} (\vb{x}_1 + \vb{x}_2) = \vb{A} \vb{x}_1 + \vb{A} \vb{x}_2 = \vb0 + \vb0 = \vb0,
\end{equation*}\begin{equation*}
	\vb{A} (k \vb{x}_1) = k (\vb{A} \vb{x}_1) = k \vb0 = \vb0,
\end{equation*}
所以\(\vb{x}_1 + \vb{x}_2\)与\(k \vb{x}_1\)都是\(\vb{A} \vb{x} = \vb0\)的解.
\end{proof}
\end{proposition}

\cref{theorem:线性方程组.齐次线性方程组的解的线性组合也是解} 表明，
\(n\)元齐次线性方程组\(x_1\vb\alpha_1+x_2\vb\alpha_2+\dotsb+x_n\vb\alpha_n=\vb0\)的解集\begin{equation*}
	W = \Set{
		\vb{x} \in K^n
		\given
		\vb{A} \vb{x} = \vb0
	}
\end{equation*}是\(K^n\)的一个子空间.
我们把它称为“方程组\(\vb{A} \vb{x} = \vb0\)的\DefineConcept{解空间}（space of solution）”
或者“矩阵\(\vb{A}\)的\DefineConcept{核空间}（kernel）\footnote{
	有的地方会把核空间称为\DefineConcept{零空间}（null space），
	%@see: https://mathworld.wolfram.com/NullSpace.html
	还特别把核空间的维数称为\DefineConcept{零度}（nullity），
	但是由于这个称谓容易与另一个同样叫做“零空间”
	但涵义是只含零空间的线性空间\(\{\vb0\}\)混淆，
	因此我们不采用这种命名方式.
}”，
并记为\(\Ker\vb{A}\).
如果这个方程组只有零解，那么\(W\)是零子空间.
如果这个方程组有非零解，那么\(W\)是非零子空间，从而\(W\)有基.
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P120 定义1
%@see: 《线性代数》（张慎语、周厚隆） P83
我们把解空间\(W\)的一个基称为这个方程组的一个\DefineConcept{基础解系}（basic set of solutions）.

如果我们找到了齐次线性方程组的一个基础解系\(\{\AutoTuple{\vb{x}}{t}\}\)，
\def\tongjie{k_1\vb{x}_1+k_2\vb{x}_2+\dotsb+k_t\vb{x}_t}%
那么这个方程组的解集为\begin{align*}
	W &= \Ker\vb{A}
	= \Span\{\AutoTuple{\vb{x}}{t}\} \\
	&= \Set{ \tongjie \given \AutoTuple{k}{t} \in K }.
\end{align*}
我们把表达式\((\tongjie)\)称为这个方程组的\DefineConcept{通解}（general solution）.

\begin{example}\label{example:齐次线性方程组的解集的结构.矩阵的像空间与它的转置的核空间互为正交补}
%@credit: {5f4d2f8a-fc8b-4798-85d6-98670f6761e7} 说\(\vb{A}^T\)的核空间就是\(\vb{A}\)的像空间的正交补
证明：矩阵\(\vb{A} \in M_{s \times n}(K)\)的像空间\(U \defeq \Im\vb{A}\)
和它的转置的核空间\(W \defeq \Ker\vb{A}^T\)满足\(
	(\forall \vb\alpha \in U)
	(\forall \vb\beta \in W)
	[
		\vb\alpha^T \vb\beta = 0
	]
\).
\begin{proof}
任取\(\vb\beta \in W\)，
则\(\vb{A}^T \vb\beta = \vb0\)
或\(\vb\beta^T \vb{A} = \vb0\).
任取\(\vb\alpha \in U\)，
则存在\(\vb{x}_0 \in K^n\)，
使得\begin{equation*}
	\vb{A} \vb{x}_0 = \vb\alpha.
	\eqno(1)
\end{equation*}
在(1)式等号两边同时左乘\(\vb\beta^T\)，
得\(
	\vb\beta^T \vb\alpha
	= (\vb\beta^T \vb{A}) \vb{x}_0
	= \vb0 \vb{x}_0
	= 0
\).
\end{proof}
\end{example}
\begin{remark}
同理可证：矩阵\(\vb{A}\)的核空间\(\Ker\vb{A}\)中任意一个向量\(\vb\alpha\)
与它的转置的像空间\(\Im\vb{A}^T\)中任意一个向量\(\vb\beta\)
满足\(\vb\alpha^T \vb\beta = 0\).
\end{remark}

\subsection{解空间的维数}
如何找出齐次线性方程组的一个基础解系？
解空间\(W\)的维数是多少？

\begin{theorem}\label{theorem:线性方程组.齐次线性方程组的解向量个数}
%@see: 《高等代数（第三版 上册）》（丘维声） P91 定理1
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P120 定理1
%@see: 《线性代数》（张慎语、周厚隆） P82 定理9
数域\(K\)上\(n\)元齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的解空间的维数与系数矩阵的秩
满足\begin{equation}
	\rank\vb{A} + \dim\Ker\vb{A} = n.
\end{equation}
当方程组有非零解时，它的每一个基础解系所含的解向量的数目都等于\(\dim W\).
\begin{proof}
首先假设\(\vb{A}\)是可逆矩阵，
那么\(\rank\vb{A} = n\)，
方程\(\vb{A} \vb{x} = \vb0\)只有零解，
矩阵\(\vb{A}\)的核空间是零子空间，
从而\(\dim\Ker\vb{A} = 0\)，
因此\begin{equation*}
	\rank\vb{A} + \dim\Ker\vb{A}
	= n + 0
	= n.
\end{equation*}

再假设\(\vb{A}\)不是可逆矩阵，
让\(\vb{A}\)经一系列初等行变换化为行约化矩阵\(\vb{B}\)，
那么\(\vb{A}\)与\(\vb{B}\)等价，
关于\(\vb{x}\)的齐次线性方程组\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)同解，
且\(\rank\vb{A} = \rank\vb{B} = r < n\).
显然存在置换矩阵\(\vb{P}\)，
使得\begin{equation*}
	\vb{B} \vb{P}
	= \begin{bmatrix}
		\vb{E}_r & \vb{F} \\
		\vb0 & \vb0
	\end{bmatrix},
\end{equation*}
其中\(\vb{E}_r\)是\(r\)阶单位矩阵，
\(\vb{F} \in M_{r\times(n-r)}(K)\).
令\(\vb{x} = \vb{P} \vb{y}\)，
则\(\vb{y}_0\)是\((\vb{B} \vb{P}) \vb{y} = \vb0\)的一个解，
当且仅当\(\vb{x}_0 \defeq \vb{P} \vb{y}_0\)是\(\vb{B} \vb{x} = \vb0\)的一个解.
注意到\begin{equation*}
	\vb{B} \vb{P}
	\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{E}_r & \vb{F} \\
		\vb0 & \vb0
	\end{bmatrix}
	\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{E}_r (-\vb{F}) + \vb{F} \vb{E}_{n-r} \\
		\vb0
	\end{bmatrix}
	= \vb0,
\end{equation*}
其中\(\vb{E}_{n-r}\)是\(n-r\)阶单位矩阵，
因此矩阵\(
	\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
\)的每一个列向量都是关于\(\vb{y}\)的齐次线性方程组\((\vb{B} \vb{P}) \vb{y} = \vb0\)的一个解，
换句话说矩阵\(
	\vb{X}
	\defeq
	\vb{P}
	\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
\)的每一个列向量都是关于\(\vb{x}\)的齐次线性方程组\(\vb{B} \vb{x} = \vb0\)或\(\vb{A} \vb{x} = \vb0\)的一个解.
由于置换矩阵\(\vb{P}\)是可逆矩阵，
所以\begin{equation*}
	\rank\vb{X}
	= \rank\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
	= \rank\vb{E}_{n-r}
	= n-r,
\end{equation*}
从而\(\vb{X}\)的列秩等于\(n-r\)，
% 根据\(\RankC\vb{A}=\dim(\SpanC\vb{A})\)
于是\(\vb{X}\)列空间的维数是\(\dim(\SpanC\vb{X}) = n-r\).
假设\(\vb{y}_0 = (\AutoTuple{y}{n})^T\)是\((\vb{B} \vb{P}) \vb{y} = \vb0\)的任意一个解，
那么\begin{equation*}
	\vb{y}_0
	- \begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
	(y_{r+1},\dotsc,y_n)^T
	= (z_1,\dotsc,z_r,0,\dotsc,0)^T
\end{equation*}
也是\((\vb{B} \vb{P}) \vb{y} = \vb0\)的一个解，
即\begin{equation*}
	\vb{B} \vb{P} (z_1,\dotsc,z_r,0,\dotsc,0)^T
	= \begin{bmatrix}
		z_1 \vb\epsilon_1 + \dotsb + z_r \vb\epsilon_r \\
		\vb0
	\end{bmatrix}
	= \vb0,
\end{equation*}
其中\(\AutoTuple{\vb\epsilon}{r}\)是\(\vb{E}_r\)的列向量组，
于是\(z_1 = \dotsb = z_r = 0\)，
即\begin{equation*}
	\vb{y}_0
	= \begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
	(y_{r+1},\dotsc,y_n)^T,
\end{equation*}
这就说明\((\vb{B} \vb{P}) \vb{y} = \vb0\)的任意一个解均可由\(
	\begin{bmatrix}
		-\vb{F} \\
		\vb{E}_{n-r}
	\end{bmatrix}
\)的列向量组线性表出，
继而说明\(\vb{A} \vb{x} = \vb0\)的任意一个解均可由\(\vb{X}\)的列向量组线性表出，
\(\vb{A}\)的核空间就是\(\vb{X}\)的的列空间，
因此\(\dim\Ker\vb{A} =\allowbreak n-r\).
综上所述\begin{equation*}
	\rank\vb{A} + \dim\Ker\vb{A}
	= r + (n-r)
	= n.
	\qedhere
\end{equation*}
\end{proof}
\end{theorem}

\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 的证明过程给出了
求解齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的基础解系的方法：
\begin{algorithm}[求解齐次线性方程组]
\hfill
\begin{enumerate}
	\item 把齐次线性方程组的系数矩阵\(\vb{A} \in M_{s \times n}(K)\)
	经过初等行变换化简成行约化矩阵\(\vb{J}\)；

	\item 从\(\vb{J}\)中，找出非零首元对应的列\(\vb\beta_{i_1},\dotsc,\vb\beta_{i_r}\)，
	将这些列称为\DefineConcept{主列}（pivot column）；

	\item 从\(\vb{J}\)中，找出没有非零首元的列\(\vb\beta_{j_1},\dotsc,\vb\beta_{j_{n-r}}\)，
	将这些列称为\DefineConcept{自由列}（free column）；

	\item 各个自由列的负向量\(-\vb\beta_{j_1},\dotsc,-\vb\beta_{j_{n-r}}\)
	分别加上\(
		(0,\dotsc,0,\epsilon_1^T)^T,
		\dotsc,
		(0,\dotsc,0,\epsilon_{n-r}^T)^T
	\)，
	其中\(\AutoTuple{\epsilon}{n-r}\)是\(\vb{E}_{n-r}\)的列向量组，
	就是齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的一个基础解系.
\end{enumerate}
\end{algorithm}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P83 推论
%@see: 《高等代数（第三版 上册）》（丘维声） P95 习题3.7 3.
设齐次线性方程组\(\vb{A} \vb{x} = \vb0\)的系数矩阵\(\vb{A}\)是\(s \times n\)矩阵.
若\(\rank\vb{A} = r < n\)，
则\begin{itemize}
	\item \(\vb{A} \vb{x} = \vb0\)的每个基础解系都含有\(n-r\)个解向量；
	\item \(\vb{A} \vb{x} = \vb0\)的任意\(n-r+1\)个解向量线性相关；
	\item \(\vb{A} \vb{x} = \vb0\)的任意\(n-r\)个线性无关的解都是它的一个基础解系.
\end{itemize}
\end{corollary}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P84 例2
求齐次线性方程组\begin{equation*}
	\left\{ \begin{array}{*{11}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &+& 4 x_5 &=& 0 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &+& 2 x_5 &=& 0 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &-& 2 x_5 &=& 0
	\end{array} \right.
\end{equation*}的通解.
\begin{solution}
写出系数矩阵\(\vb{A}\)，并作初等行变换化简
\begin{align*}
	\vb{A} &= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-2\times\text{(1行)}+\text{(2行)} \\
		-4\times\text{(1行)}+\text{(3行)}
	\end{array}}
	\begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-3\times\text{(2行)}+\text{(3行)} \\
		1\times\text{(2行)}+\text{(1行)}
	\end{array}}
	\begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \vb{B},
\end{align*}
因为\(\rank\vb{A}=\rank\vb{B}=2\)，所以基础解系含\(5-2=3\)个向量.
分别将\(x_3,x_4,x_5\)的3组值\((2,0,0),(0,1,0),(0,0,1)\)代入\(\vb{B} \vb{x} = \vb0\)，
得基础解系：\begin{equation*}
	\vb{x}_1 = (4,1,2,0,0)^T, \quad
	\vb{x}_2 = (2,2,0,1,0)^T, \quad
	\vb{x}_3 = (2,3,0,0,1)^T.
\end{equation*}
原方程组的通解为\(k_1 \vb{x}_1 + k_2 \vb{x}_2 + k_3 \vb{x}_3\)，其中\(k_1,k_2,k_3\)为任意常数.
\end{solution}
%@Mathematica: A = {{1, -2, -1, 2, 4}, {2, -2, -3, 0, 2}, {4, -2, -7, -4, -2}}
%@Mathematica: RowReduce[A]
%@Mathematica: MatrixRank[A]
%@Mathematica: NullSpace[A]
\end{example}

\subsection{线性方程有公共解的条件}
\begin{proposition}
%@see: 《线性代数》（张慎语、周厚隆） P85 习题4.5 6(2)
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
则\begin{equation*}
	\text{$\vb{A} \vb{x} = \vb0$的解都是$\vb{B} \vb{x} = \vb0$的解}
	\implies
	\rank\vb{A} \geq \rank\vb{B}.
\end{equation*}
\begin{proof}
假设\(\vb{A} \vb{x} = \vb0\)的解都是\(\vb{B} \vb{x} = \vb0\)的解，
即\(\Ker\vb{A} \subseteq \Ker\vb{B} \subseteq K^n\).
由\cref{theorem:向量空间.两个非零子空间的关系1,theorem:线性方程组.齐次线性方程组的解向量个数} 可知\begin{equation*}
	%\rank\vb{A} + \dim\Ker\vb{A} = n.
	n - \rank\vb{A} = \dim\Ker\vb{A} \leq \dim\Ker\vb{B} = n - \rank\vb{B}.
\end{equation*}
即\(\rank\vb{B} \leq \rank\vb{A}\).
\end{proof}
\end{proposition}

%@see: [两个线性方程组的公共解与同解](https://zhuanlan.zhihu.com/p/665121966)
\begin{definition}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\).
\begin{itemize}
	\item 如果存在\(\vb{x}_0 \in K^n\)，
	使得\begin{equation*}
		\vb{A} \vb{x}_0 = \vb\beta_1
		\quad\text{和}\quad
		\vb{B} \vb{x}_0 = \vb\beta_2
	\end{equation*}同时成立，
	则称“\(\vb{A} \vb{x} = \vb\beta_1\)与\(\vb{B} \vb{x} = \vb\beta_2\)有\DefineConcept{公共解}”
	或者“\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta_1\)与\(\vb{B} \vb{x} = \vb\beta_2\)的一个\DefineConcept{公共解}”.

	\item 如果存在\(\vb{x}_0 \in K^n-\{\vb0\}\)，
	使得\begin{equation*}
		\vb{A} \vb{x}_0 = \vb0
		\quad\text{和}\quad
		\vb{B} \vb{x}_0 = \vb0
	\end{equation*}同时成立，
	则称“\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)有\DefineConcept{非零公共解}”
	或者“\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)的一个\DefineConcept{非零公共解}”.
\end{itemize}
\end{definition}

\begin{proposition}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
则\begin{align*}
	\text{\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)有非零公共解}
	&\iff
	\text{$\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}
	= \vb0$有非零解} \\
	&\iff
	\rank\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	< n.
\end{align*}
\begin{proof}
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9}
首先，假设\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)有非零公共解\(\vb{x}_0\)，
即成立\(\vb{A}\vb{x}_0=\vb0,
\vb{B}\vb{x}_0=\vb0\)，
那么\begin{equation*}
	\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}_0
	= \begin{bmatrix}
		\vb{A} \vb{x}_0 \\
		\vb{B} \vb{x}_0
	\end{bmatrix}
	= \begin{bmatrix}
		\vb0_{s\times1} \\
		\vb0_{s\times1}
	\end{bmatrix}
	= \vb0_{(2s)\times1}.
\end{equation*}

反过来，假设\(\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
\vb{x}
= \vb0_{(2s)\times1}\)有非零解\(\vb{x}_0\)，
即\(\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
\vb{x}_0
= \vb0_{(2s)\times1}\)，
于是\begin{equation*}
	\begin{bmatrix}
		\vb{A} \vb{x}_0 \\
		\vb{B} \vb{x}_0
	\end{bmatrix}
	= \begin{bmatrix}
		\vb0_{s\times1} \\
		\vb0_{s\times1}
	\end{bmatrix}.
	\qedhere
\end{equation*}
\end{proof}
\end{proposition}

\begin{corollary}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\)，
则\begin{align*}
	\text{$\vb{A}\vb{x}=\vb\beta_1$与$\vb{B}\vb{x}=\vb\beta_2$有公共解}
	&\iff \text{$\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}
	= \begin{bmatrix}
		\vb\beta_1 \\
		\vb\beta_2
	\end{bmatrix}$有解} \\
	&\iff
	\rank\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\vb{A} & \vb\beta_1 \\
		\vb{B} & \vb\beta_2
	\end{bmatrix}.
\end{align*}
\begin{proof}
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9}
假设\(\vb{A}\vb{x}=\vb\beta_1\)与\(\vb{B}\vb{x}=\vb\beta_2\)有公共解\(\vb{x}_0\)，
即成立\(\vb{A} \vb{x}_0 = \vb\beta_1,
\vb{B} \vb{x}_0 = \vb\beta_2\)，
那么\begin{equation*}
	\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}_0
	= \begin{bmatrix}
		\vb{A} \vb{x}_0 \\
		\vb{B} \vb{x}_0
	\end{bmatrix}
	= \begin{bmatrix}
		\vb\beta_1 \\
		\vb\beta_2
	\end{bmatrix}.
\end{equation*}

假设\(\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
\vb{x}
= \begin{bmatrix}
	\vb\beta_1 \\
	\vb\beta_2
\end{bmatrix}\)有解\(\vb{x}_0\)，
即\(\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
\vb{x}_0
= \begin{bmatrix}
	\vb\beta_1 \\
	\vb\beta_2
\end{bmatrix}\)，
于是\(\vb{A} \vb{x}_0 = \vb\beta_1,
\vb{A} \vb{x}_0 = \vb\beta_2\).

由\cref{theorem:向量空间.线性方程组有解判别定理} 可知，
\(\text{$\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
\vb{x}
= \begin{bmatrix}
	\vb\beta_1 \\
	\vb\beta_2
\end{bmatrix}$有解}
\iff
\rank\begin{bmatrix}
	\vb{A} \\ \vb{B}
\end{bmatrix}
= \rank\begin{bmatrix}
	\vb{A} & \vb\beta_1 \\
	\vb{B} & \vb\beta_2
\end{bmatrix}\).
\end{proof}
\end{corollary}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》一选择题/第7题
已知向量\(\vb\gamma\)既可由\begin{equation*}
	\vb\alpha_1 = (1,2,3)^T,
	\qquad
	\vb\alpha_2 = (2,1,1)^T
\end{equation*}线性表出，
也可由\begin{equation*}
	\vb\beta_1 = (2,5,9)^T,
	\qquad
	\vb\beta_2 = (1,0,1)^T
\end{equation*}线性表出，
求\(\vb\gamma\).
\begin{solution}\let\qed\relax
\begin{proof}[解法一]
由题意有\begin{equation*}
	\vb\gamma = k_1 \vb\alpha_1 + k_2 \vb\alpha_2
	= k_3 \vb\beta_1 + k_4 \vb\beta_2,
\end{equation*}
其中\(\AutoTuple{k}{4}\)是常数.
建立方程\begin{equation*}
	k_1 \vb\alpha_1 + k_2 \vb\alpha_2 + k_3 (-\vb\beta_1) + k_4 (-\vb\beta_2) = 0,
\end{equation*}
写出系数矩阵得\begin{equation*}
	\vb{A} = (\vb\alpha_1,\vb\alpha_2,-\vb\beta_1,-\vb\beta_2)
	= \begin{bmatrix}
		1 & 2 & -2 & -1 \\
		2 & 1 & -5 & 0 \\
		3 & 1 & -9 & -1
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & 0 & 0 & 3 \\
		0 & 1 & 0 & 1 \\
		0 & 0 & 1 & 1
	\end{bmatrix},
\end{equation*}
解得\((k_1,k_2,k_3,k_4)^T = k (3,-1,1,-3)^T\ (\text{$k$是常数})\)，
那么\begin{equation*}
	\vb\gamma
	= k_1 \vb\alpha_1 + k_2 \vb\alpha_2
	= k \left( 3 \vb\alpha_1 - \vb\alpha_2 \right)
	= k (1,5,8)^T
	\quad(\text{$k$是常数}).
\end{equation*}
\end{proof}
\begin{proof}[解法二]
在空间解析几何视角下，
向量\(\vb\gamma\)在向量\(\vb\alpha_1,\vb\alpha_2\)张成的平面上，
也在向量\(\vb\beta_1,\vb\beta_2\)张成的平面上，
也就是说向量\(\vb\gamma\)是这两个平面的交线的一个方向向量，
或者说\(\vb\gamma\)同时垂直于这两个平面的法向量，
于是\(\vb\gamma = k(
	\VectorOuterProduct
	{(\VectorOuterProduct{\vb\alpha_1}{\vb\alpha_2})}
	{(\VectorOuterProduct{\vb\beta_1}{\vb\beta_2})}
)
\ (\text{$k$是任意常数})\).
这里\begin{gather*}
	\VectorOuterProduct{\vb\alpha_1}{\vb\alpha_2}
	= \begin{vmatrix}
		\vb{i} & \vb{j} & \vb{k} \\
		1 & 2 & 3 \\
		2 & 1 & 1
	\end{vmatrix}
	= \begin{bmatrix}
		-1 \\
		5 \\
		-3
	\end{bmatrix}, \\
	\VectorOuterProduct{\vb\beta_1}{\vb\beta_2}
	= \begin{vmatrix}
		\vb{i} & \vb{j} & \vb{k} \\
		2 & 5 & 9 \\
		1 & 0 & 1
	\end{vmatrix}
	= \begin{bmatrix}
		5 \\
		7 \\
		-5
	\end{bmatrix},
\end{gather*}
最后得到\begin{equation*}
	\vb\gamma
	= k_1 \begin{vmatrix}
		\vb{i} & \vb{j} & \vb{k} \\
		-1 & 5 & -3 \\
		5 & 7 & -5
	\end{vmatrix}
	= k_1 \begin{bmatrix}
		-4 \\
		-20 \\
		-32
	\end{bmatrix}
	= k \begin{bmatrix}
		1 \\ 5 \\ 8
	\end{bmatrix}.
\end{equation*}
\end{proof}
\end{solution}
\end{example}

\subsection{线性方程同解的条件}
\begin{proposition}\label{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件1}
%@credit: {b8a6b30d-44bc-4d7a-a6b5-574e615c5be0}
设\(\vb{A} \in M_{s \times n}(K), \vb{B} \in M_{t \times n}(K)\)，
则\(\vb{A} \vb{x} = \vb0\)的解都是\(\vb{B} \vb{x} = \vb0\)的解，
当且仅当\(\vb{A} \vb{x} = \vb0\)与\(
	\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}
	= \vb0
\)同解.
\begin{proof}
假设\(\vb{A} \vb{x} = \vb0\)的解都是\(\vb{B} \vb{x} = \vb0\)的解，
即\(
	\Set{
		\vb{x}
		\given
		\vb{A} \vb{x} = \vb0
	}
	\subseteq
	\Set{
		\vb{x}
		\given
		\vb{B} \vb{x} = \vb0
	}
\)，
那么由\cref{equation:集合论.集合代数公式7-3} 可知\begin{equation*}
	\Set{
		\vb{x}
		\given
		\vb{A} \vb{x} = \vb0
	}
	=
	\Set{
		\vb{x}
		\given
		\vb{A} \vb{x} = \vb0
	}
	\cap
	\Set{
		\vb{x}
		\given
		\vb{B} \vb{x} = \vb0
	}
	% 交集的定义
	= \Set{
		\vb{x}
		\given
		\vb{A} \vb{x} = \vb0,
		\vb{B} \vb{x} = \vb0
	},
\end{equation*}
这就说明\(\vb{A} \vb{x} = \vb0\)与\(
	\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}
	= \vb0
\)同解.
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件2}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
则\begin{align*}
	\text{$\vb{A} \vb{x} = \vb0$与$\vb{B} \vb{x} = \vb0$同解}
	&\iff
	\text{$\vb{A} \vb{x} = \vb0$、
	$\vb{B} \vb{x} = \vb0$
	与$\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	\vb{x}
	= \vb0$同解} \\
	&\iff
	\rank\vb{A}
	= \rank\vb{B}
	= \rank\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix} \\
	&\iff
	\text{$\vb{A}$的行向量组与$\vb{B}$的行向量组等价}.
\end{align*}
%TODO proof
\end{proposition}

\begin{proposition}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\)，
方程\(\vb{A}\vb{x}=\vb\beta_1\)和\(\vb{B}\vb{x}=\vb\beta_2\)都有解，
则\begin{align*}
	&\text{$\vb{A}\vb{x}=\vb\beta_1$与$\vb{B}\vb{x}=\vb\beta_2$同解} \\
	&\iff
	\text{$\vb{A} \vb{x} = \vb0$与$\vb{B} \vb{x} = \vb0$同解，
	且$\vb{A}\vb{x}=\vb\beta_1$与$\vb{B}\vb{x}=\vb\beta_2$有公共解} \\
	&\iff
	\rank\vb{A} = \rank\vb{B}
	= \rank\begin{bmatrix}
		\vb{A} \\ \vb{B}
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\vb{A} & \vb\beta_1 \\
		\vb{B} & \vb\beta_2
	\end{bmatrix} \\
	&\iff
	\text{$(\vb{A},\vb\beta_1)$的行向量组与$(\vb{B},\vb\beta_2)$的行向量组等价}.
\end{align*}
%TODO proof
%\cref{example:向量空间.等秩矩阵的行向量组的等价性}
\end{proposition}

\begin{proposition}\label{theorem:线性方程组.同解方程组的系数矩阵的秩相同}
设\(\vb{A},\vb{B} \in M_{s \times n}(K)\)，
则“\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)同解”
是“\(\rank\vb{A}=\rank\vb{B}\)”的充分不必要条件.
\begin{proof}
假设\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)同解，
那么方程\(\vb{A} \vb{x} = \vb0\)的解空间与\(\vb{B} \vb{x} = \vb0\)的解空间相同，
那么由\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
有\(n-\rank\vb{A}=n-\rank\vb{B}\)，\(\rank\vb{A}=\rank\vb{B}\).

反过来，
取\(\vb{A} = (1,0),
\vb{B} = (0,1)\).
显然\(\rank\vb{A} = \rank\vb{B} = 1\).
但是线性方程组\(\vb{A} \vb{x} = \vb0\)的解是\(k_1(0,1)^T\ (\text{$k_1$是常数})\)，
而\(\vb{B} \vb{x} = \vb0\)的解是\(k_2(1,0)^T\ (\text{$k_2$是常数})\).
\end{proof}
\end{proposition}

\begin{example}
%@see: 《2022年全国硕士研究生入学统一考试（数学一）》一选择题/第6题/选项(D)
设矩阵\(\vb{A},\vb{B} \in M_n(K)\).
举例说明：即便方程\(\vb{A} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)同解，
但是方程\(\vb{A} \vb{B} \vb{x} = \vb0\)与\(\vb{B} \vb{A} \vb{x} = \vb0\)不同解.
\begin{solution}
取\(\vb{A} = \begin{bmatrix}
	0 & 1 \\
	0 & 0
\end{bmatrix},
\vb{B} = \begin{bmatrix}
	0 & 1 \\
	0 & 1
\end{bmatrix}\)，
则\begin{equation*}
	\vb{A} \vb{B} = \begin{bmatrix}
		0 & 1 \\
		0 & 0
	\end{bmatrix},
	\qquad
	\vb{B} \vb{A} = \begin{bmatrix}
		0 & 0 \\
		0 & 0
	\end{bmatrix},
\end{equation*}
既然\(\rank(\vb{A} \vb{B}) = 1 \neq \rank(\vb{B} \vb{A}) = 0\)，
所以方程\(\vb{A} \vb{B} \vb{x} = \vb0\)与\(\vb{B} \vb{A} \vb{x} = \vb0\)不同解.
\end{solution}
\end{example}

\begin{proposition}\label{theorem:线性方程组.同解方程组.特例1}
设\(\vb{A} \in M_{s \times n}(K),
\vb{B} \in M_{n \times m}(K)\)，
则\begin{equation*}
	\text{$(\vb{A}\vb{B})\vb{x}=\vb0$与$\vb{B} \vb{x} = \vb0$同解}
	\iff
	\rank(\vb{A}\vb{B})=\rank\vb{B}.
\end{equation*}
\begin{proof}
充分性.
由\cref{theorem:线性方程组.同解方程组的系数矩阵的秩相同} 可知\begin{equation*}
	\text{$(\vb{A}\vb{B})\vb{x}=\vb0$与$\vb{B} \vb{x} = \vb0$同解}
	\implies
	\rank(\vb{A}\vb{B})=\rank\vb{B}.
\end{equation*}

必要性.
设\(\vb\xi\)是\(\vb{B} \vb{x} = \vb0\)的一个解，
即\(\vb{B}\vb\xi=\vb0\)，
那么左乘\(\vb{A}\)便得\(\vb{A}\vb{B}\vb\xi=\vb0\)，
这就说明\(\vb\xi\)也是\((\vb{A}\vb{B})\vb{x}=\vb0\)的一个解.
由于\(\vb\xi\)的任意性，
所以\(\vb{B} \vb{x} = \vb0\)的解都是\((\vb{A}\vb{B})\vb{x}=\vb0\)的解，
也就是说\begin{equation*}
	\Ker\vb{B}
	\subseteq
	\Ker(\vb{A}\vb{B}).
\end{equation*}
因为\(\rank(\vb{A}\vb{B})=\rank\vb{B}\)，
所以由\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 可知\begin{equation*}
	\dim(\Ker(\vb{A}\vb{B}))
	=\dim(\Ker\vb{B}).
\end{equation*}
因此由\cref{theorem:向量空间.两个非零子空间的关系2} 可知\begin{equation*}
	\Ker\vb{B}
	=\Ker(\vb{A}\vb{B}),
\end{equation*}
也就是说\(\vb{A}\vb{B} \vb{x} = \vb0\)与\(\vb{B} \vb{x} = \vb0\)同解.
\end{proof}
\end{proposition}
\begin{remark}
由\cref{theorem:线性方程组.同解方程组.特例1,theorem:向量空间.用列满秩矩阵左乘任一矩阵不变秩} 可知
如果\(\vb{A}\)是列满秩矩阵，
那么\((\vb{A}\vb{B})\vb{x}=\vb0\)与\(\vb{B} \vb{x} = \vb0\)同解.
\end{remark}
%@see: https://www.bilibili.com/video/BV1eYqHYnE7B/

\begin{example}\label{example:线性方程组.左乘系数矩阵的转置矩阵同解}
%@see: 《高等代数（第三版 上册）》（丘维声） P122 命题2
设\(\vb{A}\in M_{s \times n}(\mathbb{R})\).
证明：齐次线性方程组\(\vb{A} \vb{x} = \vb0\)与\((\vb{A}^T\vb{A})\vb{x}=\vb0\)同解.
\begin{proof}
设\(\vb\xi\)是\(\vb{A} \vb{x} = \vb0\)的任意一个解，
则\(\vb{A}\vb\xi=\vb0\)，于是\begin{equation*}
	(\vb{A}^T\vb{A})\vb\xi=\vb{A}^T(\vb{A}\vb\xi)=\vb{A}^T\vb0=\vb0,
\end{equation*}
这就是说\(\vb\xi\)是\((\vb{A}^T\vb{A})\vb{x}=\vb0\)的一个解.

又设\(\vb\eta\)是\((\vb{A}^T\vb{A})\vb{x}=\vb0\)的任意一个解，
则\begin{equation*}
	(\vb{A}^T\vb{A})\vb\eta=\vb0.
	\eqno(1)
\end{equation*}
在(1)式等号两边同时左乘\(\vb\eta^T\)得\begin{equation*}
	\vb\eta^T(\vb{A}^T\vb{A})\vb\eta=(\vb{A}\vb\eta)^T(\vb{A}\vb\eta)=0.
	\eqno(2)
\end{equation*}

假设\(\vb{A}\vb\eta=(\AutoTuple{c}{s})^T\in\mathbb{R}^s\).
由(2)式有\begin{equation*}
	(\AutoTuple{c}{s}) (\AutoTuple{c}{s})^T
	= \AutoTuple{c}{n}[+][2]
	= 0.
\end{equation*}
由于\(\AutoTuple{c}{n}\in\mathbb{R}\)，
所以\(\AutoTuple{c}{n}[=]=0\)，
\(\vb{A}\vb\eta=\vb0\)，
这就是说\(\vb\eta\)是\(\vb{A} \vb{x} = \vb0\)的一个解.

综上所述，\((\vb{A}^T\vb{A})\vb{x}=\vb0\)与\(\vb{A} \vb{x} = \vb0\)同解.
\end{proof}
\end{example}
\begin{example}
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9} 指出\((\vb{A}\vb{A}^T)\vb{x}=\vb0\)与\(\vb{A} \vb{x} = \vb0\)不一定同解
设\(\vb{A} \in M_n(K)\)，\(\vb{A}^T\)是\(\vb{A}\)的转置矩阵.
举例说明：\((\vb{A}\vb{A}^T)\vb{x}=\vb0\)与\(\vb{A} \vb{x} = \vb0\)不同解.
\begin{solution}
%@Mathematica: A = {{0, 1}, {0, 0}}
%@Mathematica: Transpose[A]
%@Mathematica: A.Transpose[A]
取\(\vb{A} = \begin{bmatrix}
	0 & 1 \\
	0 & 0
\end{bmatrix}\)，
则\(\vb{A}^T = \begin{bmatrix}
	0 & 0 \\
	1 & 0
\end{bmatrix},
\vb{A} \vb{A}^T = \begin{bmatrix}
	1 & 0 \\
	0 & 0
\end{bmatrix}\)，
可以解得\begin{gather*}
	\Ker\vb{A} = \Set{ k (1,0)^T \given k \in K }, \\
	\Ker(\vb{A} \vb{A}^T) = \Ker\vb{A}^T = \Set{ k (0,1)^T \given k \in K }.
\end{gather*}
\end{solution}
\end{example}
\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P122 命题2
设\(\vb{A} \in M_{s \times n}(\mathbb{R})\).
求证：\begin{equation}\label{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩}
	\rank\vb{A} = \rank(\vb{A} \vb{A}^T) = \rank(\vb{A}^T \vb{A}).
\end{equation}
\begin{proof}
由\cref{example:线性方程组.左乘系数矩阵的转置矩阵同解} 可知
\(\vb{A} \vb{x} = \vb0\)与\((\vb{A}^T \vb{A}) \vb{x} = \vb0\)同解，
所以由\cref{theorem:线性方程组.同解方程组的系数矩阵的秩相同} 可知
\(\rank\vb{A} = \rank(\vb{A}^T \vb{A})\).
又由\cref{theorem:向量空间.转置不变秩} 可知
\(\rank(\vb{A} \vb{A}^T)
= \rank[(\vb{A}^T)^T (\vb{A}^T)]
= \rank\vb{A}^T
= \rank\vb{A}\).
\end{proof}
\end{example}
\begin{remark}
应该注意到\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩} 成立的前提条件是：
矩阵\(\vb{A}\)是实矩阵.
如果矩阵\(\vb{A}\)不是实矩阵，\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩} 就不一定成立.
例如，取矩阵\(\vb{A} = \begin{bmatrix}
	1 & \iu \\
	0 & 0
\end{bmatrix}
\in M_2(\mathbb{C})\)，
易见\(\vb{A} \vb{A}^T = \begin{bmatrix}
	0 & 0 \\
	0 & 0
\end{bmatrix}\)，
于是\(\rank\vb{A}=1\)而\(\rank(\vb{A}\vb{A}^T)=0\)，
也就是说\(\rank\vb{A}\neq\rank(\vb{A}\vb{A}^T)\).
\end{remark}
\begin{example}
%@see: 《高等代数与解析几何（上册）》（盛为民、李方） P193 本章拓展题 2.
设\(\vb{A} \in M_{s \times n}(\mathbb{C})\).
求证：\begin{equation}
	\rank\vb{A} = \rank(\vb{A} \vb{A}^H) = \rank(\vb{A}^H \vb{A}).
\end{equation}
%TODO
\end{example}

\begin{example}
%@see: 《2025年全国硕士研究生入学统一考试（数学一）》二填空题/第15题
设矩阵\(\vb{A} = \begin{bmatrix}
	4 & 2 & -3 \\
	a & 3 & -4 \\
	b & 5 & -7
\end{bmatrix}\)，
且\(\vb{A}^2 \vb{X} = \vb0\)
与\(\vb{A} \vb{X} = \vb0\)不同解.
求\(a-b\).
\begin{solution}
%@Mathematica: A = {{4, 2, -3}, {a, 3, -4}, {b, 5, -7}}
假设\(\rank\vb{A} = 3\)，
则由\cref{example:西尔维斯特不等式.可逆矩阵的正整数次幂可逆} 可知
\(\rank\vb{A}^2\)也是满秩矩阵，
从而\(\vb{A}^2 \vb{X} = \vb0\)
与\(\vb{A} \vb{X} = \vb0\)均只有零解，
不满足题目要求.
因此\(\rank\vb{A} < 3\)，
那么由\cref{theorem:逆矩阵.矩阵可逆的充分必要条件1} 有\begin{equation*}
	\abs{\vb{A}}
	= \begin{vmatrix}
		4 & 2 & -3 \\
		a & 3 & -4 \\
		b & 5 & -7
	\end{vmatrix}
	= \begin{vmatrix}
		4 & 2 & -3 \\
		a & 3 & -4 \\
		-4-a+b & 0 & 0
	\end{vmatrix}
	= -4 - a + b
	= 0,
\end{equation*}
%@Mathematica: Solve[Det[A] == 0 /. {a -> x + b}, x]
于是\(a-b=-4\).
\end{solution}
\end{example}
