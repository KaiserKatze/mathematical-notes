\section{齐次线性方程组的解集的结构}
\subsection{解空间的概念}
\begin{proposition}\label{theorem:线性方程组.齐次线性方程组的解的线性组合也是解}
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质1
%@see: 《高等代数（第三版 上册）》（丘维声） P90 性质2
%@see: 《线性代数》（张慎语、周厚隆） P80 性质1
%@see: 《线性代数》（张慎语、周厚隆） P81 推论
齐次线性方程组\(\A\vb{x}=\vb0\)的解的任意线性组合也是解.
\begin{proof}
设\(\X1\)与\(\X2\)是齐次线性方程组\(\A\vb{x}=\vb0\)的任意两个解，
即\[
	\A\X1=\vb0, \qquad
	\A\X2=\vb0.
\]
又设\(k\)是任意常数，那么有\[
	\A (\X1 + \X2) = \A \X1 + \A \X2 = \vb0 + \vb0 = \vb0,
\]\[
	\A (k \X1) = k (\A \X1) = k \vb0 = \vb0,
\]
所以\(\X1 + \X2\)与\(k \X1\)都是\(\A \x = \vb0\)的解.
\end{proof}
\end{proposition}

\cref{theorem:线性方程组.齐次线性方程组的解的线性组合也是解} 表明，
\(n\)元齐次线性方程组\(x_1\a_1+x_2\a_2+\dotsb+x_n\a_n=\vb0\)的解集\[
	W = \Set{
		\x \in K^n
		\given
		\A\vb{x}=\vb0
	}
\]是\(K^n\)的一个子空间.
我们把它称为“方程组\(\A\vb{x}=\vb0\)的\DefineConcept{解空间}（space of solution）”
或者“矩阵\(\A\)的\DefineConcept{核空间}（kernel）\footnote{有的地方
会把核空间称为\DefineConcept{零空间}（null space），
还特别把核空间的维数称为\DefineConcept{零度}（nullity），
但是由于这个称谓容易与另一个同样叫做“零空间”但涵义是只含零空间的线性空间\(\{\vb0\}\)混淆，
因此我们不采用这种命名方式.}”，
并记为\(\Ker\A\).
%@see: https://mathworld.wolfram.com/NullSpace.html
如果这个方程组只有零解，那么\(W\)是零子空间.
如果这个方程组有非零解，那么\(W\)是非零子空间，从而\(W\)有基.
我们把解空间\(W\)的一个基称为这个方程组的一个\DefineConcept{基础解系}（basic set of solutions）.

如果我们找到了齐次线性方程组的一个基础解系\(\{\AutoTuple{\x}{t}\}\)，
\def\tongjie{k_1\x_1+k_2\x_2+\dotsb+k_t\x_t}%
那么这个方程组的解集为\begin{align*}
	W &= \Ker\A
	= \Span\{\AutoTuple{\x}{t}\} \\
	&= \Set{ \tongjie \given \AutoTuple{k}{t} \in K }.
\end{align*}
我们把表达式\((\tongjie)\)称为这个方程组的\DefineConcept{通解}（general solution）.

\subsection{解空间的维数}
如何找出齐次线性方程组的一个基础解系？
解空间\(W\)的维数是多少？

\begin{theorem}\label{theorem:线性方程组.齐次线性方程组的解向量个数}
%@see: 《高等代数（第三版 上册）》（丘维声） P91 定理1
数域\(K\)上\(n\)元齐次线性方程组\(\A\vb{x}=\vb0\)的解空间的维数与系数矩阵的秩满足\begin{equation}
	\rank\A + \dim\Ker\A = n.
\end{equation}
当方程组有非零解时，它的每一个基础解系所含的解向量的数目都等于\(\dim W\).
\begin{proof}
设\(\A\)经一系列初等行变换化为阶梯形矩阵\(\B\)，
那么由\cref{theorem:线性方程组.初等变换不变秩} 可知\[
	\rank\B = \rank\A = r,
\]
也就是说\(\B\)的前\(r\)行向量不为零.

不失一般性，
设\(\B\)的第\(i\)行非零首元为\(b_{ii}\ (i=1,2,\dotsc,r)\)，则\[
	\A \to \B = \begin{bmatrix}
		\B_1 & \B_2 \\
		\vb0 & \vb0
	\end{bmatrix},
\]
其中\[
	\B_1 = \begin{bmatrix}
		b_{11} & b_{12} & \dots & b_{1r} \\
		& b_{22} & \dots & b_{2r} \\
		& & \ddots & \vdots \\
		& & & b_{rr}
	\end{bmatrix},
	\qquad
	\B_2 = \begin{bmatrix}
		b_{1,r+1} & \dots & b_{1n} \\
		b_{2,r+1} & \dots & b_{2n} \\
		\vdots & & \vdots \\
		b_{r,r+1} & \dots & b_{rn}
	\end{bmatrix}.
\]

记\[
	\x = (x_1,x_2,\dotsc,x_r,x_{r+1},\dotsc,x_n)^T,
\]
将自由未知量\(x_{r+1},x_{r+2},\dotsc,x_n\)的一组值\((1,0,\dotsc,0)\)代入\[
	\B \x = \vb0,
\]
去掉\(0 = 0\)的等式，
移项得线性方程组\[
	\begin{bmatrix}
		b_{11} & b_{12} & \dots & b_{1r} \\
		& b_{22} & \dots & b_{2r} \\
		& & \ddots & \vdots \\
		& & & b_{rr}
	\end{bmatrix}
	\begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_r
	\end{bmatrix}
	= \begin{bmatrix}
		-b_{1,r+1} \\
		-b_{2,r+1} \\
		\vdots \\
		-b_{r,r+1}
	\end{bmatrix}.
	\eqno(1)
\]
系数行列式\(D = b_{11} b_{22} \dotsm b_{rr} \neq 0\).

由克拉默法则，(1)式有唯一解，于是得\(\A\vb{x}=\vb0\)的一个解\[
\X1 = (c_{11},c_{21},\dotsc,c_{r1},1,0,\dotsc,0)^T.
\]

同理，分别将\(x_{r+1},x_{r+2},\dotsc,x_n\)的值\((0,1,\dotsc,0),\dotsc,(0,0,\dotsc,1)\)代入\[
	\B \x = \vb0,
\]
求出\(\A\vb{x}=\vb0\)的相应的解\[
	\begin{array}{rcl}
		\X2 &=& (c_{12},c_{22},\dotsc,c_{r2},0,1,\dotsc,0)^T, \\
		&\vdots& \\
		\X{n-r} &=& (c_{1,n-r},c_{2,n-r},\dotsc,c_{r,n-r},0,0,\dotsc,1)^T.
	\end{array}
\]

易见，\begin{enumerate}
	\item \(\AutoTuple{\x}{n-r}\)是\(\A\vb{x}=\vb0\)的解；

	\item 考虑向量方程\(k_1\X1+k_2\X2+\dotsb+k_{n-r}\X{n-r}=\vb0\)，即\[
		(l_1,l_2,\dotsc,l_r,k_1,k_2,\dotsc,k_{n-r})^T
		= (0,0,\dotsc,0,0,\dotsc,0)^T,
	\]
	有\[
		k_1 = k_2 = \dotsb = k_{n-r} = 0,
	\]
	即\(\AutoTuple{\x}{n-r}\)线性无关；

	\item 设\(\x=(c_1,c_2,\dotsc,c_r,k_1,k_2,\dotsc,k_{n-r})^T\)是方程组\(\A\vb{x}=\vb0\)的任意一个解，
	则\[
		\x - (k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r})
		= (d_1,d_2,\dotsc,d_r,0,0,\dotsc,0)^T
	\]是齐次方程组的解，
	代入\(\B\vb{x}=\vb0\)，去掉\(0 = 0\)的等式，得\[
		\begin{bmatrix}
			b_{11} & b_{12} & \dots & b_{1r} \\
			& b_{22} & \dots & b_{2r} \\
			& & \ddots & \vdots \\
			& & & b_{rr}
		\end{bmatrix}
		\begin{bmatrix}
			d_1 \\ d_2 \\ \vdots \\ d_r
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ 0 \\ \vdots \\ 0
		\end{bmatrix}.
	\]
	因为系数行列式\(\abs{\B_1} \neq 0\)，
	所以\(d_1 = d_2 = \dotsb = d_r = 0\).
	于是\[
		\x - (k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r}) = \vb0,
	\]或\[
		\x = k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r}.
	\]
\end{enumerate}

综上所述，\(\AutoTuple{\x}{n-r}\)是\(\A\vb{x}=\vb0\)的一个基础解系，含有\(n-r\)个解向量.
\end{proof}
\end{theorem}
\begin{remark}
\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 的证明过程给出了
求解齐次线性方程组\(\A\vb{x}=\vb0\)的基础解系的方法：
\def\J{\vb{J}}
\begin{enumerate}
	\item[第一步] 把齐次线性方程组的系数矩阵\(\A\)经过初等行变换化简成行约化矩阵\(\J\).
	\item[第二步] 从\(\J\)直接写出方程组的一般解公式.
	\item[第三步] 在一般解公式中，每一次让一个自由未知量取值1，其余自由未知量取值0，求出方程组的一个解向量.
	这样得到的\(n-r\)个解向量就构成方程组的一个基础解系，其中\(r=\rank\A\).
\end{enumerate}
\end{remark}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P83 推论
%@see: 《高等代数（第三版 上册）》（丘维声） P95 习题3.7 3.
设齐次线性方程组\(\A\vb{x}=\vb0\)的系数矩阵\(\A\)是\(s \times n\)矩阵.
若\(\rank\A = r < n\)，
则\begin{itemize}
	\item \(\A\vb{x}=\vb0\)的每个基础解系都含有\(n-r\)个解向量；
	\item \(\A\vb{x}=\vb0\)的任意\(n-r+1\)个解向量线性相关；
	\item \(\A\vb{x}=\vb0\)的任意\(n-r\)个线性无关的解都是它的一个基础解系.
\end{itemize}
\end{corollary}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P84 例2
求齐次线性方程组\[
	\left\{ \begin{array}{*{11}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &+& 4 x_5 &=& 0 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &+& 2 x_5 &=& 0 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &-& 2 x_5 &=& 0
	\end{array} \right.
\]的通解.
\begin{solution}
写出系数矩阵\(\A\)，并作初等行变换化简
\begin{align*}
	\A &= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-2\times\text{(1行)}+\text{(2行)} \\
		-4\times\text{(1行)}+\text{(3行)}
	\end{array}}
	\begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		-3\times\text{(2行)}+\text{(3行)} \\
		1\times\text{(2行)}+\text{(1行)}
	\end{array}}
	\begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \B,
\end{align*}
因为\(\rank\A=\rank\B=2\)，所以基础解系含\(5-2=3\)个向量.
分别将\(x_3,x_4,x_5\)的3组值\((2,0,0),(0,1,0),(0,0,1)\)代入\(\B\vb{x}=\vb0\)，
得基础解系：\[
	\X1 = (4,1,2,0,0)^T, \quad
	\X2 = (2,2,0,1,0)^T, \quad
	\X3 = (2,3,0,0,1)^T.
\]
原方程组的通解为\(k_1 \X1 + k_2 \X2 + k_3 \X3\)，其中\(k_1,k_2,k_3\)为任意常数.
\end{solution}
\end{example}

\subsection{齐次方程有公共解的条件}
\begin{definition}
设\(\A,\B \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\).
如果存在\(\vb{x}_0 \in K^n-\{\vb0\}\)，
使得\[
	\A \vb{x}_0 = \vb\beta_1
	\quad\text{和}\quad
	\B \vb{x}_0 = \vb\beta_2
\]同时成立，
则称“\(\A\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)有非零公共解”
“\(\vb{x}_0\)是\(\A\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)的一个非零公共解”.
\end{definition}

\begin{proposition}
设\(\A,\B \in M_{s \times n}(K)\)，
则\begin{align*}
	\text{\(\A\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)有非零公共解}
	&\iff
	\text{$\begin{bmatrix}
		\A \\ \B
	\end{bmatrix}
	\vb{x}
	= \vb0$有非零解} \\
	&\iff
	\rank\begin{bmatrix}
		\A \\ \B
	\end{bmatrix}
	< n.
\end{align*}
%TODO proof
\end{proposition}

\begin{corollary}
设\(\A,\B \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\)，
则\[
	\text{$\A\vb{x}=\vb\beta_1$与$\B\vb{x}=\vb\beta_2$有公共解}
	\iff
	\rank\begin{bmatrix}
		\A \\ \B
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\A & \vb\beta_1 \\
		\B & \vb\beta_2
	\end{bmatrix}.
\]
%TODO proof
\end{corollary}

\subsection{齐次方程同解的条件}
\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P85 习题4.5 6(2)
设\(\A,\B \in M_{s \times n}(K)\)，
则\[
	\text{$\A\vb{x}=\vb0$的解都是$\B\vb{x}=\vb0$的解}
	\implies
	\rank\A \geq \rank\B.
\]
%TODO
\end{example}

\begin{proposition}
设\(\A,\B \in M_{s \times n}(K)\)，
则\begin{align*}
	\text{$\A\vb{x}=\vb0$与$\B\vb{x}=\vb0$同解}
	&\iff
	\text{$\A\vb{x}=\vb0$、
	$\B\vb{x}=\vb0$
	与$\begin{bmatrix}
		\A \\ \B
	\end{bmatrix}
	\vb{x}
	= \vb0$同解} \\
	&\iff
	\rank\A
	= \rank\B
	= \rank\begin{bmatrix}
		\A \\ \B
	\end{bmatrix} \\
	&\iff
	\text{$\A$的行向量组与$\B$的行向量组等价}.
\end{align*}
%TODO proof
\end{proposition}

\begin{proposition}
设\(\A,\B \in M_{s \times n}(K)\)，
\(\vb\beta_1,\vb\beta_2 \in K^s\)，
方程\(\A\vb{x}=\vb\beta_1\)和\(\B\vb{x}=\vb\beta_2\)都有解，
则\begin{align*}
	\text{$\A\vb{x}=\vb\beta_1$与$\B\vb{x}=\vb\beta_2$同解}
	&\iff
	\text{$\A\vb{x}=\vb0$与$\B\vb{x}=\vb0$同解，
	且$\A\vb{x}=\vb\beta_1$与$\B\vb{x}=\vb\beta_2$有公共解} \\
	&\iff
	\rank\A = \rank\B
	= \rank\begin{bmatrix}
		\A \\ \B
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\A & \vb\beta_1 \\
		\B & \vb\beta_2
	\end{bmatrix} \\
	&\iff
	\text{$(\A,\vb\beta_1)$的行向量组与$(\B,\vb\beta_2)$的行向量组等价}.
\end{align*}
%TODO proof
\end{proposition}

\begin{proposition}\label{theorem:线性方程组.同解方程组的系数矩阵的秩相同}
设\(\A,\B \in M_{s \times n}(K)\)，
则“\(\A\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)同解”
是“\(\rank\A=\rank\B\)”的充分不必要条件.
\begin{proof}
假设\(\A\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)同解，
那么方程\(\A\vb{x}=\vb0\)的解空间与\(\B\vb{x}=\vb0\)的解空间相同，
那么由\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
有\(n-\rank\A=n-\rank\B\)，\(\rank\A=\rank\B\).

反过来，
取\(\A = (1,0),
\B = (0,1)\).
显然\(\rank\A = \rank\B = 1\).
但是线性方程组\(\A\vb{x}=\vb0\)的解是\(k_1(0,1)^T\ (\text{$k_1$是常数})\)，
而\(\B\vb{x}=\vb0\)的解是\(k_2(1,0)^T\ (\text{$k_2$是常数})\).
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:线性方程组.同解方程组.特例1}
设\(\A \in M_{s \times n}(K),
\B \in M_{n \times m}(K)\)，
则\[
	\text{$(\A\B)\x=\vb0$与$\B\vb{x}=\vb0$同解}
	\iff
	\rank(\A\B)=\rank\B.
\]
\begin{proof}
充分性.
由\cref{theorem:线性方程组.同解方程组的系数矩阵的秩相同} 可知\[
	\text{$(\A\B)\x=\vb0$与$\B\vb{x}=\vb0$同解}
	\implies
	\rank(\A\B)=\rank\B.
\]

必要性.
设\(\vb\xi\)是\(\B\vb{x}=\vb0\)的一个解，
即\(\B\vb\xi=\vb0\)，
那么左乘\(\A\)便得\(\A\B\vb\xi=\vb0\)，
这就说明\(\vb\xi\)也是\((\A\B)\x=\vb0\)的一个解.
由于\(\vb\xi\)的任意性，
所以\(\B\vb{x}=\vb0\)的解都是\((\A\B)\x=\vb0\)的解，
也就是说\[
	\Ker\B
	\subseteq
	\Ker(\A\B).
\]
因为\(\rank(\A\B)=\rank\B\)，
所以由\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 可知\[
	\dim(\Ker(\A\B))
	=\dim(\Ker\B).
\]
因此由\cref{theorem:向量空间.两个非零子空间的关系2} 可知\[
	\Ker\B
	=\Ker(\A\B),
\]
也就是说\(\A\B\vb{x}=\vb0\)与\(\B\vb{x}=\vb0\)同解.
\end{proof}
\end{proposition}

\begin{example}
设\(\A\in M_{s \times n}(\mathbb{R})\).
证明：齐次线性方程组\(\A\x=\z\)与\((\A^T\A)\x=\z\)同解.
\begin{proof}
\def\a{\vb{\xi}}
\def\b{\vb{\eta}}
设\(\a\)是\(\A\x=\z\)的任意一个解，
则\(\A\a=\z\)，于是\[
	(\A^T\A)\a=\A^T(\A\a)=\A^T\z=\z,
\]
这就是说\(\a\)是\((\A^T\A)\x=\z\)的一个解.

又设\(\b\)是\((\A^T\A)\x=\z\)的任意一个解，
则\[
	(\A^T\A)\b=\z.
	\eqno(1)
\]
在(1)式等号两边同时左乘\(\b^T\)得\[
	\b^T(\A^T\A)\b=(\A\b)^T(\A\b)=0.
	\eqno(2)
\]

假设\(\A\b=(\AutoTuple{c}{s})^T\in\mathbb{R}^s\).
由(2)式有\[
	(\AutoTuple{c}{s}) (\AutoTuple{c}{s})^T
	= \AutoTuple{c}{n}[+][2]
	= 0.
\]
由于\(\AutoTuple{c}{n}\in\mathbb{R}\)，
所以\(\AutoTuple{c}{n}[=]=0\)，
\(\A\b=\z\)，
这就是说\(\b\)是\(\A\x=\z\)的一个解.

综上所述，\((\A^T\A)\x=\z\)与\(\A\x=\z\)同解.
\end{proof}
\end{example}
\begin{remark}
同理可证\((\A\A^T)\x=\z\)与\(\A\x=\z\)同解.
\end{remark}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P122 命题2
设\(\A \in M_{m \times n}(\mathbb{R})\).
求证：\begin{equation}\label{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩}
	\rank\A = \rank(\A\A^T) = \rank(\A^T\A).
\end{equation}
\begin{proof}
因为\(\A\vb{x}=\vb0\)、\((\A\A^T)\x=\vb0\)和\((\A^T\A)\x=\vb0\)同解，
所以由\cref{theorem:线性方程组.同解方程组的系数矩阵的秩相同} 可知，
这三个方程的系数矩阵的秩相等.
\end{proof}
\end{example}
\begin{remark}
应该注意到\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩} 成立的前提条件是：
矩阵\(\A\)是实矩阵.
如果矩阵\(\A\)不是实矩阵，\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩} 就不一定成立.
例如，取矩阵\(\A = \begin{bmatrix}
	1 & \iu \\
	0 & 0
\end{bmatrix}
\in M_2(\mathbb{C})\)，
易见\(\A \A^T = \begin{bmatrix}
	0 & 0 \\
	0 & 0
\end{bmatrix}\)，
于是\(\rank\A=1\)而\(\rank(\A\A^T)=0\)，
也就是说\(\rank\A\neq\rank(\A\A^T)\).
\end{remark}
