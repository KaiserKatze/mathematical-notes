\section{非齐次线性方程组的解集的结构}
数域\(K\)上\(n\)元非齐次线性方程组
\begin{equation}\label[equation-system]{equation:向量空间.非齐次线性方程组}
	x_1\vb\alpha_1+x_2\vb\alpha_2+\dotsb+x_n\vb\alpha_n=\vb\beta
\end{equation}
的每一个解都是\(K^n\)中的一个向量，
我们称这个向量为该方程组的一个解向量.
因此这个\(n\)元非齐次线性方程组的解集\(U\)是\(K^n\)的一个子集.
当该方程组无解时，\(U\)是空集.
现在我们想要知道，当该方程组有无穷多个解时，解集\(U\)的结构如何？

我们把齐次线性方程组\(\vb{A} \vb{x} = \vb0\)
称为“非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的\DefineConcept{导出组}”.

\begin{proposition}\label{theorem:非齐次线性方程组的解集的结构.解集的结构1}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质1
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P127 性质1
非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的两个解的差是它的导出组的一个解.
\begin{proof}
设\(\vb{x}_1,\vb{x}_2\)是非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的任意两个解，
即\begin{equation*}
	\vb{A} \vb{x}_1 = \vb\beta,
	\qquad
	\vb{A} \vb{x}_2 = \vb\beta,
\end{equation*}
则\begin{equation*}
	\vb{A}(\vb{x}_1 - \vb{x}_2)
	= \vb{A} \vb{x}_1 - \vb{A} \vb{x}_2
	= \vb\beta - \vb\beta
	= \vb0;
\end{equation*}
所以\(\vb{x}_1 - \vb{x}_2\)是\(\vb{A} \vb{x} = \vb0\)的解.
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:非齐次线性方程组的解集的结构.解集的结构2}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质2
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P127 性质2
非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的一个解与它的导出组的一个解之和仍是它的一个解.
\begin{proof}
设\(\vb\xi\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
\(\vb\zeta\)是\(\vb{A} \vb{x} = \vb0\)的一个解，
即\begin{equation*}
	\vb{A}\vb\xi = \vb\beta,
	\qquad
	\vb{A}\vb\zeta = \vb0,
\end{equation*}
则\begin{equation*}
	\vb{A}(\vb\xi + \vb\zeta)
	= \vb{A}\vb\xi + \vb{A}\vb\zeta
	= \vb\beta + \vb0
	= \vb\beta;
\end{equation*}
所以\(\vb\xi + \vb\zeta\)是\(\vb{A} \vb{x} = \vb\beta\)的解.
\end{proof}
\end{proposition}

\begin{example}
设\(\vb{A} \in M_{s \times n}(K)\).
证明：非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解的充分必要条件是：
如果矩阵\(\vb{A}\)的行向量组的某个线性组合是零向量，
那么向量\(\vb\beta\)的各个分量的相同线性组合也是零.
\begin{proof}
必要性.
假设\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
即\(\vb{A} \vb{x}_0 = \vb\beta\)，
那么\begin{equation*}
	(\AutoTuple{k}{s}) \vb{A} \vb{x}_0
	= (\AutoTuple{k}{s}) \vb\beta,
\end{equation*}
显然当\((\AutoTuple{k}{s}) \vb{A} = \vb0\)时，
\(
	(\AutoTuple{k}{s}) \vb\beta
	= \vb0 \vb{x}_0
	= 0
\).

充分性.
假设\begin{equation*}
	\vb{y}_0^T \vb{A} = \vb0
	\implies
	\vb{y}_0^T \vb\beta = 0,
\end{equation*}
其中\(\vb{y}_0 = (\AutoTuple{y}{s})^T\)，
那么由\cref{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件1} 可知，
\(\vb{A}^T \vb{y}_0 = \vb0\)
与\(
	\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}
	\vb{y}_0 = 0
\)同解，
再由\cref{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件2} 可知\begin{equation*}
	\rank\vb{A}^T
	= \rank\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}.
\end{equation*}
因为\(
	\rank\vb{A} = \rank\vb{A}^T,
	\rank\begin{bmatrix}
		\vb{A} & \vb\beta
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}
\)，
所以\(
	\rank\vb{A}
	= \rank\begin{bmatrix}
		\vb{A} & \vb\beta
	\end{bmatrix}
\)，
因此由\cref{theorem:向量空间.线性方程组有解判别定理} 可知，
\(\vb{A} \vb{x} = \vb\beta\)有解.
\end{proof}
\end{example}
\begin{remark}
%@credit: {b8a6b30d-44bc-4d7a-a6b5-574e615c5be0}
上例说明：\(\vb{A} \vb{x} = \vb\beta\)有解，
当且仅当\(\vb{A}^T\)的核空间\(\Ker\vb{A}^T\)中每一个向量都与\(\vb\beta\)正交.
%@credit: {5f4d2f8a-fc8b-4798-85d6-98670f6761e7}
结合\cref{example:齐次线性方程组的解集的结构.矩阵的像空间与它的左核空间互为正交补} 给出的结论，
又可以推出：\(\vb{A} \vb{x} = \vb\beta\)有解，
当且仅当\(\vb\beta\)是\(\vb{A}\)的像空间的一个元素.
\end{remark}

\begin{theorem}\label{theorem:向量空间.非齐次线性方程组的解集的结构}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 定理1
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P127 定理1
数域\(K\)上\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解集为\begin{equation}
	\vb{x}_0 + W \defeq \Set{ \vb{x}_0+\vb{x} \given \vb{x} \in W },
\end{equation}
其中\(\vb{x}_0\)是\cref{equation:向量空间.非齐次线性方程组} 的一个解，
\(W\)是\cref{equation:向量空间.非齐次线性方程组} 的导出组的解空间.
\begin{proof}
记\(U \defeq \Set{ \vb{x} \given \vb{A} \vb{x} = \vb\beta }\).
由题意有\(\vb{A} \vb{x}_0 = \vb\beta\)，即\(\vb{x}_0 \in U\)，
并且\(W = \Set{ \vb{x} \given \vb{A} \vb{x} = \vb0 }\).

假设\(\vb\eta \in W\)，
由\cref{theorem:非齐次线性方程组的解集的结构.解集的结构2} 得\(\vb{x}_0 + \vb\eta \in U\)，
因此\(\vb{x}_0 + W \subseteq U\).

反之，假设\(\vb\gamma \in U\)，
由\cref{theorem:非齐次线性方程组的解集的结构.解集的结构1} 得\(\vb\gamma - \vb{x}_0 \in W\).
记\(\vb\eta \defeq \vb\gamma - \vb{x}_0\)，
则\(\vb\gamma = \vb{x}_0 + \vb\eta \in \vb{x}_0 + W\)，
因此\(\vb{x}_0 + W \supseteq U\).

综上所述，\(U = \vb{x}_0 + W\).
\end{proof}
\end{theorem}

我们把\cref{theorem:向量空间.非齐次线性方程组的解集的结构} 中的解向量\(\vb{x}_0\)
称为“\cref{equation:向量空间.非齐次线性方程组} 的\DefineConcept{特解}（particular solution）”.

\begin{corollary}\label{theorem:向量空间.非齐次线性方程组的解集的结构.推论1}
%@see: 《高等代数（第三版 上册）》（丘维声） P98 推论2
%@see: 《高等代数（大学高等代数课程创新教材 第二版 上册）》（丘维声） P128 推论1
如果\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解唯一的充分必要条件是它的导出组只有零解.
\begin{proof}
当\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解时，
有\begin{align*}
	\text{\cref{equation:向量空间.非齐次线性方程组} 有唯一解}
	&\iff
	\text{\cref{equation:向量空间.非齐次线性方程组} 的解集为$U = \vb{x}_0 + W = \{\vb{x}_0\}$} \\
	&\iff
	W = \{\vb0\}.
	\qedhere
\end{align*}
\end{proof}
\end{corollary}

从\cref{theorem:向量空间.非齐次线性方程组的解集的结构.推论1} 立即得出，
当非齐次线性方程组有无穷多个解时，
它的导出组必有非零解.
此时取导出组的一个基础解系\(\AutoTuple{k}{n-r}\)，
其中\(r\)是导出组的系数矩阵的秩，
则非齐次线性方程组的解集为\begin{equation*}
	U = \Set{ \vb{x}_0+k_1\vb{x}_1+k_2\vb{x}_2+ \dotsb +k_{n-r}\vb{x}_{n-r} \given \AutoTuple{k}{n-r} \in K },
\end{equation*}
其中\(\vb{x}_0\)是非齐次线性方程组的一个特解.

解集\(U\)的代表元素\begin{equation*}
	\vb{x}_0+k_1\vb{x}_1+k_2\vb{x}_2+ \dotsb +k_{n-r}\vb{x}_{n-r}
	\quad(\AutoTuple{k}{n-r} \in K)
\end{equation*}
称为“\cref{equation:向量空间.非齐次线性方程组} 的\DefineConcept{通解}”.

同\cref{theorem:线性方程组.齐次线性方程组的解向量个数} 的证明过程中
对系数矩阵\(\vb{A}\)进行初等行变换一样，
我们也可以对非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 的
增广矩阵\((\vb{A},\vb\beta)\)进行类似的初等行变换，
将其化为行约化矩阵\((\vb{J},\vb\gamma)\)，
于是原方程变形为\(\vb{J} \vb{x} = \vb\gamma\)，
其中\(\vb\gamma \defeq (\AutoTuple{c}{s})\).
根据\cref{theorem:向量空间.线性方程组有解判别定理}，
\(\vb{J} \vb{x} = \vb\gamma\)有解，
当且仅当\(\vb{J}\)和\(\vb\gamma\)的后\(s-r\)行全为零.
于是，当\(\vb{J} \vb{x} = \vb\gamma\)有解时，
\(c_{r+1} = \dotsb = c_n = 0\)，
即\(\vb\gamma = (\AutoTuple{c}{r},0,\dotsc,0)^T\).
下面默认\(\vb{J} \vb{x} = \vb\gamma\)有解.
单独对\(\vb{J}\)作初等列变换，
得到\(
	\vb{R}
	\defeq \vb{J} \vb{P}
	= \begin{bmatrix}
		\vb{E}_r & \vb{F} \\
		\vb0 & \vb0
	\end{bmatrix}
\).
考虑方程组\begin{equation*}
	\begin{bmatrix}
		\vb{E}_r & \vb{F}
	\end{bmatrix}
	\begin{bmatrix}
		y_1 \\ \vdots \\ y_n
	\end{bmatrix}
	= \begin{bmatrix}
		c_1 \\ \vdots \\ c_r
	\end{bmatrix},
	\quad\text{或}\quad
	\vb{E}_r
	\begin{bmatrix}
		y_1 \\ \vdots \\ y_r
	\end{bmatrix}
	+ \vb{F}
	\begin{bmatrix}
		y_{r+1} \\ \vdots \\ y_n
	\end{bmatrix}
	= \begin{bmatrix}
		c_1 \\ \vdots \\ c_r
	\end{bmatrix},
\end{equation*}
容易看出，只要取\(y_{r+1} = \dotsb = y_n = 0\)，
就有\(
	y_1 = c_1,
	y_2 = c_2,
	\dotsc,
	y_r = c_r
\).
因此\(
	\vb{y}_0
	\defeq \vb\gamma
	= (\AutoTuple{c}{r},0,\dotsc,0)^T
\)
是\(\vb{R} \vb{y} = \vb\gamma\)的一个解，
那么\(
	\vb{x}_0
	\defeq \vb{P} \vb{y}_0
	= \vb{P} \vb\gamma
\)是\cref{equation:向量空间.非齐次线性方程组} 的一个特解.
接下来只要加上\cref{equation:向量空间.非齐次线性方程组} 的导出组的通解\(W\)，
便可得到\cref{equation:向量空间.非齐次线性方程组} 的通解\(x_0 + W\).

根据上述讨论，我们可以总结出
求解非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的基础解系的方法：
\begin{algorithm}[求解非齐次线性方程组]
\hfill
\begin{enumerate}
	\item 把非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 的
	系数矩阵\(\vb{A} \in M_{s \times n}(K)\)和常数项\(\vb\beta\)
	组成的增广矩阵\(\widetilde{\vb{A}} \defeq (\vb{A},\vb\beta)\)
	经过初等行变换化简成行约化矩阵\((\vb{J},\vb\gamma)\)；

	\item 检查\(\rank\vb{J}\)与\(\rank(\vb{J},\vb\gamma)\)是否相等，
	判断\(\vb{A} \vb{x} = \vb\beta\)是否有解；
	如果无解，停止计算；

	\item 假设\(\rank\vb{J} = \rank(\vb{J},\vb\gamma) = r\)，
	方程组\(\vb{A} \vb{x} = \vb\beta\)有解；
	从\(\vb{J}\)中找出主列\(\vb\beta_{i_1},\dotsc,\vb\beta_{i_r}\)；

	\item 构造置换矩阵\begin{equation*}
		\vb{P}
		\defeq
		% 交换第\(1\)列与第\(i_1\)列
		\begin{bmatrix}
			0 & & 1 \\
			& \vb{E}_{i_1-2} \\
			1 & & 0 \\
			& & & \vb{E}_{n-i_1}
		\end{bmatrix}
		% 交换第\(2\)列与第\(i_2\)列
		\begin{bmatrix}
			1 \\
			& 0 & & 1 \\
			& & \vb{E}_{i_2-3} \\
			& 1 & & 0 \\
			& & & & \vb{E}_{n-i_2}
		\end{bmatrix}
		\dotsm
		% 交换第\(r\)列与第\(i_r\)列
		\begin{bmatrix}
			\vb{E}_{r-1} \\
			& 0 & & 1 \\
			& & \vb{E}_{i_r-r-1} \\
			& 1 & & 0 \\
			& & & & \vb{E}_{n-i_r}
		\end{bmatrix};
	\end{equation*}

	\item
	% 交换第\(1\)个分量与第\(i_1\)个分量
	% 交换第\(2\)个分量与第\(i_2\)个分量
	% 交换第\(r\)个分量与第\(i_r\)个分量
	将\(\vb{x}_0 \defeq \vb{P} \vb\gamma\)
	作为\cref{equation:向量空间.非齐次线性方程组} 的一个特解；

	\item 利用\cref{algorithm:线性方程组.求解齐次线性方程组}
	计算导出组\(\vb{A} \vb{x} = \vb0\)的一个基础解系；

	\item 写出\cref{equation:向量空间.非齐次线性方程组} 的通解.
\end{enumerate}
\end{algorithm}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P87 例1
求线性方程组\begin{equation*}
	\left\{ \begin{array}{*{9}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &=& 4 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &=& 2 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &=& -2
	\end{array} \right.
\end{equation*}的通解.
\begin{solution}
写出增广矩阵\(\widetilde{\vb{A}}\)，并作初等行变换化简
\begin{align*}
	\widetilde{\vb{A}}
	&= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 1 & -\tfrac12 & -2 & -3 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \widetilde{\vb{B}}
	= (\vb{B},\vb\gamma),
\end{align*}
故\(\rank\vb{A} = \rank\widetilde{\vb{A}} = \rank\widetilde{\vb{B}} = 2\)，于是原方程组有解.

解同解方程组\begin{equation*}
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& -2 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& -3
	\end{array} \right..
\end{equation*}
令\(x_3 = 0\)，\(x_4 = 0\)，
解得\(x_1 = -2\)，\(x_2 = -3\)，
得特解\begin{equation*}
	\vb{x}_0 = (-2,-3,0,0)^T.
\end{equation*}

又因为导出组的基础解系含\(4 - \rank\vb{A} = 2\)个向量.
将\(x_3,x_4\)的两组值\((2,0),(0,1)\)分别代入\begin{equation*}
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& 0 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& 0
	\end{array} \right.
\end{equation*}
得基础解系
\(\vb{x}_1 = (4,1,2,0)^T,
\vb{x}_2 = (2,2,0,1)^T\).

于是原方程的通解为\begin{equation*}
	\vb{x} = \vb{x}_0 + k_1 \vb{x}_1 + k_2 \vb{x}_2
	= \begin{bmatrix} -2 \\ -3 \\ 0 \\ 0 \end{bmatrix}
	+ k_1 \begin{bmatrix} 4 \\ 1 \\ 2 \\ 0 \end{bmatrix}
	+ k_2 \begin{bmatrix} 2 \\ 2 \\ 0 \\ 1 \end{bmatrix},
\end{equation*}
其中\(k_1,k_2\)是任意常数.
\end{solution}
%@Mathematica: A = RowReduce[({{1, -2, -1, 2, 4}, {2, -2, -3, 0, 2}, {4, -2, -7, -4, -2}})]
%@Mathematica: LinearSolve[A[[All, 1 ;; 4]], A[[All, 5]]]
\end{example}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P88 例2
写出线性方程组\begin{equation*}
	\left\{ \begin{array}{l}
		x_1 - x_2 = a_1, \\
		x_2 - x_3 = a_2, \\
		x_3 - x_4 = a_3, \\
		x_4 - x_1 = a_4
	\end{array} \right.
\end{equation*}有解的充分必要条件，并求解.
\begin{solution}
对增广矩阵\(\widetilde{\vb{A}}\)作初等行变换化简
\begin{align*}
	\widetilde{\vb{A}}
	&= \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		-1 & 0 & 0 & 0 & a_4
	\end{bmatrix} \to \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & 0 & -1 & a_1 + a_2 + a_3 \\
		0 & 1 & 0 & -1 & a_2 + a_3 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix}.
\end{align*}
可见\(\rank\vb{A} = 3\).
方程组有解的充分必要条件是\(\rank\widetilde{\vb{A}} = \rank\vb{A} = 3\)，
那么充分必要条件就是\(\sum_{i=1}^4 a_i = 0\).

当方程组有解时，通解为\begin{equation*}
	\begin{bmatrix}
		a_1 + a_2 + a_3 \\ a_2 + a_3 \\ a_3 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		1 \\ 1 \\ 1 \\ 1
	\end{bmatrix},
\end{equation*}
其中\(k\)为任意常数.
\end{solution}
\end{example}

至此，我们讨论了线性方程组的解的存在性、解的性质、解的结构及求解方法，建立起了线性方程组的完整理论.
解线性方程组是线性代数的基本问题之一，现代科学技术方面用到的数学问题也有很多要归结到解线性方程组.

\begingroup
%@see: https://math.stackexchange.com/a/5083565/591741
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9}
下面我们来讨论：
当实数域上的非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解时，
它的解是否一定属于\(\vb{A}^T\)的像空间.
要使\(\vb{A} \vb{x} = \vb\beta\)的每一个解\(\vb{x}_0\)都在\(\vb{A}^T\)的像空间中，
就必须使\(\vb{A}^T \vb{y} = \vb{x}_0\)有解.
因为\begin{align*}
	\rank\vb{A}
	&= \rank(\vb{A} \vb{A}^T)
		\tag{\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩}} \\
	&\leq \rank(\vb{A} \vb{A}^T,\vb\beta)
		\tag{\cref{example:矩阵乘积的秩.分块矩阵的秩的等式2}} \\
	&= \rank(\vb{A} \vb{A}^T,\vb{A} \vb{x}_0) \\
	&= \rank(\vb{A} (\vb{A}^T,\vb{x}_0)) \\
	&\leq \rank\vb{A}
		\tag{\cref{theorem:线性方程组.矩阵乘积的秩}},
\end{align*}
所以\begin{equation}\label{equation:非齐次线性方程组的解集的结构.非齐次线性方程组的解是否属于它的系数矩阵的行空间.中间步骤1}
	\rank(\vb{A} \vb{A}^T,\vb\beta)
	= \rank\vb{A}
	= \rank(\vb{A} \vb{A}^T),
\end{equation}
说明非齐次线性方程组\(\vb{A} \vb{A}^T \vb{y} = \vb\beta\)有解.
下面研究\(\vb{A} \vb{A}^T \vb{y} = \vb\beta\)与\(\vb{A}^T \vb{y} = \vb{x}_0\)是否同解.
由\cref{example:线性方程组.左乘系数矩阵的转置矩阵同解} 可知
\(\vb{A}^T \vb{y} = \vb0\)与\(\vb{A} \vb{A}^T \vb{y} = \vb0\)同解.
下面研究满足\(\vb{A} \vb{A}^T \vb{y}_0 = \vb\beta\)的
向量\(\vb{y}_0\)是否一定满足\(\vb{A}^T \vb{y}_0 = \vb{x}_0\).
因为\begin{gather*}
	\begin{bmatrix}
		\vb{E} & \vb0 \\
		-\vb{A} & \vb{E}
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} \vb{A}^T & \vb\beta \\
		\vb{A}^T & \vb{x}_0
	\end{bmatrix}
	\begin{bmatrix}
		\vb{E} & -\vb{y}_0 \\
		\vb0 & \vb{E}
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{A} \vb{A}^T & \vb0 \\
		\vb0 & -\vb{A}^T \vb{y}_0 + \vb{x}_0
	\end{bmatrix},
\end{gather*}
所以\begin{align*}
	\rank\begin{bmatrix}
		\vb{A} \vb{A}^T & \vb\beta \\
		\vb{A}^T & \vb{x}_0
	\end{bmatrix}
	&= \rank\begin{bmatrix}
		\vb{A} \vb{A}^T & \vb0 \\
		\vb0 & \vb{x}_0 - \vb{A}^T \vb{y}_0
	\end{bmatrix} \\
	&= \rank(\vb{A} \vb{A}^T) + \rank(\vb{x}_0 - \vb{A}^T \vb{y}_0) \\
	&= \rank\vb{A} + \rank(\vb{x}_0 - \vb{A}^T \vb{y}_0).
		\tag{\cref{equation:矩阵乘积的秩.实矩阵及其转置矩阵的乘积的秩}}
\end{align*}
又因为\begin{equation*}
	\begin{bmatrix}
		\vb{E} & -\vb{A} \\
		\vb0 & \vb{E}
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} \vb{A}^T \\
		\vb{A}^T
	\end{bmatrix}
	= \begin{bmatrix}
		\vb0 \\ \vb{A}
	\end{bmatrix},
\end{equation*}
所以\begin{equation*}
	\rank\begin{bmatrix}
		\vb{A} \vb{A}^T \\
		\vb{A}^T
	\end{bmatrix}
	= \rank\vb{A}.
\end{equation*}
于是\begin{equation*}
	\rank\begin{bmatrix}
		\vb{A} \vb{A}^T & \vb\beta \\
		\vb{A}^T & \vb{x}_0
	\end{bmatrix}
	- \rank\begin{bmatrix}
		\vb{A} \vb{A}^T \\
		\vb{A}^T
	\end{bmatrix}
	= \rank(\vb{x}_0 - \vb{A}^T \vb{y}_0).
\end{equation*}
由此可见\begin{equation*}
	\rank\begin{bmatrix}
		\vb{A} \vb{A}^T & \vb\beta \\
		\vb{A}^T & \vb{x}_0
	\end{bmatrix}
	\neq
	\rank\begin{bmatrix}
		\vb{A} \vb{A}^T \\
		\vb{A}^T
	\end{bmatrix},
\end{equation*}
也就是说，
当实数域上的非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解时，
它的解不一定属于\(\vb{A}^T\)的像空间.
实际上，我们可以举例说明这个问题：
\begin{example}
举例说明：虽然\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
但是\(\vb{x}_0 \notin \Im\vb{A}^T\).
\begin{solution}
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9}
取\(
	\vb{A}
	\defeq \begin{bmatrix}
		1 & 0 \\
		0 & 0
	\end{bmatrix},
	\vb\beta
	\defeq \begin{bmatrix}
		1 \\ 0
	\end{bmatrix}
\)，
则方程组\(\vb{A} \vb{x} = \vb\beta\)的解集为\begin{equation*}
	W_1
	\defeq
	\Set*{
		\vb{x}
		\given
		\vb{x}
		= \begin{bmatrix}
			1 \\ 0
		\end{bmatrix}
		+ k_1
		\begin{bmatrix}
			0 \\ 1
		\end{bmatrix},
		\text{$k_1$是任意常数}
	}.
\end{equation*}
注意到\(\vb{A}^T = \vb{A}\)，
于是\begin{equation*}
	W_2
	\defeq
	\Im\vb{A}^T
	= \Im\vb{A}
	= \Set*{
		\vb{x}
		\given
		\vb{x}
		= k_2
		\begin{bmatrix}
			1 \\ 0
		\end{bmatrix},
		\text{$k_2$是任意常数}
	}.
\end{equation*}
考虑关于\(k_1,k_2\)的向量方程\(
	\begin{bmatrix}
		1 \\ 0
	\end{bmatrix}
	+ k_1
	\begin{bmatrix}
		0 \\ 1
	\end{bmatrix}
	= k_2
	\begin{bmatrix}
		1 \\ 0
	\end{bmatrix}
\)，
解得\(k_1 = 0, k_2 = 1\)，
于是\begin{equation*}
	W_1 - W_2
	= \Set*{
		\vb{x}
		\given
		\vb{x}
		= \begin{bmatrix}
			1 \\ 0
		\end{bmatrix}
		+ k_1
		\begin{bmatrix}
			0 \\ 1
		\end{bmatrix},
		\text{$k_1$是任意常数},
		k_1 \neq 0
	}.
\end{equation*}
显然\(\vb{x}_0 \defeq (1,1)^T \in W_1 - W_2\)，
这就说明\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
但是\(\vb{x}_0 \notin \Im\vb{A}^T\).
\end{solution}
\end{example}

\begin{proposition}
如果实数域上的非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解，
那么它的解集\(U\)与\(\vb{A}^T\)的像空间\(\Im\vb{A}^T\)有非空交集.
\begin{proof}
因为 \hyperref[equation:非齐次线性方程组的解集的结构.非齐次线性方程组的解是否属于它的系数矩阵的行空间.中间步骤1]{\(
	\rank(\vb{A} \vb{A}^T,\vb\beta)
	= \rank\vb{A}
	= \rank(\vb{A} \vb{A}^T)
\)}，
非齐次线性方程组\(\vb{A} \vb{A}^T \vb{y} = \vb\beta\)有解，
所以存在向量\(\vb{y}_1\)
使得\(\vb{x}_1 \defeq \vb{A}^T \vb{y}_1\)
满足\(\vb{A} \vb{x}_1 = \vb\beta\)，
也就是说，存在向量\(\vb{x}_1 \in \Im\vb{A}^T\)使得\(\vb{x}_1 \in U\)，
于是\(\vb{x}_1\)属于\(U\)与\(\Im\vb{A}^T\)的交集，
因此\(U\)与\(\Im\vb{A}^T\)的交集不是空集.
\end{proof}
\end{proposition}

\begin{proposition}
如果复数域上的非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解，
那么它的解集\(U\)与\(\vb{A}^H\)的像空间\(\Im\vb{A}^H\)有非空交集.
%TODO proof
\end{proposition}
\endgroup

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P89 习题4.6 4.
设\(\vb{x}_0\)是非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的一个解，
\(\AutoTuple{\vb{x}}{n-r}\)是其导出组\(\vb{A} \vb{x} = \vb0\)的一个基础解系.
证明：\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性无关.
\begin{proof}
因为\(\AutoTuple{\vb{x}}{n-r}\)是其导出组\(\vb{A} \vb{x} = \vb0\)的一个基础解系，
根据基础解系的定义，显然有\(\AutoTuple{\vb{x}}{n-r}\)线性无关.
假设\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性相关，
那么\(\vb{x}_0\)可由\(\AutoTuple{\vb{x}}{n-r}\)线性表出，
即存在数\(k_1,k_2,\dotsc,k_{n-r}\)使得\begin{equation*}
	\vb{x}_0 = k_1 \vb{x}_1 + k_2 \vb{x}_2 + \dotsb + k_{n-r} \vb{x}_{n-r},
\end{equation*}
进而有\begin{align*}
	&\vb{A} \vb{x}_0 = \vb{A}(k_1 \vb{x}_1 + k_2 \vb{x}_2 + \dotsb + k_{n-r} \vb{x}_{n-r}) \\
	&= k_1 \vb{A} \vb{x}_1 + k_2 \vb{A} \vb{x}_2 + \dotsb + k_{n-r} \vb{A} \vb{x}_{n-r}
	= \vb0 + \vb0 + \dotsb + \vb0 = \vb0,
\end{align*}
即\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb0\)的一个解，
这与\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta\neq\vb0\)的一个解矛盾，
所以\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性无关.
\end{proof}
\end{example}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P89 习题4.6 6.
设线性方程组\(\vb{A} \vb{x} = \vb\beta\)的增广矩阵
\(\widetilde{\vb{A}} = (\vb{A},\vb\beta)\)是一个\(n\)阶可逆矩阵.
证明：方程组无解.
\begin{proof}
因为\(\widetilde{\vb{A}}\)是\(n\)阶方阵，
所以\(\vb{A}\)是\(n \times (n-1)\)矩阵，
从而\(\rank\vb{A} \leq \min\{n-1,n\} = n-1\).
又因为\(\widetilde{\vb{A}}\)可逆，所以\(\rank\widetilde{\vb{A}} = n\).
因为\(\rank\widetilde{\vb{A}} = n > n-1 \geq \rank\vb{A}\)，
所以方程组\(\vb{A} \vb{x} = \vb\beta\)无解.
\end{proof}
\end{example}

\begin{example}
%@see: https://web.mit.edu/18.06/www/
%@see: https://youtu.be/l88D4r74gtM?t=644
已知实数域上关于\(\vb{x}\)的非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的通解为\begin{equation*}
	\vb{x}
	= \begin{bmatrix}
		2 \\ 0 \\ 0
	\end{bmatrix}
	+ c_1 \begin{bmatrix}
		1 \\ 1 \\ 0
	\end{bmatrix}
	+ c_2 \begin{bmatrix}
		0 \\ 0 \\ 1
	\end{bmatrix}
	\quad(\text{$c_1,c_2$是任意常数}),
\end{equation*}
其中\(\vb\beta = (2,4,2)^T\).
\begin{enumerate}
	\item 判断\(\vb{A}\)的行数、列数；
	\item 求\(\rank\vb{A}\)；
	\item 求\(\vb{A}\).
\end{enumerate}
\begin{solution}
\hfill
\begin{enumerate}
	\item
	由于通解\(\vb{x}\)是3维向量，所以\(\vb{A}\)的列数是3.
	由于常数项\(\vb\beta\)是3维向量，所以\(\vb{A}\)的行数是3.
	因此\(\vb{A} \in M_3(\mathbb{R})\).

	\item
	观察通解\(\vb{x}\)的形式可以发现导出组\(\vb{A} \vb{x} = \vb0\)的基础解系含有2个向量
	\((1,1,0)^T\)和\((0,0,1)^T\)，
	那么\(\dim\Ker\vb{A} = 2\)，
	于是\(\rank\vb{A} = 3 - 2 = 1\).

	\item
	设\begin{equation*}
		\vb{A} = \begin{bmatrix}
			a_{11} & a_{12} & a_{13} \\
			a_{21} & a_{22} & a_{23} \\
			a_{31} & a_{32} & a_{33}
		\end{bmatrix}.
	\end{equation*}

	考虑关于\(\vb{A}\)的矩阵方程\begin{equation*}
		\vb{A}
		\begin{bmatrix}
			2 \\ 0 \\ 0
		\end{bmatrix}
		= \begin{bmatrix}
			2 \\ 4 \\ 2
		\end{bmatrix},
		\quad\text{即}\quad
		\begin{bmatrix}
			2 a_{11} + 0 a_{12} + 0 a_{13} \\
			2 a_{21} + 0 a_{22} + 0 a_{23} \\
			2 a_{31} + 0 a_{32} + 0 a_{33}
		\end{bmatrix}
		= 2 \begin{bmatrix}
			a_{11} \\ a_{21} \\ a_{31}
		\end{bmatrix}
		= 2 \begin{bmatrix}
			1 \\ 2 \\ 1
		\end{bmatrix},
	\end{equation*}
	于是\(\vb{A}\)的第1列向量为\begin{equation*}
		\begin{bmatrix}
			a_{11} \\ a_{21} \\ a_{31}
		\end{bmatrix}
		= \begin{bmatrix}
			1 \\ 2 \\ 1
		\end{bmatrix}.
	\end{equation*}

	考虑关于\(\vb{A}\)的矩阵方程\begin{equation*}
		\vb{A}
		\begin{bmatrix}
			0 \\ 0 \\ 1
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ 0 \\ 0
		\end{bmatrix},
		\quad\text{即}\quad
		\begin{bmatrix}
			0 a_{11} + 0 a_{12} + 1 a_{13} \\
			0 a_{21} + 0 a_{22} + 1 a_{23} \\
			0 a_{31} + 0 a_{32} + 1 a_{33}
		\end{bmatrix}
		= \begin{bmatrix}
			a_{13} \\ a_{23} \\ a_{33}
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ 0 \\ 0
		\end{bmatrix}.
	\end{equation*}

	考虑关于\(\vb{A}\)的矩阵方程\begin{equation*}
		\vb{A}
		\begin{bmatrix}
			1 \\ 1 \\ 0
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ 0 \\ 0
		\end{bmatrix},
	\end{equation*}
	它说明\(\vb{A}\)的第1列向量与第2列向量互为负向量，
	于是\(\vb{A}\)的第2列向量为\begin{equation*}
		\begin{bmatrix}
			a_{12} \\ a_{22} \\ a_{32}
		\end{bmatrix}
		= \begin{bmatrix}
			-1 \\ -2 \\ -1
		\end{bmatrix}.
	\end{equation*}

	因此\begin{equation*}
		\vb{A} = \begin{bmatrix}
			1 & -1 & 0 \\
			2 & -2 & 0 \\
			1 & -1 & 0
		\end{bmatrix}.
	\end{equation*}
\end{enumerate}
\end{solution}
\end{example}

\begin{example}
%@see: 《2025年全国硕士研究生入学统一考试（数学一）》一选择题/第6题
设\(\AutoTuple{\vb\alpha}{4}\)是\(n\)维向量，
\(\vb\alpha_1,\vb\alpha_2\)线性无关，
\(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3\)线性相关，
且\begin{equation*}
	\vb\alpha_1 + \vb\alpha_2 + \vb\alpha_4 = \vb0.
\end{equation*}
试判别关于\(x,y,z\)的方程组
\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形.
\begin{solution}
由题意有\(\vb\alpha_3,\vb\alpha_4\)可以由\(\vb\alpha_1,\vb\alpha_2\)线性表出.
那么\begin{equation*}
	\rank(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3)
	= \rank(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3,\vb\alpha_4)
	= 2 < 3,
\end{equation*}
%\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
因此\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb0\)的基础解系含有\(3-2=1\)个向量，
这就说明该方程组的几何图形是一条直线.

假设方程组\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形是一条经过原点的直线，
则\((0,0,0)\)是该方程组的一个解，
即\begin{equation*}
	\vb\alpha_4
	= 0 \vb\alpha_1 + 0 \vb\alpha_2 + 0 \vb\alpha_3
	= \vb0.
\end{equation*}
再由\(\vb\alpha_1 + \vb\alpha_2 + \vb\alpha_4 = \vb0\)
可知\(\vb\alpha_1 + \vb\alpha_2 = \vb0\)，
这说明\(\vb\alpha_1,\vb\alpha_2\)线性相关，矛盾！
因此方程组\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形是一条不经过原点的直线.
\end{solution}
\end{example}
\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》三解答题/第20题
设矩阵\(\vb{A} = \begin{bmatrix}
	1 & -1 & -1 \\
	2 & a & 1 \\
	-1 & 1 & a
\end{bmatrix},
\vb{B} = \begin{bmatrix}
	2 & 2 \\
	1 & a \\
	-a-1 & -2
\end{bmatrix}\).
当\(a\)为何值时，方程\(\vb{A}\vb{X}=\vb{B}\)无解、有唯一解、有无穷多解？
在有解时，求解此方程.
\begin{solution}
%@Mathematica: A = {{1, -1, -1, 2, 2}, {2, a, 1, 1, a}, {-1, 1, a, -a - 1, -2}}
对增广矩阵\((\vb{A},\vb{B})\)作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		2 & a & 1 & 1 & a \\
		-1 & 1 & a & -a-1 & -2
	\end{bmatrix}
%@Mathematica: A1 = ({ {1, 0, 0}, {-2, 1, 0}, {1, 0, 1} }).A
	\to \begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a+2=0\)即\(a=-2\)时，继续对增广矩阵作初等行变换，
%@Mathematica: A /. a -> -2 // RowReduce // MatrixForm
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & 0 & 3 & -3 & -6 \\
		0 & 0 & -3 & 3 & 0
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -1 & 0 & 1 & 0 \\
		0 & 0 & 1 & -1 & 0 \\
		0 & 0 & 0 & 0 & 1
	\end{bmatrix},
\end{equation*}
由于\(\rank\vb{A} = 2 \neq \rank(\vb{A},\vb{B}) = 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)无解.

当\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}
	\to
%@Mathematica: A2 = ({ {1, 1, 0}, {0, 1, 0}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1/(a + 2), 0}, {0, 0, 1} }).A1 // Factor // Simplify
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & \frac{1-a}{a+2} & \frac{2a+1}{a+2} & \frac{3a}{a+2} \\
		0 & 1 & \frac3{a+2} & -\frac3{a+2} & \frac{a-4}{a+2} \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a-1=0\)即\(a=1\)时，
增广矩阵化为\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & 1 \\
		0 & 1 & 1 & -1 & -1 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\vb{A} = \rank(\vb{A},\vb{B}) = 2 < 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)有无穷多解.
解方程\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 0 & 0 \\
	\end{bmatrix}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
\end{equation*}
得\begin{equation*}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		0 \\ -1 \\ 1
	\end{bmatrix}
	\quad(\text{$k$是任意常数}).
\end{equation*}
于是方程\(\vb{A}\vb{X}=\vb{B}\)的解为\begin{equation*}
	\vb{X} = \begin{bmatrix}
		1 & 1\\
		-1-k_1 & -1-k_2 \\
		k_1 & k_2
	\end{bmatrix}
	\quad(\text{$k_1,k_2$是任意常数}).
\end{equation*}

当\(a\neq1\)且\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
%@Mathematica: ({ {1, 0, (a - 1)/(2 + a)}, {0, 1, -3/(2 + a)}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1, 0}, {0, 0, 1/(a - 1)} }).A2 // Factor // Simplify // MatrixForm
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & \frac{3a}{a+2} \\
		0 & 1 & 0 & 0 & \frac{a-4}{a+2} \\
		0 & 0 & 1 & -1 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\vb{A} = \rank(\vb{A},\vb{B}) = 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)有唯一解\begin{equation*}
	\def\arraystretch{1.5}
	\vb{X} = \begin{bmatrix}
		1 & \frac{3a}{a+2} \\
		0 & \frac{a-4}{a+2} \\
		-1 & 0
	\end{bmatrix}.
\end{equation*}
\end{solution}
\end{example}
