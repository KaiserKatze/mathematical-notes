\section{非齐次线性方程组的解集的结构}
数域\(K\)上\(n\)元非齐次线性方程组
\begin{equation}\label[equation-system]{equation:向量空间.非齐次线性方程组}
	x_1\a_1+x_2\a_2+\dotsb+x_n\a_n=\b
\end{equation}
的每一个解都是\(K^n\)中的一个向量，
我们称这个向量为该方程组的一个解向量.
因此这个\(n\)元非齐次线性方程组的解集\(U\)是\(K^n\)的一个子集.
当该方程组无解时，\(U\)是空集.
现在我们想要知道，当该方程组有无穷多个解时，解集\(U\)的结构如何？

我们把齐次线性方程组\(\A\x=\z\)
称为非齐次线性方程组\(\A\x=\b\)的\DefineConcept{导出组}.

\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质1
非齐次线性方程组\(\A\x=\b\)的两个解的差是它的导出组的一个解.
\begin{proof}
设\(\X1,\X2\)是非齐次线性方程组\(\A\x=\b\)的任意两个解，即\[
	\A\X1=\b, \qquad
	\A\X2=\b,
\]
则\[
	\A(\X1-\X2)=\A\X1-\A\X2=\b-\b=\z;
\]
所以\(\X1-\X2\)是\(\A\x=\z\)的解.
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质2
非齐次线性方程组\(\A\x=\b\)的一个解与它的导出组的一个解之和仍是它的一个解.
\begin{proof}
\def\ma{\vb{\xi}}
\def\mb{\vb{\zeta}}
设\(\ma\)是\(\A\x=\b\)的一个解，\(\mb\)是\(\A\x=\z\)的一个解，即\[
	\A\ma=\b, \qquad
	\A\mb=\z,
\]
则\[
	\A(\ma+\mb)=\A\ma+\A\mb=\b+\z=\b;
\]
所以\(\ma+\mb\)是\(\A\x=\b\)的解.
\end{proof}
\end{proposition}

\begin{theorem}\label{theorem:向量空间.非齐次线性方程组的解集的结构}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 定理1
数域\(K\)上\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解集\(U\)为
\begin{equation}
	\Set{ \x_0+\x \given \x \in W },
\end{equation}
其中\(\x_0\)是这个非齐次线性方程组的一个解，
\(W\)是它的导出组的解空间.
\end{theorem}

我们把\cref{theorem:向量空间.非齐次线性方程组的解集的结构} 中的解向量\(\x_0\)
称为“\cref{equation:向量空间.非齐次线性方程组} 的\DefineConcept{特解}（particular solution）”.

\begin{corollary}
%@see: 《高等代数（第三版 上册）》（丘维声） P98 推论2
如果\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解唯一的充分必要条件是它的导出组只有零解.
\end{corollary}

于是当非齐次线性方程组有无穷多个解时，
它的导出组必有非零解.
此时取导出组的一个基础解系\(\AutoTuple{k}{n-r}\)，
其中\(r\)是导出组的系数矩阵的秩，
则非齐次线性方程组的解集为\[
	U = \Set{ \x_0+k_1\x_1+k_2\x_2+ \dotsb +k_{n-r}\x_{n-r} \given \AutoTuple{k}{n-r} \in K },
\]
其中\(\x_0\)是非齐次线性方程组的一个特解.

解集\(U\)的代表元素\[
	\x_0+k_1\x_1+k_2\x_2+ \dotsb +k_{n-r}\x_{n-r}
	\quad(\AutoTuple{k}{n-r} \in K)
\]
称为“\cref{equation:向量空间.非齐次线性方程组} 的通解”.

\begin{example}
求线性方程组\[
	\left\{ \begin{array}{*{9}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &=& 4 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &=& 2 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &=& -2
	\end{array} \right.
\]的通解.
\begin{solution}
写出增广矩阵\(\wA\)，并作初等行变换化简
\begin{align*}
	\wA
	&= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 1 & -\tfrac12 & -2 & -3 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \wB
	= (\B,\g),
\end{align*}
故\(\rank\A = \rank\wA = \rank\wB = 2\)，于是原方程组有解.

解同解方程组\[
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& -2 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& -3
	\end{array} \right..
\]
令\(x_3 = 0\)，\(x_4 = 0\)，
解得\(x_1 = -2\)，\(x_2 = -3\)，
得特解\[
	\x_0 = (-2,-3,0,0)^T.
\]

又因为导出组的基础解系含\(4 - \rank\A = 2\)个向量.
将\(x_3,x_4\)的两组值\((2,0),(0,1)\)分别代入\[
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& 0 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& 0
	\end{array} \right.
\]
得基础解系
\(\x_1 = (4,1,2,0)^T,
\x_2 = (2,2,0,1)^T\).

于是原方程的通解为\[
	\x = \x_0 + k_1 \x_1 + k_2 \x_2
	= \begin{bmatrix} -2 \\ -3 \\ 0 \\ 0 \end{bmatrix}
	+ k_1 \begin{bmatrix} 4 \\ 1 \\ 2 \\ 0 \end{bmatrix}
	+ k_2 \begin{bmatrix} 2 \\ 2 \\ 0 \\ 1 \end{bmatrix},
\]
其中\(k_1,k_2\)是任意常数.
\end{solution}
%@Mathematica: A = RowReduce[({{1, -2, -1, 2, 4}, {2, -2, -3, 0, 2}, {4, -2, -7, -4, -2}})]
%@Mathematica: LinearSolve[A[[All, 1 ;; 4]], A[[All, 5]]]
\end{example}

\begin{example}
写出线性方程组\[
	\left\{ \begin{array}{l}
		x_1 - x_2 = a_1 \\
		x_2 - x_3 = a_2 \\
		x_3 - x_4 = a_3 \\
		x_4 - x_1 = a_4
	\end{array} \right.
\]有解的充分必要条件，并求解.
\begin{solution}
对增广矩阵\(\wA\)作初等行变换化简
\begin{align*}
	\wA
	&= \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		-1 & 0 & 0 & 0 & a_4
	\end{bmatrix} \to \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & 0 & -1 & a_1 + a_2 + a_3 \\
		0 & 1 & 0 & -1 & a_2 + a_3 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix}.
\end{align*}
可见\(\rank\A = 3\).
方程组有解的充分必要条件是\(\rank\wA = \rank\A = 3\)，
那么充分必要条件就是\(\sum_{i=1}^4 a_i = 0\).

当方程组有解时，通解为\[
	\begin{bmatrix}
		a_1 + a_2 + a_3 \\ a_2 + a_3 \\ a_3 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		1 \\ 1 \\ 1 \\ 1
	\end{bmatrix},
\]
其中\(k\)为任意常数.
\end{solution}
\end{example}

至此，我们讨论了线性方程组的解的存在性、解的性质、解的结构及求解方法，建立起了线性方程组的完整理论.
解线性方程组是线性代数的基本问题之一，现代科学技术方面用到的数学问题也有很多要归结到解线性方程组.

\begin{example}
设\(\X0\)是非齐次线性方程组\(\A\x=\b\)的一个解，
\(\AutoTuple{\x}{n-r}\)是其导出组\(\A\x=\z\)的一个基础解系.
证明：\(\X0,\AutoTuple{\x}{n-r}\)线性无关.
\begin{proof}
因为\(\AutoTuple{\x}{n-r}\)是其导出组\(\A\x=\z\)的一个基础解系，
根据基础解系的定义，显然有\(\AutoTuple{\x}{n-r}\)线性无关.
假设\(\X0,\AutoTuple{\x}{n-r}\)线性相关，
那么\(\X0\)可由\(\AutoTuple{\x}{n-r}\)线性表出，
即存在数\(k_1,k_2,\dotsc,k_{n-r}\)使得\[
	\X0 = k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r},
\]
进而有\begin{align*}
	&\A\X0 = \A(k_1 \X1 + k_2 \X2 + \dotsb + k_{n-r} \X{n-r}) \\
	&= k_1 \A\X1 + k_2 \A\X2 + \dotsb + k_{n-r} \A\X{n-r}
	= \z + \z + \dotsb + \z = \z,
\end{align*}
即\(\X0\)是\(\A\x=\z\)的一个解，
这与\(\X0\)是\(\A\x=\b\neq\z\)的一个解矛盾，
所以\(\X0,\AutoTuple{\x}{n-r}\)线性无关.
\end{proof}
\end{example}

\begin{example}
设线性方程组\(\A\x=\b\)的增广矩阵\(\wA = (\A,\b)\)是一个\(n\)阶可逆矩阵.
证明：方程组无解.
\begin{proof}
因为\(\wA\)是\(n\)阶方阵，
所以\(\A\)是\(n \times (n-1)\)矩阵，
从而\(\rank\A \leq \min\{n-1,n\} = n-1\).
又因为\(\wA\)可逆，所以\(\rank\wA = n\).
因为\(\rank\wA = n > n-1 \geq \rank\A\)，
所以方程组\(\A\x=\b\)无解.
\end{proof}
\end{example}

\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》三解答题/第20题
设矩阵\(\A = \begin{bmatrix}
	1 & -1 & -1 \\
	2 & a & 1 \\
	-1 & 1 & a
\end{bmatrix},
\B = \begin{bmatrix}
	2 & 2 \\
	1 & a \\
	-a-1 & -2
\end{bmatrix}\).
当\(a\)为何值时，方程\(\A\vb{X}=\B\)无解、有唯一解、有无穷多解？
在有解时，求解此方程.
\begin{solution}
%@Mathematica: A = {{1, -1, -1, 2, 2}, {2, a, 1, 1, a}, {-1, 1, a, -a - 1, -2}}
对增广矩阵\((\A,\B)\)作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		2 & a & 1 & 1 & a \\
		-1 & 1 & a & -a-1 & -2
	\end{bmatrix}
%@Mathematica: A1 = ({ {1, 0, 0}, {-2, 1, 0}, {1, 0, 1} }).A
	\to \begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a+2=0\)即\(a=-2\)时，继续对增广矩阵作初等行变换，
%@Mathematica: A /. a -> -2 // RowReduce // MatrixForm
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & 0 & 3 & -3 & -6 \\
		0 & 0 & -3 & 3 & 0
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -1 & 0 & 1 & 0 \\
		0 & 0 & 1 & -1 & 0 \\
		0 & 0 & 0 & 0 & 1
	\end{bmatrix},
\end{equation*}
由于\(\rank\A = 2 \neq \rank(\A,\B) = 3\)，
所以方程\(\A\vb{X}=\B\)无解.

当\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}
	\to
%@Mathematica: A2 = ({ {1, 1, 0}, {0, 1, 0}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1/(a + 2), 0}, {0, 0, 1} }).A1 // Factor // Simplify
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & \frac{1-a}{a+2} & \frac{2a+1}{a+2} & \frac{3a}{a+2} \\
		0 & 1 & \frac3{a+2} & -\frac3{a+2} & \frac{a-4}{a+2} \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a-1=0\)即\(a=1\)时，
增广矩阵化为\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & 1 \\
		0 & 1 & 1 & -1 & -1 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\A = \rank(\A,\B) = 2 < 3\)，
所以方程\(\A\vb{X}=\B\)有无穷多解.
解方程\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 0 & 0 \\
	\end{bmatrix}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
\end{equation*}
得\begin{equation*}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		0 \\ -1 \\ 1
	\end{bmatrix}
	\quad(\text{$k$是任意常数}).
\end{equation*}
于是方程\(\A\vb{X}=\B\)的解为\begin{equation*}
	\vb{X} = \begin{bmatrix}
		1 & 1\\
		-1-k_1 & -1-k_2 \\
		k_1 & k_2
	\end{bmatrix}
	\quad(\text{$k_1,k_2$是任意常数}).
\end{equation*}

当\(a\neq1\)且\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
%@Mathematica: ({ {1, 0, (a - 1)/(2 + a)}, {0, 1, -3/(2 + a)}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1, 0}, {0, 0, 1/(a - 1)} }).A2 // Factor // Simplify // MatrixForm
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & \frac{3a}{a+2} \\
		0 & 1 & 0 & 0 & \frac{a-4}{a+2} \\
		0 & 0 & 1 & -1 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\A = \rank(\A,\B) = 3\)，
所以方程\(\A\vb{X}=\B\)有唯一解\begin{equation*}
	\def\arraystretch{1.5}
	\vb{X} = \begin{bmatrix}
		1 & \frac{3a}{a+2} \\
		0 & \frac{a-4}{a+2} \\
		-1 & 0
	\end{bmatrix}.
\end{equation*}
\end{solution}
\end{example}
