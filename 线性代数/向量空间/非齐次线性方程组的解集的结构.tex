\section{非齐次线性方程组的解集的结构}
数域\(K\)上\(n\)元非齐次线性方程组
\begin{equation}\label[equation-system]{equation:向量空间.非齐次线性方程组}
	x_1\vb\alpha_1+x_2\vb\alpha_2+\dotsb+x_n\vb\alpha_n=\vb\beta
\end{equation}
的每一个解都是\(K^n\)中的一个向量，
我们称这个向量为该方程组的一个解向量.
因此这个\(n\)元非齐次线性方程组的解集\(U\)是\(K^n\)的一个子集.
当该方程组无解时，\(U\)是空集.
现在我们想要知道，当该方程组有无穷多个解时，解集\(U\)的结构如何？

我们把齐次线性方程组\(\vb{A} \vb{x} = \vb0\)
称为“非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的\DefineConcept{导出组}”.

\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质1
非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的两个解的差是它的导出组的一个解.
\begin{proof}
设\(\vb{x}_1,\vb{x}_2\)是非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的任意两个解，
即\begin{equation*}
	\vb{A} \vb{x}_1 = \vb\beta,
	\qquad
	\vb{A} \vb{x}_2 = \vb\beta,
\end{equation*}
则\begin{equation*}
	\vb{A}(\vb{x}_1 - \vb{x}_2)
	= \vb{A} \vb{x}_1 - \vb{A} \vb{x}_2
	= \vb\beta - \vb\beta
	= \vb0;
\end{equation*}
所以\(\vb{x}_1 - \vb{x}_2\)是\(\vb{A} \vb{x}=\vb0\)的解.
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 性质2
非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)的一个解与它的导出组的一个解之和仍是它的一个解.
\begin{proof}
设\(\vb\xi\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
\(\vb\zeta\)是\(\vb{A} \vb{x} = \vb0\)的一个解，
即\begin{equation*}
	\vb{A}\vb\xi = \vb\beta,
	\qquad
	\vb{A}\vb\zeta = \vb0,
\end{equation*}
则\begin{equation*}
	\vb{A}(\vb\xi + \vb\zeta)
	= \vb{A}\vb\xi + \vb{A}\vb\zeta
	= \vb\beta + \vb0
	= \vb\beta;
\end{equation*}
所以\(\vb\xi + \vb\zeta\)是\(\vb{A} \vb{x} = \vb\beta\)的解.
\end{proof}
\end{proposition}

\begin{example}
设\(\vb{A} \in M_{s \times n}(K)\).
证明：非齐次线性方程组\(\vb{A} \vb{x} = \vb\beta\)有解的充分必要条件是：
如果矩阵\(\vb{A}\)的行向量组的某个线性组合是零向量，
那么向量\(\vb\beta\)的各个分量的相同线性组合也是零.
\begin{proof}
必要性.
假设\(\vb{x}_0\)是\(\vb{A} \vb{x} = \vb\beta\)的一个解，
即\(\vb{A} \vb{x}_0 = \vb\beta\)，
那么\begin{equation*}
	(\AutoTuple{k}{s}) \vb{A} \vb{x}_0
	= (\AutoTuple{k}{s}) \vb\beta,
\end{equation*}
显然当\((\AutoTuple{k}{s}) \vb{A} = \vb0\)时，
\(
	(\AutoTuple{k}{s}) \vb\beta
	= \vb0 \vb{x}_0
	= 0
\).

充分性.
假设\begin{equation*}
	\vb{y}_0^T \vb{A} = \vb0
	\implies
	\vb{y}_0^T \vb\beta = 0,
\end{equation*}
其中\(\vb{y}_0 = (\AutoTuple{y}{s})^T\)，
那么由\cref{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件1} 可知，
\(\vb{A}^T \vb{y}_0 = \vb0\)
与\(
	\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}
	\vb{y}_0 = 0
\)同解，
再由\cref{theorem:齐次线性方程组的解集的结构.两个方程同解的充分必要条件2} 可知\begin{equation*}
	\rank\vb{A}^T
	= \rank\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}.
\end{equation*}
因为\(
	\rank\vb{A} = \rank\vb{A}^T,
	\rank\begin{bmatrix}
		\vb{A} & \vb\beta
	\end{bmatrix}
	= \rank\begin{bmatrix}
		\vb{A}^T \\
		\vb\beta^T
	\end{bmatrix}
\)，
所以\(
	\rank\vb{A}
	= \rank\begin{bmatrix}
		\vb{A} & \vb\beta
	\end{bmatrix}
\)，
因此由\cref{theorem:向量空间.线性方程组有解判别定理} 可知，
\(\vb{A} \vb{x} = \vb\beta\)有解.
\end{proof}
\end{example}

\begin{theorem}\label{theorem:向量空间.非齐次线性方程组的解集的结构}
%@see: 《高等代数（第三版 上册）》（丘维声） P97 定理1
数域\(K\)上\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解集\(U\)为
\begin{equation}
	\Set{ \vb{x}_0+\vb{x} \given \vb{x} \in W },
\end{equation}
其中\(\vb{x}_0\)是这个非齐次线性方程组的一个解，
\(W\)是它的导出组的解空间.
\end{theorem}

我们把\cref{theorem:向量空间.非齐次线性方程组的解集的结构} 中的解向量\(\vb{x}_0\)
称为“\cref{equation:向量空间.非齐次线性方程组} 的\DefineConcept{特解}（particular solution）”.

\begin{corollary}
%@see: 《高等代数（第三版 上册）》（丘维声） P98 推论2
如果\(n\)元非齐次线性方程组 \labelcref{equation:向量空间.非齐次线性方程组} 有解，
则它的解唯一的充分必要条件是它的导出组只有零解.
\end{corollary}

于是当非齐次线性方程组有无穷多个解时，
它的导出组必有非零解.
此时取导出组的一个基础解系\(\AutoTuple{k}{n-r}\)，
其中\(r\)是导出组的系数矩阵的秩，
则非齐次线性方程组的解集为\begin{equation*}
	U = \Set{ \vb{x}_0+k_1\vb{x}_1+k_2\vb{x}_2+ \dotsb +k_{n-r}\vb{x}_{n-r} \given \AutoTuple{k}{n-r} \in K },
\end{equation*}
其中\(\vb{x}_0\)是非齐次线性方程组的一个特解.

解集\(U\)的代表元素\begin{equation*}
	\vb{x}_0+k_1\vb{x}_1+k_2\vb{x}_2+ \dotsb +k_{n-r}\vb{x}_{n-r}
	\quad(\AutoTuple{k}{n-r} \in K)
\end{equation*}
称为“\cref{equation:向量空间.非齐次线性方程组} 的通解”.

\begin{example}
求线性方程组\begin{equation*}
	\left\{ \begin{array}{*{9}{r}}
		x_1 &-& 2 x_2 &-& x_3 &+& 2 x_4 &=& 4 \\
		2 x_1 &-& 2 x_2 &-& 3 x_3 && &=& 2 \\
		4 x_1 &-& 2 x_2 &-& 7 x_3 &-& 4 x_4 &=& -2
	\end{array} \right.
\end{equation*}的通解.
\begin{solution}
写出增广矩阵\(\widetilde{\vb{A}}\)，并作初等行变换化简
\begin{align*}
	\widetilde{\vb{A}}
	&= \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		2 & -2 & -3 & 0 & 2 \\
		4 & -2 & -7 & -4 & -2
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -2 & -1 & 2 & 4 \\
		0 & 2 & -1 & -4 & -6 \\
		0 & 6 & -3 & -12 & -18
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & -2 & -2 & -2 \\
		0 & 1 & -\tfrac12 & -2 & -3 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}
	= \widetilde{\vb{B}}
	= (\vb{B},\vb\gamma),
\end{align*}
故\(\rank\vb{A} = \rank\widetilde{\vb{A}} = \rank\widetilde{\vb{B}} = 2\)，于是原方程组有解.

解同解方程组\begin{equation*}
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& -2 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& -3
	\end{array} \right..
\end{equation*}
令\(x_3 = 0\)，\(x_4 = 0\)，
解得\(x_1 = -2\)，\(x_2 = -3\)，
得特解\begin{equation*}
	\vb{x}_0 = (-2,-3,0,0)^T.
\end{equation*}

又因为导出组的基础解系含\(4 - \rank\vb{A} = 2\)个向量.
将\(x_3,x_4\)的两组值\((2,0),(0,1)\)分别代入\begin{equation*}
	\left\{ \begin{array}{*{9}{c}}
		x_1 && &-& 2 x_3 &-& 2 x_4 &=& 0 \\
		&& x_2 &-& \frac12 x_3 &-& 2 x_4 &=& 0
	\end{array} \right.
\end{equation*}
得基础解系
\(\vb{x}_1 = (4,1,2,0)^T,
\vb{x}_2 = (2,2,0,1)^T\).

于是原方程的通解为\begin{equation*}
	\vb{x} = \vb{x}_0 + k_1 \vb{x}_1 + k_2 \vb{x}_2
	= \begin{bmatrix} -2 \\ -3 \\ 0 \\ 0 \end{bmatrix}
	+ k_1 \begin{bmatrix} 4 \\ 1 \\ 2 \\ 0 \end{bmatrix}
	+ k_2 \begin{bmatrix} 2 \\ 2 \\ 0 \\ 1 \end{bmatrix},
\end{equation*}
其中\(k_1,k_2\)是任意常数.
\end{solution}
%@Mathematica: A = RowReduce[({{1, -2, -1, 2, 4}, {2, -2, -3, 0, 2}, {4, -2, -7, -4, -2}})]
%@Mathematica: LinearSolve[A[[All, 1 ;; 4]], A[[All, 5]]]
\end{example}

\begin{example}
写出线性方程组\begin{equation*}
	\left\{ \begin{array}{l}
		x_1 - x_2 = a_1 \\
		x_2 - x_3 = a_2 \\
		x_3 - x_4 = a_3 \\
		x_4 - x_1 = a_4
	\end{array} \right.
\end{equation*}有解的充分必要条件，并求解.
\begin{solution}
对增广矩阵\(\widetilde{\vb{A}}\)作初等行变换化简
\begin{align*}
	\widetilde{\vb{A}}
	&= \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		-1 & 0 & 0 & 0 & a_4
	\end{bmatrix} \to \begin{bmatrix}
		1 & -1 & 0 & 0 & a_1 \\
		0 & 1 & -1 & 0 & a_2 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix} \\
	&\to \begin{bmatrix}
		1 & 0 & 0 & -1 & a_1 + a_2 + a_3 \\
		0 & 1 & 0 & -1 & a_2 + a_3 \\
		0 & 0 & 1 & -1 & a_3 \\
		0 & 0 & 0 & 0 & \sum_{i=1}^4 a_i
	\end{bmatrix}.
\end{align*}
可见\(\rank\vb{A} = 3\).
方程组有解的充分必要条件是\(\rank\widetilde{\vb{A}} = \rank\vb{A} = 3\)，
那么充分必要条件就是\(\sum_{i=1}^4 a_i = 0\).

当方程组有解时，通解为\begin{equation*}
	\begin{bmatrix}
		a_1 + a_2 + a_3 \\ a_2 + a_3 \\ a_3 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		1 \\ 1 \\ 1 \\ 1
	\end{bmatrix},
\end{equation*}
其中\(k\)为任意常数.
\end{solution}
\end{example}

至此，我们讨论了线性方程组的解的存在性、解的性质、解的结构及求解方法，建立起了线性方程组的完整理论.
解线性方程组是线性代数的基本问题之一，现代科学技术方面用到的数学问题也有很多要归结到解线性方程组.

\begin{example}
设\(\vb{x}_0\)是非齐次线性方程组\(\vb{A} \vb{x}=\vb\beta\)的一个解，
\(\AutoTuple{\vb{x}}{n-r}\)是其导出组\(\vb{A} \vb{x}=\vb0\)的一个基础解系.
证明：\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性无关.
\begin{proof}
因为\(\AutoTuple{\vb{x}}{n-r}\)是其导出组\(\vb{A} \vb{x}=\vb0\)的一个基础解系，
根据基础解系的定义，显然有\(\AutoTuple{\vb{x}}{n-r}\)线性无关.
假设\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性相关，
那么\(\vb{x}_0\)可由\(\AutoTuple{\vb{x}}{n-r}\)线性表出，
即存在数\(k_1,k_2,\dotsc,k_{n-r}\)使得\begin{equation*}
	\vb{x}_0 = k_1 \vb{x}_1 + k_2 \vb{x}_2 + \dotsb + k_{n-r} \vb{x}_{n-r},
\end{equation*}
进而有\begin{align*}
	&\vb{A} \vb{x}_0 = \vb{A}(k_1 \vb{x}_1 + k_2 \vb{x}_2 + \dotsb + k_{n-r} \vb{x}_{n-r}) \\
	&= k_1 \vb{A} \vb{x}_1 + k_2 \vb{A} \vb{x}_2 + \dotsb + k_{n-r} \vb{A} \vb{x}_{n-r}
	= \vb0 + \vb0 + \dotsb + \vb0 = \vb0,
\end{align*}
即\(\vb{x}_0\)是\(\vb{A} \vb{x}=\vb0\)的一个解，
这与\(\vb{x}_0\)是\(\vb{A} \vb{x}=\vb\beta\neq\vb0\)的一个解矛盾，
所以\(\vb{x}_0,\AutoTuple{\vb{x}}{n-r}\)线性无关.
\end{proof}
\end{example}

\begin{example}
设线性方程组\(\vb{A} \vb{x}=\vb\beta\)的增广矩阵\(\widetilde{\vb{A}} = (\vb{A},\vb\beta)\)是一个\(n\)阶可逆矩阵.
证明：方程组无解.
\begin{proof}
因为\(\widetilde{\vb{A}}\)是\(n\)阶方阵，
所以\(\vb{A}\)是\(n \times (n-1)\)矩阵，
从而\(\rank\vb{A} \leq \min\{n-1,n\} = n-1\).
又因为\(\widetilde{\vb{A}}\)可逆，所以\(\rank\widetilde{\vb{A}} = n\).
因为\(\rank\widetilde{\vb{A}} = n > n-1 \geq \rank\vb{A}\)，
所以方程组\(\vb{A} \vb{x}=\vb\beta\)无解.
\end{proof}
\end{example}

\begin{example}
%@see: 《2025年全国硕士研究生入学统一考试（数学一）》一选择题/第6题
设\(\AutoTuple{\vb\alpha}{4}\)是\(n\)维向量，
\(\vb\alpha_1,\vb\alpha_2\)线性无关，
\(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3\)线性相关，
且\begin{equation*}
	\vb\alpha_1 + \vb\alpha_2 + \vb\alpha_4 = \vb0.
\end{equation*}
试判别关于\(x,y,z\)的方程组
\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形.
\begin{solution}
由题意有\(\vb\alpha_3,\vb\alpha_4\)可以由\(\vb\alpha_1,\vb\alpha_2\)线性表出.
那么\begin{equation*}
	\rank(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3)
	= \rank(\vb\alpha_1,\vb\alpha_2,\vb\alpha_3,\vb\alpha_4)
	= 2 < 3,
\end{equation*}
%\cref{theorem:线性方程组.齐次线性方程组的解向量个数}
因此\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb0\)的基础解系含有\(3-2=1\)个向量，
这就说明该方程组的几何图形是一条直线.

假设方程组\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形是一条经过原点的直线，
则\((0,0,0)\)是该方程组的一个解，
即\begin{equation*}
	\vb\alpha_4
	= 0 \vb\alpha_1 + 0 \vb\alpha_2 + 0 \vb\alpha_3
	= \vb0.
\end{equation*}
再由\(\vb\alpha_1 + \vb\alpha_2 + \vb\alpha_4 = \vb0\)
可知\(\vb\alpha_1 + \vb\alpha_2 = \vb0\)，
这说明\(\vb\alpha_1,\vb\alpha_2\)线性相关，矛盾！
因此方程组\(x \vb\alpha_1 + y \vb\alpha_2 + z \vb\alpha_3 = \vb\alpha_4\)的几何图形是一条不经过原点的直线.
\end{solution}
\end{example}
\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》三解答题/第20题
设矩阵\(\vb{A} = \begin{bmatrix}
	1 & -1 & -1 \\
	2 & a & 1 \\
	-1 & 1 & a
\end{bmatrix},
\vb{B} = \begin{bmatrix}
	2 & 2 \\
	1 & a \\
	-a-1 & -2
\end{bmatrix}\).
当\(a\)为何值时，方程\(\vb{A}\vb{X}=\vb{B}\)无解、有唯一解、有无穷多解？
在有解时，求解此方程.
\begin{solution}
%@Mathematica: A = {{1, -1, -1, 2, 2}, {2, a, 1, 1, a}, {-1, 1, a, -a - 1, -2}}
对增广矩阵\((\vb{A},\vb{B})\)作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		2 & a & 1 & 1 & a \\
		-1 & 1 & a & -a-1 & -2
	\end{bmatrix}
%@Mathematica: A1 = ({ {1, 0, 0}, {-2, 1, 0}, {1, 0, 1} }).A
	\to \begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a+2=0\)即\(a=-2\)时，继续对增广矩阵作初等行变换，
%@Mathematica: A /. a -> -2 // RowReduce // MatrixForm
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & 0 & 3 & -3 & -6 \\
		0 & 0 & -3 & 3 & 0
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & -1 & 0 & 1 & 0 \\
		0 & 0 & 1 & -1 & 0 \\
		0 & 0 & 0 & 0 & 1
	\end{bmatrix},
\end{equation*}
由于\(\rank\vb{A} = 2 \neq \rank(\vb{A},\vb{B}) = 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)无解.

当\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
	\begin{bmatrix}
		1 & -1 & -1 & 2 & 2 \\
		0 & a+2 & 3 & -3 & a-4 \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}
	\to
%@Mathematica: A2 = ({ {1, 1, 0}, {0, 1, 0}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1/(a + 2), 0}, {0, 0, 1} }).A1 // Factor // Simplify
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & \frac{1-a}{a+2} & \frac{2a+1}{a+2} & \frac{3a}{a+2} \\
		0 & 1 & \frac3{a+2} & -\frac3{a+2} & \frac{a-4}{a+2} \\
		0 & 0 & a-1 & 1-a & 0
	\end{bmatrix}.
\end{equation*}

当\(a-1=0\)即\(a=1\)时，
增广矩阵化为\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & 1 \\
		0 & 1 & 1 & -1 & -1 \\
		0 & 0 & 0 & 0 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\vb{A} = \rank(\vb{A},\vb{B}) = 2 < 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)有无穷多解.
解方程\begin{equation*}
	\begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 0 & 0 \\
	\end{bmatrix}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
\end{equation*}
得\begin{equation*}
	\vb{x}
	= \begin{bmatrix}
		1 \\ -1 \\ 0
	\end{bmatrix}
	+ k \begin{bmatrix}
		0 \\ -1 \\ 1
	\end{bmatrix}
	\quad(\text{$k$是任意常数}).
\end{equation*}
于是方程\(\vb{A}\vb{X}=\vb{B}\)的解为\begin{equation*}
	\vb{X} = \begin{bmatrix}
		1 & 1\\
		-1-k_1 & -1-k_2 \\
		k_1 & k_2
	\end{bmatrix}
	\quad(\text{$k_1,k_2$是任意常数}).
\end{equation*}

当\(a\neq1\)且\(a\neq-2\)时，继续对增广矩阵作初等行变换，
得\begin{equation*}
%@Mathematica: ({ {1, 0, (a - 1)/(2 + a)}, {0, 1, -3/(2 + a)}, {0, 0, 1} }).({ {1, 0, 0}, {0, 1, 0}, {0, 0, 1/(a - 1)} }).A2 // Factor // Simplify // MatrixForm
	\def\arraystretch{1.5}
	\begin{bmatrix}
		1 & 0 & 0 & 1 & \frac{3a}{a+2} \\
		0 & 1 & 0 & 0 & \frac{a-4}{a+2} \\
		0 & 0 & 1 & -1 & 0
	\end{bmatrix}.
\end{equation*}
由于\(\rank\vb{A} = \rank(\vb{A},\vb{B}) = 3\)，
所以方程\(\vb{A}\vb{X}=\vb{B}\)有唯一解\begin{equation*}
	\def\arraystretch{1.5}
	\vb{X} = \begin{bmatrix}
		1 & \frac{3a}{a+2} \\
		0 & \frac{a-4}{a+2} \\
		-1 & 0
	\end{bmatrix}.
\end{equation*}
\end{solution}
\end{example}
