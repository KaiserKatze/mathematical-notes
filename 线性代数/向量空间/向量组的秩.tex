\section{向量组的秩}
\subsection{向量组的等价关系}
\begin{definition}\label{definition:向量空间.线性表出2}
%@see: 《线性代数》（张慎语、周厚隆） P72 定义7
%@see: 《高等代数（第三版 上册）》（丘维声） P72 定义2
在\(K^n\)中，如果向量组\(A\)的每个向量都可由向量组\(B\)线性表出，
即\[
	(\forall \a \in A)[\a \in \Span B],
\]或\[
	A\subseteq\Span B,
\]
则称“向量组\(A\)可由向量组\(B\)~\DefineConcept{线性表出}”
或“向量组\(B\)可以\DefineConcept{线性表出}向量组\(A\)”；
否则称“向量组\(A\)不可由向量组\(B\)~线性表出”
或“向量组\(B\)不可以线性表出向量组\(A\)”.
\end{definition}

\begin{proposition}\label{theorem:向量空间.线性表出2的等价条件}
在\(K^n\)中，向量组\(A=\{\AutoTuple{\vb\alpha}{s}\}\)
可由向量组\(B=\{\AutoTuple{\vb\beta}{t}\}\)线性表出，
当且仅当存在矩阵\(\vb{Q} \in M_{t \times s}(K)\)，
使得\[
	(\AutoTuple{\vb\alpha}{s}) = (\AutoTuple{\vb\beta}{t})~\vb{Q}.
\]
\begin{proof}
假设向量组\(\{\AutoTuple{\vb\alpha}{s}\}\)由向量组\(\{\AutoTuple{\vb\beta}{t}\}\)线性表出，
即存在\[
	x_{ij} \in K\ (i=1,2,\dotsc,s;j=1,2,\dotsc,t),
\]
使得\begin{equation*}
	\left\{ \begin{array}{l}
		\vb\alpha_1
		= x_{11} \vb\beta_1 + x_{12} \vb\beta_2 + \dotsb + x_{1t} \vb\beta_t
		= (\AutoTuple{\vb\beta}{t})
		(x_{11},\dotsc,x_{1t})^T, \\
		\vb\alpha_2
		= x_{21} \vb\beta_1 + x_{22} \vb\beta_2 + \dotsb + x_{2t} \vb\beta_t
		= (\AutoTuple{\vb\beta}{t})
		(x_{21},\dotsc,x_{2t})^T, \\
		\hdotsfor{1} \\
		\vb\alpha_s
		= x_{s1} \vb\beta_1 + x_{s2} \vb\beta_2 + \dotsb + x_{st} \vb\beta_t
		= (\AutoTuple{\vb\beta}{t})
		(x_{s1},\dotsc,x_{st})^T,
	\end{array} \right.
\end{equation*}
那么\begin{align*}
	(\AutoTuple{\vb\alpha}{s})
	&= (
		(\AutoTuple{\vb\beta}{t})
		(x_{11},\dotsc,x_{1t})^T,
		\dotsc,
		(\AutoTuple{\vb\beta}{t})
		(x_{s1},\dotsc,x_{st})^T
	) \\
	&= (\AutoTuple{\vb\beta}{t})
	((x_{11},\dotsc,x_{1t})^T,\dotsc,(x_{s1},\dotsc,x_{st})^T),
\end{align*}
这里\(\Q = ((x_{11},\dotsc,x_{1t})^T,\dotsc,(x_{s1},\dotsc,x_{st})^T)\).
\end{proof}
\end{proposition}
\begin{remark}
\cref{theorem:向量空间.线性表出2的等价条件} 说明：
矩阵\(\A\)与\(\B\)的乘积\(\A \B\)的列向量组可以由\(\A\)的列向量组线性表出.
\end{remark}

\begin{proposition}\label{theorem:向量空间.线性表出2的自反性}
非空向量组\(A\)总可由它本身线性表出，
即\[
	A \subseteq \Span A.
\]
\begin{proof}
设\(A=\{\AutoTuple{\a}{s}\}\ (s\geq1)\)，
显然\[
	\a_i=0\a_1+\dotsb+0\a_{i-1}+1\a_i+0\a_{i+1}+\dotsb+0\a_s,
	\quad i=1,2,\dotsc,s;
\]
这就是说\(\a_i\ (i=1,2,\dotsc,s)\)可由\(A\)线性表出，即\[
	\a_i\in\opair{\AutoTuple{\a}{s}},
	\quad i=1,2,\dotsc,s.
\]
于是\(A\)可由\(A\)线性表出.
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:向量空间.线性表出2的必要条件}
设\(A,B\)都是向量组，
则\[
	\text{\(A\)可由\(B\)线性表出}
	\implies
	\Span A \subseteq \Span B.
\]
\begin{proof}
假设\(A = \{\AutoTuple{\a}{s}\},
B = \{\AutoTuple{\b}{t}\}\).

任意取定\(\a\in\Span A\)，
那么一定存在\(\AutoTuple{k}{s}\in K\)满足\[
	\a = \sum_{i=1}^s k_i \a_i;
\]
又设\(l_{ij}\in K\ (i=1,2,\dotsc,s;j=1,2,\dotsc,t)\)满足\[
	\a_i = \sum_{j=1}^t l_{ij} \b_j,
	\quad i=1,2,\dotsc,s;
\]
那么\[
	\a = \sum_{i=1}^s k_i \left(
		\sum_{j=1}^t l_{ij} \b_j
	\right)
	= \sum_{j=1}^t \left(
		\sum_{i=1}^s k_i l_{ij}
	\right) \b_j,
\]
这就是说\(\a\in\Span B\)，
于是\(\Span A\subseteq\Span B\).
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:向量空间.线性表出2的充分条件}
如果\(\Span A\subseteq\Span B\)，
那么向量组\(A\)可由\(B\)线性表出.
\begin{proof}
因为\(\Span A\subseteq\Span B\)，\(A\subseteq\Span A\)，
所以\(A\subseteq\Span B\).
\end{proof}
\end{proposition}

于是，依据\cref{theorem:向量空间.线性表出2的必要条件,%
theorem:向量空间.线性表出2的充分条件}，
我们可以说：\begin{equation}
	\text{向量组\(A\)可由\(B\)线性表出}
	\iff
	\Span A\subseteq\Span B.
\end{equation}
从而“线性表出”和集合的“包含”关系一样，具有自反性和传递性：
\begin{enumerate}
	\item \(\Span A\subseteq\Span A\).

	这由\cref{theorem:向量空间.线性表出2的自反性} 立即可得.

	\item \(\Span A\subseteq\Span B\land\Span B\subseteq\Span C\implies\Span A\subseteq\Span C\).

	即便不利用集合的包含关系，我们也可以证明线性表出的传递性.
	具体来说，
	假设向量组\(A=\Set{\AutoTuple{\a}{s}}\)可以由向量组\(B=\Set{\AutoTuple{\b}{r}}\)线性表出，
	且\(B\)可以由向量组\(C=\Set{\AutoTuple{\g}{m}}\)线性表出.
	在向量组\(A\)中任取一个向量\(\a_i\)，则\[
		\a_i = \sum_{j=1}^r k_j \b_j.
	\]
	又由于\(\b_j\)可以由向量组\(C\)线性表出，因此\[
		\b_j = \sum_{t=1}^m l_{jt} \g_t,
		\quad j=1,\dotsc,r.
	\]
	从而\[
		\a_i = \sum_{j=1}^r k_j \b_j
		= \sum_{j=1}^r k_j \left(
			\sum_{t=1}^m l_{jt} \g_t
		\right)
		= \sum_{t=1}^m \left(
			\sum_{j=1}^r k_j l_{jt}
		\right) \g_t.
	\]
	于是\(\a_i\)可以由\(C\)线性表出，
	从而\(A\)可以由\(C\)线性表出.
\end{enumerate}

\begin{definition}\label{definition:向量空间.向量组等价的定义}
%@see: 《线性代数》（张慎语、周厚隆） P72 定义7
%@see: 《高等代数（第三版 上册）》（丘维声） P72 定义2
如果向量组\(A\)与\(B\)可以相互线性表出，
即\[
	\Span A\subseteq\Span B
	\land
	\Span B\subseteq\Span A,
\]
或\[
	\Span A = \Span B,
\]
则称“\(A\)与\(B\) \DefineConcept{等价}”，
记作\(A \cong B\).
\end{definition}
\begin{proposition}\label{theorem:向量空间.向量组等价的等价条件}
在\(K^n\)中，向量组\(A=\{\AutoTuple{\vb\alpha}{s}\}\)
与向量组\(B=\{\AutoTuple{\vb\beta}{t}\}\)等价，
当且仅当存在
矩阵\(\vb{P} \in M_{s \times t}(K)\)、
矩阵\(\vb{Q} \in M_{t \times s}(K)\)，
使得\[
	(\AutoTuple{\vb\beta}{t}) = (\AutoTuple{\vb\alpha}{s})~\vb{P},
	\quad\text{且}\quad
	(\AutoTuple{\vb\alpha}{s}) = (\AutoTuple{\vb\beta}{t})~\vb{Q}.
\]
\begin{proof}
由\cref{theorem:向量空间.线性表出2的等价条件} 易得.
\end{proof}
%@credit: {5f4d2f8a-fc8b-4798-85d6-98670f6761e7} 说
% 不能把上述条件浓缩为“存在一个行满秩矩阵或列满秩矩阵\(\vb{Q}\)使得\((\AutoTuple{\vb\alpha}{s}) = (\AutoTuple{\vb\beta}{t})~\vb{Q}\)”.
% 特别是考虑到向量组\(A\)和向量组\(B\)可能是线性相关的，那样就完全不需要一个满秩过渡矩阵.
\end{proposition}

\begin{property}\label{theorem:向量空间.向量组的等价的性质}
对于任意向量组\(A,B,C\subseteq K^n\)来说，
\begin{itemize}
	\item “向量组的等价”具有自反性，即\(A \cong A\).
	\item “向量组的等价”具有对称性，即\(A \cong B \implies B \cong A\).
	\item “向量组的等价”具有传递性，即\(A \cong B \land B \cong C \implies A \cong C\).
\end{itemize}
\end{property}
“向量组的等价”是向量组之间的一种等价关系.

另外，应该注意到，即便有\[
	A \subseteq \Span A = \Span B \supseteq B,
\]成立，不见得就有\(A=B\)一定成立.

\begin{theorem}\label{theorem:线性方程组.部分组可由全组线性表出}
%@see: 《线性代数》（张慎语、周厚隆） P72
部分组可由全组线性表出.
\begin{proof}
设数域\(K\)上一个向量组\(A=\{\AutoTuple{\a}{s}\}\)，
从中任取\(t\ (t \leq s)\)个向量组成向量组\[
	B=\{\AutoTuple{\a}{t}\}.
\]
欲证部分组可由全组线性表出，
即证\(\forall \a_j \in B\)，
\(\exists \AutoTuple{k}{j},\dotsc,k_s \in K\)，
使得\[
	\a_j = k_1 \a_1 + k_2 \a_2 + \dotsb + k_j \a_j + \dotsb + k_s \a_s.
\]
显然只要取\[
	k_i = \left\{ \begin{array}{cl}
		1, & i=j, \\
		0, & i \neq j,
	\end{array} \right.
\]
便可令上式成立.
\end{proof}
\end{theorem}
对于\cref{theorem:线性方程组.部分组可由全组线性表出}，
从\(A \subseteq B\)出发，
我们还可以利用\cref{theorem:向量空间.线性表出2的自反性}，
结合\(B \subseteq \Span B\)，
根据集合包含关系的传递性，
就可以得到\(A \subseteq \Span B\).
因此\[
	A \subseteq B \implies A \subseteq \Span B.
\]

\begin{theorem}
%@see: 《线性代数》（张慎语、周厚隆） P72
设\(A\)是向量组，且\(\card A > 1\).
\(A\)线性相关的充分必要条件是：
\(A\)可由某个部分组线性表出.
\begin{proof}
必要性.
因为\(\card A > 1\)，
所以由\cref{theorem:线性方程组.向量组线性相关的充分必要条件1} 可知
\[
	\text{\(A\)线性相关}
	\iff
	(\exists \a \in A)[\a \in \Span(A-\{\a\})].
\]
又因为\(\card A > 1\)，
所以\((\forall\b\in A)[\card(A-\{\b\})>0]\)，
那么只要令\(B=A-\{\a\}\)，
就必然有\[
	\emptyset \neq B \subseteq A = \{\a\} \cup B, \qquad
	\{\a\}\subseteq\Span B, \qquad
	B \subseteq \Span B
\]同时成立.
因此\(A\subseteq\Span B\)，
这就是说\(A\)可由\(B\)线性表出.

充分性.
因为\(\card A > 1\)，
所以\((\exists B)[\emptyset \neq B \subset A]\).
假设\(B\)是\(A\)的一个非空真子集，且\(A\)可由它线性表出，
即\(\emptyset \neq B \subset A\)且\(\Span A \subseteq \Span B\).
显然\(A-B\neq\emptyset\).
由于\hyperref[theorem:线性方程组.部分组可由全组线性表出]{部分组可由全组线性表出}，
所以\[
	A-B \subseteq A
	\implies
	A-B \subseteq \Span A
	\implies
	A-B \subseteq \Span B.
\]
我们可以笃定：存在向量\(\g \in A-B\)，使得\(\g\)可由向量组\(B\)线性表出，
即\(\g \in \Span B\).
因为\(\g \in A-B \implies A-\{\g\} \supseteq B\)，
所以\(\Span B \subseteq \Span(A-\{\g\})\)，
那么\(\g\)也可由向量组\((A-\{g\})\)线性表出，
即\(\g \in \Span(A-\{g\})\).
于是由\cref{theorem:线性方程组.向量组线性相关的充分必要条件1} 可知
向量组\(A\)线性相关.
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:向量空间.可由比自己基数小的向量组线性表出的向量组线性相关}
%@see: 《线性代数》（张慎语、周厚隆） P72 定理2
%@see: 《高等代数（第三版 上册）》（丘维声） P74 引理1
设向量组\(A=\{\AutoTuple{\a}{s}\}\)可由\(B=\{\AutoTuple{\b}{t}\}\)线性表出.
如果\(s>t\)，则\(A\)线性相关.
\begin{proof}
欲证\(A\)线性相关，须找到不全为零的\(s\)个数\(\AutoTuple{k}{s}\)使得\[
	k_1 \a_1 + k_2 \a_2 + \dotsb + k_s \a_s = \z.
\]
因为向量组\(A\)可由\(B\)线性表出，即有\[
	\left\{ \begin{array}{l}
		\a_1 = c_{11} \b_1 + c_{21} \b_2 + \dotsb + c_{t1} \b_t, \\
		\a_2 = c_{12} \b_1 + c_{22} \b_2 + \dotsb + c_{t2} \b_t, \\
		\hdotsfor{1} \\
		\a_s = c_{1s} \b_1 + c_{2s} \b_2 + \dotsb + c_{ts} \b_t.
	\end{array} \right.
\]代入可得\[
	\sum_{j=1}^s k_j \a_j
	=\sum_{j=1}^s k_j \sum_{i=1}^t c_{ij} \b_i
	=\sum_{j=1}^s \sum_{i=1}^t k_j c_{ij} \b_i
	=\sum_{i=1}^t \b_i \sum_{j=1}^s k_j c_{ij}
	=\z.
\]
如此只需证存在不全为零的\(s\)个数\(\AutoTuple{k}{s}\)
使得对于任意\(i=1,2,\dotsc,t\)都有\[
	\sum_{j=1}^s k_j c_{ij} = 0.
\]
而关于\(k_i\ (i=1,2,\dotsc,s)\)的齐次线性方程组
\[
	\left\{ \begin{array}{l}
		c_{11} k_1 + c_{12} k_2 + \dotsb + c_{1s} k_s = 0, \\
		c_{21} k_1 + c_{22} k_2 + \dotsb + c_{2s} k_s = 0, \\
		\hdotsfor{1} \\
		c_{t1} k_1 + c_{t2} k_2 + \dotsb + c_{ts} k_s = 0.
	\end{array} \right.
\]中方程数\(t\)小于未知量个数\(s\)，必有非零解.
\end{proof}
\end{theorem}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P73 推论1
任意\(n+1\)个\(n\)维向量线性相关.
\begin{proof}
由\cref{theorem:向量空间.任一向量可由基本向量组唯一线性表出}，
\(K^n\)中任意\(n+1\)个\(n\)维向量\(A=\{\AutoTuple{\a}{n+1}\}\)
可由基本向量组线性表出；
这两个向量组中的向量个数满足\(n+1>n\)，
由\cref{theorem:向量空间.可由比自己基数小的向量组线性表出的向量组线性相关}，
向量组\(A\)线性相关.
\end{proof}
\end{corollary}

\begin{corollary}\label{theorem:向量空间.线性无关向量组的基数不大于可以线性表出它的任意向量组的基数}
%@see: 《线性代数》（张慎语、周厚隆） P73 推论2
%@see: 《高等代数（第三版 上册）》（丘维声） P74 推论3
若线性无关向量组\(A=\{\AutoTuple{\a}{s}\}\)可由\(B=\{\AutoTuple{\b}{t}\}\)线性表出，
则\(s \leq t\).
\begin{proof}
用反证法.
假设\(s > t\)，
由\cref{theorem:向量空间.可由比自己基数小的向量组线性表出的向量组线性相关}，
因为向量组\(A\)可由\(B\)线性表出，
所以向量组\(A\)线性相关，矛盾！
故\(s \leq t\).
\end{proof}
\end{corollary}

\begin{corollary}\label{theorem:向量空间.两个等价的线性无关向量组含有相同的向量个数}
%@see: 《线性代数》（张慎语、周厚隆） P73 推论3
%@see: 《高等代数（第三版 上册）》（丘维声） P74 推论4
两个等价的线性无关向量组含有相同的向量个数，即\[
	A \cong B \implies \card A = \card B.
\]
\begin{proof}
设\(A=\{\AutoTuple{\a}{s}\}\)%
与\(B=\{\AutoTuple{\b}{t}\}\)%
都线性无关，且\(A \cong B\).
因为\(A\)可由\(B\)线性表出，
由\cref{theorem:向量空间.线性无关向量组的基数不大于可以线性表出它的任意向量组的基数}，
\(s \leq t\)；
同理可得\(t \leq s\)；
于是\(s = t\).
\end{proof}
\end{corollary}
\begin{remark}
含有相同个数向量的两个向量组不一定等价.
例如，取向量组\(A=\{(0,1)\},
B=\{(1,0)\}\).
易知向量组\(B\)不可以线性表出向量组\(A\)，
向量组\(A\)也不可以线性表出向量组\(B\).
\end{remark}

%\begin{example}
%在数域\(K\)上，满足\[
%\abs{a_{ii}} > \sum_{\substack{1 \leq j \leq n \\ j \neq i}} \abs{a_{ij}}
%\quad (i=1,2,\dotsc,n)
%\]的\(n\)阶矩阵\(\A = (a_{ij})_n\)称为\DefineConcept{主对角占优矩阵}.
%证明：\(\A\)的列向量组\(\AutoTuple{\a}{n}\)的秩等于\(n\).
%\begin{proof}
%假设\(\AutoTuple{\a}{n}\)线性相关，
%则在\(K\)中有一组不全为0的数\(\AutoTuple{k}{n}\)，
%使得\[
%	k_1 \a_1 + k_2 \a_2 + \dotsb + k_n \a_n = \z.
%\]
%不妨设\(\abs{k_l} = \max\{\abs{k_1},\abs{k_2},\dotsc,\abs{k_n}\}\neq0\).
%由\[
%	k_1 a_{l1} + k_2 a_{l2} + \dotsb + k_l a_{ll} + \dotsb + k_n a_{ln} = 0,
%\]
%可得\[
%	a_{ll} = -\frac{1}{k_l} (k_1 a_{l1} + \dotsb + k_{l-1} a_{l,l-1} + k_{l+1} a_{l,l+1} + \dotsb + k_n a_{ln})
%	= - \sum_{\substack{1 \leq j \leq n \\ j \neq l}} \frac{k_j}{k_l} a_{lj},
%\]\[
%	\abs{a_{ll}} \leq \sum_{\substack{1 \leq j \leq n \\ j \neq l}} \frac{\abs{k_j}}{\abs{k_l}} \abs{a_{lj}}
%	\leq \sum_{\substack{1 \leq j \leq n \\ j \neq l}} \abs{a_{lj}}.
%\]
%这与已知条件矛盾！
%因此\(\AutoTuple{\a}{n}\)线性无关，
%\(\rank\{\AutoTuple{\a}{n}\} = n\).
%\end{proof}
%\end{example}
%TODO 后移到【向量的秩】

\subsection{极大线性无关组的概念}
\begin{definition}\label{definition:线性方程组.极大线性无关组的定义}
%@see: 《线性代数》（张慎语、周厚隆） P73 定义8
%@see: 《高等代数（第三版 上册）》（丘维声） P72 定义1
在\(K^n\)中，设\(B\)是\(A\)的一个部分组.
如果\begin{itemize}
	\item \(B\)线性无关，
	\item \(A\)可由\(B\)线性表出，
\end{itemize}
则称“\(B\)是\(A\)的一个\DefineConcept{极大线性无关组}（maximally linearly independent subset）”.
%@see: https://mathworld.wolfram.com/MaximallyLinearlyIndependent.html
\end{definition}

\begin{example}\label{example:向量空间.单向量组的极大线性无关组}
求向量组\(\{\vb\alpha\}\)的极大线性无关组.
\begin{solution}
显然有\(\Powerset\{\vb\alpha\} = \{ \emptyset, \{\vb\alpha\} \}\)，
也就是说\(\{\vb\alpha\}\)的部分组只有\(\emptyset\)和\(\{\vb\alpha\}\)，
于是它的极大线性无关组也只能是这两者中的一个.
因为\(\card\{\vb\alpha\} = 1 > 0 = \card\emptyset\)，
所以只需要讨论\(\{\vb\alpha\}\)是不是极大线性无关组.

当\(\vb\alpha=\vb0\)时，\(\{\vb\alpha\}\)线性相关，
不能满足\hyperref[definition:线性方程组.极大线性无关组的定义]{极大线性无关组的定义}，
故\(\{\vb\alpha\}\)的极大线性无关组是\(\emptyset\).

当\(\vb\alpha\neq\vb0\)时，\(\{\vb\alpha\}\)线性无关，
所以\(\{\vb\alpha\}\)的极大线性无关组是它本身.
\end{solution}
\end{example}

\begin{theorem}\label{theorem:线性方程组.向量组与其极大线性无关组等价}
%@see: 《高等代数（第三版 上册）》（丘维声） P73 命题1
向量组与其极大线性无关组等价.
\begin{proof}
由\cref{theorem:线性方程组.部分组可由全组线性表出} 可知，
作为部分组，极大线性无关组可由全组线性表出；
再根据\hyperref[definition:线性方程组.极大线性无关组的定义]{极大线性无关组的定义}，
全组可由极大线性无关组线性表出；
因此，根据\hyperref[definition:向量空间.向量组等价的定义]{向量组等价的定义}，
全组与极大线性无关组等价.
\end{proof}
\end{theorem}
\cref{theorem:线性方程组.向量组与其极大线性无关组等价} 说明，
向量组\(\AutoTuple{\a}{s}\)可以由它的一个极大线性无关组线性表出.
再根据线性表出的传递性得，
\(W=\opair{\AutoTuple{\a}{s}}\)中的每个向量%
可以由\(\AutoTuple{\a}{s}\)的一个极大线性无关组线性表出，
此时表出方式就唯一了.

\begin{corollary}\label{theorem:线性空间.向量组的任意两个极大线性无关组等价且等势}
%@see: 《线性代数》（张慎语、周厚隆） P73 定理3
%@see: 《高等代数（第三版 上册）》（丘维声） P73 推论2
%@see: 《高等代数（第三版 上册）》（丘维声） P75 推论5
向量组的任何两个极大线性无关组等价，
且包含相同个数的向量.
\begin{proof}
设\(A\)与\(B\)是向量组\(C\)的两个极大线性无关组.
根据\cref{theorem:线性方程组.向量组与其极大线性无关组等价}，
\(A \cong C\)，\(B \cong C\).
再由\cref{theorem:向量空间.向量组的等价的性质}，向量组等价具有对称性和传递性，
于是\(A \cong B\).
\end{proof}
\end{corollary}

\begin{theorem}
在\(K^n\)中，任意向量组的极大线性无关组的向量个数不大于\(n\)个.
\begin{proof}
根据定义，任意向量组的极大线性无关组是线性无关的，
而向量个数大于维数的向量组总是线性相关，
故任意向量组的极大线性无关组的向量个数总是不大于其维数\(n\)的.
\end{proof}
\end{theorem}

\subsection{向量组的秩}
\begin{definition}
向量组\(A = \{\AutoTuple{\a}{s}\}\)的极大线性无关组所含向量的个数，
称为向量组的\DefineConcept{秩}（rank），
记为\(\rank A\)或\(\rank\{\AutoTuple{\a}{s}\}\)，
即\[
	\text{\(A'\)是\(A\)的极大线性无关组}
	\implies
	[\rank A = \card A'].
\]
\end{definition}

\begin{property}
空集\(\emptyset\)的秩为零，即\(\rank\emptyset = 0\).
\begin{proof}
由于\(A\subseteq\emptyset\iff A=\emptyset\)，
所以\(\emptyset\)的极大线性无关组就是它本身，
\(\rank\emptyset=\card\emptyset=0\).
\end{proof}
\end{property}

\begin{property}
零向量组的秩为零，即\(\rank\{\z\}=0\).
\begin{proof}
由\cref{example:向量空间.单向量组的极大线性无关组}，
\(\{\z\}\)的极大线性无关组是\(\emptyset\)，
故\(\rank\{\z\} = \card\emptyset = 0\).
\end{proof}
\end{property}

\begin{proposition}\label{theorem:向量组的秩.并集的秩}
设\(A\)是\(K^n\)中的向量组.
\begin{itemize}
	\item 如果向量\(\a\)可由\(A\)线性表出，
	则\[
		\rank(A \cup \{\a\}) = \rank A.
	\]

	\item 如果向量\(\a\)不可由\(A\)线性表出，
	则\[
		\rank(A \cup \{\a\}) = \rank A + 1.
	\]
\end{itemize}
\begin{proof}
假设\(A'\)是\(A\)的一个极大线性无关组.

如果向量\(\a\)可由\(A\)线性表出，
那么\(\a\)可由\(A'\)线性表出，
所以\(A \cup \{\a\}\)中的每一个向量都可由\(A'\)线性表出，
于是\[
	\rank(A \cup \{\a\})
	= \card A'
	= \rank A.
\]

如果向量\(\a\)不可由\(A\)线性表出，
那么\(A' \cup \{\a\}\)线性无关，
且\(A \cup \{\a\}\)可由\(A' \cup \{\a\}\)线性表出，
这就说明\(A' \cup \{\a\}\)一定是\(A \cup \{\a\}\)的一个极大线性无关组.
于是\[
	\rank(A \cup \{\a\})
	= \card(A' \cup \{\a\})
	= \card A' + 1
	= \rank A + 1.
	\qedhere
\]
\end{proof}
\end{proposition}

\begin{corollary}\label{theorem:向量空间.秩与线性相关性的关系}
%@see: 《线性代数》（张慎语、周厚隆） P73 推论4
%@see: 《高等代数（第三版 上册）》（丘维声） P75 命题6
设向量组\(A\).
\begin{itemize}
	\item 如果\(\rank A=\card A\)，则向量组\(A\)线性无关.
	\item 如果\(\rank A<\card A\)，则向量组\(A\)线性相关.
\end{itemize}
\begin{proof}
\(\text{\(A\)线性无关}
	\iff \text{\(A\)的极大线性无关组是它本身}
	\iff \rank A = \card A\).
\end{proof}
\end{corollary}

\begin{theorem}\label{theorem:向量空间.向量组的秩的比较1}
%@see: 《线性代数》（张慎语、周厚隆） P73 推论5
%@see: 《高等代数（第三版 上册）》（丘维声） P75 命题7
设向量组\(A\)可由\(B\)线性表出，
则\(\rank A \leq \rank B\).
\begin{proof}
设\(A=\{\AutoTuple{\a}{s}\}\)，
\(B=\{\AutoTuple{\b}{t}\}\)，
\(\rank A = r\)，\(\rank B = u\).
因为\(A\)可由\(B\)线性表出，即\[
	\a_k = \sum_{i=1}^t l_{ki} \b_i,
	\quad k=1,2,\dotsc,s.
\]
设\(A'=\{\AutoTuple{\a}{r}\}\)%
和\(B'=\{\AutoTuple{\b}{u}\}\)%
分别是\(A\)和\(B\)的极大线性无关组，
则\(B\)可由\(B'\)线性表出，即\[
	\b_i = \sum_{j=1}^u b_{ij} \b_j,
	\quad i=1,2,\dotsc,t;
\]
所以有\[
	\a_k = \sum_{i=1}^t l_{ki} \sum_{j=1}^u b_{ij} \b_j
	= \sum_{i=1}^t \sum_{j=1}^u l_{ki} b_{ij} \b_j
	= \sum_{j=1}^u \b_j \sum_{i=1}^t l_{ki} b_{ij},
	\quad k=1,2,\dotsc,s.
\]

特别地，\(A'\)可由\(B'\)线性表出，
由\cref{theorem:向量空间.线性无关向量组的基数不大于可以线性表出它的任意向量组的基数}，
则有\(r \leq u\)，即\(\rank A \leq \rank B\).
\end{proof}
\end{theorem}

我们可以把\cref{theorem:向量空间.向量组的秩的比较1} 的证明思路绘制如下：\begin{equation*}
	\color{gray}
	\left. \begin{array}{r}
		\rank A = \rank A' = \card A' \\
		\left. \begin{array}{r}
			A' \subseteq A \\
			{\color{black} A \subseteq \Span B} \\
			\Span B \subseteq \Span B'
		\end{array} \right\}
		\implies
		A' \subseteq \Span B'
		\implies
		\card A' \leq \card B' \\
		\rank B = \rank B' = \card B'
	\end{array} \right\}
	\implies
	{\color{black} \rank A \leq \rank B}.
\end{equation*}

\begin{corollary}\label{theorem:向量空间.向量组的秩的比较2}
部分组的秩总是小于或等于全组的秩.
\begin{proof}
因为\hyperref[theorem:线性方程组.部分组可由全组线性表出]{部分组总可由全组线性表出}，
所以\cref{theorem:向量空间.向量组的秩的比较1} 可知，
部分组的秩总是小于或等于全组的秩.
\end{proof}
\end{corollary}

\begin{theorem}\label{theorem:向量组的秩.等价向量组的秩相等}
%@see: 《线性代数》（张慎语、周厚隆） P74 推论6
%@see: 《高等代数（第三版 上册）》（丘维声） P76 推论8
等价向量组的秩相等.
秩相等的向量组却不一定等价.
\begin{proof}
先证“等价向量组的秩相等”.
设向量组\(A\)与\(B\)等价，
则\(A\)可由\(B\)线性表出，
那么由\cref{theorem:向量空间.向量组的秩的比较1} 可得%
\(\rank A \leq \rank B\)；
同理可得\(\rank A \geq \rank B\)；
因此，\(\rank A = \rank B\).

再证“秩相等的向量组却不一定等价”.
设\(A=\{(0,1)\},
B=\{(1,0)\}\).
虽然\[
	\rank A = \rank B = 1,
\]
但\(A\)与\(B\)显然不等价.
\end{proof}
\end{theorem}

\begin{proposition}\label{theorem:向量组的秩.向量组等价的充分必要条件}
设\(A,B\)都是\(K^n\)中的向量组，
则\(A\)与\(B\)等价的充分必要条件是\[
	\rank A = \rank B = \rank(A \cup B).
\]
\begin{proof}
必要性.
假设\(A \cong B\)成立.
因为\hyperref[theorem:向量组的秩.等价向量组的秩相等]{等价向量组的秩相等}，
所以\(\rank A = \rank B\).
因为\(A\)和\(B\)均可由\(B\)线性表出，
从而\(A \cup B\)也可由\(B\)线性表出；
同时\(B\)作为\(A \cup B\)的部分组自然可由\(A \cup B\)线性表出，
所以\(A \cup B\)与\(B\)等价，
于是\(\rank(A \cup B) = \rank B\).

充分性.
用反证法.
假设\(\rank A = \rank(A \cup B)\)成立，
但是\(B\)不可由\(A\)线性表出.
因为\(B\)不可由\(A\)线性表出，
所以\[
	(\exists\b \in B)  		% 向量组 B 中存在向量 \b
	[\b \notin \Span A],	% 向量 \b 不在向量组 A 的线性生成空间中
\]
于是根据\cref{theorem:向量组的秩.并集的秩}
可知\(\rank(A \cup B) > \rank A\)，
与假设矛盾，
因此\[
	\rank A = \rank(A \cup B)
	\implies
	\text{\(B\)可由\(A\)线性表出}.
\]
同理\[
	\rank B = \rank(A \cup B)
	\implies
	\text{\(A\)可由\(B\)线性表出}.
\]
综上所述\[
	\rank A = \rank(A \cup B) = \rank B
	\implies
	A \cong B.
	\qedhere
\]
\end{proof}
\end{proposition}

\begin{example}\label{example:向量空间.若部分组向量个数多于全组的秩则部分组必线性相关}
证明：在秩为\(r\)的向量组中，任意\(r+1\)个向量必线性相关.
\begin{proof}
设向量组\(\AutoTuple{\a}{s}\)的秩为\(r\).
假设部分组\(\AutoTuple{\a}{r+1}\)线性无关，
那么由\cref{theorem:向量空间.秩与线性相关性的关系} 得\[
	\rank\{\AutoTuple{\a}{r+1}\} = r+1.
\]
因为\hyperref[theorem:向量空间.向量组的秩的比较2]{部分组的秩总是小于或等于全组的秩}，
而这与\[
	r+1 = \rank\{\AutoTuple{\a}{r+1}\} \leq \rank\{\AutoTuple{\a}{s}\} = r,
\]矛盾，
所以部分组\(\AutoTuple{\a}{r+1}\)一定线性相关.
\end{proof}
\end{example}

\begin{example}
设向量组\(\AutoTuple{\a}{s}\)的秩为\(r\).
如果\(\AutoTuple{\a}{r}\)线性无关，证明：
\(\AutoTuple{\a}{r}\)
是\(\AutoTuple{\a}{s}\)的一个极大线性无关组.
\begin{proof}
设\[
	A=\{\AutoTuple{\a}{s}\},
	\qquad
	B=\{\AutoTuple{\a}{r}\}.
\]
要证\(B\)是\(A\)的一个极大线性无关组，
须证\(A\)的任意向量可由\(B\)线性表出.

\begin{enumerate}
	\item 显然地，\(\a_i\ (i=1,2,\dotsc,r)\)可由\(B\)线性表出.

	\item 根据上例，在秩为\(r\)的向量组中，
	任意\(r+1\)个向量必线性相关，
	那么向量组\[
		A_i = \{\AutoTuple{\a}{r},\a_i\}\quad(i=r+1,\dotsc,s)
	\]必线性相关.

	又因为\(B\)线性无关，
	所以\(\a_i\ (i=r+1,\dotsc,s)\)可由\(B\)线性表出.
\end{enumerate}

综上所述，\(A\)的任意向量可由\(B\)线性表出，且\(B\)线性无关，
根据极大线性无关组的定义，\(B\)是\(A\)的一个极大线性无关组.
\end{proof}
\end{example}

\begin{example}
向量组\(\AutoTuple{\a}{r+1}\)与部分组\(\AutoTuple{\a}{r}\)的秩相等.
证明：\(\a_{r+1}\)可由\(\AutoTuple{\a}{r}\)线性表出.
\begin{proof}
记\(A=\{\AutoTuple{\a}{r+1}\}\)，
\(B=\{\AutoTuple{\a}{r}\}\).
设\(B\)的极大线性无关组为\[
	B'=\{\AutoTuple{\a}{t}\},
	\quad 0 \leq t \leq r.
\]
由题意有\(\rank A = \rank B = \rank B' = \card B' = t\).

由上例可知，因为\(\rank A = t\)，\(B'\)线性无关，
所以\(B'\)是\(A\)的一个极大线性无关组.
那么向量组\(A\)中的向量\(\a_{r+1}\)可以由极大线性无关组\(B'\)线性表出.
又由于\(B'\)是\(B\)的部分组，故\(B'\)可由\(B\)线性表出.
总而言之，\(A\)可由\(B\)线性表出.
\end{proof}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV19N4y1b7aS/
设向量组\(A = \{\AutoTuple{\vb\alpha}{r}\}\)线性无关，
且可以由向量组\(B = \{\AutoTuple{\vb\beta}{s}\}\ (s>r)\)线性表出.
证明：存在\(\vb\beta \in B\)，
使得\begin{equation*}
	\rank(\vb\beta,\AutoTuple{\vb\alpha}[2]{r}) = r.
\end{equation*}
%TODO proof
\end{example}

\subsection{极大线性无关组的求解}
\begin{theorem}\label{theorem:向量空间.利用初等行变换求取列极大线性无关组的依据}
%@see: 《线性代数》（张慎语、周厚隆） P75 定理4
设矩阵\[
	\A=(\AutoTuple{\a}{m})
\]
经一系列初等行变换化为矩阵\[
	\B=(\AutoTuple{\b}{m}),
\]
则\(\a_{j1},\a_{j2},\dotsc,\a_{jk}\)为\(\A\)的列极大线性无关组的充分必要条件是：
\(\b_{j1},\b_{j2},\dotsc,\b_{jk}\)为\(\B\)的列极大线性无关组.
\begin{proof}
假设矩阵\(\wA=(\a_{j1},\a_{j2},\dotsc,\a_{jk},\a_l)\)经相同的初等行变换化为\[
	\wB=(\b_{j1},\b_{j2},\dotsc,\b_{jk},\b_l) \quad(l=1,2,\dotsc,m).
\]
考虑以下四个向量形式的线性方程组
\begin{gather}
	x_1 \a_{j1} + x_2 \a_{j2} + \dotsb + x_k \a_{jk} = \z, \tag1 \\
	x_1 \b_{j1} + x_2 \b_{j2} + \dotsb + x_k \b_{jk} = \z, \tag2 \\
	y_1 \a_{j1} + y_2 \a_{j2} + \dotsb + y_k \a_{jk} = \a_l, \tag3 \\
	y_1 \b_{j1} + y_2 \b_{j2} + \dotsb + y_k \b_{jk} = \b_l, \tag4
\end{gather}
其中(1)与(2)同解，(3)与(4)同解.

必要性.
当\(\a_{j1},\a_{j2},\dotsc,\a_{jk}\)是\(\A\)的列极大线性无关组时，
(1)仅有零解，(3)有解.于是(2)仅有零解，(4)有解，
从而\(\b_{j1},\b_{j2},\dotsc,\b_{jk}\)线性无关，
\(\b_l\ (l=1,2,\dotsc,m)\)可由其线性表出；
由极大线性无关组定义，
\(\b_{j1},\b_{j2},\dotsc,\b_{jk}\)是\(\B\)的列极大线性无关组.

同理可证充分性.
\end{proof}
\end{theorem}

\cref{theorem:向量空间.利用初等行变换求取列极大线性无关组的依据} 告诉我们，
要想求出一组向量\(\AutoTuple{\a}{s}\)的极大线性无关组，
可以构造矩阵\(\A=(\AutoTuple{\a}{s})\)，
再利用高斯消元法得到阶梯形矩阵\(\B\)，
找出\(\B\)的非零首元所在的列\(\b_{j1},\b_{j2},\dotsc,\b_{jk}\)，
回过头找出\(\A\)中对应的列\(\a_{j1},\a_{j2},\dotsc,\a_{jk}\)，
那么\(\a_{j1},\a_{j2},\dotsc,\a_{jk}\)就是\(\AutoTuple{\a}{s}\)的极大线性无关组.
%@see: https://math.stackexchange.com/a/164021/591741

\begin{example}
求列向量组\[
	\a_1 = \begin{bmatrix} -1 \\ 1 \\ 0 \\ 0 \end{bmatrix},
	\a_2 = \begin{bmatrix} -1 \\ 2 \\ -1 \\ 1 \end{bmatrix},
	\a_3 = \begin{bmatrix} 0 \\ -1 \\ 1 \\ -1 \end{bmatrix},
	\a_4 = \begin{bmatrix} 1 \\ -1 \\ 2 \\ 3 \end{bmatrix},
	\a_5 = \begin{bmatrix} 2 \\ -6 \\ 4 \\ 1 \end{bmatrix}
\]的秩与一个极大线性无关组.
\begin{solution}
对矩阵\(\A = (\AutoTuple{\a}{5})\)作初等行变换化为阶梯形矩阵：
\begin{align*}
	\A &= \begin{bmatrix}
		-1 & -1 & 0 & 1 & 2 \\
		1 & 2 & -1 & -3 & -6 \\
		0 & -1 & 1 & 2 & 4 \\
		0 & 1 & -1 & 3 & 1 \\
	\end{bmatrix}
	\xlongrightarrow{\begin{array}{c}
		(2\text{行}) \addeq 1 \times (1\text{行}) \\
		(4\text{行}) \addeq (3\text{行})
	\end{array}}
	\begin{bmatrix}
		-1 & -1 & 0 & 1 & 2 \\
		0 & 1 & -1 & -2 & -4 \\
		0 & -1 & 1 & 2 & 4 \\
		0 & 0 & 0 & 5 & 5 \\
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c}
		(3\text{行}) \addeq (2\text{行}) \\
		(4\text{行}) \diveq 5
	\end{array}}
	\begin{bmatrix}
		-1 & -1 & 0 & 1 & 2 \\
		0 & 1 & -1 & -2 & -4 \\
		0 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 1 & 1 \\
	\end{bmatrix} \\
	&\xlongrightarrow{\begin{array}{c} \text{交换(3行)与(4行)} \end{array}}
	\begin{bmatrix}
		-1 & -1 & 0 & 1 & 2 \\
		0 & 1 & -1 & -2 & -4 \\
		0 & 0 & 0 & 1 & 1 \\
		0 & 0 & 0 & 0 & 0 \\
	\end{bmatrix}
	= \B.
\end{align*}
若按列分块有\(\B = (\AutoTuple{\b}{5})\).
阶梯形矩阵\(\B\)有3行不为零，故\[
	\rank\{\AutoTuple{\a}{5}\}=3.
\]
又因为\(\B\)的非零首元分别位于1、2、4列，
则\(\b_1,\b_2,\b_4\)是\(\B\)的一个列极大线性无关组，
相应地，\(\a_1,\a_2,\a_4\)是\(\A\)的一个列极大线性无关组，
即\(\{\AutoTuple{\a}{5}\}\)的极大线性无关组.
\end{solution}
\end{example}
