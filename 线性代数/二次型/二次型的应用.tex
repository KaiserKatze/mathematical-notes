\section{二次型的应用}
下面利用矩阵的运算及二次型理论讨论平面二次曲线、空间二次曲面的分类问题.

\subsection{平面二次曲线的分类问题}
首先考虑一般的二次曲线的方程：\begin{equation}\label{equation:二次型的应用.平面二次曲线的一般方程}
%@see: 《线性代数》（张慎语、周厚隆） P139 (1)
	a_{11} x_1^2
	+ 2 a_{12} x_1 x_2
	+ a_{22} x_2^2
	+ 2 b_1 x_1
	+ 2 b_2 x_2
	+ c
	= 0.
\end{equation}
设\begin{equation*}
	\vb{X}
	\defeq \begin{bmatrix}
		x_1 \\ x_2
	\end{bmatrix},
	\qquad
	\vb{A}
	\defeq \begin{bmatrix}
		a_{11} & a_{12} \\
		a_{12} & a_{22}
	\end{bmatrix},
	\qquad
	\vb{b}
	\defeq \begin{bmatrix}
		b_1 \\ b_2
	\end{bmatrix},
\end{equation*}
于是\cref{equation:二次型的应用.平面二次曲线的一般方程} 可以写成\begin{equation*}
	\vb{X}^T \vb{A} \vb{X}
	+ \vb{b}^T \vb{X}
	+ c
	= 0,
\end{equation*}
或\begin{equation}\label{equation:二次型的应用.平面二次曲线的一般方程.矩阵形式}
%@see: 《线性代数》（张慎语、周厚隆） P139 (2)
	\begin{bmatrix}
		\vb{X}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}
	= 0.
\end{equation}
记\begin{equation*}
	f(\vb{X})
	\defeq
	\begin{bmatrix}
		\vb{X}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}.
\end{equation*}
于是\(\vb{X}^T \vb{A} \vb{X}\)
可以经过正交变换\(\vb{X} = \vb{Q} \vb{Y}\)化为标准型：\begin{equation*}
	\lambda_1 y_1^2 + \lambda_2 y_2^2,
\end{equation*}
其中\(\vb{Q}\)是二阶正交矩阵，
\(\lambda_1,\lambda_2\)是\(\vb{A}\)的两个特征值.
将\(\vb{X} = \vb{Q} \vb{Y}\)
代入\cref{equation:二次型的应用.平面二次曲线的一般方程.矩阵形式} 便得\begin{align*}
	f(\vb{X})
	&\xlongequal{\vb{X} = \vb{Q} \vb{Y}}
	\begin{bmatrix}
		\vb{Y}^T \vb{Q}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{Q} \vb{Y} \\ 1
	\end{bmatrix} \\
	&= \lambda_1 y_1^2 + \lambda_2 y_2^2 + d_1 y_1 + d_2 y_2 + c,
\end{align*}
这里\(\lambda_1,\lambda_2\)不全为零.
对上式非零的平方项与相应的一次项进行配方，
再作平移变换\(\vb{Y} = \vb{Z} + \vb{X}_0\)，
其中\(\vb{Z} = \begin{bmatrix}
	z_1 \\ z_2
\end{bmatrix},
\vb{X}_0 = \begin{bmatrix}
	x'_1 \\ x'_2
\end{bmatrix}\)，
便可化简得\begin{equation*}
	f(\vb{X})
	= \lambda_1 z_1^2 + \lambda_2 z_2^2 + d,
	\quad\text{或}\quad
	f(\vb{X})
	= \lambda_1 z_1^2 + q z_2.
\end{equation*}
同时\begin{equation*}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{Q} (\vb{Z} + \vb{X}_0) \\ 1
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{Q} & \vb\delta \\
		\vb0 & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{Z} \\ 1
	\end{bmatrix},
\end{equation*}
其中\(\vb\delta = \vb{Q} \vb{X}_0 \in M_{2\times1}(\mathbb{R})\).
\cref{equation:二次型的应用.平面二次曲线的一般方程.矩阵形式}
化为\begin{equation}\label{equation:二次型的应用.平面二次曲线的一般方程.矩阵标准形式}
%@see: 《线性代数》（张慎语、周厚隆） P140 (3)
	\begin{bmatrix}
		\vb{Z}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A}_1 & \vb{b}_1 \\
		\vb{b}_1^T & c_1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{Z} \\ 1
	\end{bmatrix}
	= 0,
\end{equation}
其中\begin{equation*}
	\begin{bmatrix}
		\vb{A}_1 & \vb{b}_1 \\
		\vb{b}_1^T & c_1
	\end{bmatrix}
	= \begin{bmatrix}
		\vb{Q} & \vb0^T \\
		\vb\delta^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{Q} & \vb\delta \\
		\vb0 & 1
	\end{bmatrix},
	\qquad
	\vb{A}_1
	= \vb{Q}^T \vb{A} \vb{Q}
	= \diag(\lambda_1,\lambda_2).
\end{equation*}

\begin{lemma}
%@see: 《线性代数》（张慎语、周厚隆） P140 引理2
经过正交变换\(\vb{X} = \vb{Q} \vb{Y}\)与平移\(\vb{Y} = \vb{Z} + \vb{X}_0\)，
平面上任意两点的距离保持不变.
\begin{proof}
设\(\vb{X}_1,\vb{X}_2\)是平面上任意两点，
则它们的距离为\[
	d(\vb{X}_1,\vb{X}_2)
	= \sqrt{(\vb{X}_1-\vb{X}_2)^T(\vb{X}_1-\vb{X}_2)}.
\]
经过正交变换和平移，得到新的两点为\[
	\vb{Z}_1 = \vb{Q}^T \vb{X}_1 - \vb{X}_0,
	\qquad
	\vb{Z}_2 = \vb{Q}^T \vb{X}_2 - \vb{X}_0.
\]
于是\begin{align*}
	d(\vb{Z}_1,\vb{Z}_2)
	&= \sqrt{(\vb{Z}_1-\vb{Z}_2)^T(\vb{Z}_1-\vb{Z}_2)} \\
	&= \sqrt{
		((\vb{Q}^T \vb{X}_1 - \vb{X}_0) - (\vb{Q}^T \vb{X}_2 - \vb{X}_0))^T
		((\vb{Q}^T \vb{X}_1 - \vb{X}_0) - (\vb{Q}^T \vb{X}_2 - \vb{X}_0))
	} \\
	&= \sqrt{
		(\vb{Q}^T \vb{X}_1 - \vb{Q}^T \vb{X}_2)^T
		(\vb{Q}^T \vb{X}_1 - \vb{Q}^T \vb{X}_2)
	} \\
	&= \sqrt{
		(\vb{Q}^T (\vb{X}_1 - \vb{X}_2))^T
		(\vb{Q}^T (\vb{X}_1 - \vb{X}_2))
	} \\
	&= \sqrt{
		(\vb{X}_1 - \vb{X}_2)^T
		\vb{Q} \vb{Q}^T
		(\vb{X}_1 - \vb{X}_2)
	} \\
	&= \sqrt{
		(\vb{X}_1 - \vb{X}_2)^T
		(\vb{X}_1 - \vb{X}_2)
	}
	= d(\vb{X}_1,\vb{X}_2).
	\qedhere
\end{align*}
\end{proof}
\end{lemma}

\begin{theorem}[平面二次曲线的分类定理]
%@see: 《线性代数》（张慎语、周厚隆） P140 定理8
设\(\vb{X} = \begin{bmatrix}
	x_1 \\ x_2
\end{bmatrix},
\vb{A} = \begin{bmatrix}
	a_{11} & a_{12} \\
	a_{12} & a_{22}
\end{bmatrix},
\vb{b} = \begin{bmatrix}
	b_1 \\ b_2
\end{bmatrix}\)，
则二次曲线\[
	\begin{bmatrix}
		\vb{X}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}
	= 0
\]可以经过正交变换、平移变换化为\[
	\lambda_1 z_1^2 + \lambda_2 z_2^2 + d = 0,
	\quad\text{或}\quad
	\lambda_1 z_1^2 + q z_2 = 0.
\]
%TODO proof 教材省略了证明过程，只提示应该讨论\(\vb{A}\)、\((\vb{A},\vb{b})\)和\(\begin{bmatrix} \vb{A} & \vb{b} \\ \vb{b}^T & c \end{bmatrix}\)这三个矩阵的秩.
\end{theorem}

\subsection{空间二次曲面的分类问题}
首先考虑一般的二次曲面的方程：\begin{equation}\label{equation:二次型的应用.空间二次曲面的一般方程}
	a_{11} x_1^2
	+ a_{22} x_2^2
	+ a_{33} x_3^2
	+ 2 a_{12} x_1 x_2
	+ 2 a_{13} x_1 x_3
	+ 2 a_{23} x_2 x_3
	+ 2 b_1 x_1
	+ 2 b_2 x_2
	+ 2 b_3 x_3
	+ c
	= 0.
\end{equation}
设\begin{equation*}
	\vb{X} = \begin{bmatrix}
		x_1 \\ x_2 \\ x_3
	\end{bmatrix},
	\qquad
	\vb{A} = \begin{bmatrix}
		a_{11} & a_{12} & a_{13} \\
		a_{12} & a_{22} & a_{23} \\
		a_{13} & a_{23} & a_{33}
	\end{bmatrix},
	\qquad
	\vb{b} = \begin{bmatrix}
		b_1 \\ b_2 \\ b_3
	\end{bmatrix},
\end{equation*}
于是\cref{equation:二次型的应用.空间二次曲面的一般方程} 可以写成\begin{equation*}
	\vb{X}^T \vb{A} \vb{X}
	+ \vb{b}^T \vb{X}
	+ c
	= 0,
\end{equation*}
或\begin{equation}\label{equation:二次型的应用.空间二次曲面的一般方程.矩阵形式}
	\begin{bmatrix}
		\vb{X}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}
	= 0.
\end{equation}

\begin{theorem}[空间二次曲面的分类定理]
%@see: 《线性代数》（张慎语、周厚隆） P141 定理9
设\(\vb{X} = \begin{bmatrix}
	x_1 \\ x_2 \\ x_3
\end{bmatrix},
\vb{A} = \begin{bmatrix}
	a_{11} & a_{12} & a_{13} \\
	a_{12} & a_{22} & a_{23} \\
	a_{13} & a_{23} & a_{33}
\end{bmatrix},
\vb{b} = \begin{bmatrix}
	b_1 \\ b_2 \\ b_3
\end{bmatrix}\)，
则二次曲面\[
	\begin{bmatrix}
		\vb{X}^T & 1
	\end{bmatrix}
	\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	\begin{bmatrix}
		\vb{X} \\ 1
	\end{bmatrix}
	= 0
\]可以经过正交变换、平移变换化为\[
	\lambda_1 z_1^2 + \lambda_2 z_2^2 + \lambda_3 z_3^2 + d = 0,
	\qquad
	\lambda_1 z_1^2 + \lambda_2 z_2^2 + p z_3 = 0,
	\quad\text{或}\quad
	\lambda_1 z_1^2 + q z_2 + r z_3 = 0.
\]
%TODO proof
%@Mathematica: X = {{x1}, {x2}, {x3}}
%@Mathematica: A = {{a11, a12, a13}, {a12, a22, a23}, {a13, a23, a33}}
%@Mathematica: B = {{b1}, {b2}, {b3}}
%@Mathematica: Xstar = Join[X, {{1}}, 1]
%@Mathematica: Astar = Join[Join[A, B, 2], Join[Transpose[B], {{c}}, 2]]
%@Mathematica: Transpose[Xstar].Astar.Xstar // Expand
\end{theorem}

记\[
	\rho_3 \defeq \rank\vb{A},
	\qquad
	\rho_4 \defeq \rank\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}.
\]
那么我们可以依据
秩\(\rho_3,\rho_4\)以及正惯性指数\(p\)和负惯性指数\(q\)，
对空间二次曲面进行分类，
大致如\cref{figure:二次型的应用.空间二次曲面的分类} 所示.

\begin{table}[htb]
%@see: https://mathworld.wolfram.com/QuadraticSurface.html
	\centering
	\begin{tblr}{*5{c|}c}
		\hline
		曲面 & 标准方程 & \(\rho_3\) & \(\rho_4\) & \(p\) & \(q\) \\
		\hline
		% 椭球面
		\begin{tblr}{c}
			椭球面 \\
			ellipsoid
		\end{tblr}
		& \(\frac{x^2}{a^2}+\frac{y^2}{b^2}+\frac{z^2}{c^2}=1\)
		& 3 & 4
		& 3 & 0
		\\
		% 双曲面
		\begin{tblr}{c}
			单叶双曲面 \\
			hyperboloid of one sheet
		\end{tblr}
		& \(\frac{x^2}{a^2}+\frac{y^2}{b^2}-\frac{z^2}{c^2}=1\)
		& 3 & 4
		& 2 & 1
		\\
		\begin{tblr}{c}
			双叶双曲面 \\
			hyperboloid of two sheets
		\end{tblr}
		& \(\frac{x^2}{a^2}+\frac{y^2}{b^2}-\frac{z^2}{c^2}=-1\)
		& 3 & 4
		& 1 & 2
		\\
		% 抛物面
		\begin{tblr}{c}
			椭圆抛物面 \\
			elliptic paraboloid
		\end{tblr}
		& \(\frac{x^2}{p}+\frac{y^2}{q}=2z\)
		& 2 & 4
		& 2 & 0
		\\
		\begin{tblr}{c}
			双曲抛物面 \\
			hyperbolic paraboloid
		\end{tblr}
		& \(\frac{x^2}{p}-\frac{y^2}{q}=2z\)
		& 2 & 4
		& 1 & 1
		\\
		% 二次锥面
		\begin{tblr}{c}
			椭圆锥面 \\
			elliptic cone
		\end{tblr}
		& \(\frac{x^2}{a^2}+\frac{y^2}{b^2}-\frac{z^2}{c^2}=0\)
		& 3 & 3
		& 2 & 1
		\\
		% 二次柱面
		\begin{tblr}{c}
			椭圆柱面 \\
			elliptic cylinder
		\end{tblr}
		& \(\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\)
		& 2 & 4
		& 2 & 0
		\\
		\begin{tblr}{c}
			双曲柱面 \\
			hyperbolic cylinder
		\end{tblr}
		& \(\frac{x^2}{a^2}-\frac{y^2}{b^2}=1\)
		& 2 & 3
		& 1 & 1
		\\
		\begin{tblr}{c}
			抛物柱面 \\
			parabolic cylinder
		\end{tblr}
		& \(x^2=2py\)
		& 1 & 3
		& 1 & 0
		\\
		\hline
	\end{tblr}
	\caption{}
	\label{figure:二次型的应用.空间二次曲面的分类}
\end{table}

\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》一选择题/第6题
设二次型\(f(x_1,x_2,x_3) = x_1^2 + x_2^2 + x_3^2 + 4 x_1 x_2 + 4 x_1 x_3 + 4 x_2 x_3\).
试判定\(f(x_1,x_2,x_3) = 2\)在空间直角坐标下表示的二次曲面的类型.
\begin{solution}
二次型的矩阵为\[
	\A = \begin{bmatrix}
		1 & 2 & 2 \\
		2 & 1 & 2 \\
		2 & 2 & 1
	\end{bmatrix}.
\]
它的特征多项式为\begin{align*}
	\abs{\lambda\E-\A}
	&= \begin{vmatrix}
		\lambda-1 & -2 & -2 \\
		-2 & \lambda-1 & -2 \\
		-2 & -2 & \lambda-1
	\end{vmatrix}
	= \begin{vmatrix}
		\lambda-5 & -2 & -2 \\
		\lambda-5 & \lambda-1 & -2 \\
		\lambda-5 & -2 & \lambda-1
	\end{vmatrix}
	= (\lambda-5)
	\begin{bmatrix}
		1 & -2 & -2 \\
		1 & \lambda-1 & -2 \\
		1 & -2 & \lambda-1
	\end{bmatrix} \\
	&= (\lambda-5)
	\begin{vmatrix}
		1 & 0 & 0 \\
		1 & \lambda+1 & 0 \\
		1 & 0 & \lambda+1
	\end{vmatrix}
	= (\lambda-5)(\lambda+1)^2.
\end{align*}
它的特征值就是\(\lambda=5\)和\(\lambda=-1\ (\text{二重})\).
二次型的正惯性指数和负惯性指数分别是\(p=1,q=2\)，
查表可知%\cref{figure:二次型的应用.空间二次曲面的分类}
\(f(x_1,x_2,x_3) = 2\)在空间直角坐标下表示的二次曲面
是一个双叶双曲面.
\end{solution}
\end{example}

\begin{example}
将曲面方程\(3x^2+3y^2+5z^2+2xy-2yz-2xz+2x+10y+6z+7=0\)化简为标准型，
说明该方程描绘的是哪一类图形.
\begin{solution}
令\begin{equation*}
	\vb{A} \defeq \begin{bmatrix}
		3 & 1 & -1 \\
		1 & 3 & -1 \\
		-1 & -1 & 5
	\end{bmatrix},
	\qquad
	\vb{b} \defeq \begin{bmatrix}
		1 \\ 5 \\ 3
	\end{bmatrix},
	\qquad
	c \defeq 7,
\end{equation*}
则\begin{equation*}
	\rho_3
	= \rank\vb{A}
	= 3,
	\qquad
	\rho_4
	= \rank\begin{bmatrix}
		\vb{A} & \vb{b} \\
		\vb{b}^T & c
	\end{bmatrix}
	= 4,
\end{equation*}
而\(\vb{A}\)的正负惯性指数分别为\(3\)和\(0\)，
查\cref{figure:二次型的应用.空间二次曲面的分类} 可知，
该方程描绘的是椭球面.
\end{solution}
%@Mathematica: F[x_, y_, z_] := 3 x^2 + 3 y^2 + 5 z^2 + 2 x y - 2 y z - 2 x z + 2 x + 10 y + 6 z + 7
%@Mathematica: GetArgumentCount[func_Symbol] :=  									(* 获取函数的自变量个数 *)
%				Module[{downValues, args}, downValues = DownValues[func];
%				If[downValues === {}, Return[0]];
%				args = Cases[downValues[[1, 1]],
%					Verbatim[Pattern][name_, _] :> name, Infinity];
%				Length[args]];
%@Mathematica: GenerateSubscriptedSequence[start_, stop_] :=						(* 生成一串带有下标的代数符号 *)
%				Module[{n, symbols}, n = stop - start + 1;
%				symbols = Table[Subscript[x, i], {i, start, stop}];
%				Return[symbols]]
%@Mathematica: QuadraticFormMatrix[f_] :=											(* 从函数中获取二次项系数，返回对称矩阵 *)
%				Module[{vars = GenerateSubscriptedSequence[1, GetArgumentCount[f]],
%				coeffs}, coeffs = Normal@CoefficientArrays[f @@ vars, vars][[3]];
%				(coeffs + Transpose[coeffs])/2]
\end{example}
