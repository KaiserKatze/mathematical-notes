\section{矩阵的合同}
\subsection{矩阵合同的概念}
\begin{definition}
%@see: 《线性代数》（张慎语、周厚隆） P118 定义2
%@see: 《高等代数（第三版 上册）》（丘维声） P193 定义3
设\(\vb{A}\)和\(\vb{B}\)是数域\(K\)上的两个\(n\)阶矩阵.
若存在数域\(K\)上的一个可逆矩阵\(\vb{C}\)，
使得\begin{equation*}
	\vb{B}=\vb{C}^T\vb{A}\vb{C},
\end{equation*}
则称“\(\vb{A}\)与\(\vb{B}\)~\DefineConcept{合同}（congruent）”
“\(\vb{B}\)是\(\vb{A}\)的\DefineConcept{合同矩阵}”，
记为\(\vb{A}\simeq\vb{B}\).
\end{definition}

\subsection{矩阵合同的性质}
\begin{property}
设\(\vb{A},\vb{B}\)是数域\(K\)上的两个\(n\)阶矩阵.
如果\(\vb{A}\)与\(\vb{B}\)合同，
则\(\vb{A}\)与\(\vb{B}\)等价.
\end{property}

\begin{property}
%@see: 《线性代数》（张慎语、周厚隆） P119 习题6.1 2(2)选项(A)
合同矩阵有相同的秩.
\begin{proof}
由\cref{theorem:矩阵乘积的秩.与可逆矩阵相乘不变秩} 可得.
\end{proof}
\end{property}

\begin{proposition}\label{theorem:矩阵合同.合同矩阵的行列式的关系}
设数域\(K\)上的\(n\)阶矩阵\(\vb{A},\vb{B}\)
和数域\(K\)上的\(n\)阶可逆矩阵\(\vb{C}\)
满足\(\vb{B} = \vb{C}^T \vb{A} \vb{C}\)，
则\begin{equation*}
	\abs{\vb{A}} \abs{\vb{C}}^2
	= \abs{\vb{B}}.
\end{equation*}
\begin{proof}
根据\cref{theorem:行列式.性质1,theorem:行列式.矩阵乘积的行列式}，
必有\begin{equation*}
	\abs{\vb{B}}
	= \abs{\vb{C}^T \vb{A} \vb{C}}
	= \abs{\vb{C}^T} \abs{\vb{A}} \abs{\vb{C}}
	= \abs{\vb{A}} \abs{\vb{C}}^2.
	\qedhere
\end{equation*}
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《线性代数》（张慎语、周厚隆） P119 习题6.1 2(2)选项(B)
合同矩阵的行列式同号.
\begin{proof}
设\(\vb{A},\vb{B} \in M_n(K)\).
假设\(\vb{A}\simeq\vb{B}\)，
那么存在数域\(K\)上\(n\)阶可逆矩阵\(\vb{C}\)，
使得\begin{equation*}
	\vb{C}^T \vb{A} \vb{C} = \vb{B}.
\end{equation*}
由\cref{theorem:矩阵合同.合同矩阵的行列式的关系} 有\begin{equation*}
	\abs{\vb{A}} \abs{\vb{B}}
	= \abs{\vb{A}} (\abs{\vb{A}} \abs{\vb{C}}^2)
	= \abs{\vb{A}}^2 \abs{\vb{C}}^2
	\geq 0.
	\qedhere
\end{equation*}
\end{proof}
\end{proposition}

\subsection{相似与合同的联系}
\begin{proposition}
相似的两个矩阵不一定合同.
\begin{proof}
例如，矩阵\(\vb{A}=\begin{bmatrix}
	1 & 1 \\
	0 & 2
\end{bmatrix}\)
和\(\vb{B}=\begin{bmatrix}
	0 & -1 \\
	2 & 3
\end{bmatrix}\)相似，
这是因为可逆矩阵\(\vb{P}=\begin{bmatrix}
	1 & 0 \\
	-1 & -1
\end{bmatrix}\)满足\(\vb{P}^{-1}\vb{A}\vb{P}=\vb{B}\).
%@Mathematica: Inverse[{{1, 0}, {-1, -1}}].{{1, 1}, {0, 2}}.{{1, 0}, {-1, -1}}
现在假设存在矩阵\(\vb{Q}=\begin{bmatrix}
	a & b \\
	c & d
\end{bmatrix}\)使得\(\vb{Q}^T\vb{A}\vb{Q}=\vb{B}\).
那么有\begin{equation*}
	\vb{Q}^T\vb{A}\vb{Q}-\vb{B}
	=\begin{bmatrix}
		a^2+ac+2c^2 & 1+ab+ad+2cd \\
		-2+ab+bc+2cd & -3+b^2+bd+2d^2
	\end{bmatrix}
	=\vb0,
\end{equation*}
%@Mathematica: Expand[{{a, c}, {b, d}}.{{1, 1}, {0, 2}}.{{a, b}, {c, d}} - {{0, -1}, {2, 3}}]
得到关于\(a,b,c,d\)的方程组
\begin{align*}
	\left\{ \begin{array}{l}
		a^2+ac+2c^2 = 0, \\
		1+ab+ad+2cd = 0, \\
		-2+ab+bc+2cd = 0, \\
		-3+b^2+bd+2d^2 = 0,
	\end{array} \right.
	\tag*{$\begin{matrix}(1)\\(2)\\(3)\\(4)\end{matrix}$}
\end{align*}
(2)式减去(3)式得\begin{equation*}
	3+ad-bc=0,
\end{equation*}
这就是说\(\abs{\vb{Q}}=-3\).
但是根据\cref{theorem:矩阵合同.合同矩阵的行列式的关系}，
因为\(\abs{\vb{A}}=\abs{\vb{B}}=2\)，所以\(\abs{\vb{Q}}^2=1\).
矛盾！因此\(\vb{A}\)与\(\vb{B}\)不合同！
\end{proof}
\end{proposition}

\begin{proposition}\label{example:矩阵合同.合同矩阵不一定相似}
合同的两个矩阵不一定相似.
\begin{proof}
例如，矩阵\(\vb{A}=\begin{bmatrix}
	1 & 0 \\
	0 & 1
\end{bmatrix}\)与\(\vb{B}=\begin{bmatrix}
	4 & 0 \\
	0 & 1
\end{bmatrix}\)合同，
这是因为可逆矩阵\(\vb{Q}=\begin{bmatrix}
	2 & 0 \\
	0 & 1
\end{bmatrix}\)满足\(\vb{Q}^T\vb{A}\vb{Q}=\vb{B}\).
%@Mathematica: {{2, 0}, {0, 1}}.{{1, 0}, {0, 1}}.{{2, 0}, {0, 1}}
但是\(\tr\vb{A}=2 \neq \tr\vb{B} = 5\)，
根据\hyperref[theorem:特征值与特征向量.相似矩阵的迹的不变性]{相似矩阵的迹的不变性}，
\(\vb{A}\)与\(\vb{B}\)必不相似！
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:二次型.实对称矩阵相似必合同}
设\(\vb{A},\vb{B}\)都是实对称矩阵，
则“\(\vb{A}\)与\(\vb{B}\)相似”是“\(\vb{A}\)与\(\vb{B}\)合同”的充分不必要条件.
\begin{proof}
因为\(\vb{A}\)、\(\vb{B}\)都是实对称矩阵，
\(\vb{A}^T=\vb{A}\)，
\(\vb{B}^T=\vb{B}\)，
且存在正交矩阵\(\vb{Q}_1,\vb{Q}_2\)使得\begin{equation*}
	\vb{Q}_1^{-1} \vb{A} \vb{Q}_1 = \vb{Q}_1^T \vb{A} \vb{Q}_1 = \vb{\Lambda}_1,
	\qquad
	\vb{Q}_2^{-1} \vb{B} \vb{Q}_2 = \vb{Q}_2^T \vb{B} \vb{Q}_2 = \vb{\Lambda}_2,
\end{equation*}
其中\(\vb{\Lambda}_1,\vb{\Lambda}_2\)是对角阵.
又因为\(\vb{A}\sim\vb{B}\)，
所以\(\vb{A}\)与\(\vb{B}\)有相同的特征多项式、特征值，
即\(\vb{\Lambda}_1=\vb{\Lambda}_2\)，
或\begin{equation*}
	\vb{Q}_1^{-1} \vb{A} \vb{Q}_1 = \vb{Q}_2^{-1} \vb{B} \vb{Q}_2,
	\qquad
	(\vb{Q}_2 \vb{Q}_1^{-1}) \vb{A} (\vb{Q}_1 \vb{Q}_2^{-1}) = \vb{B}.
\end{equation*}
令\(\vb{P} = \vb{Q}_1 \vb{Q}_2^{-1}\)，
\(\vb{P}^T = (\vb{Q}_1 \vb{Q}_2^{-1})^T
= (\vb{Q}_2^{-1})^T \vb{Q}_1^T
= \vb{Q}_2 \vb{Q}_1^{-1}
= (\vb{Q}_1 \vb{Q}_2^{-1})^{-1}
= \vb{P}^{-1}\)，
那么\begin{equation*}
	\vb{P}^T \vb{A} \vb{P} = \vb{B},
\end{equation*}
也就是说\(\vb{A}\)与\(\vb{B}\)合同.

再根据\cref{example:矩阵合同.合同矩阵不一定相似}，合同的两个实对称矩阵未必相似.
因此，对于实对称矩阵\(\vb{A},\vb{B}\)而言，
“\(\vb{A}\)与\(\vb{B}\)相似”是“\(\vb{A}\)与\(\vb{B}\)合同”的充分不必要条件.
\end{proof}
\end{proposition}

\begin{example}
设\(\AutoTuple{i}{n}\)是\(1,2,\dotsc,n\)的一个排列，
而\begin{equation*}
	\vb{A}=\diag(\AutoTuple{d}{n}),
	\qquad
	\vb{B}=\diag(d_{i_1},d_{i_2},\dotsc,d_{i_n}).
\end{equation*}
证明：矩阵\(\vb{A},\vb{B}\)合同且相似.
\begin{proof}
显然\(\diag(d_{i_1},d_{i_2},\dotsc,d_{i_n})\)
可由\(\diag(\AutoTuple{d}{n})\)同时左乘和右乘若干个初等矩阵\begin{equation*}
	\vb{P}(i,j) \quad(1 \leq i < j \leq n)
\end{equation*}得到，
又因为\(\vb{P}(i,j)^T = \vb{P}(i,j)^{-1} = \vb{P}(i,j)\)，
所以只要令这些初等矩阵的乘积为\(\vb{P}\)，
就有\begin{equation*}
	\vb{P}^{-1} \vb{A} \vb{P} = \vb{B},
	\qquad
	\vb{P}^T \vb{A} \vb{P} = \vb{B}.
\end{equation*}
也就是说\(\vb{A}\simeq\vb{B}\land\vb{A}\sim\vb{B}\).
\end{proof}
\end{example}

\subsection{合同类}
\begin{property}\label{theorem:矩阵合同.合同关系是等价关系}
%@see: 《线性代数》（张慎语、周厚隆） P118
%@see: 《高等代数（第三版 上册）》（丘维声） P193
矩阵的合同关系是等价关系，
即具备下列三条性质：\begin{itemize}
	\item {\rm\bf 反身性}：
	\(\vb{A}\simeq\vb{A}\)；
	\item {\rm\bf 对称性}：
	\(\vb{A}\simeq\vb{B} \implies \vb{B}\simeq\vb{A}\)；
	\item {\rm\bf 传递性}：
	\(\vb{A}\simeq\vb{B} \land \vb{B}\simeq\vb{C} \implies \vb{A}\simeq\vb{C}\).
\end{itemize}
\begin{proof}
合同是集合\(M_n(K)\)上的一个二元关系.

由于\begin{equation*}
	\vb{A} = \vb{E}^T \vb{A} \vb{E},
\end{equation*}
所以\(\vb{A} \simeq \vb{A}\).

假设\(\vb{A} \simeq \vb{B}\)，
那么存在可逆矩阵\(\vb{C}\)使得\begin{equation*}
	\vb{B}=\vb{C}^T\vb{A}\vb{C},
\end{equation*}
于是\begin{equation*}
	\vb{A}=(\vb{C}^T)^{-1}\vb{B}\vb{C}^{-1}
	=(\vb{C}^{-1})^T\vb{B}\vb{C}^{-1},
\end{equation*}
即\(\vb{B} \simeq \vb{A}\).

假设\(\vb{A} \simeq \vb{B}\)且\(\vb{B} \simeq \vb{C}\)，
那么存在可逆矩阵\(\vb{D}_1,\vb{D}_2\)
使得\begin{equation*}
	\vb{B} = \vb{D}_1^T \vb{A} \vb{D}_1, \qquad
	\vb{C} = \vb{D}_2^T \vb{B} \vb{D}_2,
\end{equation*}
从而有\begin{equation*}
	\vb{C} = \vb{D}_2^T (\vb{D}_1^T \vb{A} \vb{D}_1) \vb{D}_2
	= (\vb{D}_1 \vb{D}_2)^T \vb{A} (\vb{D}_1 \vb{D}_2),
\end{equation*}
因此\(\vb{A} \simeq \vb{C}\).
\end{proof}
\end{property}

\begin{definition}
%@see: 《高等代数（第三版 上册）》（丘维声） P193
把矩阵\(\vb{A} \in M_n(K)\)在合同关系下的等价类\begin{equation*}
	\Set{ \vb{B} \in M_n(K) \given \vb{A} \simeq \vb{B} }
\end{equation*}称为“矩阵\(\vb{A}\)的\DefineConcept{合同类}”.
\end{definition}

\begin{proposition}\label{theorem:对称矩阵.对称矩阵的合同类}
对称矩阵的合同矩阵也是对称的，
即\begin{equation*}
	\vb{A}^T = \vb{A}
	\implies
	[\vb{A}\simeq\vb{B} \implies \vb{B}^T = \vb{B}].
\end{equation*}
\begin{proof}
设可逆矩阵\(\vb{C}\)满足\(\vb{C}^T\vb{A}\vb{C}=\vb{B}\)，
那么\begin{equation*}
	\vb{B}^T = (\vb{C}^T\vb{A}\vb{C})^T = \vb{C}^T\vb{A}^T\vb{C} = \vb{C}^T\vb{A}\vb{C} = \vb{B}.
	\qedhere
\end{equation*}
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:反对称矩阵.反对称矩阵的合同类}
反对称矩阵的合同矩阵也是反对称的，
即\begin{equation*}
	\vb{A}^T = -\vb{A}
	\implies
	[\vb{A}\simeq\vb{B} \implies \vb{B}^T = -\vb{B}].
\end{equation*}
\begin{proof}
设可逆矩阵\(\vb{C}\)满足\(\vb{C}^T\vb{A}\vb{C}=\vb{B}\)，
那么\begin{equation*}
	\vb{B}^T = (\vb{C}^T\vb{A}\vb{C})^T = \vb{C}^T\vb{A}^T\vb{C} = -\vb{C}^T\vb{A}\vb{C} = -\vb{B}.
	\qedhere
\end{equation*}
\end{proof}
\end{proposition}

\begin{remark}
从\cref{theorem:对称矩阵.对称矩阵的合同类,theorem:反对称矩阵.反对称矩阵的合同类}
可以看出：对称矩阵不可能与反对称矩阵合同，它们都不可能与非对称矩阵合同.
\end{remark}

\begin{proposition}
设\(\vb{A},\vb{B} \in M_n(K)\).
记\begin{gather*}
	\vb{A}_1 = \frac12 (\vb{A}+\vb{A}^T), \qquad
	\vb{A}_2 = \frac12 (\vb{A}-\vb{A}^T), \\
	\vb{B}_1 = \frac12 (\vb{B}+\vb{B}^T), \qquad
	\vb{B}_2 = \frac12 (\vb{B}-\vb{B}^T),
\end{gather*}
其中\(\vb{A}^T,\vb{B}^T\)分别为\(\vb{A},\vb{B}\)的转置.
那么\begin{equation*}
	\vb{A} \simeq \vb{B} \implies \vb{A}_1 \simeq \vb{B}_1 \land \vb{A}_2 \simeq \vb{B}_2.
\end{equation*}
\begin{proof}
当\(\vb{A} \simeq \vb{B}\)时，
必存在可逆矩阵\(\vb{C}\)，使得\begin{equation*}
	\vb{B}
	=\vb{C}^T\vb{A}\vb{C};
	\eqno(1)
\end{equation*}
于是\begin{equation*}
	\vb{B}^T
	=(\vb{C}^T\vb{A}\vb{C})^T
	=\vb{C}^T\vb{A}^T\vb{C},
	\eqno(2)
\end{equation*}
也就是说\(\vb{B}^T \simeq \vb{A}^T\).
由(1)(2)两式不难得到\begin{equation*}
	\vb{B}\pm\vb{B}^T
	=\vb{C}^T(\vb{A}\pm\vb{A}^T)\vb{C},
\end{equation*}
于是\(\vb{A}_1\simeq\vb{B}_1,
\vb{A}_2\simeq\vb{B}_2\).
\end{proof}
\end{proposition}

\subsection{合同对角化}
\begin{definition}
%@see: 《高等代数（第三版 上册）》（丘维声） P194
设矩阵\(\vb{A} \in M_n(K)\).
如果存在\(n\)阶对角矩阵\(\vb\Lambda\)与\(\vb{A}\)合同，
则称“矩阵\(\vb{A}\)可以\DefineConcept{合同对角化}”
“矩阵\(\vb\Lambda\)是\(\vb{A}\)的\DefineConcept{合同标准型}”.
\end{definition}

\begin{definition}
%@credit: {cee35532-e299-4587-89a0-7b84e7454774} 提到的
设矩阵\(\vb{A} \in M_n(K)\).
如果存在\(n\)阶对角矩阵\(\vb\Lambda\)和\(n\)阶正交矩阵\(\vb{Q}\)，
使得\begin{equation*}
	\vb{Q}^T \vb{A} \vb{Q} = \vb\Lambda,
\end{equation*}
则称“矩阵\(\vb{A}\)可以\DefineConcept{正交对角化}”.
\end{definition}
\begin{remark}
可以看出，“正交对角化”是“合同对角化”的一种特殊情况.
当矩阵\(\vb{A}\)可以正交对角化时，
它与对应的对角矩阵\(\vb{B}\)既相似也合同.
\end{remark}

\begin{proposition}\label{theorem:实对称矩阵.实对称矩阵可以正交对角化}
%@credit: {cee35532-e299-4587-89a0-7b84e7454774} 提到的
实对称矩阵可以正交对角化.
\begin{proof}
由\cref{theorem:特征值与特征向量.实对称矩阵3} 立即可得.
\end{proof}
\end{proposition}
