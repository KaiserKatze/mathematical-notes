\section{二次型化为标准型的三种方法}
二次型的基本问题是研究如何通过非退化的线性替换将一个二次型化简为平方和的形式，从而讨论其性质.

\begin{definition}
%@see: 《线性代数》（张慎语、周厚隆） P120 定义3
如果二次型\(f(\AutoTuple{x}{n})=\vb{x}^T\vb{A}\vb{x}\)
可以经过非退化的线性替换\(\vb{x} = \vb{C} \vb{y}\)化简为\[
	d_1 y_1^2 + d_2 y_2^2 + \dotsb + d_n y_n^2
\]的形式，
则称上式为
“二次型\(f\)的\DefineConcept{标准型}”
或“二次型\(f\)的\DefineConcept{规范型}”.
\end{definition}
将二次型化为标准型的问题可以归结为对称矩阵合同于对角阵的问题.
下面介绍三种化二次型为标准型的方法.

\subsection{正交变换法}
根据\cref{theorem:特征值与特征向量.实对称矩阵3}，
对于任何一个实对称矩阵\(\vb{A}\)，
存在正交矩阵\(\vb{Q}\)，
使得\[
	\vb{Q}^{-1}\vb{A}\vb{Q} = \vb{Q}^T\vb{A}\vb{Q} = \diag(\AutoTuple{\lambda}{n}),
\]
即实对称矩阵\(\vb{A}\)与对角阵\(\diag(\AutoTuple{\lambda}{n})\)合同且相似.

\begin{theorem}
%@see: 《线性代数》（张慎语、周厚隆） P120 定理3
对于任一\(n\)元实二次型\(f(\AutoTuple{x}{n})=\vb{x}^T\vb{A}\vb{x}\ (\vb{A}=\vb{A}^T)\)，
都存在正交矩阵\(\vb{Q}\)，
由\(\vb{Q}\)构成的线性替换\(\vb{x}=\vb{Q}\vb{y}\)
（称为\DefineConcept{正交变换}，{\rm orthogonal operator}）
将\(f\)化为标准型\[
	f(\AutoTuple{x}{n})
	\xlongequal{\vb{x}=\vb{Q}\vb{y}}
	\lambda_1y_1^2+\lambda_2y_2^2+ \dotsb +\lambda_ny_n^2
\]
其中\(\lambda_1,\lambda_2,\dotsc,\lambda_n\)是\(\vb{A}\)的全部特征值.
\end{theorem}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P120
正交变换的特点之一是保持向量的内积不变，也就是保持向量的长度不变，保持图形的形状不变.
\begin{proof}
设\(\vb{Q}\)为正交矩阵.
令\(\vb{x}_1=\vb{Q}\vb{y}_1\)，
\(\vb{x}_2=\vb{Q}\vb{y}_2\)，
必有\begin{align*}
	\VectorInnerProductDot{\vb{x}_1}{\vb{x}_2}
	&=\VectorInnerProductDot{(\vb{Q}\vb{y}_1)}{(\vb{Q}\vb{y}_2)}
	=(\vb{Q}\vb{y}_1)^T (\vb{Q}\vb{y}_2)
	=\vb{y}_1^T \vb{Q}^T \vb{Q} \vb{y}_2 \\
	&=\vb{y}_1^T \vb{E} \vb{y}_2
	=\vb{y}_1^T \vb{y}_2
	=\VectorInnerProductDot{\vb{y}_1}{\vb{y}_2},
\end{align*}
又令\(\vb{x}_1=\vb{x}_2=\vb{x}\)，
\(\vb{y}_1=\vb{y}_2=\vb{y}\)，
则\(\abs{\vb{x}}^2=\abs{\vb{y}}^2\)，
\(\abs{\vb{x}}=\abs{\vb{y}}\).
\end{proof}
\end{corollary}

\begingroup
\color{red}
用正交变换法将二次型化为标准型的步骤如下：
\begin{enumerate}
	\item 首先根据\(f\)的表达式写出\(f\)的矩阵\(\vb{A}\)；
	\item 写出\(f\)矩阵的特征多项式\(\abs{\lambda\vb{E}-\vb{A}}=0\)，
	求解\(\vb{A}\)的特征值\(\AutoTuple{\lambda}{n}\)
	以及对应的特征向量\(\AutoTuple{\vb{x}}{n}\)；
	\item 运用施密特规范化方法，
	将\(\vb{A}\)的特征向量正交单位化为\(\AutoTuple{\vb\gamma}{n}\)，
	然后写成正交矩阵\(\vb{Q}=(\AutoTuple{\vb\gamma}{n})\)；
	\item 计算得出标准型的矩阵
	\(\vb{B}=\vb{Q}^T\vb{A}\vb{Q}=\vb{Q}^{-1}\vb{A}\vb{Q}=\diag(\AutoTuple{\lambda}{n})\).
\end{enumerate}
\endgroup

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P121 例1
设\(f(x_1,x_2,x_3) = -x_1^2-x_2^2-7x_3^2-4x_1x_2+8x_1x_3+8x_2x_3\).
利用正交变换将\(f\)化为标准型，并写出所用的正交变换.
\begin{solution}
\(f\)的矩阵为\[
	\vb{A} = \begin{bmatrix}
		-1 & -2 & 4 \\
		-2 & -1 & 4 \\
		4 & 4 & -7
	\end{bmatrix}.
\]
令\[
	\abs{\lambda\vb{E}-\vb{A}}
	= \begin{bmatrix}
		\lambda+1 & 2 & -4 \\
		2 & \lambda+1 & -4 \\
		-4 & -4 & \lambda+7
	\end{bmatrix}
	= (\lambda-1)^2 (\lambda+11)
	= 0,
\]
解得特征值\(\lambda_1=1\ (\text{二重})\)，\(\lambda_2=-11\).

当\(\lambda=1\)时，解方程\((\vb{E}-\vb{A})\vb{x}=\vb0\)，\[
	\vb{E}-\vb{A} = \begin{bmatrix}
		2 & 2 & -4 \\
		2 & 2 & -4 \\
		-4 & -4 & 8
	\end{bmatrix}
	\to \begin{bmatrix}
		2 & 2 & -4 \\
		0 & 0 & 0 \\
		0 & 0 & 0
	\end{bmatrix},
\]基础解系为\[
	\vb{x}_1 = \begin{bmatrix} -1 \\ 1 \\ 0 \end{bmatrix},
	\qquad
	\vb{x}_2 = \begin{bmatrix} 2 \\ 0 \\ 1 \end{bmatrix}.
\]
利用施密特方法将其正交化，得\[
	\vb{y}_1=\vb{x}_1,
	\qquad
	\vb{y}_2=\vb{x}_2-\frac{\vb{x}_2\cdot\vb{y}_1}{\vb{y}_1\cdot\vb{y}_1}\vb{y}_1
	=\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix};
\]再将其单位化，得\[
	\vb{Z}_1
	= \frac{1}{\sqrt{2}} \begin{bmatrix} -1 \\ 1 \\ 0 \end{bmatrix},
	\qquad
	\vb{Z}_2
	= \frac{1}{\sqrt{3}} \begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}.
\]

当\(\lambda=-11\)时，解方程\((-11\vb{E}-\vb{A})\vb{x}=\vb0\)，\[
	-11\vb{E}-\vb{A} = \begin{bmatrix}
		-10 & 2 & -4 \\
		2 & -10 & -4 \\
		-4 & -4 & -4
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & 1 & 1 \\
		0 & 2 & 1 \\
		0 & 0 & 0
	\end{bmatrix},
\]
基础解系为\[
	\vb{x}_3 = \begin{bmatrix} 1 \\ 1 \\ -2 \end{bmatrix},
\]
单位化得\[
	\vb{Z}_3 = \frac{1}{\sqrt{6}} \begin{bmatrix} 1 \\ 1 \\ -2 \end{bmatrix}.
\]

令\[
	\vb{Q} = (\vb{Z}_1,\vb{Z}_2,\vb{Z}_3)
	= \begin{bmatrix}
		-\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \\
		\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \\
		0 & \frac{1}{\sqrt{3}} & -\frac{2}{\sqrt{6}} \\
	\end{bmatrix},
\]\(\vb{Q}\)是正交矩阵，满足\(\vb{Q}^T\vb{A}\vb{Q}=\vb{Q}^{-1}\vb{A}\vb{Q}=\diag(1,1,-11)\).
作正交变换\(\vb{x}=\vb{Q}\vb{y}\)，于是\(f\)化为标准型\(y_1^2+y_2^2-11y_3^2\).
\end{solution}
\end{example}

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P122 例2
设实二次型\[
	f(\AutoTuple{x}{n})=\vb{x}^T\vb{A}\vb{x}
\]的矩阵\(\vb{A}\)的特征值为\(\AutoTuple{\lambda}{n}\)，
\(c=\max\{\AutoTuple{\lambda}{n}\}\).
证明：对于任意\(n\)维实向量\(\vb{x}\)，都有\[
	f(\AutoTuple{x}{n}) \leq c \vb{x}^T\vb{x}.
\]
\begin{proof}
因为\(\vb{A}\)是实对称矩阵，
即存在正交矩阵\(\vb{Q}\)
使得\(\vb{Q}^T\vb{A}\vb{Q} = \diag(\AutoTuple{\lambda}{n})\)，
作正交变换\(\vb{x}=\vb{Q}\vb{y}\)，
则\(f\)化为标准型\begin{align*}
	f(\AutoTuple{x}{n})
	&= \lambda_1 y_1^2 + \lambda_2 y_2^2 + \dotsb + \lambda_n y_n^2 \\
	&\leq c y_1^2 + c y_2^2 + \dotsb + c y_n^2 \\
	&= c \vb{y}^T \vb{y}
	= c \vb{x}^T \vb{x}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

\subsection{拉格朗日配方法}
用正交变换能够化实二次型为标准型，这种方法是根据实对称矩阵的性质，
求出二次型矩阵的特征值和规范正交的特征向量，条件要求较强.
当研究一般数域\(K\)上的二次型（包括实二次型）的标准型时，
可以用\DefineConcept{拉格朗日配方法}.
这种方法不用解矩阵特征值问题，
只需反复利用以下两个初等代数公式\[
	a^2+2ab+b^2=(a+b)^2,
	\quad
	a^2-b^2=(a+b)(a-b)
\]就能将二次型化为标准型.

但是在对二次型配方时，应该做到一点：
每配得一个完全平方式，余下的多项式就减少一个变量.
在完成配方以后，还应该写出线性替换矩阵\(\vb{C}\)，检验它是不是可逆线性替换.
如果\(\vb{C}\)不是可逆的，那么配方结果就是错误的.
例如二次型\[
	f(x_1,x_2,x_3) = (x_1-x_2)^2 + (x_2-x_3)^2 + (x_3-x_1)^2
\]看上去好像已经完成配方了，
但是它对应的线性替换矩阵\[
	\vb{C} = \begin{bmatrix}
		1 & -1 & 0 \\
		0 & 1 & -1 \\
		-1 & 0 & 1 \\
	\end{bmatrix}
	% \to \begin{bmatrix}
	% 	1 & 0 & -1 \\
	% 	0 & 1 & -1 \\
	% 	0 & 0 & 0
	% \end{bmatrix}
\]是奇异矩阵，
于是我们只能把原式展开得到\[
	f(x_1,x_2,x_3)
	= 2 x_1^2 + 2 x_2^2 + 2 x_3^2
	- 2 x_1 x_2 - 2 x_1 x_3 - 2 x_2 x_3,
\]
写出它的矩阵\[
	\vb{A} = \begin{bmatrix}
		2 & -1 & -1 \\
		-1 & 2 & -1 \\
		-1 & -1 & 2
	\end{bmatrix},
\]
求出对应的相似标准型\(\diag(3,3,0)\)，
最后写出标准型\[
	g(y_1,y_2,y_3) = 3 y_1^2 + 3 y_2^2.
\]

\begin{example}
%@see: 《线性代数》（张慎语、周厚隆） P122 例3
用配方法化二次型\(f(x_1,x_2,x_3)
= x_1^2 + 2 x_1 x_2 + 2 x_2^2 - 3 x_2 x_3\)为标准型，并求出所用的可逆线性替换.
\begin{solution}
首先有\begin{align*}
	f(x_1,x_2,x_3)
	&= x_1^2 + 2 x_1 x_2 + 2 x_2^2 - 3 x_2 x_3 \\
	&= x_1^2 + 2 x_1 x_2 + x_2^2 + x_2^2 - 3 x_2 x_3 \\
	&= (x_1 + x_2)^2 + x_2^2 - 3 x_2 x_3 + \frac{9}{4} x_3^2 - \frac{9}{4} x_3^2 \\
	&= (x_1 + x_2)^2 + \left( x_2 - \frac{3}{2} x_3 \right)^2 - \frac{9}{4} x_3^2,
\end{align*}
令\[
	\left\{ \def\arraystretch{1.5} \begin{array}{*7r}
		y_1 &= &x_1 &+&x_2 \\
		y_2 &= & & & x_2 & -& \frac{3}{2} x_3 \\
		y_3 &= & & & & & x_3
	\end{array} \right.
	\eqno(1)
\]
则\[
	\left\{ \def\arraystretch{1.5} \begin{array}{*7r}
	x_1 &= &y_1 &-&y_2 &-&\frac{3}{2} y_3 \\
	x_2 &= & & & y_2 & +& \frac{3}{2} y_3 \\
	x_3 &= & & & & & y_3
	\end{array} \right.
	\eqno(2)
\]
(2)是可逆线性替换，使\(f(x_1,x_2,x_3) = y_1^2 + y_2^2 - \frac{9}{4} y_3^2\).
\end{solution}
\end{example}

\begin{theorem}
%@see: 《线性代数》（张慎语、周厚隆） P125 定理4
对于任意一个\(n\)元二次型\(f(\AutoTuple{x}{n})=\vb{x}^T\vb{A}\vb{x}\ (\vb{A}=\vb{A}^T)\)，
都存在非退化的线性替换\(\vb{x}=\vb{C}\vb{y}\)，
使之成为\[
	f(\AutoTuple{x}{n})=d_1 y_1^2 + d_2 y_2^2 + \dotsb + d_n y_n^2.
\]
\begin{proof}
应用数学归纳法.
当\(n=1\)时，\(f(x_1) = a_{11} x_1^2 = d_1 y_1^2\)，结论成立.

假设当\(n=k-1\ (k\geq2)\)时结论成立；那么当\(n=k\)时，我们分以下两种情况进行讨论：
\begin{enumerate}
\item 若\(f\)的平方项系数不全为零，不妨设\(a_{11}\neq0\)，
从而有\begin{align*}
	f(\AutoTuple{x}{n})
	&= a_{11} x_1^2 + 2 x_1 \sum_{j=2}^n a_{1j} x_j
		+ \sum_{i=2}^n \sum_{j=2}^n a_{ij} x_i x_j \\
	&= a_{11} \left[
		x_1 + \frac{1}{a_{11}} \sum_{j=2}^n a_{1j} x_j
	\right]^2
	- \frac{1}{a_{11}} \left[
		\sum_{j=2}^n a_{1j} x_j
	\right]^2
	+ \sum_{i=2}^n \sum_{j=2}^n a_{ij} x_i x_j,
\end{align*}
令\[
	y_1 = x_1 + \frac{1}{a_{11}} \sum_{j=2}^n a_{1j} x_j, \qquad
	y_2 = x_2, \qquad
	\dotsc, \qquad
	y_n = x_n,
\]
则\[
	f(\AutoTuple{x}{n}) = a_{11} y_1^2 + g(\AutoTuple{y}[2]{n}),
\]
其中\(g(\AutoTuple{y}[2]{n})
= - \frac{1}{a_{11}} \left[
	\sum_{j=2}^n a_{1j} x_j
\right]^2
+ \sum_{i=2}^n \sum_{j=2}^n a_{ij} x_i x_j\)%
是一个\(n-1\)元二次型或零多项式.
由归纳假设，存在\(n-1\)阶可逆矩阵\(\vb{Q}\)，
得到非退化线性变换\((\AutoTuple{y}[2]{n})^T = \vb{Q} (\AutoTuple{z}[2]{n})^T\)，
使得\[
	g(\AutoTuple{y}[2]{n})
	= d_2 z_2^2 + d_3 z_3^2 + \dotsb + d_n z_n^2.
\]
记\[
	\vb{P} = \begin{bmatrix}
		1 & -a_{11}^{-1} a_{12} & -a_{11}^{-1} a_{13} & \dots & -a_{11}^{-1} a_{1n} \\
		& 1 & 0 & \dots & 0 \\
		& & 1 & \dots & 0 \\
		& & & \ddots & \vdots \\
		& & & & 1
	\end{bmatrix},
\]则非退化线性替换\[
	\begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_n
	\end{bmatrix}
	= \vb{P} \begin{bmatrix}
		y_1 \\ y_2 \\ \vdots \\ y_n
	\end{bmatrix}
	= \vb{P} \begin{bmatrix} 1 & \vb0 \\ \vb0 & \vb{Q} \end{bmatrix} \begin{bmatrix}
		z_1 \\ z_2 \\ \vdots \\ z_n
	\end{bmatrix}
\]
使得\(f(\AutoTuple{x}{n}) = a_{11} z_1^2 + d_2 z_2^2 + d_3 z_3^2 + \dotsb + d_n z_n^2\).

\item 若\(f\)不含平方项，则必存在\(1 \leq i < j \leq n\)使得\(a_{ij}\neq0\)；
于是\[
	\left\{ \begin{array}{l}
		x_i = y_i + y_j \\
		x_j = y_i - y_j \\
		x_k = y_k\ (1 \leq k \leq n \land k \neq i \land k \neq j)
	\end{array} \right.
\]是非退化的线性替换，
使得\[
	f(\AutoTuple{x}{n})
	= g(\AutoTuple{y}{n})
	= a_{ij} y_i^2 - a_{ij} y_j^2 + h(\AutoTuple{y}{n}),
\]
其中\(h(\AutoTuple{y}{n})\)是不含平方项的二次型或零多项式，
故\(g(\AutoTuple{y}{n})\)含有平方项，这归结为第一种情形，从而可以化为标准型.
\qedhere
\end{enumerate}
\end{proof}
\end{theorem}

\begin{corollary}
%@see: 《线性代数》（张慎语、周厚隆） P126 推论1
任意\(n\)阶对称矩阵\(\vb{A}\)都与对角形矩阵合同.
\end{corollary}

\begin{example}
%@see: 《2018年全国硕士研究生入学统一考试（数学一）》三解答题/第20题
设实二次型\(f(x_1,x_2,x_3) = (x_1-x_2+x_3)^2 + (x_2+x_3)^2 + (x_1+ax_3)^2\)，
其中\(a\)是未知参数.
求\(f(x_1,x_2,x_3)=0\)的解和规范型.
\begin{solution}
记\[
	\vb{C} \defeq \begin{bmatrix}
		1 & -1 & 1 \\
		0 & 1 & 1 \\
		1 & 0 & a
	\end{bmatrix}.
\]
作初等行变换得\[
	\vb{C} \to \vb{C}_1 = \begin{bmatrix}
		1 & 0 & 2 \\
		0 & 1 & 1 \\
		0 & 0 & a-2
	\end{bmatrix}.
\]

当\(a\neq2\)时，\(\rank\vb{C}=3\)，方程\(\vb{C}\vb{x}=\vb0\)只有零解.

当\(a=2\)时，\(\rank\vb{C}=2\)，方程\(\vb{C}\vb{x}=\vb0\)
解得\(k (-2,-1,1)^T\ (\text{$k$是任意常数})\).

注意到\(f(x_1,x_2,x_3) = (x_1-x_2+x_3)^2 + (x_2+x_3)^2 + (x_1+ax_3)^2 \geq 0\).

当\(a\neq2\)时，由于方程\(f(x_1,x_2,x_3)=0\)只有零解，\(f\)是正定的.
因此可令\[
	\left\{ \begin{array}{l}
		y_1 = x_1-x_2+x_3, \\
		y_2 = x_2+x_3, \\
		y_3 = x_1+ax_3,
	\end{array} \right.
\]
于是\(f\)的规范型为\(g(y_1,y_2,y_3) = y_1^2 + y_2^2 + y_3^2\).

当\(a=2\)时，\(\vb{C}\)不满秩，将\(f\)展开得\begin{align*}
	f(x_1,x_2,x_3) &= (x_1-x_2+x_3)^2 + (x_2+x_3)^2 + (x_1+2x_3)^2 \\
	&= 2 x_1^2 - 2 x_1 x_2 + 2 x_2^2 + 6 x_1 x_3 + 6 x_3^2,
\end{align*}
写出对应的矩阵\[
	\vb{A} = \begin{bmatrix}
		2 & -1 & 3 \\
		-1 & 2 & 0 \\
		3 & 0 & 6
	\end{bmatrix},
\]
解\(\vb{A}\)的特征方程\(\abs{\lambda\vb{E}-\vb{A}}=\lambda(\lambda^2-10\lambda+18)=0\)
得\(\lambda\in\Set{0,5\pm\sqrt7}\)，
\(f\)的正惯性指数为\(2\)，
于是\(f\)的规范型为\(h(z_1,z_2,z_3) = z_1^2+z_2^2\).
\end{solution}
\end{example}

\subsection{初等变换法}
\begin{definition}
%@see: 《线性代数》（张慎语、周厚隆） P126 定义4
设\(\vb{P}\)为初等矩阵.
对于任意矩阵\(\vb{B}\)，称变换\(\vb{B} \to \vb{P}^T\vb{B}\vb{P}\)为
对\(\vb{B}\)作一次\DefineConcept{合同变换}.
\end{definition}

\begin{theorem}
因为对于任一对称阵\(\vb{A}\)，存在可逆矩阵\(\vb{C}\)，使得\[
	\vb{C}^T\vb{A}\vb{C}=\diag(\AutoTuple{d}{n}).
\]
又因为存在初等矩阵\(\vb{P}_1,\vb{P}_2,\dotsc,\vb{P}_m\)，使得\[
	\vb{C}=\vb{P}_1\vb{P}_2\dotsm\vb{P}_m,
\]
那么\[
	\vb{C}^T\vb{A}\vb{C}
	= (\vb{P}_m^T\vb{P}_{m-1}^T\dotsm\vb{P}_1^T)\vb{A}(\vb{P}_1\vb{P}_2\dotsm\vb{P}_m)
	= \diag(\AutoTuple{d}{n}).
\]

因为初等矩阵有三类：\begin{itemize}
	\item \(\vb{P}(i,j)^T\vb{B}\vb{P}(i,j)=\vb{P}(i,j)\vb{B}\vb{P}(i,j)\)，
	相当于交换\(\vb{B}\)的\(i,j\)两行，再交换\(\vb{P}(i,j)\vb{B}\)的\(i,j\)两列.
	\item \(\vb{P}(i(c))^T\vb{B}\vb{P}(i(c))=\vb{P}(i(c))\vb{B}\vb{P}(i(c))\ (c \neq 0)\)，
	相当于用\(c\)乘\(\vb{B}\)的\(i\)行，再用\(c\)乘\(\vb{P}(i(c))\vb{B}\)的\(i\)列.
	\item \(\vb{P}(i,j(k))^T\vb{B}\vb{P}(i,j(k))=\vb{P}(j,i(k))\vb{B}\vb{P}(i,j(k))\)，
	相当于将\(\vb{B}\)的\(i\)行的\(k\)倍加到\(j\)行，
	再将\(\vb{P}(j,i(k))\vb{B}\)的\(i\)列的\(k\)倍加到\(j\)列.
\end{itemize}
可见，对称矩阵\(\vb{A}\)可以经过一系列合同变换化为对角形矩阵.
则\[
	\begin{bmatrix} \vb{A} \\ \vb{E} \end{bmatrix}
	\to
	\begin{bmatrix} \vb{C}^T & \vb0 \\ \vb0 & \vb{E} \end{bmatrix}
	\begin{bmatrix} \vb{A} \\ \vb{E} \end{bmatrix}
	\vb{C}
	= \begin{bmatrix} \vb{C}^T\vb{A}\vb{C} \\ \vb{C} \end{bmatrix},
\]\[
	(\vb{A},\vb{E})
	\to
	\vb{C}^T (\vb{A},\vb{E}) \begin{bmatrix}
		\vb{C} & \vb0 \\
		\vb0 & \vb{E}
	\end{bmatrix}
	= (\vb{C}^T\vb{A}\vb{C},\vb{C}^T).
\]
其中\(\vb{C}=\vb{P}_1\vb{P}_2\dotsm\vb{P}_m\)，
即对\(\vb{A}\)作一系列合同变换化为对角阵\(\vb{C}^T\vb{A}\vb{C}\)，
只对\(\vb{E}\)进行列变换，将\(\vb{E}\)变成\(\vb{C}\)；
或者只对\(\vb{E}\)作其中的行变换，则将\(\vb{E}\)变为\(\vb{C}^T\).
\end{theorem}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》三解答题/第21题
设二次型\begin{align*}
	f(x_1,x_2,x_3) &= x_1^2 + 2 x_2^2 + 2 x_3^2 + 2 x_1 x_2 - 2 x_1 x_3, \\
	g(y_1,y_2,y_3) &= y_1^2 + y_2^2 + y_3^2 + 2 y_2 y_3.
\end{align*}
求可逆变换\(\vb{x} = \vb{P} \vb{y}\)将\(f(x_1,x_2,x_3)\)化为\(g(y_1,y_2,y_3)\).
\begin{solution}\let\qed\relax
\begin{proof}[解法一]
配方，得\begin{align*}
	f(x_1,x_2,x_3) &= x_1^2 + 2 x_2^2 + 2 x_3^2 + 2 x_1 x_2 - 2 x_1 x_3 \\
	&= (x_1 + x_2 - x_3)^2 + x_2 + x_3^2 + 2 x_2 x_3 \\
	&= (x_1 + x_2 - x_3)^2 + (x_2 + x_3)^2, \\
	g(y_1,y_2,y_3) &= y_1^2 + y_2^2 + y_3^2 + 2 y_2 y_3 \\
	&= y_1^2 + (y_2 + y_3)^2,
\end{align*}

令\(\left\{ \begin{array}{l}
	z_1 = x_1 + x_2 - x_3, \\
	z_2 = x_2 + x_3, \\
	z_3 = x_3,
\end{array} \right.\)
即\(\begin{bmatrix}
	z_1 \\ z_2 \\ z_3
\end{bmatrix}
= \begin{bmatrix}
	1 & 1 & -1 \\
	0 & 1 & 1 \\
	0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
	x_1 \\ x_2 \\ x_3
\end{bmatrix}\)，
可逆变换\(\vb{x} = \vb{P}_1 \vb{z}\)将\(f(x_1,x_2,x_3)\)化为\(h(z_1,z_2,z_3)\)，
其中\begin{equation*}
	\vb{P}_1 = \begin{bmatrix}
		1 & 1 & -1 \\
		0 & 1 & 1 \\
		0 & 0 & 1
	\end{bmatrix}^{-1}.
\end{equation*}

令\(\left\{ \begin{array}{l}
	z_1 = y_1, \\
	z_2 = y_2 + y_3, \\
	z_3 = y_3,
\end{array} \right.\)
即\(\begin{bmatrix}
	z_1 \\ z_2 \\ z_3
\end{bmatrix}
= \begin{bmatrix}
	1 & 0 & 0 \\
	0 & 1 & 1 \\
	0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
	y_1 \\ y_2 \\ y_3
\end{bmatrix}\)，
可逆变换\(\vb{z} = \vb{P}_2 \vb{y}\)将\(h(z_1,z_2,z_3)\)化为\(g(y_1,y_2,y_3)\)，
其中\begin{equation*}
	\vb{P}_2 = \begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 0 & 1
	\end{bmatrix}.
\end{equation*}

因此，若要可逆变换\(\vb{x} = \vb{P} \vb{y}\)将\(f(x_1,x_2,x_3)\)化为\(g(y_1,y_2,y_3)\)，
只需令\begin{equation*}
%@Mathematica: Inverse[{{1, 1, -1}, {0, 1, 1}, {0, 0, 1}}] . {{1, 0, 0}, {0, 1, 1}, {0, 0, 1}}
	\vb{P} = \vb{P}_1 \vb{P}_2
	= \begin{bmatrix}
		1 & 1 & -1 \\
		0 & 1 & 1 \\
		0 & 0 & 1
	\end{bmatrix}^{-1}
	\begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 0 & 1
	\end{bmatrix}
	= \begin{bmatrix}
		1 & -1 & 1 \\
		0 & 1 & 0 \\
		0 & 0 & 1
	\end{bmatrix}.
\end{equation*}
\end{proof}
\begin{proof}[解法二]
二次型\(f(x_1,x_2,x_3)\)的矩阵为\begin{equation*}
	\vb{A} = \begin{bmatrix}
		1 & 1 & -1 \\
		1 & 2 & 0 \\
		-1 & 0 & 2
	\end{bmatrix}.
\end{equation*}
二次型\(g(y_1,y_2,y_3)\)的矩阵为\begin{equation*}
	\vb{B} = \begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 1 & 1
	\end{bmatrix}.
\end{equation*}
将\(\vb{A}\)的第2行减去第1行，第2列减去第1列，
得到\begin{equation*}
	\vb{A} \to \begin{bmatrix}
		1 & 1 & -1 \\
		0 & 1 & 1 \\
		-1 & 0 & 2
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & 0 & -1 \\
		0 & 1 & 1 \\
		-1 & 1 & 2
	\end{bmatrix};
\end{equation*}
再让第3行加上第1行，第3列加上第1列，
得到\begin{equation*}
	\vb{A} \to \begin{bmatrix}
		1 & 0 & -1 \\
		0 & 1 & 1 \\
		0 & 1 & 1
	\end{bmatrix}
	\to \begin{bmatrix}
		1 & 0 & 0 \\
		0 & 1 & 1 \\
		0 & 1 & 1
	\end{bmatrix}
	= \vb{B}.
\end{equation*}
于是所求可逆矩阵\(\vb{P}\)就是\(\vb{P}_1 = \begin{bmatrix}
	1 & -1 & 0 \\
	0 & 1 & 0 \\
	0 & 0 & 1
\end{bmatrix}\)和\(\vb{P}_2 = \begin{bmatrix}
	1 & 0 & 1 \\
	0 & 1 & 0 \\
	0 & 0 & 1
\end{bmatrix}\)这两个初等矩阵的乘积，
即\begin{equation*}
	\vb{P} = \begin{bmatrix}
		1 & -1 & 1 \\
		0 & 1 & 0 \\
		0 & 0 & 1
	\end{bmatrix}.
\end{equation*}
\end{proof}
\end{solution}
\end{example}
