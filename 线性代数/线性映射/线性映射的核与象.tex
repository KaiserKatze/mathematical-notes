\section{线性映射的核与象}
\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P113 定义1
设\(V\)和\(V'\)都是域\(F\)上的线性空间，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射.
我们把\(V'\)中零向量\(0'\)在\(\vb{A}\)下的原象集
\(\Set{
	\alpha\in V
	\given
	\vb{A}\alpha=0'
}\)
称为“\(\vb{A}\)的\DefineConcept{核}（kernel）”，
记作\(\Ker\vb{A}\).
把映射\(\vb{A}\)的值域
\(\Set{
	\beta \in V'
	\given
	\beta = \vb{A}\alpha,
	\alpha \in V
}\)
称为“\(\vb{A}\)的\DefineConcept{象}（image）”，
记作\(\Im\vb{A}\)或\(\vb{A}V\).
\end{definition}
%“核”的概念在群同态中也有定义
%考虑零元是加法群的单位元，
%因此线性映射的核的定义只是群同态的特殊情况
\begin{remark}
线性映射的核有可能含有非零元.
例如，在几何空间\(V\)中，
\(V\)在\(xOy\)平面上的正投影\(\vb{P}_W\)
把\(z\)轴上的每一个向量\(\alpha=(0,0,z)\ (z\in\mathbb{R})\)
映射为零向量\(0=(0,0,0)\)；
显然，当\(z\neq0\)时，\(\alpha\)就是一个非零元，
但它又是线性映射\(\vb{P}_W\)的核的一个元素.
\end{remark}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 1.
设\(V\)是域\(F\)上的一个线性空间，
\(U\)和\(W\)都是\(V\)的子空间，
且\(V = U \DirectSum W\)，
\(\vb{P}_U\)是\(V\)平行于\(W\)在\(U\)上的投影，
\(\vb{P}_W\)是\(V\)平行于\(U\)在\(W\)上的投影.
求\(\Ker\vb{P}_U,
\Im\vb{P}_U,
\Ker\vb{P}_W,
\Im\vb{P}_W\).
%TODO \(\Ker\vb{P}_U = W\)
%TODO \(\Im\vb{P}_U = U\)
\end{example}

\begin{proposition}\label{theorem:线性映射.线性映射的核空间和像空间分别是定义域和陪域的子空间}
%@see: 《高等代数（第三版 下册）》（丘维声） P113 命题1
设\(\vb{A}\)是域\(F\)上线性空间\(V\)到\(V'\)的一个线性映射，
则\(\Ker\vb{A}\)是\(V\)的一个子空间，
\(\Im\vb{A}\)是\(V'\)的一个子空间.
\begin{proof}
由于\(\vb{A}(0)=0\)，
因此\(0 \in \Ker\vb{A}\).
任取\(\alpha,\beta \in \Ker\vb{A},
k \in F\)，
则有\begin{gather*}
	\vb{A}(\alpha+\beta)
	= \vb{A}\alpha + \vb{A}\beta
	= 0 + 0
	= 0, \\
	\vb{A}(k\alpha)
	= k \vb{A}\alpha
	= k0
	= 0,
\end{gather*}
因此\(\Ker\vb{A}\)是\(V\)的一个子空间.

显然\(\Im\vb{A}\)是\(V'\)的一个非空子集.
在\(\Im\vb{A}\)中任取两个元素\(\gamma_1,\gamma_2\)，
则存在\(\alpha_1,\alpha_2 \in V\)，
使得\begin{gather*}
	\gamma_1 = \vb{A}\alpha_1, \\
	\gamma_2 = \vb{A}\alpha_2,
\end{gather*}
从而\begin{gather*}
	\gamma_1 + \gamma_2
	= \vb{A}\alpha_1 + \vb{A}\alpha_2
	= \vb{A}(\alpha_1 + \alpha_2)
	\in \Im\vb{A}, \\
	k \gamma_1
	= k \vb{A}\alpha_1
	= \vb{A}(k \alpha_1)
	\in \Im\vb{A},
	\quad k \in F,
\end{gather*}
因此\(\Im\vb{A}\)是\(V'\)的一个子空间.
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P114 命题2
设\(\vb{A}\)是域\(F\)上线性空间\(V\)到\(V'\)的一个线性映射，
则\begin{gather*}
	\text{$\vb{A}$是单射}
	\iff
	\Ker\vb{A}=0, \\
	\text{$\vb{A}$是满射}
	\iff
	\Im\vb{A}=V'.
\end{gather*}
\begin{proof}
首先证明
\(\text{$\vb{A}$是单射}
\iff
\Ker\vb{A}=0\).
\begin{itemize}
	\item 设\(\vb{A}\)是单射.
	任取\(\alpha \in \Ker\vb{A}\)，
	则\[
		% 第一个等号是由“核”的定义保证的
		\vb{A}\alpha = 0 = \vb{A}0,
	\]
	% 由于\(\vb{A}\)是单射
	从而有\(\alpha = 0\)，
	因此\(\Ker\vb{A} = 0\).

	\item 设\(\Ker\vb{A} = 0\).
	设\(\alpha_1,\alpha_2 \in V\)满足\(\vb{A}\alpha_1 = \vb{A}\alpha_2\)，
	则\[
		0 = \vb{A}\alpha_2 - \vb{A}\alpha_1 = \vb{A}(\alpha_2 - \alpha_1),
	\]
	从而\(\alpha_2 - \alpha_1 \in \Ker\vb{A}\).
	由\(\Ker\vb{A} = 0\)
	可知\(\alpha_2 - \alpha_1 = 0\)，
	即\(\alpha_1 = \alpha_2\).
	这就说明\(\vb{A}\)是单射.
\end{itemize}

由满射的定义立即可得
\(\text{$\vb{A}$是满射}
\iff
\Im\vb{A}=V'\).
\end{proof}
\end{proposition}

\begin{definition}
设\(V\)和\(V'\)都是域\(F\)上的线性空间，
且\(V\)是有限维的，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射.
我们把\(\vb{A}\)的核\(\Ker\vb{A}\)的维数\(\dim(\Ker\vb{A})\)
称为“\(\vb{A}\)的\DefineConcept{零度}（nullity）”，
%@see: https://mathworld.wolfram.com/Nullity.html
把\(\vb{A}\)的象\(\Im\vb{A}\)的维数\(\dim(\Im\vb{A})\)
称为“\(\vb{A}\)的\DefineConcept{秩}（rank）”.
\end{definition}

\begin{theorem}
%@see: 《高等代数（第三版 下册）》（丘维声） P114 定理3
设\(V\)和\(V'\)都是域\(F\)上的线性空间，
且\(V\)是有限维的，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射，
则\(\Ker\vb{A}\)和\(\Im\vb{A}\)都是有限维的，
且\[
%@see: 《高等代数（第三版 下册）》（丘维声） P114 (2)
	\dim(\Ker\vb{A})
	+\dim(\Im\vb{A})
	=\dim V.
\]
\begin{proof}
因为\(V\)是有限维的，
%\cref{theorem:线性空间.子空间.有限维线性空间的子空间是有限维的}
%\cref{theorem:线性映射.线性映射的核空间和像空间分别是定义域和陪域的子空间}
所以它的子空间\(\Ker\vb{A}\)是有限维的.

设\(\dim(\Ker\vb{A}) = m,
\dim V = n\).
取\(\Ker\vb{A}\)的一个基\(\AutoTuple{\alpha}{m}\)，
把它扩充成\(V\)的一个基\[
	\AutoTuple{\alpha}{m},
	\AutoTuple{\alpha}[m+1]{n}.
\]
由核的定义可知，
对于任意一个向量\(\alpha \in V\)，
有\[
	% 核空间\(\Ker\vb{A}\)中的任意一个向量\(\alpha\)在线性映射\(\vb{A}\)下的像\(\vb{A}\alpha\)必定等于\(0\)
	\alpha \in \Ker\vb{A}
	\implies
	\vb{A}\alpha = 0,
\]
那么\[
	% 核空间\(\Ker\vb{A}\)的每一个基向量都是\(\Ker\vb{A}\)中的向量，自然它在线性映射\(\vb{A}\)下的像\(\vb{A}\alpha\)必定等于\(0\)
	\vb{A}\alpha_i = 0,
	\quad i=1,2,\dotsc,m,
\]
于是，
对于任意\(\AutoTuple{x}{m} \in F\)，
有\[
	\vb{A} \sum_{i=1}^m x_i \alpha_i
	= \sum_{i=1}^m x_i \vb{A}\alpha_i
	= \sum_{i=1}^m x_i 0
	= 0.
\]
在\(\Im\vb{A}\)中任取一个向量\(\vb{A}\alpha\)，
其中\(\alpha \in V\).
% \(\alpha\)作为\(V\)中的向量，自然可以由\(V\)的基\(\alpha_1,\dotsc,\alpha_n\)线性表出
设\(\alpha = \sum_{i=1}^n x_i \alpha_i\)，
其中\(\AutoTuple{x}{m} \in F\)，
则\[
%@see: 《高等代数（第三版 下册）》（丘维声） P114 (3)
	\vb{A}\alpha
	% 在\(\alpha = \sum_{i=1}^n x_i \alpha_i\)等号左右两边同时乘以\(\vb{A}\)便得
	= \sum_{i=1}^n x_i \vb{A} \alpha_i
	% 由上可知\(\sum_{i=1}^m x_i \vb{A} \alpha_i = 0\)
	= \sum_{i=m+1}^n x_i \vb{A} \alpha_i,
\]
因此\[
%@see: 《高等代数（第三版 下册）》（丘维声） P114 (4)
	\Im\vb{A} = \Span\{\AutoTuple{\vb{A}\alpha}[m+1]{n}\},
\]
从而\(\Im\vb{A}\)是有限维的.

接下来证明\(\AutoTuple{\vb{A}\alpha}[m+1]{n}\)线性无关.
令\[
	y_{m+1} \vb{A} \alpha_{m+1} + \dotsb + y_n \vb{A} \alpha_n = 0,
\]
则\[
	\vb{A} (y_{m+1} \alpha_{m+1} + \dotsb + y_n \alpha_n) = 0,
\]
于是\[
	\beta
	\defeq
	y_{m+1} \alpha_{m+1} + \dotsb + y_n \alpha_n \in \Ker\vb{A},
\]
% 既然\(\beta\)是核空间\(\Ker\vb{A}\)中的向量，
% 那么\(\beta\)肯定可以由\(\Ker\vb{A}\)的基\(\AutoTuple{\alpha}{m}\)线性表出
所以\[
	y_{m+1} \alpha_{m+1} + \dotsb + y_n \alpha_n
	= z_1 \alpha_1 + \dotsb + z_m \alpha_m,
\]
即\[
	-z_1 \alpha_1 - \dotsb - z_m \alpha_m + y_{m+1} \alpha_{m+1} + \dotsb + y_n \alpha_n = 0,
\]
% 既然\(\AutoTuple{\alpha}{n}\)是\(V\)的一个基，
% 那么\(\AutoTuple{\alpha}{n}\)一定是线性无关的向量组，
% 于是上面这个关于\(z_1,\dotsc,z_m,y_{m+1},\dotsc,y_n\)的线性方程只有零解
从而有\[
	z_1 = \dotsb = z_m = y_{m+1} = \dotsb = y_n = 0.
\]
这就说明\(\AutoTuple{\vb{A}\alpha}[m+1]{n}\)线性无关，
于是它是\(\Im\vb{A}\)的一个基.
因此\[
	\dim(\Im\vb{A})
	= \card\{\AutoTuple{\vb{A}\alpha}[m+1]{n}\}
	= n - m
	= \dim V - \dim(\Ker\vb{A}),
\]
移项得\(\dim V = \dim(\Ker\vb{A}) + \dim(\Im\vb{A})\).
\end{proof}
\end{theorem}

\begin{corollary}
%@see: 《高等代数（第三版 下册）》（丘维声） P115
设\(V\)和\(V'\)都是域\(F\)上的线性空间，
且\(V\)是有限维的，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射.
若\(\AutoTuple{\alpha}{n}\)是\(V\)的一个基，
则\[
	\Im\vb{A}=\opair{\vb{A}\alpha_1,\dotsc,\vb{A}\alpha_n}.
\]
\end{corollary}

\begin{corollary}
%@see: 《高等代数（第三版 下册）》（丘维声） P115 推论4
设\(V\)和\(V'\)都是域\(F\)上的\(n\)维线性空间，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射，
则\[
	\text{$\vb{A}$是单射}
	\iff
	\text{$\vb{A}$是满射}.
\]
\begin{proof}
直接有\begin{align*}
	\text{$\vb{A}$是单射}
	&\iff
	\Ker\vb{A} = 0 \\
	&\iff
	\dim(\Im\vb{A})
	= \dim V
	= \dim V' \\
	&\iff
	\Im\vb{A} = V' \\
	&\iff
	\text{$\vb{A}$是满射}.
	\qedhere
\end{align*}
\end{proof}
\end{corollary}

\begin{corollary}
%@see: 《高等代数（第三版 下册）》（丘维声） P115 推论5
设\(\vb{A}\)是域\(F\)上的有限维线性空间\(V\)上的线性变换，
则\[
	\text{$\vb{A}$是单射}
	\iff
	\text{$\vb{A}$是满射}.
\]
\end{corollary}

\begin{remark}
对于有限维线性空间\(V\)上的线性变换\(\vb{A}\)，
虽然子空间\(\Ker\vb{A}\)与\(\Im\vb{A}\)的维数之和等于\(\dim V\)，
但是\(\Ker\vb{A}+\Im\vb{A}\)并不一定是整个空间\(V\).

例如，在线性空间\(K[x]_n\)中，
求导数\(\vb{D}\)的象为
\(\Im\vb{D}=K[x]_{n-1}\)，
它的核为\(\Ker\vb{D}=K\).
显然\(K+K[x]_{n-1}\neq K[x]_n\).
\end{remark}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P115
设矩阵\(A \in M_{s \times n}(F)\).
令\[
	\vb{A}\colon F^n \to F^s, \alpha \mapsto A\alpha,
\]
%TODO 参考：第9章第1节例4
则\(\vb{A}\)是从\(F^n\)到\(F^s\)的一个线性映射，
%TODO 参考：第2章第7节
且\(\Ker\vb{A}\)是齐次线性方程组\(AX=0\)的解空间，
而\(\Im\vb{A}\)是矩阵\(A\)的列空间.
%TODO proof
\end{proposition}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 2.
设\(V\)是域\(F\)上的一个线性空间，
\(\vb{A}\)是\(V\)上的一个线性变换.
证明：如果\(\vb{A}\)是\(V\)上的幂等变换，
则\(V = \Ker\vb{A} \DirectSum \Im\vb{A}\)，
且\(\vb{A}\)是\(V\)平行于\(\Ker\vb{A}\)在\(\Im\vb{A}\)上的投影.
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 3.
设\(V,U,W\)都是域\(F\)上的线性空间，且\(V\)是有限维的，
\(\vb{A}\)是从\(V\)到\(U\)的一个线性映射，
\(\vb{B}\)是从\(U\)到\(W\)的一个线性映射.
证明：\[
	\dim(\Ker(\vb{B}\vb{A}))
	\leq
	\dim(\Ker\vb{A})
	+ \dim(\Ker\vb{B}).
\]
%TODO proof
\end{example}

% 西尔维斯特不等式
\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 4.
设\(V,U,W\)都是域\(F\)上的线性空间，\(\dim V = n,\dim U = m\)，
\(\vb{A}\)是从\(V\)到\(U\)的一个线性映射，
\(\vb{B}\)是从\(U\)到\(W\)的一个线性映射.
证明：\[
	\rank(\vb{B}\vb{A})
	\geq \rank\vb{A} + \rank\vb{B} - m.
\]
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 5.(1)
设\(\vb{A},\vb{B}\)都是域\(F\)上线性空间\(V\)上的幂等变换.
证明：\[
	\Im\vb{A} = \Im\vb{B}
	\iff
	\vb{A}\vb{B} = \vb{B},
	\vb{B}\vb{A} = \vb{A}.
\]
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 5.(2)
设\(\vb{A},\vb{B}\)都是域\(F\)上线性空间\(V\)上的幂等变换.
证明：\[
	\Ker\vb{A} = \Ker\vb{B}
	\iff
	\vb{A}\vb{B} = \vb{A},
	\vb{B}\vb{A} = \vb{B}.
\]
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 6.
设\(V\)和\(V'\)都是域\(F\)上的有限维线性空间，
\(\vb{A}\)是从\(V\)到\(V'\)的一个线性映射.
证明：存在直和分解\(V = U \DirectSum W,
V' = M \DirectSum N\)，
使得\(\Ker\vb{A} = U\)且\(W \Isomorphism M\).
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P116 习题9.2 7.
设\(V\)是域\(F\)上的一个线性空间，域\(F\)的特征为\(\Char F = 0\).
证明：如果\(\AutoTuple{\vb{A}}{s}\)是\(V\)上\(s\)个两两不同的线性变换，
那么\(V\)中至少有一个向量\(\alpha\)，
使得\(\vb{A}_1\alpha,\allowbreak\dotsc,\allowbreak\vb{A}_s\alpha\)两两不同.
%TODO proof
\end{example}
