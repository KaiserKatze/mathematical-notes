\section{线性映射的矩阵表示}
在本节，我们学习如何利用矩阵研究线性映射.

\subsection{用矩阵表示一个有限维线性空间上的线性变换}
%@see: 《高等代数（第三版 下册）》（丘维声） P116
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P69 3.31
设\(V\)是域\(F\)上的\(n\)维线性空间，
\(\vb{A}\)是\(V\)上的一个线性变换.
我们知道，\(\vb{A}\)被它在\(V\)上的一个基上的作用所决定.
于是取\(V\)的一个基\(\AutoTuple{\alpha}{n}\).
由于\(\vb{A}\alpha_i\in V\)，
因此\(\vb{A}\alpha_i\)可以被\(V\)的这个基唯一地线性表出：\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P117 (1)
	\left\{ \begin{array}{l}
		\vb{A}\alpha_1=a_{11}\alpha_1+a_{21}\alpha_2+\dotsb+a_{n1}\alpha_n, \\
		\vb{A}\alpha_2=a_{12}\alpha_1+a_{22}\alpha_2+\dotsb+a_{n2}\alpha_n, \\
		\hdotsfor1 \\
		\vb{A}\alpha_n=a_{1n}\alpha_1+a_{2n}\alpha_2+\dotsb+a_{nn}\alpha_n.
	\end{array} \right.
\end{equation*}
我们可以在形式上把上式写成\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P117 (2)
	(\vb{A}\alpha_1,\vb{A}\alpha_2,\dotsc,\vb{A}\alpha_n)
	=(\AutoTuple{\alpha}{n})
	\begin{bmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & a_{2n} \\
		\vdots & \vdots && \vdots \\
		a_{n1} & a_{n2} & \dots & a_{nn}
	\end{bmatrix}.
\end{equation*}
我们把上式右端的\(n\)阶矩阵\begin{equation*}
	A \defeq \begin{bmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & a_{2n} \\
		\vdots & \vdots && \vdots \\
		a_{n1} & a_{n2} & \dots & a_{nn}
	\end{bmatrix}
\end{equation*}
称为“线性变换\(\vb{A}\)在基\(\AutoTuple{\alpha}{n}\)下的\DefineConcept{矩阵}”，
记作\(\LinearMapMatrix(\vb{A},(\AutoTuple{\alpha}{n}))\)\footnote{
	应该注意到，这里定义的\(\LinearMapMatrix\)记号，
	与之前在\cref{section:线性空间.向量的坐标}定义
	线性空间中的向量的坐标时
	所采用的记号完全相同.
	这是我们有意为之.
}，
或在不致混淆的情况下简记为\(\LinearMapMatrix(\vb{A})\).

\(A\)的第\(j\ (j=1,2,\dotsc,n)\)列是
\(\vb{A}\alpha_j\)在基\(\AutoTuple{\alpha}{n}\)下的坐标.
% 线性变换和它的矩阵一一对应
因此\(A\)由线性变换\(\vb{A}\)唯一决定.

如果我们再把\((\vb{A}\alpha_1,\vb{A}\alpha_2,\dotsc,\vb{A}\alpha_n)\)
简记为\(\vb{A}(\AutoTuple{\alpha}{n})\)，
那么上式可以化为\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P117 (3)
	\vb{A}(\AutoTuple{\alpha}{n})
	=(\AutoTuple{\alpha}{n})A.
\end{equation*}
这就是一个\(n\)阶矩阵\(A\)
是\(V\)上线性变换\(\vb{A}\)
在基\(\AutoTuple{\alpha}{n}\)下的矩阵的充分必要条件.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P117 例1
在\(\mathbb{R}^\mathbb{R}\)中，
设\(V=\Span\{1,\sin x,\cos x\}\)，
证明：
导数\(\vb{D}\)是\(V\)上的线性变换，
写出\(\vb{D}\)在基\(1,\sin x,\cos x\)下的矩阵.
\begin{proof}
因为\begin{equation*}
	\vb{D}(k_1\cdot1+k_2\cdot\sin x+k_3\cos x)
	=-k_3\sin x+k_2\cos x
	\in V,
\end{equation*}
所以\(\vb{D}\)是\(V\)上的线性变换.
因为\begin{equation*}
	\left\{ \begin{array}{l}
		\vb{D}1
		=0
		=0\cdot1+0\cdot\sin x+0\cdot\cos x, \\
		\vb{D}\sin x
		=\cos x
		=0\cdot1+0\cdot\sin x+1\cdot\cos x, \\
		\vb{D}\cos x
		=-\sin x
		=0\cdot1+(-1)\cdot\sin x+0\cdot\cos x,
	\end{array} \right.
\end{equation*}
所以\(\vb{D}\)在基\(1,\sin x,\cos x\)下的矩阵是\begin{equation*}
	D=\begin{bmatrix}
		0 & 0 & 0 \\
		0 & 0 & -1 \\
		0 & 1 & 0
	\end{bmatrix}.
	\qedhere
\end{equation*}
\end{proof}
\end{example}

\subsection{用矩阵表示两个有限维线性空间之间的线性映射}
%@see: 《高等代数（第三版 下册）》（丘维声） P117
上例说明，\(n\)维线性空间\(V\)上的线性变换可以用矩阵来表示.
下面我们来讨论两个有限维线性空间之间的线性映射能不能用矩阵来表示.

设\(V\)和\(V'\)分别是域\(F\)上\(n\)维、\(s\)维线性空间，
\(\vb{A}\)是\(V\)到\(V'\)的一个线性映射.
在\(V\)中取一个基\(\AutoTuple{\alpha}{n}\)，
在\(V'\)中取一个基\(\AutoTuple{\beta}{s}\)，
由于\(\vb{A}\alpha_i\in V'\)，
因此\(\vb{A}\alpha_i\)可以
由\(V'\)的基\(\AutoTuple{\beta}{s}\)唯一地线性表出：\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P118 (4)
	\left\{ \begin{array}{l}
		\vb{A}\alpha_1=a_{11}\beta_1+a_{21}\beta_2+\dotsb+a_{s1}\beta_s, \\
		\vb{A}\alpha_2=a_{12}\beta_1+a_{22}\beta_2+\dotsb+a_{s2}\beta_s, \\
		\hdotsfor1 \\
		\vb{A}\alpha_n=a_{1n}\beta_1+a_{2n}\beta_2+\dotsb+a_{sn}\beta_s.
	\end{array} \right.
\end{equation*}
我们可以在形式上把上式写成\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P118 (5)
	(\vb{A}\alpha_1,\vb{A}\alpha_2,\dotsc,\vb{A}\alpha_n)
	=(\AutoTuple{\beta}{s})
	\begin{bmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & a_{2n} \\
		\vdots & \vdots && \vdots \\
		a_{s1} & a_{s2} & \dots & a_{sn}
	\end{bmatrix}.
\end{equation*}
我们把上式右端的\(s\times n\)阶矩阵\begin{equation*}
	A \defeq \begin{bmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & a_{2n} \\
		\vdots & \vdots && \vdots \\
		a_{s1} & a_{s2} & \dots & a_{sn}
	\end{bmatrix}
\end{equation*}
称为“线性映射\(\vb{A}\)
在\(V\)的基\(\AutoTuple{\alpha}{n}\)
和\(V'\)的基\(\AutoTuple{\beta}{s}\)
下的\DefineConcept{矩阵}”，
记作\(\LinearMapMatrix(\vb{A},(\AutoTuple{\alpha}{n}),(\AutoTuple{\beta}{n}))\)，
或在不致混淆的情况下简记为\(\LinearMapMatrix(\vb{A})\).

\(A\)的第\(j\ (j=1,2,\dotsc,n)\)列是
\(\vb{A}\alpha_j\)在基\(\AutoTuple{\beta}{s}\)下的坐标.
% 线性映射和它的矩阵一一对应
因此\(A\)由线性映射\(\vb{A}\)唯一决定.
那么上式可以化为\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P118 (6)
	\vb{A}(\AutoTuple{\alpha}{n})
	=(\AutoTuple{\beta}{s})A.
\end{equation*}
这就是一个\(s\times n\)矩阵\(A\)
是\(V\)到\(V'\)的线性映射\(\vb{A}\)
在\(V\)的基\(\AutoTuple{\alpha}{n}\)
和\(V'\)的基\(\AutoTuple{\beta}{s}\)下的矩阵的充分必要条件.

\begin{proposition}
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P89 3.75
设\(V,W\)都是域\(F\)上的有限维线性空间，
\(\AutoTuple{\alpha}{n}\)和\(\AutoTuple{\beta}{m}\)分别是\(V\)和\(W\)的基，
\(\vb{T}\in\Hom(V,W)\)，
则线性映射\(\vb{T}\)的矩阵的第\(k\)列，
等于向量\(\vb{T}\alpha_k\)的坐标，
即\begin{equation*}
	\MatrixEntry{
		\LinearMapMatrix(\vb{T})
	}{*,k}
	= \VectorMatrix(\vb{T} \alpha_k),
	\quad k=1,2,\dotsc,n.
\end{equation*}
\end{proposition}

\subsection{线性映射空间与矩阵空间同构}
从上面看到，
域\(F\)上\(n\)维线性空间\(V\)到\(s\)维线性空间\(V'\)的
每一个线性映射\(\vb{A}\)可以用一个\(s\times n\)矩阵\(A\)表示.
我们已经知道，\(V\)到\(V'\)的所有线性映射组成的集合\(\Hom(V,V')\)
是域\(F\)上的一个线性空间.
我们又知道，\(F\)上所有\(s\times n\)矩阵组成的集合\(M_{s\times n}(F)\)
也是域\(F\)上的一个线性空间.
容易证明，\(\Hom(V,V')\)与\(M_{s\times n}(F)\)同构.

\begin{theorem}\label{theorem:线性映射.线性映射空间与矩阵空间同构1}
%@see: 《高等代数（第三版 下册）》（丘维声） P119 定理1
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P87 3.71
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P87 3.32
设\(V\)和\(V'\)分别是域\(F\)上\(n\)维、\(s\)维线性空间，
则\begin{gather}
	\Hom(V,V') \Isomorphism M_{s\times n}(F), \\  % 同构
	\dim\Hom(V,V')
	=\dim M_{s\times n}(F)
	=sn.
\end{gather}
\begin{proof}
在\(V\)中取一个基\(\AutoTuple{\alpha}{n}\)，
在\(V'\)中取一个基\(\AutoTuple{\beta}{s}\)，
令\begin{equation*}
	\sigma \defeq \Set{
		(\vb{A},A)
		\given
		\vb{A} \in \Hom(V,V'),
		A \in M_{s \times n}(F),
		\vb{A}(\AutoTuple{\alpha}{n}) = (\AutoTuple{\beta}{s}) A
	}.
\end{equation*}
显然\(\sigma\)是从\(\Hom(V,V')\)到\(M_{s \times n}(F)\)的一个映射.

任给\(C \in M_{s \times n}(F)\)，
令\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P118 (7)
	(\AutoTuple{\gamma}{n}) = (\AutoTuple{\beta}{s}) C,
\end{equation*}
显然\(\AutoTuple{\gamma}{n} \in V'\).
由\cref{theorem:线性映射.线性映射的存在性} 可知，
存在从\(V\)到\(V'\)的唯一一个线性映射\(\vb{C}\)，
使得\begin{equation*}
	\vb{C} \alpha_j = \gamma_j,
	\quad j=1,2,\dotsc,n,
\end{equation*}
于是\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P118 (8)
	\vb{C} (\AutoTuple{\alpha}{n})
	= (\AutoTuple{\gamma}{n})
	= (\AutoTuple{\beta}{s}) C.
\end{equation*}
上式表明，\(C\)是线性映射\(\vb{C}\)的矩阵，
因此\(\sigma(\vb{C}) = C\).
这说明\(\sigma\)既是满射，也是单射.
换言之，\(\sigma\)是双射.

下面验证\(\sigma\)可以保持加法与纯量乘法运算.

设\(\vb{A},\vb{B} \in \Hom(V,V'),
k \in F,
\sigma(\vb{A}) = A,
\sigma(\vb{B}) = B\).
由于\begin{align*}
	(\vb{A}+\vb{B}) (\AutoTuple{\alpha}{n})
	&= (\vb{A}\alpha_1+\vb{B}\alpha_1,\dotsc,\vb{A}\alpha_n+\vb{B}\alpha_n) \\
	&= (\AutoTuple{\vb{A}\alpha}{n}) + (\AutoTuple{\vb{B}\alpha}{n}) \\
	&= (\AutoTuple{\beta}{s}) A + (\AutoTuple{\beta}{s}) B \\
	&= (\AutoTuple{\beta}{s}) (A+B),
\end{align*}
所以线性映射\(\vb{A}+\vb{B}\)的矩阵是\(A+B\)，
从而\begin{equation*}
	\sigma(\vb{A}+\vb{B})
	= A+B
	= \sigma(\vb{A}) + \sigma(\vb{B}),
\end{equation*}
这表明\(\sigma\)保持加法运算.
由于\begin{align*}
	(k\vb{A}) (\AutoTuple{\alpha}{n})
	&= (\AutoTuple{k\vb{A}\alpha}{n}) \\
	&= k (\AutoTuple{\vb{A}\alpha}{n}) \\
	&= k ((\AutoTuple{\beta}{s}) A) \\
	&= (\AutoTuple{\beta}{s}) (kA),
\end{align*}
所以线性映射\(k\vb{A}\)的矩阵是\(kA\)，
从而\begin{equation*}
	\sigma(k\vb{A})
	= kA
	= k \sigma(\vb{A}),
\end{equation*}
这表明\(\sigma\)保持纯量乘法运算.

综上所述，
\(\sigma\)是从\(\Hom(V,V')\)到\(M_{s \times n}(F)\)的一个同构.
\end{proof}
\end{theorem}

\begin{corollary}\label{theorem:线性映射.线性映射空间与矩阵空间同构2}
%@see: 《高等代数（第三版 下册）》（丘维声） P119 推论2
设\(V\)是域\(F\)上的\(n\)维线性空间，
则\begin{gather}
%@see: 《高等代数（第三版 下册）》（丘维声） P119 (12)
	\Hom(V,V) \Isomorphism M_n(F), \\  % 同构
%@see: 《高等代数（第三版 下册）》（丘维声） P119 (13)
	\dim\Hom(V,V) = \left(\dim V\right)^2.
\end{gather}
\end{corollary}

%@see: 《高等代数（第三版 下册）》（丘维声） P119
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P91 3.81
在\(\Hom(V,V)\)与\(M_n(F)\)中，都有乘法运算.
我们可以进一步证明：
把线性变换\(\vb{A}\)对应到它在\(V\)的基\(\AutoTuple{\alpha}{n}\)下的矩阵\(A\)的映射\(\sigma\)还保持乘法运算.

设线性变换\(\vb{B}\)在\(V\)的基\(\AutoTuple{\alpha}{n}\)下的矩阵是\(B\).
由于\begin{align*}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (14)
	&\hspace{-20pt}
	(\vb{A}\vb{B})(\AutoTuple{\alpha}{n}) \\
	&=\vb{A}(\vb{B}\alpha_1,\dotsc,\vb{B}\alpha_n) \\
	&=\vb{A}[(\AutoTuple{\alpha}{n})B] \\
	&=\vb{A}(b_{11}\alpha_1+\dotsb+b_{n1}\alpha_n,\dotsc,b_{1n}\alpha_1+\dotsb+b_{nn}\alpha_n) \\
	&=(b_{11}\vb{A}\alpha_1+\dotsb+b_{n1}\vb{A}\alpha_n,\dotsc,b_{1n}\vb{A}\alpha_1+\dotsb+b_{nn}\vb{A}\alpha_n) \\
	&=(\vb{A}\alpha_1,\dotsc,\vb{A}\alpha_n)
		\begin{bmatrix}
			b_{11} & \dots & b_{1n} \\
			\vdots & & \vdots \\
			b_{n1} & \dots & b_{nn}
		\end{bmatrix} \\
	&=[\vb{A}(\AutoTuple{\alpha}{n})]B \\
	&=[(\AutoTuple{\alpha}{n})A]B \\
	&=((\AutoTuple{\alpha}{n}))(AB),
\end{align*}
所以\(\vb{A}\vb{B}\)在基\(\AutoTuple{\alpha}{n}\)下的矩阵是\(AB\).
那么\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (15)
	\sigma(\vb{A}\vb{B}) = AB = \sigma(\vb{A}) \sigma(\vb{B}).
\end{equation*}
这表明\(\sigma\)保持乘法运算.

从上述推导过程还可看到：\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (16)
	\vb{A}[(\AutoTuple{\alpha}{n})B]
	= [\vb{A}(\AutoTuple{\alpha}{n})]B.
\end{equation*}

显然，\(V\)上的恒等变换\(\vb{I}\)在基\(\AutoTuple{\alpha}{n}\)下的矩阵是单位矩阵\(I\)，
因此\(\sigma(\vb{I})=I\).

设\(V\)上线性变换\(\vb{A}\)在基\(\AutoTuple{\alpha}{n}\)下的矩阵是\(A\).
由于\begin{align*}
	&\text{线性变换$\vb{A}$可逆} \\
	&\iff \text{存在$V$上的线性变换$\vb{B}$使得$\vb{A}\vb{B}=\vb{B}\vb{A}=\vb{I}$} \\
	&\iff \text{存在$V$上的线性变换$\vb{B}$使得$\sigma(\vb{A}) \sigma(\vb{B}) = \sigma(\vb{B}) \sigma(\vb{A}) = \sigma(\vb{I})$} \\
	&\iff \text{存在域$F$上$n$阶矩阵$B$使得$AB=BA=I$} \\
	&\iff \text{矩阵$A$可逆},
\end{align*}
所以，\(V\)上线性变换\(\vb{A}\)可逆，
当且仅当它在\(V\)的一个基的矩阵\(A\)可逆.
从上述推导过程还可看到，
对于线性变换\(\vb{A},\vb{B}\)，
假设它们在\(V\)的一个基下的矩阵分别是\(A,B\)，
则\(\vb{B}\)是可逆线性变换\(\vb{A}\)的逆变换，
当且仅当\(B\)是可逆矩阵\(A\)的逆矩阵.

设\(\vb{A}\)是域\(F\)上\(n\)维线性空间\(V\)上的一个线性变换，
且\(\vb{A}\)在\(V\)的一个基\(\AutoTuple{\alpha}{n}\)下的矩阵是\(A\).
\(V\)中任一向量\(\alpha\)在基\(\AutoTuple{\alpha}{n}\)下的坐标记作\(X\).
由于\(\alpha=(\AutoTuple{\alpha}{n})X\)，
所以\begin{align*}
	\vb{A}\alpha
	&= \vb{A}[(\AutoTuple{\alpha}{n})X]
	= [\vb{A}(\AutoTuple{\alpha}{n})]X \\
	&= [(\AutoTuple{\alpha}{n})A]X
	= (\AutoTuple{\alpha}{n})(AX).
\end{align*}
这表明\(\vb{A}\alpha\)在基\(\AutoTuple{\alpha}{n}\)下的坐标是\(AX\)，
即\begin{equation*}
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P89 3.76
	\LinearMapMatrix(\vb{T}\alpha)
	= \LinearMapMatrix(\vb{T}) \VectorMatrix(\alpha).
\end{equation*}

由于\(V\)中两个向量相等，
当且仅当它们在\(V\)的一个基下的坐标相等，
因此，如果向量\(\gamma\)在基\(\AutoTuple{\alpha}{n}\)下的坐标是\(Y\)，
则\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (17)
	\vb{A}\alpha=\gamma
	\iff
	AX=Y.
\end{equation*}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P121 习题9.3 1.
设\(\vb{A}\)是\(K^3\)上的一个线性变换：\begin{equation*}
	\vb{A}
	\begin{bmatrix}
		x_1 \\ x_2 \\ x_3
	\end{bmatrix}
	= \begin{bmatrix}
		x_1 + 2x_2 \\
		x_3 - x_2 \\
		x_2 - x_3
	\end{bmatrix}.
\end{equation*}
求\(\vb{A}\)在标准基\(\AutoTuple{\epsilon}{3}\)下的矩阵.
\begin{solution}
注意到\begin{equation*}
	\begin{bmatrix}
		x_1 + 2x_2 \\
		x_3 - x_2 \\
		x_2 - x_3
	\end{bmatrix}
	= \begin{bmatrix}
		1 & 2 & 0 \\
		0 & -1 & 1 \\
		0 & 1 & -1
	\end{bmatrix}
	\begin{bmatrix}
		x_1 \\ x_2 \\ x_3
	\end{bmatrix},
\end{equation*}
于是\(\vb{A}\)在标准基\(\AutoTuple{\epsilon}{3}\)下的矩阵为\begin{equation*}
	A = \begin{bmatrix}
		1 & 2 & 0 \\
		0 & -1 & 1 \\
		0 & 1 & -1
	\end{bmatrix}.
\end{equation*}
\end{solution}
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P121 习题9.3 2.
在映射空间\(\mathbb{R}^\mathbb{R}\)中，
令\(V \defeq \Span\{f_1,f_2\}\)，
其中\(f_1(x) = e^{ax} \cos bx,
f_2(x) = e^{ax} \sin bx\).
%@Mathematica: f1[x_] := Exp[a x] Cos[b x]
%@Mathematica: f2[x_] := Exp[a x] Sin[b x]
证明求导数\(\vb{D}\)是\(V\)上的一个线性变换，
求\(\vb{D}\)在基\(f_1,f_2\)下的矩阵.
\begin{solution}
任取\(u,v \in V\)，
其中\(u = p_1 f_1 + p_2 f_2,
v = q_1 f_1 + q_2 f_2\)，
任取\(k \in \mathbb{R}\)，
则\begin{align*}
%@Mathematica: D[u[x] + v[x], x]
%@Mathematica: D[k u[x], x]
	\vb{D}(u + v)
	&= a e^{a x} p_1 \cos b x
		+ b e^{a x} p_2 \cos b x
		+ a e^{a x} q_1 \cos b x
		+ b e^{a x} q_2 \cos b x \\
	&\hspace{20pt}
		- b e^{a x} p_1 \sin b x
		+ a e^{a x} p_2 \sin b x
		- b e^{a x} q_1 \sin b x
		+ a e^{a x} q_2 \sin b x \\
	&= \vb{D}u + \vb{D}v, \\
	\vb{D}(k u)
	&= k (a e^{a x} p_1 \cos b x + b e^{a x} p_2 \cos b x -
		b e^{a x} p_1 \sin b x + a e^{a x} p_2 \sin b x) \\
	&= k \vb{D}u,
\end{align*}
这就说明\(\vb{D}\)是\(V\)上的线性变换.

因为\begin{gather*}
	\vb{D}f_1 = e^{ax} (a \cos bx - b \sin bx)
	= a f_1 - b f_2, \\
	\vb{D}f_2 = e^{ax} (a \sin bx + b \cos bx)
	= b f_1 + a f_2,
%@Mathematica: D[f1[x], x] // Factor
%@Mathematica: D[f2[x], x] // Factor
\end{gather*}
所以\(\vb{A}\)在基\(f_1,f_2\)下的矩阵为\begin{equation*}
	A = \begin{bmatrix}
		a & b \\
		-b & a
	\end{bmatrix}.
\end{equation*}
\end{solution}
\end{example}

\subsection{线性变换在不同基下的矩阵的关系}
域\(F\)上\(n\)维线性空间\(V\)上的一个线性变换\(\vb{A}\)在\(V\)的不同基下的矩阵有什么关系？

\begin{proposition}
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P92 3.82
设\(V\)是域\(F\)上\(n\)维线性空间，
\(V\)上的恒等变换\(\vb{I}\)在\(V\)的两个基
\(\AutoTuple{\alpha}{n}\)与\(\AutoTuple{\beta}{n}\)下的矩阵分别为\(A,B\)，
则\(A,B\)都是可逆矩阵，且\(A,B\)互为逆矩阵.
\end{proposition}

\begin{theorem}\label{theorem:线性映射的矩阵表示.线性变换在不同基下的矩阵相似}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 定理3
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P93 3.84
设\(V\)是域\(F\)上\(n\)维线性空间，
\(V\)上的一个线性变换\(\vb{A}\)在\(V\)的两个基
\(\AutoTuple{\alpha}{n}\)与\(\AutoTuple{\beta}{n}\)下的矩阵分别为\(A,B\).
从基\(\AutoTuple{\alpha}{n}\)到基\(\AutoTuple{\beta}{n}\)的过渡矩阵是\(S\)，
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (18)
则\(B = S^{-1} A S\).
\begin{proof}
由已知条件有\begin{gather*}
	\vb{A}(\AutoTuple{\alpha}{n})
	= (\AutoTuple{\alpha}{n}) A, \\
	\vb{A}(\AutoTuple{\beta}{n})
	= (\AutoTuple{\beta}{n}) B, \\
	\vb{A}(\AutoTuple{\beta}{n})
	= (\AutoTuple{\alpha}{n}) S,
\end{gather*}
于是\begin{align*}
	(\AutoTuple{\beta}{n}) S^{-1}
	&= ((\AutoTuple{\alpha}{n}) S) S^{-1} \\
	&= (\AutoTuple{\alpha}{n}) (S S^{-1}) \\
	&= (\AutoTuple{\alpha}{n}),
\end{align*}
从而\begin{align*}
%@see: 《高等代数（第三版 下册）》（丘维声） P120 (19)
	\vb{A}(\AutoTuple{\beta}{n})
	&= \vb{A}((\AutoTuple{\alpha}{n}) S) \\
	&= (\vb{A}(\AutoTuple{\alpha}{n})) S \\
	&= ((\AutoTuple{\alpha}{n}) A) S \\
	&= (\AutoTuple{\alpha}{n}) (A S) \\
	&= ((\AutoTuple{\beta}{n}) S^{-1}) (AS) \\
	&= (\AutoTuple{\beta}{n}) (S^{-1} A S).
\end{align*}
上式表明，\(\vb{A}\)在基\(\AutoTuple{\beta}{n}\)下的矩阵是\(S^{-1} A S\).
由于\(\vb{A}\)在基\(\AutoTuple{\beta}{n}\)下的矩阵是唯一的，
因此\(B = S^{-1} A S\).
\end{proof}
\end{theorem}
可以看出，同一个线性变换\(\vb{A}\)在\(V\)的不同基下的矩阵是相似的.
反之，我们有如下命题：
\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P121 命题4
如果域\(F\)上\(n\)阶矩阵\(A\)与\(B\)相似，
那么\(A\)与\(B\)可以看成是域\(F\)上\(n\)维线性空间\(V\)上的
一个线性变换\(\vb{A}\)在\(V\)的不同基下的矩阵.
\begin{proof}
由于\(A\)与\(B\)相似，
因此有可逆矩阵\(S\)，
使得\(B = S^{-1} A S\).
设\(V\)是域\(F\)上的\(n\)维线性空间，
在\(V\)中取一个基\(\AutoTuple{\alpha}{n}\).
从\cref{theorem:线性映射.线性映射空间与矩阵空间同构1} 的证明过程中可以看出，
存在\(V\)上唯一一个线性变换\(\vb{A}\)，
使得\(\vb{A}\)在\(V\)的基\(\AutoTuple{\alpha}{n}\)下的矩阵为\(A\).
令\begin{equation*}
	(\AutoTuple{\beta}{n}) = (\AutoTuple{\alpha}{n}) S.
\end{equation*}
由\cref{theorem:线性空间.命题14} 可知
\(\AutoTuple{\beta}{n}\)是\(V\)的一个基.
设\(\vb{A}\)在基\(\AutoTuple{\beta}{n}\)下的矩阵为\(C\)，
则根据\cref{theorem:线性映射的矩阵表示.线性变换在不同基下的矩阵相似} 得
\(C = S^{-1} A S\)，
从而\(C = B\).
因此\(\vb{A}\)在基\(\vb{A}\)在基\(\AutoTuple{\beta}{n}\)下的矩阵为\(B\).
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《Linear Algebra Done Right (Fourth Eidition)》（Sheldon Axler） P93 3.86
设\(V\)是域\(F\)上\(n\)维线性空间，
\(\vb{A}\)是\(V\)上的一个可逆线性变换，
\(\AutoTuple{\alpha}{n}\)的一个基，
则\(\vb{A}\)的逆\(\vb{A}^{-1}\)的矩阵
就是\(\vb{A}\)的矩阵的逆，
即\begin{equation*}
	\LinearMapMatrix(\vb{A}^{-1})
	= (\LinearMapMatrix(\vb{A}))^{-1}.
\end{equation*}
\end{proposition}
