\section{广义逆矩阵}
对于线性方程组\(\vb{A}\vb{x}=\vb\beta\)，如果\(\vb{A}\)可逆，那么它有\(\vb{x}=\vb{A}^{-1}\vb\beta\).
如果\(\vb{A}\)不可逆，但\(\vb{A}\vb{x}=\vb\beta\)有解，那么它的解是否也可表达为类似的简洁公式呢？
我们接下来带着这个问题，开始对\(\vb{A}^{-1}\)的性质的分析.

如果\(\vb{A}\)可逆，那么\(\vb{A}\vb{A}^{-1}=\vb{E}\).
显然，只要在等式两端同时右乘\(\vb{A}\)，便得\(\vb{A}\vb{A}^{-1}\vb{A}=\vb{A}\).
这就表明：当\(\vb{A}\)可逆时，\(\vb{A}^{-1}\)是矩阵方程\(\vb{A} \vb{X} \vb{A} = \vb{A}\)的一个解.
受此启发，当\(\vb{A}\)不可逆时，为了找到\(\vb{A}^{-1}\)的替代物，应当去找矩阵方程\(\vb{A} \vb{X} \vb{A} = \vb{A}\)的解.

\begin{theorem}[广义逆存在定理]\label{theorem:线性方程组.广义逆1}
设\(\vb{A}\)是数域\(K\)上的\(s \times n\)非零矩阵，
则矩阵方程\begin{equation}\label{equation:线性方程组.广义逆1矩阵方程}
	\vb{A} \vb{X} \vb{A} = \vb{A}
\end{equation}一定有解.
如果\(\rank\vb{A}=r\)，并且\[
	\vb{A}
	= \vb{P}
	\begin{bmatrix}
		\vb{E}_r & \vb0 \\
		\vb0 & \vb0
	\end{bmatrix}
	\vb{Q},
\]
其中\(\vb{P},\vb{Q}\)分别是\(K\)上\(s\)阶、\(n\)阶可逆矩阵，
那么矩阵方程 \labelcref{equation:线性方程组.广义逆1矩阵方程} 的通解为
\begin{equation}\label{equation:线性方程组.广义逆1矩阵方程的通解}
	\vb{X} = \vb{Q}^{-1} \begin{bmatrix} \vb{E}_r & \vb{B} \\ \vb{C} & \vb{D} \end{bmatrix} \vb{P}^{-1},
\end{equation}
其中\(\vb{B}\in M_{r\times(s-r)}(K),
\vb{C}\in M_{(n-r)\times r}(K),
\vb{D}\in M_{(n-r)\times(s-r)}(K)\).
\end{theorem}

\begin{definition}
设\(\vb{A}\)是数域\(K\)上的\(s \times n\)矩阵，
矩阵方程\(\vb{A} \vb{X} \vb{A} = \vb{A}\)的每一个解都称为
“\(\vb{A}\)的一个\DefineConcept{广义逆矩阵}（generalized inverse）”，
简称“\(\vb{A}\)的广义逆”，记作\(\vb{A}^-\).
\end{definition}

\begin{property}\label{theorem:线性方程组.广义逆的性质1}
广义逆满足以下性质：\begin{gather}
	\vb{A}\vb{A}^-\vb{A}=\vb{A}, \\
	\vb{A}^-\vb{A}\vb{A}^-=\vb{A}^-, \\
	(\vb{A}\vb{A}^-)^H=\vb{A}\vb{A}^-, \\
	(\vb{A}^-\vb{A})^H=\vb{A}^-\vb{A}.
\end{gather}
\end{property}

\begin{property}\label{theorem:线性方程组.广义逆的性质2}
任意一个\(n \times s\)矩阵都是\(\vb0_{s \times n}\)的广义逆.
\end{property}

\begin{theorem}[非齐次线性方程组的相容性定理]\label{theorem:线性方程组.非齐次线性方程组的相容性定理}
非齐次线性方程组\(\vb{A} \vb{X} = \vb\beta\)有解的充分必要条件是
\(\vb\beta = \vb{A} \vb{A}^- \vb\beta\).
\begin{proof}
必要性.
设\(\vb\alpha\)是\(\vb{A} \vb{X} = \vb\beta\)的一个解，
则\[
	\vb\beta
	= \vb{A} \vb\alpha
	= (\vb{A} \vb{A}^- \vb{A}) \vb\alpha
	= \vb{A} \vb{A}^- \vb\beta.
\]

充分性.
设\(\vb\beta = \vb{A} \vb{A}^- \vb\beta\)，
则\(\vb{A}^- \vb\beta\)是\(\vb{A} \vb{X} = \vb\beta\)的解.
\end{proof}
\end{theorem}

\begin{theorem}[非齐次线性方程组的解的结构定理]\label{theorem:线性方程组.非齐次线性方程组的解的结构定理}
非齐次线性方程组\(\vb{A} \vb{X} = \vb\beta\)有解时，
它的通解为\begin{equation}\label{equation:线性方程组.非齐次线性方程组的通解1}
	\vb{X} = \vb{A}^- \vb\beta.
\end{equation}
\end{theorem}
从\cref{theorem:线性方程组.非齐次线性方程组的解的结构定理} 看出，
任意非齐次线性方程组\(\vb{A} \vb{X} = \vb\beta\)有解时，
它的通解有简洁漂亮的形式 \labelcref{equation:线性方程组.非齐次线性方程组的通解1}.

\begin{theorem}[齐次线性方程组的解的结构定理]\label{theorem:线性方程组.齐次线性方程组的解的结构定理}
数域\(K\)上\(n\)元齐次线性方程组\(\vb{A}\vb{X}=\vb0\)的通解为\begin{equation}\label{equation:线性方程组.齐次线性方程组的通解}
	\vb{X}=(\vb{E}_n - \vb{A}^- \vb{A}) \vb{Z},
\end{equation}
其中\(\vb{A}^-\)是\(\vb{A}\)的任意给定的一个广义逆，
\(\vb{Z}\)取遍\(K^n\)中任意列向量.
\end{theorem}

\begin{corollary}\label{theorem:线性方程组.齐次线性方程组的解的结构定理.推论1}
设数域\(K\)上\(n\)元非齐次线性方程组\(\vb{A} \vb{X} = \vb\beta\)有解，则它的通解为\begin{equation}\label{equation:线性方程组.非齐次线性方程组的通解2}
	\vb{X} = \vb{A}^- \vb\beta + (\vb{E}_n - \vb{A}^- \vb{A}) \vb{Z},
\end{equation}
其中\(\vb{A}^-\)是\(\vb{A}\)的任意给定的一个广义逆，\(\vb{Z}\)取遍\(K^n\)中任意列向量.
\end{corollary}

一般情况下，矩阵方程\(\vb{A} \vb{X} \vb{A} = \vb{A}\)的解不唯一，从而\(\vb{A}\)的广义逆不唯一.
但是我们有时候希望\(\vb{A}\)的满足特殊条件的广义逆是唯一的，这就引出以下概念：
\begin{definition}
设\(\vb{A} \in M_{s \times n}(\mathbb{C})\).
关于矩阵\(\vb{X}\)的矩阵方程组\begin{equation}\label{equation:线性方程组.彭罗斯方程组}
	\begin{cases}
		\vb{A} \vb{X} \vb{A} = \vb{A}, \\
		\vb{X}\vb{A}\vb{X}=\vb{X}, \\
		(\vb{A}\vb{X})^H = \vb{A}\vb{X}, \\
		(\vb{X}\vb{A})^H = \vb{X}\vb{A}
	\end{cases}
\end{equation}
称为\(\vb{A}\)的\DefineConcept{彭罗斯方程组}，
它的解称为\(\vb{A}\)的\DefineConcept{穆尔--彭罗斯广义逆}，记作\(\vb{A}^+\).
%@see: https://mathworld.wolfram.com/Moore-PenroseMatrixInverse.html
\end{definition}

\begin{theorem}[穆尔--彭罗斯广义逆的唯一性]\label{theorem:线性方程组.穆尔--彭罗斯广义逆的唯一性}
如果\(\vb{A} \in M_{s \times n}(\mathbb{C})\)，则\(\vb{A}\)的彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 总是有解，并且它的解唯一.

设\(\vb{A}=\vb{B}\vb{C}\)，其中\(\vb{B}\)、\(\vb{C}\)分别是列满秩矩阵、行满秩矩阵，则方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的唯一解是
\begin{equation}\label{equation:线性方程组.彭罗斯方程组的唯一解}
	\vb{X} = \vb{C}^H (\vb{C} \vb{C}^H)^{-1} (\vb{B}^H \vb{B})^{-1} \vb{B}^H.
\end{equation}
\begin{proof}
首先考虑\(\vb{A}\neq\vb0\).
把\cref{equation:线性方程组.彭罗斯方程组的唯一解}
代入彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的每一个方程，
不难验证每一个方程都将变成恒等式\footnote{由于\(\rank(\vb{C}\vb{C}^H)=\rank\vb{C}=r\)，
所以\(\vb{C}\vb{C}^H\)是\(r\)阶满秩矩阵，可逆；
同理\(\vb{B}^H\vb{B}\)也可逆.}，
由此可知\cref{equation:线性方程组.彭罗斯方程组的唯一解} 的确是
彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解.

要证明这种广义逆的唯一性，
先设\(\vb{X}_1\)和\(\vb{X}_2\)都是
彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解，
则\begin{align*}
	\vb{X}_1
	&= \vb{X}_1\vb{A}\vb{X}_1
	= \vb{X}_1(\vb{A}\vb{X}_2\vb{A})\vb{X}_1
	= \vb{X}_1(\vb{A}\vb{X}_2)(\vb{A}\vb{X}_1)
	= \vb{X}_1(\vb{A}\vb{X}_2)^H(\vb{A}\vb{X}_1)^H \\
	&= \vb{X}_1(\vb{A}\vb{X}_1\vb{A}\vb{X}_2)^H
	= \vb{X}_1(\vb{A}\vb{X}_2)^H
	= \vb{X}_1\vb{A}\vb{X}_2
	= \vb{X}_1(\vb{A}\vb{X}_2\vb{A})\vb{X}_2 \\
	&= (\vb{X}_1\vb{A})(\vb{X}_2\vb{A})\vb{X}_2
	= (\vb{X}_1\vb{A})^H(\vb{X}_2\vb{A})^H\vb{X}_2
	= (\vb{X}_2\vb{A}\vb{X}_1\vb{A})^H \vb{X}_2 \\
	&= (\vb{X}_2\vb{A})^H \vb{X}_2
	= \vb{X}_2\vb{A}\vb{X}_2
	= \vb{X}_2.
\end{align*}
这就证明了彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解的唯一性.

现在考虑\(\vb{A}=\vb0\).
设\(\vb{X}_0\)是零矩阵\(\vb0\)的穆尔--彭罗斯广义逆，
则\[
	\vb{X}_0 = \vb{X}_0 \vb0 \vb{X}_0 = \vb0.
\]
显然\(\vb0\)是零矩阵的彭罗斯方程组的解，因此零矩阵的穆尔--彭罗斯广义逆是零矩阵本身.

综上，对任意复矩阵\(\vb{A}\)，它的穆尔--彭罗斯广义逆存在且唯一.
\end{proof}
\end{theorem}
