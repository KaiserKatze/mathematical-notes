\section{广义逆矩阵}
对于线性方程组\(\A\x=\b\)，如果\(\A\)可逆，那么它有\(\x=\A^{-1}\b\).
如果\(\A\)不可逆，但\(\A\x=\b\)有解，那么它的解是否也可表达为类似的简洁公式呢？
我们接下来带着这个问题，开始对\(\A^{-1}\)的性质的分析.

如果\(\A\)可逆，那么\(\A\A^{-1}=\E\).
显然，只要在等式两端同时右乘\(\A\)，便得\(\A\A^{-1}\A=\A\).
这就表明：当\(\A\)可逆时，\(\A^{-1}\)是矩阵方程\(\A\x\A=\A\)的一个解.
受此启发，当\(\A\)不可逆时，为了找到\(\A^{-1}\)的替代物，应当去找矩阵方程\(\A\x\A=\A\)的解.

\begin{theorem}[广义逆存在定理]\label{theorem:线性方程组.广义逆1}
设\(\A\)是数域\(K\)上的\(s \times n\)非零矩阵，
则矩阵方程
\begin{equation}\label{equation:线性方程组.广义逆1矩阵方程}
	\A\x\A = \A
\end{equation}一定有解.
如果\(\rank\A=r\)，并且\[
\A = \P \begin{bmatrix} \E_r & \z \\ \z & \z \end{bmatrix} \Q,
\]其中\(\P,\Q\)分别是\(K\)上\(s\)阶、\(n\)阶可逆矩阵，
那么矩阵方程 \labelcref{equation:线性方程组.广义逆1矩阵方程} 的通解为
\begin{equation}\label{equation:线性方程组.广义逆1矩阵方程的通解}
	\x = \Q^{-1} \begin{bmatrix} \E_r & \B \\ \C & \D \end{bmatrix} \P^{-1},
\end{equation}
其中\(\B\in M_{r\times(s-r)}(K),
\C\in M_{(n-r)\times r}(K),
\D\in M_{(n-r)\times(s-r)}(K)\).
\end{theorem}

\begin{definition}
设\(\A\)是数域\(K\)上的\(s \times n\)矩阵，
矩阵方程\(\A\x\A = \A\)的每一个解都称为
“\(\A\)的一个\DefineConcept{广义逆矩阵}（generalized inverse）”，
简称“\(\A\)的广义逆”，记作\(\A^-\).
\end{definition}

\begin{property}\label{theorem:线性方程组.广义逆的性质1}
广义逆满足以下性质：
\begin{enumerate}
	\item \(\A\A^-\A=\A\).
	\item \(\A^-\A\A^-=\A^-\).
	\item \((\A\A^-)^H=\A\A^-\).
	\item \((\A^-\A)^H=\A^-\A\).
\end{enumerate}
\end{property}

\begin{property}\label{theorem:线性方程组.广义逆的性质2}
任意一个\(n \times s\)矩阵都是\(\z_{s \times n}\)的广义逆.
\end{property}

\begin{theorem}[非齐次线性方程组的相容性定理]\label{theorem:线性方程组.非齐次线性方程组的相容性定理}
非齐次线性方程组\(\A\x=\b\)有解的充要条件是\(\b=\A\A^-\b\).
\begin{proof}
必要性.设\(\a\)是\(\A\x=\b\)的一个解，则\[
\b = \A\a = (\A\A^-\A)\a = \A\A^-\b.
\]

充分性.设\(\b=\A\A^-\b\)，则\(\A^-\b\)是\(\A\x=\b\)的解.
\end{proof}
\end{theorem}

\begin{theorem}[非齐次线性方程组的解的结构定理]\label{theorem:线性方程组.非齐次线性方程组的解的结构定理}
非齐次线性方程组\(\A\x=\b\)有解时，它的通解为\begin{equation}\label{equation:线性方程组.非齐次线性方程组的通解1}
\x=\A^-\b.
\end{equation}
\end{theorem}
从\cref{theorem:线性方程组.非齐次线性方程组的解的结构定理} 看出，任意非齐次线性方程组\(\A\x=\b\)有解时，它的通解有简洁漂亮的形式 \labelcref{equation:线性方程组.非齐次线性方程组的通解1}.

\begin{theorem}[齐次线性方程组的解的结构定理]\label{theorem:线性方程组.齐次线性方程组的解的结构定理}
数域\(K\)上\(n\)元齐次线性方程组\(\A\x=\z\)的通解为\begin{equation}\label{equation:线性方程组.齐次线性方程组的通解}
\x=(\E_n - \A^- \A) \vb{Z},
\end{equation}
其中\(\A^-\)是\(\A\)的任意给定的一个广义逆，
\(\vb{Z}\)取遍\(K^n\)中任意列向量.
\end{theorem}

\begin{corollary}\label{theorem:线性方程组.齐次线性方程组的解的结构定理.推论1}
设数域\(K\)上\(n\)元非齐次线性方程组\(\A\x=\b\)有解，则它的通解为\begin{equation}\label{equation:线性方程组.非齐次线性方程组的通解2}
\x = \A^-\b + (\E_n - \A^- \A) \vb{Z},
\end{equation}
其中\(\A^-\)是\(\A\)的任意给定的一个广义逆，\(\vb{Z}\)取遍\(K^n\)中任意列向量.
\end{corollary}

一般情况下，矩阵方程\(\A\x\A=\A\)的解不唯一，从而\(\A\)的广义逆不唯一.
但是我们有时候希望\(\A\)的满足特殊条件的广义逆是唯一的，这就引出以下概念：
\begin{definition}
设\(\A \in M_{s \times n}(\mathbb{C})\).
关于矩阵\(\x\)的矩阵方程组\begin{equation}\label{equation:线性方程组.彭罗斯方程组}
	\begin{cases}
		\A\x\A=\A, \\
		\x\A\x=\x, \\
		(\A\x)^H = \A\x, \\
		(\x\A)^H = \x\A
	\end{cases}
\end{equation}
称为\(\A\)的\DefineConcept{彭罗斯方程组}，
它的解称为\(\A\)的\DefineConcept{穆尔--彭罗斯广义逆}，记作\(\A^+\).
%@see: https://mathworld.wolfram.com/Moore-PenroseMatrixInverse.html
\end{definition}

\begin{theorem}[穆尔--彭罗斯广义逆的唯一性]\label{theorem:线性方程组.穆尔--彭罗斯广义逆的唯一性}
如果\(\A \in M_{s \times n}(\mathbb{C})\)，则\(\A\)的彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 总是有解，并且它的解唯一.

设\(\A=\B\C\)，其中\(\B\)、\(\C\)分别是列满秩矩阵、行满秩矩阵，则方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的唯一解是
\begin{equation}\label{equation:线性方程组.彭罗斯方程组的唯一解}
\x = \C^H (\C \C^H)^{-1} (\B^H \B)^{-1} \B^H.
\end{equation}
\begin{proof}
首先考虑\(\A\neq\z\).
把\cref{equation:线性方程组.彭罗斯方程组的唯一解} 代入彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的每一个方程，不难验证每一个方程都将变成恒等式\footnote{由于\(\rank(\C\C^H)=\rank\C=r\)，所以\(\C\C^H\)是\(r\)阶满秩矩阵，可逆；同理\(\B^H\B\)也可逆.}，由此可知\cref{equation:线性方程组.彭罗斯方程组的唯一解} 的确是彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解.

要证明这种广义逆的唯一性，先设\(\X1\)和\(\X2\)都是彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解，则\begin{align*}
\X1
&= \X1\A\X1
= \X1(\A\X2\A)\X1
= \X1(\A\X2)(\A\X1)
= \X1(\A\X2)^H(\A\X1)^H \\
&= \X1(\A\X1\A\X2)^H
= \X1(\A\X2)^H
= \X1\A\X2
= \X1(\A\X2\A)\X2 \\
&= (\X1\A)(\X2\A)\X2
= (\X1\A)^H(\X2\A)^H\X2
= (\X2\A\X1\A)^H \X2 \\
&= (\X2\A)^H \X2
= \X2\A\X2
= \X2.
\end{align*}
这就证明了彭罗斯方程组 \labelcref{equation:线性方程组.彭罗斯方程组} 的解的唯一性.

现在考虑\(\A=\z\).
设\(\X0\)是零矩阵\(\z\)的穆尔--彭罗斯广义逆，则\[
\X0 = \X0 \z \X0 = \z.
\]显然\(\z\)是零矩阵的彭罗斯方程组的解，因此零矩阵的穆尔--彭罗斯广义逆是零矩阵本身.

综上，对任意复矩阵\(\A\)，它的穆尔--彭罗斯广义逆存在且唯一.
\end{proof}
\end{theorem}
