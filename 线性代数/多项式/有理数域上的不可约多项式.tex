\section{有理数域上的不可约多项式}
这一节讨论有理数域上的不可约多项式有哪些，
如何判别一个有理系数多项式是否不可约.
这些问题的回答比复系数多项式和实系数多项式困难得多.

在\cref{section:多项式.多项式的根}的开头，
我们曾指出，
在\(K[x]\)中，
如果一个次数大于1的多项式\(p(x)\)不可约，
则\(p(x)\)没有一次因式，
从而\(p(x)\)在\(K\)中没有根，
这样就可以缩小讨论\(\mathbb{Q}[x]\)中不可约多项式的范围.
那么如何判别\(\mathbb{Q}[x]\)中次数大于1的多项式\(f(x)\)有没有有理根呢？
显然\(f(x)\)有有理根当且仅当\(f(x)\)在\(\mathbb{Q}[x]\)中的相伴元也有有理根.
因此很自然地选取\(f(x)\)在\(\mathbb{Q}[x]\)中的一个最简单的相伴元来研究.
例如，设\(f(x)=\frac12x^4+\frac13x^3-2x+1\)，
则\(g(x)=3x^4+2x^3-12x+6\)就是\(f(x)\)的一个相伴元.
注意到\(g(x)\)是整系数多项式，
而它的各项系数的最大公因数只有\(\pm1\).
受此启发，我们可以给出如下概念.

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P42 定义1
一个非零的整系数多项式\[
	g(x)=b_n x^n+\dotsb+b_1 x+b_0,
\]
如果它的各项系数的最大公因数只有\(\pm1\)，
则称“\(g(x)\)是\DefineConcept{本原的}”
或“\(g(x)\)是一个\DefineConcept{本原多项式}”.
\end{definition}

\begin{proposition}
任一非零的有理系数多项式都与一个本原多项式相伴.
\begin{proof}
只需求出有理系数多项式\[
	f(x)=a_n x^n+\dotsb+a_1 x+a_0
\]的各项系数的分母的最小公倍数\(m\)，
提取公因数\(\frac1m\)得到\[
	f(x)=\frac1m(m a_n x^n+\dotsb+m a_1 x+m a_0);
\]
接着求出括号内多项式的各项系数的最大公因数\(c\)，
就有\[
	f(x)=\frac{c}{m}(b_n x^n+\dotsb+b_1 x+b_0),
\]
其中\(b_i=\frac{m a_i}{c}\ (i=0,1,\dotsc,n)\)，
\(g(x)=b_n x^n+\dotsb+b_1 x+b_0\)就是与\(f(x)\)相伴的本原多项式.
\end{proof}
\end{proposition}

我们不禁想要知道，
一个非零的有理系数多项式
可以与几个本原多项式相伴？

\begin{lemma}\label{theorem:多项式.有理数域上的不可约多项式.引理1}
%@see: 《高等代数（第三版 下册）》（丘维声） P42 引理1
两个本原多项式\(f(x)\)和\(g(x)\)在\(Q[x]\)中相伴
当且仅当\(f(x)=\pm g(x)\).
\begin{proof}
充分性是显然的.
下面证必要性.
设\(f(x),g(x)\)是相伴的本原多项式，
则存在\(r\in\mathbb{Q}-\{0\}\)，
使得\(f(x)=r g(x)\).
设\[
	f(x)=\sum_{i=0}^n a_i x^i, \qquad
	g(x)=\sum_{i=0}^n b_i x^i,
\]
其中\(a_i,b_i\in\mathbb{Z}\ (i=0,1,\dotsc,n)\).
假设\(r\neq\pm1\)，
不妨设\(r=\frac{q}{p}\)，
其中\((p,q)=1\).
于是\(p,q\)两者中至少有一个不等于\(\pm1\).
不妨设\(p\neq\pm1\)，
从而有\(p f(x)=q g(x)\).
比较各项系数可知\(p a_i=q b_i\ (i=0,1,\dotsc,n)\).
于是\(p \mid q b_i\).
因为\((p,q)=1\)，
所以根据\cref{theorem:多项式.互素.性质1}
有\(p \mid b_i\)，
这与“\(g(x)\)是本原多项式”矛盾.
因此\(r=\pm1\)，
\(f(x)=\pm g(x)\).
\end{proof}
\end{lemma}

\cref{theorem:多项式.有理数域上的不可约多项式.引理1}
告诉我们，对于一个非零的有理系数多项式\(f(x)\)，
与它在\(\mathbb{Q}[x]\)中相伴的本原多项式有且仅有两个，
它们相差一个正负号.
现在我们来研究本原多项式在\(\mathbb{Q}[x]\)中的不可约性问题.
为此首先介绍本原多项式的一个重要性质.

\begin{lemma}[高斯引理]\label{theorem:多项式.有理数域上的不可约多项式.引理2}
%@see: 《高等代数（第三版 下册）》（丘维声） P43 引理2
两个本原多项式的乘积还是本原多项式.
\begin{proof}
设\(
	f(x)=\sum_{i=0}^n a_i x^i,
	g(x)=\sum_{i=0}^n b_i x^i
\)是两个本原多项式，
又设\(
	h(x) = f(x) g(x) = \sum_{i=0}^{n+m} c_i x^i
\)，
其中\(c_k=\sum_{i+j=k} a_i b_j\ (k=0,1,\dotsc,n+m)\).

假如\(h(x)\)不是本原多项式，
那么存在一个素数\(p\)，
使得\(p\)是\(h(x)\)各项系数的公因式，
即\(p \mid c_k\ (k=0,1,\dotsc,n+m)\).
因为\(f(x)\)是本原的，
所以\(p\)不能同时整除\(f(x)\)的各项系数，
也就是说，存在\(k\ (0\leq k\leq n)\)满足\[
	p \mid a_0,
	p \mid a_1,
	\dotsc
	p \mid a_{k-1},
	p \nmid a_k.
	\eqno(1)
\]
同理，存在\(l\ (0\leq l\leq m)\)满足\[
	p \mid b_0,
	p \mid b_1,
	\dotsc
	p \mid b_{l-1},
	p \nmid b_l.
	\eqno(2)
\]

考虑\(h(x)\)的\(k+l\)次项的系数\[
	c_{k+l}
	= a_{k+l} b_0
	+ a_{k+l-1} b_1
	+ \dotsb
	+ a_1 b_{k+l-1}
	+ a_0 b_{k+l}.
\]
由(1)(2)两式可知\(p \nmid c_{k+l}\)
（注意从\(p \nmid a_k\)且\(p \nmid b_l\)
可以推出\(p \nmid a_k b_l\)），矛盾！
因此\(h(x)\)是本原多项式.
\end{proof}
\end{lemma}

\begin{theorem}\label{theorem:多项式.有理数域上的不可约多项式.本原多项式的分解}
%@see: 《高等代数（第三版 下册）》（丘维声） P43 定理1
一个次数大于零的本原多项式\(g(x)\)在\(\mathbb{Q}\)可约
当且仅当\(g(x)\)可以分解成两个次数都比\(g(x)\)的次数低的本原多项式的乘积.
\begin{proof}
充分性是显然的.
下面证必要性.

设本原多项式\(g(x)\)在\(\mathbb{Q}\)上可约，
则存在\(g_1(x),g_2(x)\in\mathbb{Q}[x]\)，
使得\(g(x) = g_1(x) g_2(x)\)，
其中\(\deg g_1(x) < \deg g(x)\)，
\(\deg g_2(x) < \deg g(x)\).
设\(g_i(x)=r_i h_i(x)\ (i=1,2)\)，
其中\(r_1,r_2\in\mathbb{Q}^*\)，
而\(h_1(x),h_2(x)\)是本原多项式，
则\[
	g(x) = r_1 r_2 h_1(x) h_2(x).
\]
由于根据\cref{theorem:多项式.有理数域上的不可约多项式.引理2}
两个本原多项式的乘积\(h_1(x) h_2(x)\)也是本原多项式，
因此根据\cref{theorem:多项式.有理数域上的不可约多项式.引理1}
有\(r_1 r_2 = \pm1\).
从而\(g(x)=[\pm h_1(x)]\cdot h_2(x)\).
由于\(\deg(\pm h_1(x))
= \deg g_1(x)
< \deg g(x)\)，
\(\deg h_2(x)
= \deg g_2(x)
< \deg g(x)\)，
因此\(g(x)\)分解成了两个次数较低的本原多项式的乘积.
\end{proof}
\end{theorem}

\begin{corollary}\label{theorem:多项式.有理数域上的不可约多项式.本原多项式的分解.推论}
%@see: 《高等代数（第三版 下册）》（丘维声） P43 推论2
如果一个次数大于零的整系数多项式在\(\mathbb{Q}\)上可约，
则它可以分解成两个次数比它低的整系数多项式的乘积.
\begin{proof}
设\(f(x)\)是一个次数大于零的整系数多项式，
在\(\mathbb{Q}\)上可约，
则\(f(x)= r g(x)\)，
其中\(r\in\mathbb{Z}^*\)，
\(g(x)\)是本原多项式.
根据\cref{theorem:多项式.有理数域上的不可约多项式.本原多项式的分解}
可知\(g(x)\)可以分解为\(h_1(x),h_2(x)\)
这两个次数都比\(g(x)\)的次数低的本原多项式，
即\(g(x)=h_1(x) h_2(x)\)，
从而\(f(x)=[r h_1(x)] h_2(x)\).
这表明\(f(x)\)分解成了两个次数较低的整系数多项式的乘积.
\end{proof}
\end{corollary}

\begin{theorem}\label{theorem:多项式.有理数域上的不可约多项式.高次本原多项式可唯一分解为不可约本原多项式的乘积}
%@see: 《高等代数（第三版 下册）》（丘维声） P44 定理3
每一个次数大于零的本原多项式\(g(x)\)
可以唯一地分解成\(\mathbb{Q}\)上不可约的本原多项式的乘积.
\begin{proof}
设\(g(x)\)是一个次数大于零的本原多项式.

先证可分解性.
对本原多项式的次数\(n\)作数学归纳法.
当\(n=1\)时，
显然有\(g(x)=g(x)\)，
且\(g(x)\)不可约.
假设任一次数小于\(n\)的本原多项式
都可以分解成\(\mathbb{Q}\)上不可约的本原多项式的乘积.
现在来看\(n\)次本原多项式\(g(x)\).
如果\(g(x)\)在\(\mathbb{Q}\)上不可约，
则\(g(x)=g(x)\)，
可分解性成立.
如果\(g(x)\)在\(\mathbb{Q}\)上可约，
那么根据\cref{theorem:多项式.有理数域上的不可约多项式.本原多项式的分解} 得，
\(g(x)=g_1(x) g_2(x)\)，
其中\(g_1(x),g_2(x)\)是本原多项式，
且\(\deg g_1(x) < \deg g(x),
\deg g_2(x) < \deg g(x)\)，
可分解性也成立.

再证唯一性.
根据\(\mathbb{Q}[x]\)的\hyperref[theorem:多项式.唯一因式分解定理]{唯一因式分解定理}得，
\(s=t\)，
且只要适当排列因式次序
就有\(p_i(x) \sim q_i(x)\ (i=1,2,\dotsc,s)\).
由于\(p_i(x),q_i(x)\)都是本原多项式，
因此\(p_i(x)=\pm q_i(x)\ (i=1,2,\dotsc,s)\).
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:多项式.有理数域上的不可约多项式.正次整系数多项式的有理根的分子分母分别整除常数项和首项系数}
%@see: 《高等代数（第三版 下册）》（丘维声） P44 定理4
设\(f(x)=a_n x^n+a_{n-1} x^{n-1}+\dotsb+a_1 x+a_0\)
是一个次数\(n\)大于零的整系数多项式.
如果\(\frac{q}{p}\)是\(f(x)\)的一个有理根，
其中\(p,q\)是互素的整数，
那么\(p \mid a_n,
q \mid a_0\).
\begin{proof}
设\(f(x)=r f_1(x)\)，
其中\(r\in\mathbb{Z}^*\)，
\(f_1(x)\)是本原多项式.
又设\(\frac{q}{p}\)是\(f(x)\)的一个根，
其中\(p,q\)是互素的整数，
则\(\frac{q}{p}\)是\(f_1(x)\)的一个根.
于是在\(\mathbb{Q}[x]\)中，
有\(\left(x-\frac{q}{p}\right) \mid f_1(x)\)，
从而\((px-q) \mid f_1(x)\).
由于\((p,q)=1\)，
因此\(px-q\)是本原多项式.
根据\cref{theorem:多项式.有理数域上的不可约多项式.高次本原多项式可唯一分解为不可约本原多项式的乘积}
和\hyperref[theorem:多项式.有理数域上的不可约多项式.引理2]{高斯引理}得\[
	f_1(x)=(px-q) g(x),
\]
其中\(g(x)=b_{n-1} x^{n-1}+\dotsb+b_1 x+b_0\)是本原多项式.
于是\[
	f(x)=r(px-q) g(x).
\]
分别比较上式等号两边的首项系数与常数项，得\[
	a_n = r p b_{n-1}, \qquad
	a_0 = -r q b_0.
\]
因此\(p \mid a_n,
q \mid a_0\).
\end{proof}
\end{theorem}

\cref{theorem:多项式.有理数域上的不可约多项式.正次整系数多项式的有理根的分子分母分别整除常数项和首项系数}
的证明过程表明，
如果由互素整数\(p,q\)构成的\(\frac{q}{p}\)是\(f(x)\)的一个有理根，
则存在一个整系数多项式\(g(x)\)
使得\(f(x)=(px-q) g(x)\).
于是\[
	f(1)=(p-q) g(1), \qquad
	f(-1)=-(p+1) g(-1).
\]
当\(\frac{q}{p}\neq\pm1\)时，
有\[
	\frac{f(1)}{p-q}=g(1)\in\mathbb{Z}, \qquad
	\frac{f(-1)}{p+q}=-g(-1)\in\mathbb{Z}.
\]
因此，如果计算出
\(\frac{f(1)}{p-q}\notin\mathbb{Z}\)
或\(\frac{f(-1)}{p+q}\notin\mathbb{Z}\)，
那么可以断言\(\frac{q}{p}\)不是\(f(x)\)的根.
这个判断方法在求整系数多项式的有理根时有用.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P45 例1
判断\(f(x)=x^3+x+1\)在有理数域上是否不可约.
\begin{solution}
如果\(f(x)\)在\(\mathbb{Q}\)上可约，
则\(f(x)\)可以分解成两个次数较低的有理系数多项式的乘积.
由于\(\deg f(x)=3\)，
因此\(f(x)\)在\(\mathbb{Q}[x]\)中必有一次因式，
从而\(f(x)\)必有有理根.
由于\(a_3=1,a_0=1\)，
因此根据\cref{theorem:多项式.有理数域上的不可约多项式.正次整系数多项式的有理根的分子分母分别整除常数项和首项系数}，
\(f(x)\)的有理根只可能是\(\pm1\).
但是\(f(1)=3,
f(-1)=-1\).
因此\(\pm1\)都不是\(f(x)\)的根.
这个矛盾表明\(f(x)\)在\(\mathbb{Q}\)上不可约.
\end{solution}
\end{example}

\begin{remark}
如果整系数多项式\(f(x)\)的次数大于3，
那么不能从“\(f(x)\)没有有理根”
便得出\(f(x)\)在\(\mathbb{Q}\)上不可约的结论.
这是因为“\(f(x)\)没有有理根”
只是说明“\(f(x)\)没有一次因式”，
但是\(f(x)\)可能有次数大于1的因式，
从而\(f(x)\)可能可约.
\end{remark}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P45 例2
求\(f(x)=3x^4+8x^3+6x^2+3x-2\)的全部有理根.
\begin{solution}
首项系数\(a_4=3\)的因子只有\(\pm1,\pm3\)；
常数项\(a_0=-2\)的因子只有\(\pm1,\pm2\).
根据\cref{theorem:多项式.有理数域上的不可约多项式.正次整系数多项式的有理根的分子分母分别整除常数项和首项系数}，
\(f(x)\)的有理根只可能是\(\pm1,\pm2,\pm\frac13,\pm\frac23\).

因为\(f(1)=18\neq0,
f(-1)=-4\neq0\)，
所以\(\pm1\)不是\(f(x)\)的根.

因为\(\frac{f(-1)}{p+q}=-\frac43\)不是整数，
所以\(2\)不是\(f(x)\)的根.

因为\(\frac{f(1)}{p-q}=6,
\frac{f(-1)}{p+q}=4\)，
无法确定\(-2\)不是\(f(x)\)的根，
所以我们需要用综合除法来进一步判断\(-2\)是不是\(f(x)\)的根：\[
	\begin{array}{r|*5r}
		& 3 & 8 & 6 & 3 & -2 \\
		-2 && -6 & -4 & -4 & 2 \\ \cline{2-6}
		& 3 & 2 & 2 & -1 & 0 \\
		&& -6 & 8 & -20 \\ \cline{2-5}
		& 3 & -4 & 10 & -21
	\end{array}
\]
这表明\(-2\)是\(f(x)\)的单根.
于是\[
	f(x)=(x+2)(3x^3+2x^2+2x-1).
\]

因为\(\frac{f(1)}{p-q}=9,
\frac{f(-1)}{p+q}=-1\)，
无法确定\(\frac13\)不是\(f(x)\)的根，
所以我们需要用综合除法来进一步判断\(\frac13\)是不是\(f(x)\)的根：\[
	\def\arraystretch{1.5}
	\begin{array}{r|*5r}
		& 3 & 2 & 2 & -1 \\
		\frac13 && 1 & 1 & 1 \\ \cline{2-5}
		& 3 & 3 & 3 & 0 \\
		&& 1 & \frac43 \\ \cline{2-4}
		& 3 & 4 & \frac{13}3
	\end{array}
\]
这表明\(\frac13\)是\(f(x)\)的单根.
于是\[
	f(x)=(x+2)\left(x-\frac13\right)
	(3x^2+3x+3).
\]
由于\(x^2+x+1\)没有有理根，
所以\(f(x)\)的全部有理根是\(-2,\frac13\)，
它们都是单根.
\end{solution}
\end{example}

下面来探索次数大于1的整系数多项式在\(\mathbb{Q}\)上不可约的条件.
我们来剖析两个例子：
\(x^2+4x+4=(x+2)^2\)，
因此它在\(\mathbb{Q}\)上可约.
\(x^2+4x+6\)的虚根为\(-2\pm\sqrt2\iu\)，
因此它没有有理根，在\(\mathbb{Q}\)上不可约.
\(x^2+4x+4\)与\(x^2+4x+6\)的共同点是
有素数2整除常数项和一次项系数，2不能整除首项系数；
不同点是2的平方能整除\(x^2+4x+4\)的常数项4，
2的平方不能整除\(x^2+4x+6\)的常数项6.

\begin{theorem}[艾森斯坦判别法]\label{theorem:多项式.有理数域上的不可约多项式.艾森斯坦判别法}
%@see: 《高等代数（第三版 下册）》（丘维声） P47 定理5
设\[
	f(x)=a_n x^n+\dotsb+a_1 x+a_0
\]是一个次数\(n\)大于零的整系数多项式.
如果存在一个素数\(p\)，
使得\begin{enumerate}
	\item \(p \mid a_i\ (i=0,1,\dotsc,n-1)\)；
	\item \(p \nmid a_n\)；
	\item \(p^2 \nmid a_0\)，
\end{enumerate}
则\(f(x)\)在\(\mathbb{Q}\)上不可约.
\begin{proof}
用反证法.
假设\(f(x)\)在\(\mathbb{Q}\)上可约，
则根据\cref{theorem:多项式.有理数域上的不可约多项式.本原多项式的分解.推论} 得\[
	f(x)=(b_m x^m+\dotsb+b_1 x+b_0)(c_l x^l+\dotsb+c_1 x+c_0),
	\eqno(1)
\]
其中\(b_i,c_j\in\mathbb{Z}\ (i=0,1,\dotsc,m;j=0,1,\dotsc,l),
b_m\neq0,
c_l\neq0,
m<n,
l<n,
m+l=n\).
因此\[
	a_n=b_m c_l, \qquad
	a_0=b_0 c_0.
\]
已知\(p \mid a_0\)，
所以\(p \mid b_0\)或\(p \mid c_0\).
又因为\(p^2 \nmid a_0\)，
所以\(p\)不能同时整除\(b_0\)和\(c_0\).
不妨设\(p \mid b_0\)但\(p \nmid c_0\).
因为\(p \nmid a_n\)，
所以\(p \nmid b_m\).
假设\(b_0,b_1,\dotsc,b_m\)中第一个不能被\(p\)整除的是\(b_k\)，
即\[
	p \mid b_0,
	p \mid b_1,
	\dotsc,
	p \mid b_{k-1},
	p \nmid b_k,
	\qquad
	0<k\leq m.
	\eqno(2)
\]
比较(1)式两边\(x^k\)的系数，
得\[
	a_k=b_k c_0+b_{k-1} c_1+\dotsb+b_1 c_{k-1}+b_0 c_k.
	\eqno(3)
\]
因为\(k\leq m<n\)，
所以\(p \mid a_k\).
于是从(2)(3)两式得
\(p \mid b_k c_0,
p \mid c_0\)，
矛盾！
因此\(f(x)\)在\(\mathbb{Q}\)上不可约.
\end{proof}
%@see: https://brilliant.org/wiki/eisensteins-irreducibility-criterion/
%@see: https://maa.org/sites/default/files/pdf/upload_library/22/Ford/Cox-2012.pdf
\end{theorem}

\begin{corollary}
%@see: 《高等代数（第三版 下册）》（丘维声） P47 推论6
在\(\mathbb{Q}[x]\)中存在任意次数的不可约多项式.
\begin{proof}
对任意的正整数\(n\)，
设\(f(x)=x^n+2\).
素数\(2\)满足\cref{theorem:多项式.有理数域上的不可约多项式.艾森斯坦判别法} 的条件，
因此\(f(x)\)在\(\mathbb{Q}\)上不可约.
\end{proof}
\end{corollary}
