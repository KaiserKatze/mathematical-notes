\section{整除性，带余除法}
从一元多项式环的通用性质看到，
我们应当尽可能多地得到\(K[x]\)中有关加法和乘法的等式，
为此需要研究一元多项式环\(K[x]\)的结构.
从本节开始我们将主要研究\(K[x]\)的结构，其中\(K\)是任一数域.

\subsection{整除}
观察\(K[x]\)中两个多项式\(f(x)\)与\(g(x)\)之间有什么关系：\[
	f(x)=x^2-1, \qquad
	g(x)=x-1.
\]
显然，\[
	f(x)=(x+1) g(x).
\]
由此我们抽象出“整除”的概念.

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 定义1
设\(f,g \in K[x]\).
如果存在\(h \in K[x]\)，使得\[
	f(x) = h(x) g(x),
\]
则称“\(g(x)\) \DefineConcept{整除} \(f(x)\)”，
记作\(g(x) \mid f(x)\)，
又称“\(g(x)\)是\(f(x)\)的\DefineConcept{因式}”
“\(f(x)\)是\(g(x)\)的\DefineConcept{倍式}”；
否则称“\(g(x)\)不能整除\(f(x)\)”，
记作\(g(x) \nmid f(x)\).
\end{definition}

容易看出下列事实：
\begin{enumerate}
	\item 零多项式整除一个多项式当且仅当这个多项式是零多项式，
	即\[
		0 \mid f(x)
		\iff
		f(x) = 0.
	\]
	\item 任一多项式整除零多项式，
	即\[
		(\forall f \in K[x])
		[f(x) \mid 0].
	\]
	\item 非零数都是多项式的因式，
	即\[
		(\forall b \in K - \{0\})
		(\forall f \in K[x])
		[b \mid f(x)].
	\]
\end{enumerate}

\begin{proposition}\label{theorem:多项式.整除的序}
设\(f,g\)都是数域\(K\)上的非零多项式.
若\(g \mid f\)，
则\(\deg g \leq \deg f\).
\begin{proof}
当\(g \mid f\)时，
根据定义，存在\(h \in K[x]\)，
使得\(f = h g\).
于是由\cref{equation:多项式.积的次数} 有\[
	\deg f
	= \deg(hg)
	= \deg h + \deg g.
\]
假设\(h\)是零多项式，
则\(f\)必定也是零多项式，
矛盾！
因此\(\deg h\geq0\)，
从而\(\deg f\geq\deg g\).
\end{proof}
\end{proposition}

从\cref{theorem:多项式.整除的序} 可以看出：
一个非零多项式不可能整除比它次数更低的另一个非零多项式.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P13 习题7.2 1.
证明：整除关系具有传递性，即在\(K[x]\)中，\[
	(\forall f,g,h \in K[x])
	[
		f(x) \mid g(x) \land g(x) \mid h(x)
		\implies
		f(x) \mid h(x)
	].
\]
\begin{proof}
假设\(f(x) \mid g(x), g(x) \mid h(x)\).
由定义可知，存在\(u,v \in K[x]\)，
使得\[
	g(x) = u(x) f(x), \qquad
	h(x) = v(x) g(x),
\]
于是\(h(x) = v(x) u(x) f(x)\)，
即\(f(x) \mid h(x)\).
\end{proof}
\end{example}

\subsection{相伴}
\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 定义2
在\(K[x]\)中，如果\(f(x) \mid g(x)\)且\(g(x) \mid f(x)\)，
则称“\(f(x)\)与\(g(x)\) \DefineConcept{相伴}”
或“\(f(x)\)是\(g(x)\)的\DefineConcept{相伴元}”，
记作\(f(x) \sim g(x)\).
\end{definition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 命题1
在\(K[x]\)中，\(f(x) \sim g(x)\)当且仅当存在\(c \in K-\{0\}\)，使得\[
	f(x) = c g(x).
\]
\begin{proof}
充分性.
假设\(f(x)=c g(x)\)，其中\(c \in K-\{0\}\).
显然有\(g(x) \mid f(x)\).
又因为\(g(x)=\frac1c f(x)\)，
所以\(f(x) \mid g(x)\).
因此\(f(x) \sim g(x)\).

必要性.
假设\(f(x) \sim g(x)\).
由定义有\(f(x) \mid g(x)\)和\(g(x) \mid f(x)\).
于是存在\(h_1(x),h_2(x) \in K[x]\)，
使得\[
	g(x) = h_1(x) f(x), \qquad
	f(x) = h_2(x) g(x).
\]
于是\[
	f(x) = h_2(x) h_1(x) f(x).
\]
如果\(f(x)=0\)，则\(g(x)=0\).
下面假设\(f(x)\neq0\).
运用消去律，
由上式可得\[
	1 = h_2(x) h_1(x).
\]
继而可得\[
	\deg h_2(x) + \deg h_1(x) = 0.
\]
因此\(\deg h_1(x) = \deg h_2(x) = 0\)，
从而\(h_2(x)\)等于\(K\)中某个非零常数\(c\)，
于是\(f(x) = c g(x)\).
\end{proof}
\end{proposition}

容易看出，两个多项式的相伴关系是多项式环\(K[x]\)上的等价关系.

\subsection{整除的性质}
\begin{proposition}\label{theorem:多项式.整除的线性性}
%@see: 《高等代数（第三版 下册）》（丘维声） P10 命题2
在\(K[x]\)中，如果\(g(x) \mid f_i(x)\ (i=1,2,\dotsc,s)\)，
则对于任意\(u_i \in K[x]\ (i=1,2,\dotsc,s)\)，有\[
	g(x) \mid (u_1(x) f_1(x) + u_2(x) f_2(x) + \dotsb + u_s(x) f_s(x)).
\]
\begin{proof}
由\(g(x) \mid f_i(x)\)可知，
存在\(h_i(x) \in K[x]\)，
使得\(f_i(x) = h_i(x) g(x)\).
因此\begin{align*}
	\sum_{i=1}^s u_i(x) f_i(x)
	&= \sum_{i=1}^s u_i(x) h_i(x) g(x) \\
	&= g(x) \sum_{i=1}^s u_i(x) h_i(x),
\end{align*}
所以\(g(x) \mid (u_1(x) f_1(x) + u_2(x) f_2(x) + \dotsb + u_s(x) f_s(x))\).
\end{proof}
\end{proposition}

\subsection{带余除法}
在\(K[x]\)中，如果\(g(x)\)不能整除\(f(x)\)，
那么能有什么样的结论呢？
例如，设\(f(x)=x^2,
g(x)=x-1\)，
则\[
	f(x)=x^2-1+1=(x+1)g(x)+1.
\]
由此受到启发，我们可以给出如下结论.
\begin{theorem}\label{theorem:多项式.带余除法}
%@see: 《高等代数（第三版 下册）》（丘维声） P11 定理3
对于\(K[x]\)中任意两个多项式\(f(x)\)与\(g(x)\)，其中\(g(x)\neq0\)，
则在\(K[x]\)中存在唯一的一对多项式\(h(x),r(x)\)，使得\[
	f(x) = h(x) g(x) + r(x),
	\qquad
	\deg r(x) < \deg g(x).
\]
\begin{proof}
存在性.
假设被除式\(f(x)\)的次数为\(n\)，
除式\(g(x)\)的次数为\(m\)，
即\(\deg f(x)=n\in\mathbb{N}\)，
\(\deg g(x)=m\in\mathbb{N}\).
让我们分情况讨论：\begin{enumerate}
	\item[情形1]
	当\(m=0\)时，
	除式\(g(x)\)是零次多项式，
	不妨设\(g(x)\)等于\(K\)中某个非零常数\(b\).
	于是，只要取\(h(x) = \frac1b f(x), r(x) = 0\)，
	就有\[
		f(x) = h(x) g(x) + r(x),
		\qquad
		\deg 0 < \deg g(x).
	\]

	\item[情形2]
	当\(m>0\)且\(\deg f(x) = n < m\)时，
	只要取\(h(x) = 0, r(x) = f(x)\)
	就有\[
		f(x) = h(x) g(x) + r(x), \qquad
		\deg f(x) < \deg g(x).
	\]

	\item[情形3]
	当\(m>0\)且\(\deg f(x) = n \geq m\)时，
	对被除式\(f(x)\)的次数\(n\)运用数学归纳法.

	假设对于次数小于\(n\)的被除式，
	命题的存在性部分成立.
	现在来看\(n\)次多项式\(f(x)\).

	设\(f(x),g(x)\)的首项分别是\(a_n x^n,b_m x^m\).
	于是\(a_n b_m^{-1} x^{n-m} g(x)\)的首项是\(a_n x^n\).
	令\(f_1(x) = f(x) - a_n b_m^{-1} x^{n-m} g(x)\)，
	则\(\deg f_1(x) < n\).
	根据归纳假设，
	存在\(h_1(x),r_1(x) \in K[x]\)，
	使得\[
		f_1(x) = h_1(x) g(x) + r_1(x), \qquad
		\deg r_1(x) < \deg g(x).
	\]
	于是\begin{align*}
		f(x)
		&= f_1(x) + a_n b_m^{-1} x^{n-m} g(x) \\
		&= [h_1(x) + a_n b_m^{-1} x^{n-m}] g(x) + r_1(x).
	\end{align*}
	因此，只需要令\(h(x) = h_1(x) + a_n b_m^{-1} x^{n-m}\)，
	就有\[
		f(x) = h(x) g(x) + r_1(x),
		\qquad
		\deg r_1(x) < \deg g(x).
	\]
\end{enumerate}

唯一性.
设\(h(x),r(x),h'(x),r'(x) \in K[x]\)，
使得\begin{gather*}
	f(x) = h(x) g(x) + r(x), \qquad \deg r(x) < \deg g(x), \\
	f(x) = h'(x) g(x) + r'(x), \qquad \deg r'(x) < \deg g(x).
\end{gather*}
于是有\[
	h(x) g(x) + r(x)
	= h'(x) g(x) + r'(x),
\]
即\[
	[h(x) - h'(x)] g(x) = r'(x) - r(x).
\]
那么\begin{align*}
	\deg[h(x) - h'(x)] + \deg g(x)
	&= \deg[r'(x) - r(x)] \\
	&\leq \max\{
		\deg r'(x),
		\deg r(x)
	\}
	< \deg g(x).
\end{align*}
假设\(h(x) \neq h'(x)\)，
那么由上式可知\[
	\deg[h(x) - h'(x)] < 0,
\]
矛盾！
因此必有\(h(x) = h'(x)\).
从而又有\(r(x) = r'(x)\).
\end{proof}
\end{theorem}

\cref{theorem:多项式.带余除法} 中的
\(f(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{被除式}（dividend）”，
\(g(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{除式}（divisor）”，
\(h(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{商式}（quotient）”，
\(r(x)\)称为“\(g(x)\)除\(f(x)\)的\DefineConcept{余式}（remainder）”.
%@see: https://mathworld.wolfram.com/Dividend.html
%@see: https://mathworld.wolfram.com/Divisor.html

\begin{corollary}\label{theorem:多项式.带余除法.推论}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 推论4
设\(f,g \in K[x]\)，且\(g(x) \neq 0\)，
则\(g(x) \mid f(x)\)当且仅当\(g(x)\)除\(f(x)\)的余式为零.
\begin{proof}
由\cref{theorem:多项式.带余除法} 立即可得\begin{align*}
	g(x) \mid f(x)
	&\iff
	(\exists h \in K[x])
	[f(x) = h(x) g(x)] \\
	&\iff
	\text{$g(x)$除$f(x)$的余式是$0$}.
	\qedhere
\end{align*}
\end{proof}
\end{corollary}

利用带余除法可以证明：
对于\(K[x]\)中的多项式\(f(x),g(x)\)，
如果在\(K[x]\)中，\(g(x)\)不能整除\(f(x)\)，
那么把数域\(K\)扩大成数域\(F\)后，
在\(F[x]\)中，\(g(x)\)仍然不能整除\(f(x)\).

\begin{proposition}\label{theorem:多项式.整除性不随数域的扩大而改变}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 命题5
设\(F,K\)都是数域，且\(F \supseteq K\).
如果\(f,g \in K[x]\)，那么\[
	\text{在\(K[x]\)中成立\(g(x) \mid f(x)\)}
	\iff
	\text{在\(F[x]\)中成立\(g(x) \mid f(x)\)}.
\]
\begin{proof}
必要性.
假设在\(K[x]\)中，\(g(x) \mid f(x)\)，
则存在\(h(x) \in K[x]\)，
使得\(f(x) = h(x) g(x)\).
由于\(K \subseteq F\)，
因此\(f(x),g(x),h(x) \in K[x]\).
从而在\(F[x]\)中，\(g(x) \mid f(x)\).

充分性.
假设在\(F[x]\)中，\(g(x) \mid f(x)\).
我们分以下两种情况讨论：\begin{enumerate}
	\item 当\(g(x)\neq0\)时，
	在\(K[x]\)中作带余除法，
	有\(h(x),r(x) \in K[x]\)，
	使得\[
		f(x) = h(x) g(x) + r(x), \qquad
		\deg r(x) < \deg g(x).
	\]
	由于\(f(x),g(x),h(x),r(x) \in F[x]\)，
	因此上式也可以看成是在\(F[x]\)中的带余除法.
	由于在\(F[x]\)中，
	\(g(x) \mid f(x)\)，
	因此根据\cref{theorem:多项式.带余除法.推论}
	得\(r(x) = 0\).
	从而在\(K[x]\)中，有\(g(x) \mid f(x)\).

	\item 当\(g(x)=0\)时，
	从\(g(x) \mid f(x)\)得\(f(x)=0\).
	从而在\(K[x]\)中，也有\(g(x) \mid f(x)\).
\end{enumerate}
综上所述，在\(K[x]\)中，总有\(g(x) \mid f(x)\).
\end{proof}
\end{proposition}

\cref{theorem:多项式.整除性不随数域的扩大而改变} 表明，整除性不随数域的扩大而改变.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 例1
设\(f(x) = 2x^3+3x^2+5\)，
\(g(x) = x^2+2x-1\)，
求用\(g(x)\)除\(f(x)\)的商式与余式.
\begin{solution}
我们可以参考整数除法的竖式，作出如下计算：
\[
	\begin{array}{r|*4r|l}
		x^2+2x-1 &
		2x^3 & +3x^2 & & +5
		& 2x-1 \\
		& 2x^3 & +4x^2 & -2x & \\ \cline{2-5}
		& & -x^2 & +2x & +5 \\
		& & -x^2 & -2x & +1 \\ \cline{3-5}
		& & & 4x & +4
	\end{array}
\]
因此\[
	2x^3+3x^2+5=(2x-1)(x^2+2x-1)+(4x+4),
\]
即\(g(x)\)除\(f(x)\)的商式是\(2x-1\)，余式是\(4x+4\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P12 例1
设\(f(x) = 2x^4-6x^3+3x^2-2x+5\)，
\(g(x) = x-2\)，
求用\(g(x)\)除\(f(x)\)的商式与余式.
\begin{solution}我们可以参考整数除法的竖式，作出如下计算：
\[
	\begin{array}{r|*5r|l}
		x{\color{red}-2} &
		2x^4 & -6x^3 & +3x^2 & -2x & +5
		& 2x^3-2x^2-x-4 \\
		& 2x^4 & {\color{red}-4}x^3 &&&& \\ \cline{2-6}
		&& -2x^3 & +3x^2 &&& \\
		&& -2x^3 & {\color{red}+4}x^2 &&& \\ \cline{3-6}
		&&& -x^2 & -2x && \\
		&&& -x^2 & {\color{red}+2}x && \\ \cline{4-6}
		&&&& -4x & +5 & \\
		&&&& -4x & {\color{red}+8} & \\ \cline{5-6}
		&&&&& {\color{red}-3}
	\end{array}
\]
注意到除式是1次多项式，
我们可以采用“综合除法”这种简易计算方法.
首先我们需要把被除式的各项系数写成一行，
再把除式的常数项的相反数写在下一行的最左边，
如下：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		{\color{red}2} \\ \cline{2-6}
	\end{array}
\]
接下来把第一行第一列数（即首项系数）
写到横线下方对应位置，
得到\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 \\ \cline{2-6}
		& {\color{red}2}
	\end{array}
\]
接下来把横线下方当前排在最末的数与竖线左边的数相乘，
写在第二行第二列：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 && {\color{red}4} \\ \cline{2-6}
		& 2
	\end{array}
\]
然后把第二列第一行、第二行的数字相加，
把结果写到横线下方对应位置：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 && 4 \\ \cline{2-6}
		& 2 & {\color{red}-2}
	\end{array}
\]
类似地，把横线下方当前排在最末的数与竖线左边的数相乘，
写在第二行第三列：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 && 4 & {\color{red}-4} \\ \cline{2-6}
		& 2 & -2
	\end{array}
\]
然后又把第三列第一行、第二行的数字相加，
把结果写到横线下方对应位置：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 && 4 & -4 \\ \cline{2-6}
		& 2 & -2 & {\color{red}-1}
	\end{array}
\]
以此类推，最后我们得到：\[
	\begin{array}{r|*5r}
		& 2 & -6 & 3 & -2 & 5 \\
		2 && 4 & -4 & -2 & -8 \\ \cline{2-6}
		& \color{blue}2 & \color{blue}-2 & \color{blue}-1 & \color{blue}-4
		& {\color{red}-3}
	\end{array}
\]
我们把上式中蓝色的数字
按顺序写成一个3次多项式\(2x^3-2x^2-x-4\)
（这是因为\(\deg f(x)-\deg g(x)=3\)），
这就是\(g(x)\)除\(f(x)\)的商式；
然后我们把上式中红色的数字\(-3\)
作为\(g(x)\)除\(f(x)\)的余式；
也就是说\[
	2x^4-6x^3+3x^2-2x+5
	=(2x^3-2x^2-x-4)(x-2)-3.
\]
\end{solution}
\end{example}

%@see: https://zhuanlan.zhihu.com/p/634579122
%@see: https://mathworld.wolfram.com/LongDivision.html
%@see: https://mathworld.wolfram.com/SyntheticDivision.html
在上面这个例子中，
我们利用\DefineConcept{综合除法}（synthetic division）
求出了用一次多项式\(g(x)=x-c\)
去除任一多项式\(f(x)=a_n x^n+a_{n-1} x^{n-1}+\dotsb+a_1 x+a_0\)的商式和余式.
实际上综合除法是基于带余除法和待定系数法建立了一种简易算法.
不妨设\[
	f(x)=(x-c) q(x)+r,
\]
其中\(q(x)=b_{n-1} x^{n-1}+b_{n-2} x^{n-2}+\dotsb+b_1 x+b_0\).
那么有\[
	f(x)
	=b_{n-1} x^n
	+(b_{n-2}-c b_{n-1}) x^{n-1}
	+(b_{n-3}-c b_{n-2}) x^{n-2}
	+\dotsb
	+(b_0-c b_1) x
	+(r-c b_0).
\]
将上式与\(f(x)=a_n x^n+a_{n-1} x^{n-1}+\dotsb+a_1 x+a_0\)比较可得\[
	\left\{ \begin{array}{l}
		a_n=b_{n-1}, \\
		a_{n-1}=b_{n-2}-c b_{n-1}, \\
		a_{n-2}=b_{n-3}-c b_{n-2}, \\
		\hdotsfor1, \\
		a_1=b_0-c b_1, \\
		a_0=r-c b_0,
	\end{array} \right.
	\quad\text{即}\quad
	\left\{ \begin{array}{l}
		b_{n-1}=a_n, \\
		b_{n-2}=a_{n-1}+c b_{n-1}, \\
		b_{n-3}=a_{n-2}+c b_{n-2}, \\
		\hdotsfor1 \\
		b_0=a_1+c b_1, \\
		r=a_0+c b_0.
	\end{array} \right.
\]
于是我们可以列出下表：\[
	\begin{array}{r|*5c}
		& a_n & a_{n-1} & \dots & a_1 & a_0 \\
		c && c a_n & \dots & c b_1 & c b_0 \\ \cline{2-6}
		& a_n=b_{n-1} & a_{n-1}+c a_n=b_{n-2} & \dots & a_1+c b_1=b_0 & a_0+c b_0=r
	\end{array}
\]
这就是综合除法的原理.
