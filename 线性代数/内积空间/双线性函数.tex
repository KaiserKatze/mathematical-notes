\section{双线性函数}
\subsection{双线性函数}
我们已经知道，\(\mathbb{R}^n\)上一个内积
\((\alpha,\beta) \mapsto \VectorInnerProductDot{\alpha}{\beta}\)是\(\mathbb{R}^n\)上的一个二元实值函数，
并且它具有对称性、线性性、正定性，
不难得到\begin{gather*}
	\VectorInnerProductDot{(k_1\alpha_1+k_2\alpha_2)}{\beta}
	= k_1(\VectorInnerProductDot{\alpha_1}{\beta})
	+ k_2(\VectorInnerProductDot{\alpha_2}{\beta}), \\
	\VectorInnerProductDot{\alpha}{(k_1\beta_1+k_2\beta_2)}
	= k_1(\VectorInnerProductDot{\alpha}{\beta_1})
	+ k_2(\VectorInnerProductDot{\alpha}{\beta_2}).
\end{gather*}
受此启发，我们抽象出域\(F\)上线性空间\(V\)上的双线性函数的概念：
\begin{definition}\label{definition:双线性函数.双线性函数的定义1}
%@see: 《高等代数（第三版 下册）》（丘维声） P166 定义1
设\(V\)是域\(F\)上的一个线性空间.
如果映射\(f\colon V \times V \to F\)满足\begin{gather}
	f(k_1\alpha_1+k_2\alpha_2,\beta)
	= k_1 f(\alpha_1,\beta)
	+ k_2 f(\alpha_2,\beta),
		\label{equation:双线性函数.双线性函数判定条件1} \\
	f(\alpha,k_1\beta_1+k_2\beta_2)
	= k_1 f(\alpha,\beta_1)
	+ k_2 f(\alpha,\beta_2),
		\label{equation:双线性函数.双线性函数判定条件2}
\end{gather}
则称“\(f\)是\(V\)上的一个\DefineConcept{双线性函数}%
（\(f\) is a \emph{bilinear function} on \(V\)）”.
%@see: https://mathworld.wolfram.com/BilinearFunction.html
\end{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P166
条件 \labelcref{equation:双线性函数.双线性函数判定条件1} 表明：
当\(\beta\)固定时，
双线性函数\(f\)在\(V \times \{\beta\}\)上的限制\(f \SetRestrict (V \times \{\beta\})\)，
是\(V\)上的一个线性函数.
% 在《高等代数（第三版 下册）》（丘维声）上，将这个映射的限制记为\(\beta_R\).
条件 \labelcref{equation:双线性函数.双线性函数判定条件2} 表明：
当\(\alpha\)固定时，
双线性函数\(f\)在\(\{\alpha\} \times V\)上的限制\(f \SetRestrict (\{\alpha\} \times V)\)，
是\(V\)上的一个线性函数.
% 在《高等代数（第三版 下册）》（丘维声）上，将这个映射的限制记为\(\alpha_L\).
于是我们可以得到双线性函数的等价定义：
\begin{theorem}\label{definition:双线性函数.双线性函数的定义2}
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P333 9.1
设\(V\)是域\(F\)上的一个线性空间，
则“映射\(f\colon V \times V \to F\)是\(V\)上的一个双线性函数”的充分必要条件是：
对于任意\(\alpha \in V\)，
\(x \mapsto f(x,\alpha)\)和\(x \mapsto f(\alpha,x)\)都是\(V\)上的线性函数.
\begin{proof}
必要性.
假设\(f\)是\(V\)上的一个双线性函数.
任意取定\(\alpha \in V\)，
显然映射\(x \mapsto f(x,\alpha)\)和\(x \mapsto f(\alpha,x)\)都是从\(V\)到\(F\)的映射，
并且由\hyperref[definition:双线性函数.双线性函数的定义1]{定义}可知，
对于\(\forall x_1,x_2 \in V,
\forall k_1,k_2 \in F\)，
有\begin{gather*}
	f(k_1x_1+k_2x_2,\alpha)
	= k_1 f(x_1,\alpha)
	+ k_2 f(x_2,\alpha), \\
	f(\alpha,k_1x_1+k_2x_2)
	= k_1 f(\alpha,x_1)
	+ k_2 f(\alpha,x_2),
\end{gather*}
可见\(x \mapsto f(x,\alpha)\)和\(x \mapsto f(\alpha,x)\)都适合可加性、齐次性，
因此\(x \mapsto f(x,\alpha)\)和\(x \mapsto f(\alpha,x)\)
都是\(V\)上的\hyperref[definition:线性映射.线性函数]{线性函数}.

充分性.
假设对于任意\(\alpha \in V\)，
\(x \mapsto f(x,\alpha)\)和\(x \mapsto f(\alpha,x)\)都是\(V\)上的线性函数.
任意取定\(\beta \in V\)，
记\(g(x) \defeq f(x,\beta)\)，
那么由\hyperref[definition:线性映射.线性映射]{定义}可知，
对于\(\forall \alpha_1,\alpha_2 \in V,
\forall k_1,k_2 \in F\)，
有\begin{equation*}
	g(\alpha_1+\alpha_2)=g(\alpha_1)+g(\alpha_2),
	\qquad
	g(k_1\alpha_1)=k_1g(\alpha_1),
	\qquad
	g(k_2\alpha_2)=k_2g(\alpha_2),
\end{equation*}
从而有\begin{equation*}
	g(k_1\alpha_1+k_2\alpha_2)
	= g(k_1\alpha_1) + g(k_2\alpha_2)
	= k_1g(\alpha_1) + k_2g(\alpha_2),
\end{equation*}
即\begin{equation*}
	f(k_1\alpha_1+k_2\alpha_2,\beta)
	= k_1 f(\alpha_1,\beta)
	+ k_2 f(\alpha_2,\beta).
\end{equation*}
同理可证，在任意取定\(\alpha \in V\)以后，
对于\(\forall \beta_1,\beta_2 \in V,
\forall k_1,k_2 \in F\)，
有\begin{equation*}
	f(\alpha,k_1\beta_1+k_2\beta_2)
	= k_1 f(\alpha,\beta_1)
	+ k_2 f(\alpha,\beta_2).
\end{equation*}
因此\(f\)是\(V\)上的一个双线性函数.
\end{proof}
\end{theorem}

\begin{example}\label{example:双线性函数.例1}
%@see: 《高等代数（第三版 下册）》（丘维声） P166 例1
设\(V = M_n(F)\).
令\(f(A,B) \defeq \tr(AB)\ (A,B \in V)\)，
则\(f\)是\(V\)上的一个双线性函数.
\end{example}

\begin{example}\label{example:双线性函数.例2}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 例2
设\(V = C[a,b]\).
令\(f(g,h) \defeq \int_a^b g(x) h(x) \dd{x}\ (g,h \in V)\)，
则\(f\)是\(V\)上的一个双线性函数.
\end{example}

\begin{example}\label{example:双线性函数.例3}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 例3
设\(V = F^n\).
映射\(f\colon V \times V \to F,
(\alpha,\beta) \mapsto \sum_{i=1}^n a_i b_i\)是\(V\)上的一个双线性函数，
其中\(\alpha=(\AutoTuple{a}{n})^T,
\beta=(\AutoTuple{b}{n})^T\).
\end{example}

\begin{property}\label{theorem:双线性函数.双线性函数取值为零的条件1}
设\(V\)是域\(F\)上的一个线性空间，
\(f\)是\(V\)上的一个双线性函数，
则\(f(0,0) = 0\).
\begin{proof}
在 \hyperref[equation:双线性函数.双线性函数判定条件1]{$
	f(k_1\alpha_1+k_2\alpha_2,\beta)
	= k_1 f(\alpha_1,\beta)
	+ k_2 f(\alpha_2,\beta)
$} 中，
取\(k_1=k_2=1,
\alpha_1=\alpha_2=\beta=0\)，
得\begin{equation*}
	f(0,0) = f(0,0) + f(0,0),
\end{equation*}
整理得\(f(0,0) = 0\).
\end{proof}
\end{property}

\begin{property}\label{theorem:双线性函数.双线性函数取值为零的条件2}
设\(V\)是域\(F\)上的一个线性空间，
\(f\)是\(V\)上的一个双线性函数，
则\begin{equation*}
	f(\alpha,0)
	= f(0,\beta)
	= 0.
\end{equation*}
\begin{proof}
%@credit: {de3029b8-10a6-4ae5-8f64-108dae1c10a9},{a84f055e-f32d-418a-8d8c-0b72a4b2df78},{6d916ea6-1441-4c5b-9e97-4f834b319710},{83c38fc7-afe0-41ba-a56b-684984744681}
在 \hyperref[equation:双线性函数.双线性函数判定条件2]{$
	f(\alpha,k_1\beta_1+k_2\beta_2)
	= k_1 f(\alpha,\beta_1)
	+ k_2 f(\alpha,\beta_2)
$} 中，
取\(k_1=k_2=1,
\beta_1=\beta_2=0\)，
得\begin{equation*}
	f(\alpha,0)
	= f(\alpha,0+0)
	= f(\alpha,0) + f(\alpha,0),
\end{equation*}
整理得\(f(\alpha,0) = 0\).
同理可得\(f(0,\beta) = 0\).
\end{proof}
\end{property}
\begin{remark}
我们还可以为\cref{theorem:双线性函数.双线性函数取值为零的条件2} 给出另一种证明：
由\hyperref[definition:双线性函数.双线性函数的定义2]{双线性函数的等价定义}可知，
在固定任意一个自变量的情况下，
映射\(x \mapsto f(\alpha,x)\)和\(x \mapsto f(x,\beta)\)都是\(V\)上的线性函数，
那么由\hyperref[theorem:线性映射.线性映射的性质]{线性映射的性质}可知
这两个线性函数在\(x=0\)的值都是\(0\).
\end{remark}

\subsection{双线性函数的度量矩阵}
\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P167
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P334 9.4
设\(V\)是域\(F\)上\(n\)维线性空间，
\(f\)是\(V\)上的一个双线性函数，
在\(V\)中取一个基\(\AutoTuple{\epsilon}{n}\)，
向量\(\alpha,\beta\)在基\(\AutoTuple{\epsilon}{n}\)下的坐标
分别是\begin{equation}\label{equation:双线性函数.双线性函数的自变量的坐标}
	X=(\AutoTuple{x}{n})^T,
	\qquad
	Y=(\AutoTuple{y}{n})^T,
\end{equation}
把\begin{equation}\label{equation:双线性函数.双线性函数的因变量的坐标}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 (1)
	f(\alpha,\beta)
	= f\left( \sum_{i=1}^n x_i \epsilon_i, \sum_{j=1}^n y_j \epsilon_j \right)
	= \sum_{i=1}^n \sum_{j=1}^n x_i y_j f(\epsilon_i,\epsilon_j)
\end{equation}
中\(x_i y_j\)的系数\(f(\epsilon_i,\epsilon_j)\)作为矩阵的\((i,j)\)元素，
得到\begin{equation}\label{equation:双线性函数.双线性函数的度量矩阵}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 (2)
	A \defeq \begin{bmatrix}
		f(\epsilon_1,\epsilon_1) & f(\epsilon_1,\epsilon_2) & \dots & f(\epsilon_1,\epsilon_n) \\
		f(\epsilon_2,\epsilon_1) & f(\epsilon_2,\epsilon_2) & \dots & f(\epsilon_2,\epsilon_n) \\
		\vdots & \vdots & & \vdots \\
		f(\epsilon_n,\epsilon_1) & f(\epsilon_n,\epsilon_2) & \dots & f(\epsilon_n,\epsilon_n) \\
	\end{bmatrix},
\end{equation}
将\(A\)称为“双线性函数\(f\)在基\(\AutoTuple{\epsilon}{n}\)下的\DefineConcept{度量矩阵}”，
记为\(\BilinearMatrix(f,(\AutoTuple{\epsilon}{n}))\)，
或在不致混淆的情况下简记为\(\BilinearMatrix(f)\).
\end{definition}
\begin{remark}
%@see: 《高等代数（第三版 下册）》（丘维声） P167
双线性函数\(f\)的度量矩阵
由\(f\)以及基\(\AutoTuple{\epsilon}{n}\)唯一确定.
\end{remark}
\begin{remark}
由\cref{equation:双线性函数.双线性函数的自变量的坐标,equation:双线性函数.双线性函数的因变量的坐标,equation:双线性函数.双线性函数的度量矩阵}
可得\begin{equation}\label{equation:双线性函数.双线性函数的矩阵表示}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 (3)
	f(\alpha,\beta)
	= X^T A Y.
\end{equation}
\cref{equation:双线性函数.双线性函数的矩阵表示,equation:双线性函数.双线性函数的因变量的坐标}
都是双线性函数\(f\)在基\(\AutoTuple{\epsilon}{n}\)下的表达式.
\end{remark}
\begin{theorem}
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P335 9.6
设\(V\)是域\(F\)上的\(n\)维线性空间，
\(f\)是\(V\)上的一个双线性函数，
\(A\)是\(V\)上的一个线性变换，
在\(V\)中取一个基\(\AutoTuple{\epsilon}{n}\)，
令\begin{equation*}
	g(u,v) \defeq f(u,Av),
	\qquad
	h(u,v) \defeq f(Au,v),
\end{equation*}
则\begin{equation*}
	\BilinearMatrix(g)
	= \BilinearMatrix(f) \LinearMapMatrix(A),
	\qquad
	\BilinearMatrix(h)
	= (\LinearMapMatrix(A))^T \BilinearMatrix(f).
\end{equation*}
%TODO proof
\end{theorem}

\begin{theorem}\label{theorem:双线性函数.双线性函数在两个基下的度量矩阵合同}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 定理1
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P336 9.7
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
在\(V\)中取两个基\(\AutoTuple{\alpha}{n}\)与\(\AutoTuple{\beta}{n}\)，
矩阵\(P \in M_n(F)\)满足\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 (4)
	(\AutoTuple{\beta}{n})
	= (\AutoTuple{\alpha}{n}) P,
\end{equation*}
\(f\)在这两个基下的度量矩阵分别是\(A,B\)，
则\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P167 (5)
	B = P^T A P.
\end{equation*}
\begin{proof}
设\begin{equation*}
	\alpha = (\AutoTuple{\alpha}{n}) X
	= (\AutoTuple{\beta}{n}) X_0,
	\qquad
	\beta = (\AutoTuple{\alpha}{n}) Y
	= (\AutoTuple{\beta}{n}) Y_0,
\end{equation*}
则\(X = P X_0,
Y = P Y_0\)，
从而\begin{equation*}
	f(\alpha,\beta)
	= X^T A Y
	= (P X_0)^T A (P Y_0)
	= X_0^T (P^T A P) Y_0.
\end{equation*}
再由\(f(\alpha,\beta) = X_0^T B Y_0\)
可得\begin{equation*}
	X_0^T B Y_0 = X_0^T (P^T A P) Y_0,
\end{equation*}
根据\(X_0,Y_0\)的任意性，
可知\(B = P^T A P\).
\end{proof}
\end{theorem}
\begin{remark}
\cref{theorem:双线性函数.双线性函数在两个基下的度量矩阵合同} 表明，
\(V\)上的双线性函数\(f\)在不同基下的度量矩阵是合同的.
由于合同矩阵有相同的秩，
因此我们把双线性函数\(f\)在\(V\)某个基下的度量矩阵的秩由\(f\)唯一确定.
\end{remark}
\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P168
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
\(A\)是\(f\)在\(V\)中某个基下的度量矩阵.
把\(\rank A\)
称为“双线性函数\(f\)的\DefineConcept{矩阵秩}”，
记为\(\rank f\).
\end{definition}

\subsection{双线性函数空间}
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P334
由\cref{theorem:线性空间.线性空间的笛卡尔和是线性空间}
可知\(V \times V\)是一个线性空间，
这让我们想要知道：双线性函数是不是从\(V \times V\)到\(F\)的线性映射.
答案是否定的.
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P344 Exercises 9A 3.
实际上，如果\(V\)上的双线性函数\(f\)是\(V \times V\)上的一个线性函数，
那么\(f\)一定是零映射.
不过，虽然除了零映射以外的其余双线性函数都不是线性映射，
但是所有\(V\)上的双线性函数组成的集合\begin{equation}
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P334 9.3
	V^{(2)}
	\defeq
	\Set{
		f
		\given
		\text{$f$是$V$上的双线性函数}
	}
\end{equation}
在配上通常的映射加法、纯量乘法运算以后
还是可以成为域\(F\)上的一个线性空间.

\begin{proposition}
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P335 9.4
设\(V\)是域\(F\)上的\(n\)维线性空间，
则\(\dim V^{(2)} = (\dim V)^2\).
%TODO proof
\end{proposition}

\subsection{非退化双线性函数}
\begin{definition}
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P446 例6
设\(f\)是域\(F\)上线性空间\(V\)上的一个双线性函数，
\(f\)是对称的或斜对称的.
如果\(V\)中的两个向量\(\alpha,\beta\)满足\(f(\alpha,\beta) = 0\)，
则称“\(\alpha\)与\(\beta\) \DefineConcept{正交}”，
记为\(\alpha \perp \beta\).
\end{definition}

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P168 定义2
%@see: 《高等代数》（丁南庆、刘公祥、纪庆忠、郭学军） P351 定义9.1.6
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P446 例6
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
\(W\)是\(V\)的一个子空间.
\begin{itemize}
	\item 定义：\begin{equation}
		\Rad_L(f,W)
		\defeq
		\Set{
			\alpha \in W
			\given
			(\forall\beta \in W)
			[f(\alpha,\beta) = 0]
		},
	\end{equation}
	称之为“\(f\)在\(W\)中的\DefineConcept{左根}（left radical）”
	或“\(f \SetRestrict W\)的\DefineConcept{左根}”.

	在不致混淆的情况下，可以将\(\Rad_L(f,W)\)简记为\(\Rad_L f\)或\(\Rad_L W\).

	\item 定义：\begin{equation}
		\Rad_R(f,W)
		\defeq
		\Set{
			\beta \in W
			\given
			(\forall\alpha \in W)
			[f(\alpha,\beta) = 0]
		},
	\end{equation}
	称之为“\(f\)在\(W\)中的\DefineConcept{右根}（right radical）”
	或“\(f \SetRestrict W\)的\DefineConcept{右根}”.

	在不致混淆的情况下，可以将\(\Rad_R(f,W)\)简记为\(\Rad_R f\)或\(\Rad_R W\).

	\item 如果\(\Rad_L(f,W) = \Rad_R(f,W)\)，
	定义：\begin{equation*}
		\Rad(f,W)
		\defeq
		\Rad_L(f,W),
	\end{equation*}
	称之为“\(f\)在\(W\)中的\DefineConcept{根}（radical）”
	或“\(f \SetRestrict W\)的\DefineConcept{根}”.

	在不致混淆的情况下，可以将\(\Rad(f,W)\)简记为\(\Rad f\)或\(\Rad W\).
\end{itemize}
\end{definition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P168
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
则\(f\)的左根\(\Rad_L f\)和右根\(\Rad_R f\)都是\(V\)的子空间.
%TODO proof
\end{proposition}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 2.
证明：如果\(V\)是有限维线性空间，则\(V\)上的双线性函数\(f\)满足\begin{equation*}
	\dim\Rad_L f
	= \dim\Rad_R f
	= \dim V - \rank f.
\end{equation*}
%TODO proof
\end{example}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 3.
\def\fL{\alpha_L}  % 双线性函数\(f\)的限制
\def\fR{\beta_R}  % 双线性函数\(f\)的限制
\def\Lf{L_f}  % 从\(V\)到\(V^*\)的线性映射
\def\Rf{R_f}  % 从\(V\)到\(V^*\)的线性映射
设\(V\)是域\(F\)上\(n\)维线性空间，
\(V^*\)是\(V\)的对偶空间，
\(f\)是\(V\)上的一个双线性函数，
记\(\alpha_L \defeq f \SetRestrict (\{\alpha\} \times V),
\beta_R \defeq f \SetRestrict (V \times \{\beta\})\)，
映射\(\Lf\colon \alpha \mapsto \fL\)，
映射\(\Rf\colon \beta \mapsto \fR\).
证明：\begin{itemize}
	\item \(\Lf\)和\(\Rf\)都是从\(V\)到\(V^*\)的线性映射；
	\item \(\Ker \Lf = \Rad_L V\)；
	\item \(\Ker \Rf = \Rad_R V\)；
	\item \(\rank \Lf = \rank \Rf = \rank f\)；
	\item \(f\)是非退化的，当且仅当\(\Lf\)或\(\Rf\)是从\(V\)到\(V^*\)的同构.
\end{itemize}
%TODO proof
\end{example}

\begin{theorem}
%@see: 《高等代数（第三版 下册）》（丘维声） P168 定理2
%@see: 《高等代数》（丁南庆、刘公祥、纪庆忠、郭学军） P351 定理9.1.7
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
在\(V\)中取一个基\(\AutoTuple{\epsilon}{n}\)，
\(A\)是\(f\)在基\(\AutoTuple{\epsilon}{n}\)下的度量矩阵，
则\begin{equation*}
	\text{$A$是满秩矩阵}
	\iff
	\Rad_L f = 0
	\iff
	\Rad_R f = 0.
\end{equation*}
%TODO proof
\end{theorem}

\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P168 定义3
%@see: 《高等代数》（丁南庆、刘公祥、纪庆忠、郭学军） P351 定理9.1.7
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数.
如果\(\Rad_L f = \Rad_R f = 0\)，
则称“\(f\)是\DefineConcept{非退化的}（nondegenerate）”；
否则称“\(f\)是\DefineConcept{退化的}（degenerate）”.
\end{definition}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 4.
设\(V = M_n(F)\)，
令\(f(A,B) \defeq \tr(AB)\ (A,B \in V)\).
证明：\(f\)是非退化的.
%TODO proof
%\cref{example:双线性函数.例1}
\end{example}

\begin{definition}
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
\(U = V-\{0\}\).
\begin{itemize}
	\item 如果\(
		(\forall \alpha \in U)
		[f(\alpha,\alpha) > 0]
	\)，
	则称“\(f\)是\DefineConcept{正定的}（positive definite）”.

	\item 如果\(
		(\forall \alpha \in U)
		[f(\alpha,\alpha) \geq 0]
	\)，
	则称“\(f\)是\DefineConcept{半正定的}（positive semi-definite）”.

	\item 如果\(
		(\forall \alpha \in U)
		[f(\alpha,\alpha) < 0]
	\)，
	则称“\(f\)是\DefineConcept{负定的}（negative definite）”.

	\item 如果\(
		(\forall \alpha \in U)
		[f(\alpha,\alpha) \leq 0]
	\)，
	则称“\(f\)是\DefineConcept{半负定的}（negative semi-definite）”.

	\item 否则，称“\(f\)是\DefineConcept{不定的}（indefinite）”.
\end{itemize}
%\cref{definition:实二次型的分类.实二次型的分类}
\end{definition}

\subsection{对称双线性函数，斜对称双线性函数}
\begin{definition}
%@see: 《高等代数（第三版 下册）》（丘维声） P169 定义4
%@see: 《Linear Algebra Done Right (Fourth Edition)》（Sheldon Axler） P337 9.9
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数.
\begin{itemize}
	\item 如果\begin{equation}
	%@see: 《高等代数（第三版 下册）》（丘维声） P169 (8)
		(\forall \alpha,\beta \in V)
		[f(\alpha,\beta) = f(\beta,\alpha)],
	\end{equation}
	则称“\(f\)是\DefineConcept{对称的}”.
	\item 如果\begin{equation}
	%@see: 《高等代数（第三版 下册）》（丘维声） P169 (9)
		(\forall \alpha,\beta \in V)
		[f(\alpha,\beta) = -f(\beta,\alpha)],
	\end{equation}
	则称“\(f\)是\DefineConcept{斜对称的}”
	或“\(f\)是\DefineConcept{反对称的}”.
\end{itemize}
\end{definition}

\cref{example:双线性函数.例1,example:双线性函数.例2,example:双线性函数.例3} 中的双线性函数也都是对称的.

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P169 例5
设\(V = \mathbb{R}^2\).
映射\(f\colon V \times V \to \mathbb{R},
\left(
	\begin{bmatrix}
		x_1 \\
		x_2
	\end{bmatrix},
	\begin{bmatrix}
		y_1 \\
		y_2
	\end{bmatrix}
\right)
\mapsto
\begin{vmatrix}
	x_1 & y_1 \\
	x_2 & y_2
\end{vmatrix}\)是斜对称双线性函数.
\end{example}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P169
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
则\begin{equation*}
	\text{$f$是对称的}
	\iff
	\text{$f$的度量矩阵是对称的}.
\end{equation*}
%TODO proof
\end{proposition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P169
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个双线性函数，
则\begin{equation*}
	\text{$f$是斜对称的}
	\iff
	\text{$f$的度量矩阵是斜对称的}.
\end{equation*}
%TODO proof
\end{proposition}

\begin{example}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 6.
设\(f\)是域\(F\ (\FieldChar F\neq2)\)上线性空间\(V\)的双线性函数.
证明：\(f\)是斜对称的，当且仅当
对于任意\(\alpha \in V\)，
都有\(f(\alpha,\alpha) = 0\).
%TODO proof
\end{example}

\begin{definition}\label{definition:双线性函数.利用双线性函数构造的正交补}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 7.
设\(V\)是域\(F\)上的线性空间，
\(f\)是\(V\)上的双线性函数，
\(f\)是对称的或斜对称的，
\(W\)是\(V\)的一个子空间.
定义：\begin{equation*}
	W^\perp
	\defeq
	\Set{
		\alpha \in V
		\given
		(\forall \beta \in W)
		[f(\alpha,\beta) = 0]
	},
\end{equation*}
称之为“\(W\)的\DefineConcept{正交补}”.
\end{definition}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 7.
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P448 例7(1)
设\(V\)是域\(F\)上的线性空间，
\(f\)是\(V\)上的双线性函数，
\(f\)是对称的或斜对称的，
\(W\)是\(V\)的一个子空间，
\(W^\perp\)是\(W\)的正交补，
则\(W^\perp\)是\(V\)的一个子空间.
\begin{proof}
由于\(f(0,\beta) = 0 f(0,\beta) = 0\)，
所以\(0 \in W^\perp\).
显然\(W^\perp\)对于\(V\)的加法与纯量乘法都封闭.
于是，由\cref{theorem:线性空间.子空间的判定2} 可知
\(W^\perp\)是\(V\)的一个子空间.
\end{proof}
\end{proposition}

\begin{proposition}
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P448 例7(2)
设\(V\)是域\(F\)上的线性空间，
\(f\)是\(V\)上的双线性函数，
\(f\)是对称的或斜对称的，
\(W\)是\(V\)的一个子空间，
\(W^\perp\)是\(W\)的正交补，
则\begin{gather*}
	\Rad W \subseteq W^\perp, \\
	\Rad W = W \cap W^\perp.
\end{gather*}
\begin{proof}
由\(\Rad W\)与\(W^\perp\)的定义立即可得.
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:双线性函数.利用双线性函数构造的正交补.正交补空间的维数}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 8.(1)
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P448 例8(1)
设\(V\)是域\(F\)上的\(n\)维线性空间，
\(f\)是\(V\)上的非退化的双线性函数，
\(f\)是对称的或斜对称的，
\(W\)是\(V\)的一个子空间，
则\(\dim W + \dim W^\perp = \dim V\).
\begin{proof}
设\(f\)是\(V\)上的非退化的对称双线性函数.
在\(W\)中取一个基\(\AutoTuple{\alpha}{m}\)，
把它扩充成\(V\)的一个基\(\AutoTuple{\alpha}{m},\AutoTuple{\alpha}[m+1]{n}\).
设\(f\)在此基下的度量矩阵为\(A\).
由于\(f\)是非退化的，
所以\(A\)是满秩的.
对于\(V\)中向量\(\alpha = (\AutoTuple{a}{n}) x\)，
有\begin{align*}
	\alpha \in W^\perp
	&\iff (\forall \beta \in W)[f(\alpha,\beta) = 0] \\
	&\iff f(\alpha,\alpha_1)
			= f(\alpha,\alpha_2)
			= \dotsb
			= f(\alpha,\alpha_m)
			= 0 \\
	&\iff x^T A \epsilon_1
			= x^T A \epsilon_2
			= \dotsb
			= x^T A \epsilon_m
			= 0 \\
	&\iff x^T A (\AutoTuple{\epsilon}{m}) = 0 \\
	&\iff (\AutoTuple{\epsilon}{m})^T A^T x = 0 \\
	&\iff \text{$x$是关于$z$的齐次线性方程组$(\AutoTuple{\epsilon}{m})^T A^T z = 0$的解}.
\end{align*}
把上述齐次线性方程组的解空间记作\(U\)，
则\(\alpha \in W^\perp\)，
当且仅当\(\alpha\)在上述基下的坐标\(x \in U\).
由于\(\alpha \mapsto x\)是\(V\)到\(F^n\)的一个同构映射，
且\(W^\perp\)在此同构映射下的象是\(U\)，
因此\(
	\dim W^\perp
	= \dim U
	= n - \rank((\AutoTuple{\epsilon}{m})^T A^T)
	= n - \rank(\AutoTuple{\epsilon}{m})^T
	= n - m
	= \dim V - \dim W
\)，
从而\(\dim W + \dim W^\perp = \dim V\).
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:双线性函数.利用双线性函数构造的正交补.正交补的对合律}
%@see: 《高等代数（第三版 下册）》（丘维声） P173 习题10.1 8.(2)
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P448 例8(2)
设\(V\)是域\(F\)上的\(n\)维线性空间，
\(f\)是\(V\)上的非退化的双线性函数，
\(f\)是对称的或斜对称的，
\(W\)是\(V\)的一个子空间，
则\((W^\perp)^\perp = W\).
\begin{proof}
任取\(\gamma \in W\)，
对于任意\(\delta \in W^\perp\)，
有\(f(\delta,\gamma) = 0\).
由于\(f\)要么是对称的，要么是斜对称的，
因此\(f(\gamma,\delta) = 0\)，
从而\(\gamma \in (W^\perp)^\perp\)，
于是\(W \subseteq (W^\perp)^\perp\).
对于\(W^\perp\)，
由\cref{theorem:双线性函数.利用双线性函数构造的正交补.正交补空间的维数} 可知，
\(\dim W^\perp + \dim(W^\perp)^\perp = \dim V\).
与\(\dim W + \dim W^\perp = \dim V\)比较可得\(\dim W = \dim(W^\perp)^\perp\).
因此\(W = (W^\perp)^\perp\).
\end{proof}
\end{proposition}

\subsection{对称双线性函数的度量矩阵}
\begin{theorem}\label{theorem:双线性函数.数域上的对称双线性函数在某个基下的度量矩阵是对角矩阵}
%@see: 《高等代数（第三版 下册）》（丘维声） P169 定理3
设\(f\)是数域\(K\)上\(n\)维线性空间\(V\)上的一个对称双线性函数，
则\(V\)中存在一个基\(\AutoTuple{\epsilon}{n}\)，
使得\(f\)在基\(\AutoTuple{\epsilon}{n}\)下的度量矩阵是对角矩阵.
%TODO proof
\end{theorem}

\begin{theorem}\label{theorem:双线性函数.特征不为2的域上的对称双线性函数在某个基下的度量矩阵是对角矩阵}
%@see: 《高等代数（第三版 下册）》（丘维声） P170 定理4
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P429 定理3
设\(f\)是域\(F\ (\FieldChar F\neq2)\)上\(n\)维线性空间\(V\)上的一个对称双线性函数，
则\(V\)中存在一个基\(\AutoTuple{\epsilon}{n}\)，
使得\(f\)在基\(\AutoTuple{\epsilon}{n}\)下的度量矩阵是对角矩阵.
%TODO proof
\end{theorem}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P171
设\(f\)是域\(F\ (\FieldChar F\neq2)\)上\(n\)维线性空间\(V\)上的一个非退化的对称双线性函数，
则\(V\)中存在一个基\(\AutoTuple{\eta}{n}\)，
使得\begin{align*}
	f(\eta_i,\eta_j)
	&= 0,
	\quad i \neq j; i,j=1,2,\dotsc,n; \\
	f(\eta_i,\eta_i)
	&\neq 0,
	\quad i=1,2,\dotsc,n.
\end{align*}
\end{proposition}

\cref{theorem:双线性函数.特征不为2的域上的对称双线性函数在某个基下的度量矩阵是对角矩阵} 的意义之一
在于它可以用来简化计算对称双线性函数在任意一对向量上的函数值.
由于\(V\)中一定存在一个基\(\AutoTuple{\eta}{n}\)，
使得\(f\)在基\(\AutoTuple{\eta}{n}\)下的度量矩阵是对称矩阵\(\diag(\AutoTuple{d}{n})\)，
从而对于\(\forall\alpha=x_1\eta_1+\dotsb+x_n\eta_n\)
和\(\forall\beta=y_1\eta_1+\dotsb+y_n\eta_n\)，
有\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P171 (13)
	f(\alpha,\beta)
	= d_1 x_1 y_1 + \dotsb + d_n x_n y_n.
\end{equation*}

\subsection{斜对称双线性函数的度量矩阵}
%@see: 《高等代数（第三版 下册）》（丘维声） P171
下面来讨论斜对称双线性函数.
设\(f\)是域\(F\)上\(n\)维线性空间\(V\)上的一个斜对称双线性函数.

当\(\FieldChar F=2\)时，
对\(\forall \alpha,\beta \in V\)，
由\hyperref[definition:域的特征.域的特征]{域的特征的定义}有\(2 f(\alpha,\beta) = 0,
f(\alpha,\beta) = -f(\alpha,\beta)\).
由于\(f\)是斜对称的，
所以\(f(\alpha,\beta)
= -f(\beta,\alpha)
= f(\beta,\alpha)\)，
这就说明\(f\)是对称的.
因此，在特征为2的域上的线性空间中，\begin{equation*}
	\text{$f$是斜对称双线性函数}
	\iff
	\text{$f$是对称双线性函数}.
\end{equation*}

当\(\FieldChar F\neq2\)时，
对\(\forall \alpha,\beta \in V\)，
由\(f(\alpha,\alpha) = -f(\alpha,\alpha),
2 f(\alpha,\alpha) = 0,
f(\alpha,\alpha) = 0\).

\begin{theorem}\label{theorem:双线性函数.特征不为2的域上的斜对称双线性函数在某个基下的度量矩阵是分块对角矩阵}
%@see: 《高等代数（第三版 下册）》（丘维声） P171 定理5
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P430 定理4
\def\MatrixChunk{\begin{bmatrix}
	0 & 1 \\
	-1 & 0
\end{bmatrix}}
设\(f\)是域\(F\ (\FieldChar F\neq2)\)上的\(n\)维线性空间\(V\)上的斜对称双线性函数，
则\(V\)中存在一个基\(\delta_1,\delta_{-1},\delta_2,\delta_{-2},\dotsc,\delta_r,\delta_{-r},\eta_1,\eta_2,\dotsc,\eta_s\)，
使得\begin{align*}
%@see: 《高等代数（第三版 下册）》（丘维声） P171 (15)
	f(\delta_i,\delta_{-i}) &= 1,
	\quad i=1,2,\dotsc,r; \\
	f(\delta_i,\delta_j) &= 0,
	\quad i+j\neq0; \\
	f(\alpha,\eta_k) &= 0,
	\quad \alpha \in V; k=1,2,\dotsc,s;
\end{align*}
且\(f\)在这个基下的度量矩阵是\begin{equation*}
%@see: 《高等代数（第三版 下册）》（丘维声） P171 (14)
	\diag\left(
		\MatrixChunk,
		\dotsc,
		\MatrixChunk,
		0,
		\dotsc,
		0
	\right).
\end{equation*}
%TODO proof
\end{theorem}

\begin{proposition}
%@see: 《高等代数（第三版 下册）》（丘维声） P172
\def\MatrixChunk{\begin{bmatrix}
	0 & 1 \\
	-1 & 0
\end{bmatrix}}
如果域\(F\ (\FieldChar F\neq2)\)上的\(n\)维线性空间\(V\)上的斜对称双线性函数\(f\)是非退化的，
则\(V\)中存在一个基\(\AutoTuple{\delta}{n}\)，
使得\(f\)在基\(\AutoTuple{\delta}{n}\)下的度量矩阵是分块对角矩阵\begin{equation*}
	%@see: 《高等代数（第三版 下册）》（丘维声） P173 (20)
		\diag\left(
			\MatrixChunk,
			\dotsc,
			\MatrixChunk
		\right).
	\end{equation*}
\begin{proof}
由\cref{theorem:双线性函数.特征不为2的域上的斜对称双线性函数在某个基下的度量矩阵是分块对角矩阵} 可得.
\end{proof}
\end{proposition}

\begin{example}
%@see: 《高等代数（大学高等代数课程创新教材 第二版 下册）》（丘维声） P446 例6
设\(f\)是域\(F\ (\FieldChar F\neq2)\)上线性空间\(V\)上的一个对称或斜对称的双线性函数，
\(W\)是\(V\)的一个有限维真子空间，
向量\(\xi \in V-W\)与\(\Rad W\)中的每一个向量都正交.
证明：在\(W\)的陪集\(\xi+W\)中，
存在\(\eta\neq0\)，
使得对于任意\(\beta \in W\)，
成立\(f(\eta,\beta) = 0\).
\begin{proof}
设\(\dim W = m\).
\begin{enumerate}
	\item 假设\(f\)是对称的，
	则\(f\)在\(W\)上的限制\(f \SetRestrict W\)是\(W\)上的一个对称双线性函数.

	如果\(f \SetRestrict W = 0\)，
	则\(\Rad W = W\)，
	于是对于任意\(\beta \in W\)，
	有\(f(\xi,\beta) = 0\)，
	从而对于\(\xi+W\)中任意一个向量\(\xi+\gamma\)（其中\(\gamma \in W\)）有\begin{equation*}
		f(\xi+\gamma,\beta)
		= f(\xi,\beta)
		+ f(\gamma,\beta)
		= 0.
	\end{equation*}

	如果\(f \SetRestrict W \neq 0\)，
	那么由\cref{theorem:双线性函数.特征不为2的域上的对称双线性函数在某个基下的度量矩阵是对角矩阵} 可知，
	\(W\)中存在一个基\(\AutoTuple{\alpha}{m}\)，
	使得\(f \SetRestrict W\)在此基下的度量矩阵为\begin{equation*}
		D = \diag(d_1,d_2,\dotsc,d_r,0,\dotsc,0),
	\end{equation*}
	其中\(d_i\neq0\ (i=1,2,\dotsc,r)\)且\(1 \leq r \leq m\).
	令\begin{equation*}
		\eta
		\defeq
		\xi - \sum_{i=1}^r \frac{f(\xi,\alpha_i)}{f(\alpha_i,\alpha_i)} \alpha_i,
	\end{equation*}
	则当\(1 \leq j \leq r\)时，
	有\begin{align*}
		f(\eta,\alpha_j)
		&= f(\xi,\alpha_j) - \sum_{i=1}^r \frac{f(\xi,\alpha_i)}{f(\alpha_i,\alpha_i)} f(\alpha_i,\alpha_j) \\
		&= f(\xi,\alpha_j) - f(\xi,\alpha_j)
		= 0;
	\end{align*}
	当\(r < j \leq m\)时，
	由于\(f(\alpha_i,\alpha_j) = 0\ (i=1,2,\dotsc,m)\)，
	因此\(\alpha_j \in \Rad W\)，
	从而有\begin{equation*}
		f(\eta,\alpha_j)
		= f(\xi,\alpha_j)
		= 0.
	\end{equation*}
	因此，对于\(W\)中任意一个向量\(\beta = \sum_{i=1}^m b_i \alpha_i\)，
	有\begin{equation*}
		f(\eta,\beta)
		= f\left( \eta,\sum_{i=1}^m b_i \alpha_i \right)
		= \sum_{i=1}^m b_i f(\eta,\alpha_i)
		= 0.
	\end{equation*}

	\item 假设\(f\)是斜对称的.

	如果\(f \SetRestrict W = 0\)，
	则与“\(f\)是对称双线性函数”这个情形一样，命题依然成立.

	如果\(f \SetRestrict W \neq 0\)，
	那么由\cref{theorem:双线性函数.特征不为2的域上的斜对称双线性函数在某个基下的度量矩阵是分块对角矩阵} 可知，
	\(W\)中存在一个基\(
		\delta_1, \allowbreak
		\delta_{-1}, \allowbreak
		\delta_2, \allowbreak
		\delta_{-2}, \allowbreak
		\dotsc, \allowbreak
		\delta_r, \allowbreak
		\delta_{-r}, \allowbreak
		\eta_1, \allowbreak
		\eta_2, \allowbreak
		\dotsc, \allowbreak
		\eta_{m-2r}
	\)，
	使得\(f\)在这个基下的度量矩阵是\begin{equation*}
		\def\MatrixChunk{\begin{bmatrix}
			0 & 1 \\
			-1 & 0
		\end{bmatrix}}
		\diag\left(
			\MatrixChunk,
			\dotsc,
			\MatrixChunk,
			0,
			\dotsc,
			0
		\right),
	\end{equation*}
	其中\(2 \leq 2r \leq m\).
	令\begin{equation*}
		\eta
		\defeq
		\xi + \sum_{i=1}^r (
			-f(\xi,\delta_{-i}) \delta_i
			+f(\xi,\delta_i) \delta_{-i}
		),
	\end{equation*}
	则当\(1 \leq j \leq r\)时，
	有\begin{align*}
		f(\eta,\delta_j)
		&= f(\xi,\delta_j)
		+ \sum_{i=1}^r (
			-f(\xi,\delta_{-i}) f(\delta_i,\delta_j)
			+f(\xi,\delta_i) f(\delta_{-i},\delta_j)
		) \\
		&= f(\xi,\delta_j)
		+ f(\xi,\delta_j) (-1)
		= 0, \\
		f(\eta,\delta_{-j})
		&= f(\xi,\delta_{-j})
		+ \sum_{i=1}^r (
			-f(\xi,\delta_{-i}) f(\delta_i,\delta_{-j})
			+f(\xi,\delta_i) f(\delta_{-i},\delta_{-j})
		) \\
		&= f(\xi,\delta_{-j})
		+ f(\xi,\delta_{-j}) (-1)
		= 0.
	\end{align*}
	当\(1 \leq s \leq m-2r\)时，
	由于\((\forall \beta \in W)[f(\eta_s,\beta) = 0]\)，
	因此\(\eta_s \in \Rad W\)，
	从而\(f(\xi,\eta_s) = 0\)，
	于是\begin{equation*}
		f(\eta,\eta_s)
		= f(\xi,\eta_s)
		+ \sum_{i=1}^r (
			-f(\xi,\delta_{-i}) f(\delta_i,\eta_s)
			+f(\xi,\delta_i) f(\delta_{-i},\eta_s)
		)
		= 0.
	\end{equation*}
	综上所述，有\((\forall \beta \in W)[f(\eta,\beta) = 0]\).
	\qedhere
\end{enumerate}
\end{proof}
\end{example}
