\section{正交矩阵}
在平面上取一个直角坐标系\(Oxy\)，
设向量\(\vb\alpha,\vb\beta\)的坐标分别是\((a_1,a_2),(b_1,b_2)\).
如果\(\vb\alpha,\vb\beta\)都是单位向量，并且互相垂直，
那么它们的坐标满足：\begin{equation*}
	\begin{split}
		a_1^2+a_2^2=1, \qquad
		a_1b_1+a_2b_2=0, \\
		b_1a_1+b_2a_2=0, \qquad
		b_1^2+b_2^2=1,
	\end{split}
\end{equation*}
这组等式可以写成一个矩阵等式：\begin{equation*}
	\begin{bmatrix}
		a_1 & a_2 \\
		b_1 & b_2
	\end{bmatrix}
	\begin{bmatrix}
		a_1 & b_1 \\
		a_2 & b_2
	\end{bmatrix}
	= \begin{bmatrix}
		1 & 0 \\
		0 & 1
	\end{bmatrix}.
\end{equation*}
如果记\(\vb{A}=(\vb\alpha^T,\vb\beta^T)\)，
那么上式又可写为\begin{equation*}
	\vb{A}^T\vb{A}=\vb{E}.
\end{equation*}
根据\(\vb\alpha,\vb\beta\)的几何意义，
我们很自然地把矩阵\(\vb{A}\)称为“正交矩阵”.

这一节我们来研究正交矩阵的性质，尤其是它的行（列）向量组的特性.

\subsection{正交向量组}
\begin{definition}
在欧几里得空间中，如果
\begin{itemize}
	\item 向量组\(A=\{\AutoTuple{\vb\alpha}{m}\}\)不含零向量，即\(\vb0 \notin A\)；
	\item \(A\)中向量两两正交，即\(\VectorInnerProductDot{\vb\alpha_i}{\vb\alpha_j} = 0\ (i \neq j)\)，
\end{itemize}
则称\(A\)为一个\DefineConcept{正交向量组}，简称\DefineConcept{正交组}.
由单位向量构成的正交组叫做\DefineConcept{规范正交组}或\DefineConcept{标准正交组}.
称含有\(n\)个向量的规范正交组
\begin{equation*}
	\AutoTuple{\vb\epsilon}{n}
\end{equation*}
为\(\mathbb{R}^n\)的一个\DefineConcept{规范正交基}%
或\DefineConcept{标准正交基}（orthonormal basis）.
%@see: https://mathworld.wolfram.com/OrthonormalBasis.html
\end{definition}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》二填空题/第15题
已知向量\(\vb\alpha_1 = \begin{bmatrix}
	1 \\ 0 \\ 1 \\ 1
\end{bmatrix},
\vb\alpha_2 = \begin{bmatrix}
	-1 \\ -1 \\ 0 \\ 1
\end{bmatrix},
\vb\alpha_3 = \begin{bmatrix}
	0 \\ 1 \\ -1 \\ 1
\end{bmatrix},
\vb\beta = \begin{bmatrix}
	1 \\ 1 \\ 1 \\ -1
\end{bmatrix},
\vb\gamma = k_1 \vb\alpha_1 + k_2 \vb\alpha_2 + k_3 \vb\alpha_3\)，
若\(\vb\gamma^T \vb\alpha_i = \vb\beta^T \alpha_i\ (i=1,2,3)\)，
计算\(k_1^2 + k_2^2 + k_3^2\).
\begin{solution}
注意到\(\vb\alpha_1^T \vb\alpha_2
= \vb\alpha_2^T \vb\alpha_3
= \vb\alpha_3^T \vb\alpha_1
= 0\)，
\(\AutoTuple{\vb\alpha}{3}\)是一个正交向量组，
于是\begin{equation*}
	\vb\gamma^T \vb\alpha_i
	= k_i \abs{\vb\alpha_i}^2
	% \(\abs{\vb\alpha_i}^2 = 3\)
	= 3 k_i
	\quad(i=1,2,3).
\end{equation*}
又因为\begin{equation*}
	\vb\beta^T \vb\alpha_1 = 1,
	\qquad
	\vb\beta^T \vb\alpha_2 = -3,
	\qquad
	\vb\beta^T \vb\alpha_3 = -1,
\end{equation*}
所以\(k_1 = \frac13,
k_2 = -1,
k_3 = -\frac13\)，
从而有\(k_1^2 + k_2^2 + k_3^2
= \frac{11}9\).
\end{solution}
\end{example}

\subsection{正交矩阵}
\begin{definition}\label{definition:正交矩阵.正交矩阵的定义}
%@see: 《高等代数（第三版 上册）》（丘维声） P145 定义1
%@see: 《线性代数》（张慎语、周厚隆） P107 定义6
设\(\vb{Q} \in M_n(\mathbb{R})\)，
\(\vb{E}\)是实数域上的\(n\)阶单位矩阵.
若\(\vb{Q}\)满足\begin{equation}\label{equation:正交矩阵.正交矩阵的定义式}
	\vb{Q}^T \vb{Q} = \vb{E},
\end{equation}
则称“\(\vb{Q}\)是\(n\)阶\DefineConcept{正交矩阵}（orthogonal matrix）”.
%@see: https://mathworld.wolfram.com/OrthogonalMatrix.html
\end{definition}

\begin{example}%\label{example:正交矩阵.二阶旋转矩阵是正交矩阵}
%@see: 《高等代数（第三版 上册）》（丘维声） P145 例1
设\(\theta\)是实数，
判断矩阵\(
	\vb{A} \defeq \begin{bmatrix}
		\cos\theta & -\sin\theta \\
		\sin\theta & \cos\theta
	\end{bmatrix}
\)是否正交矩阵.
\begin{solution}
由于\begin{align*}
	\vb{A} \vb{A}^T
	&= \begin{bmatrix}
		\cos\theta & -\sin\theta \\
		\sin\theta & \cos\theta
	\end{bmatrix}
	\begin{bmatrix}
		\cos\theta & \sin\theta \\
		-\sin\theta & \cos\theta
	\end{bmatrix} \\
	&= \begin{bmatrix}
		\cos^2\theta + \sin^2\theta & \cos\theta \sin\theta - \sin\theta \cos\theta \\
		\sin\theta \cos\theta - \cos\theta \sin\theta & \sin^2\theta + \cos^2\theta
	\end{bmatrix} \\
	&= \begin{bmatrix}
		1 & 0 \\
		0 & 1
	\end{bmatrix},
\end{align*}
所以\(\vb{A}\)是正交矩阵.
\end{solution}
\end{example}

\begin{property}
若\(\vb{A},\vb{B}\)都是\(n\)阶正交矩阵，
则\begin{itemize}
	\item \(\vb{A}\)的行列式\(\det\vb{A}\)的绝对值等于\(1\)，
	即\begin{equation}\label{equation:正交矩阵.正交矩阵的行列式}
		\abs{\det\vb{A}}=1.
	\end{equation}

	\item \(\vb{A}\)可逆.

	\item \(\vb{A}\)的转置\(\vb{A}^T\)以及它的逆\(\vb{A}^{-1}\)满足
	\begin{equation}\label{equation:正交矩阵.正交矩阵的转置等于正交矩阵的逆}
		\vb{A}^{-1}=\vb{A}^T.
	\end{equation}

	\item \(\vb{A}\vb{B}\)也是正交矩阵.
\end{itemize}
\begin{proof}
在正交矩阵的定义式 \labelcref{equation:正交矩阵.正交矩阵的定义式} 等号两端分别取行列式，
利用\cref{theorem:行列式.矩阵乘积的行列式,theorem:行列式.性质1} 得\begin{equation*}
	\abs{\det\vb{A}}^2
	=\abs{\det\vb{A}^T} \abs{\det\vb{A}\vphantom{^T}}
	=\abs{\det(\vb{A}^T \vb{A})}
	=\abs{\det\vb{E}}
	=1,
\end{equation*}
开方，得\(\abs{\det\vb{A}}=1\).

因为\(\det\vb{A}\neq0\)，
\(\vb{A}\)是非奇异矩阵，
所以由\cref{theorem:逆矩阵.矩阵可逆的充分必要条件1} 可知，正交矩阵\(\vb{A}\)可逆.

由\hyperref[definition:可逆矩阵.可逆矩阵的定义]{可逆矩阵的定义}有\(\vb{A}^{-1}\vb{A}=\vb{E}\)，
与\hyperref[equation:正交矩阵.正交矩阵的定义式]{正交矩阵的定义式}
\(\vb{A}^T\vb{A}=\vb{E}\)比较可知\(\vb{A}^{-1}=\vb{A}^T\).

利用矩阵乘法的结合律，
便得\begin{equation*}
	(\vb{A}\vb{B})(\vb{A}\vb{B})^T
	= (\vb{A}\vb{B})(\vb{B}^T\vb{A}^T)
	= \vb{A}(\vb{B}\vb{B}^T)\vb{A}^T
	= \vb{A}\vb{E}\vb{A}^T
	= \vb{A}\vb{A}^T
	= \vb{E}.
	\qedhere
\end{equation*}
\end{proof}
\end{property}

\begin{example}
由于单位矩阵\(\vb{E}\)满足\begin{equation*}
	\vb{E}^T=\vb{E}, \qquad
	\vb{E}^T \vb{E} = \vb{E} \vb{E}^T = \vb{E},
\end{equation*}
因此\(\vb{E}\)也是正交矩阵.
\end{example}

\begin{proposition}
正交矩阵\(\vb{Q}\)的伴随矩阵\(\vb{Q}^*\)满足\begin{equation*}
	\vb{Q}^*
	= \left\{ \begin{array}{rc}
		\vb{Q}^T, & \abs{\vb{Q}}>0, \\
		-\vb{Q}^T, & \abs{\vb{Q}}<0.
	\end{array} \right.
\end{equation*}
\begin{proof}
由\cref{theorem:逆矩阵.逆矩阵的唯一性}
可知\(\vb{Q}^* = \abs{\vb{Q} \vb{Q}^{-1}}\).
再由\cref{equation:正交矩阵.正交矩阵的转置等于正交矩阵的逆}
可知\(\vb{Q}^* = \abs{\vb{Q} \vb{Q}^T}\).
最后由\cref{equation:正交矩阵.正交矩阵的行列式}
就有\(\vb{Q}^* = \pm\vb{Q}^T\).
\end{proof}
\end{proposition}
\begin{example}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
%@see: 《2013年全国硕士研究生入学统一考试（数学一）》二填空题/第13题
设\(\vb{A}\)是实数域上的\(n\ (n>2)\)阶非零矩阵，
\(\vb{A}^T\)是\(\vb{A}\)的转置矩阵，\(\vb{A}^*\)是\(\vb{A}\)的伴随矩阵.
证明：\begin{itemize}
	\item 如果\(\vb{A}^T=\vb{A}^*\)，则\(\vb{A}\)是正交矩阵，且\(\abs{\vb{A}}=1\).
	\item 如果\(\vb{A}^T+\vb{A}^*=0\)，则\(\vb{A}\)是正交矩阵，且\(\abs{\vb{A}}=-1\).
\end{itemize}
%TODO proof
% \begin{proof}
% 假设\(\vb{A}^T=\vb{A}^*\)，
% 那么\begin{equation*}
% 	\vb{A} \vb{A}^T
% 	= \vb{A} \vb{A}^*
% 	%\cref{equation:行列式.伴随矩阵.恒等式1}
% 	= \abs{\vb{A}} \vb{E}.
% 	\eqno(1)
% \end{equation*}
% 又因为\begin{equation*}
% 	\abs{\vb{A}} \abs{\vb{A}^T}
% 	%\cref{theorem:行列式.性质1}
% 	= \abs{\vb{A}}^2,
% 	\qquad
% 	\abs{\abs{\vb{A}} \vb{E}}
% 	%\cref{theorem:行列式.性质2.推论2}
% 	= \abs{\vb{A}}^n,
% \end{equation*}
% 所以\begin{equation*}
% 	\abs{\vb{A}}^2 (1 - \abs{\vb{A}}^{n-2}) = 0,
% \end{equation*}
% 解得\(\abs{\vb{A}}=0\)或\(\abs{\vb{A}}=1\).
% \end{proof}
\end{example}

\begin{proposition}\label{theorem:正交矩阵.正交矩阵的多项式的行列式1}
行列式小于零的正交矩阵\(\vb{A}\)与单位矩阵\(\vb{E}\)之和的行列式\(\abs{\vb{A}+\vb{E}}\)等于零.
\begin{proof}
见\cref{example:正交矩阵.行列式小于零的正交矩阵与单位矩阵之和的行列式等于零}.
\end{proof}
\end{proposition}
\begin{proposition}\label{theorem:正交矩阵.正交矩阵的多项式的行列式2}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
设\(\vb{A}\)是\(n\)阶正交矩阵.
证明：\begin{itemize}
	\item 如果\(n\)是偶数，且\(\abs{\vb{A}}<0\)，则\(\abs{\vb{A}-\vb{E}} = 0\).
	\item 如果\(n\)是奇数，且\(\abs{\vb{A}}>0\)，则\(\abs{\vb{A}-\vb{E}} = 0\).
\end{itemize}
\begin{proof}
由\cref{equation:正交矩阵.正交矩阵的行列式} 可知，
当\(\abs{\vb{A}}<0\)时\(\abs{\vb{A}}=\abs{\vb{A}^T}=-1\)，
当\(\abs{\vb{A}}>0\)时\(\abs{\vb{A}}=\abs{\vb{A}^T}=1\).

假设\(\vb{A}\)是偶数阶正交矩阵，且\(\abs{\vb{A}}<0\)，
则\begin{align*}
	\abs{\vb{A}^T} \abs{\vb{A}-\vb{E}}
	%\cref{theorem:行列式.矩阵乘积的行列式}
	= \abs{\vb{A}^T (\vb{A}-\vb{E})}
	%\cref{equation:矩阵的乘法.左分配律}
	= \abs{\vb{E}-\vb{A}^T}
	%\cref{theorem:行列式.性质1}
	%\cref{theorem:矩阵的转置.性质2}
	= \abs{\vb{E}-\vb{A}}
	%\cref{theorem:行列式.性质2.推论2}
	= (-1)^n \abs{\vb{A}-\vb{E}}
	= \abs{\vb{A}-\vb{E}};
\end{align*}
又因为\(\abs{\vb{A}^T} \abs{\vb{A}-\vb{E}} = -\abs{\vb{A}-\vb{E}}\)，
所以\begin{equation*}
	\abs{\vb{A}-\vb{E}}
	= -\abs{\vb{A}-\vb{E}},
\end{equation*}
于是\(\abs{\vb{A}-\vb{E}} = 0\).

假设\(\vb{A}\)是奇数阶正交矩阵，且\(\abs{\vb{A}}>0\)，
则同理可知\(\abs{\vb{A}-\vb{E}} = 0\)成立.
\end{proof}
\end{proposition}
\begin{remark}
由\cref{theorem:正交矩阵.正交矩阵的多项式的行列式1,theorem:正交矩阵.正交矩阵的多项式的行列式2} 可知，
当\(\vb{A}\)是奇数阶正交矩阵时，总有\begin{equation*}
	\abs{\vb{A}+\vb{E}} \abs{\vb{A}-\vb{E}} = 0.
\end{equation*}
另外还可以看出，
行列式小于零的正交矩阵必有一个特征值为\(-1\)，
行列式大于零的奇数阶正交矩阵必有一个特征值为\(1\)，
行列式小于零的偶数阶正交矩阵必有一个特征值为\(1\).
\end{remark}
\begin{proposition}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
设\(\vb{A}\)是正交矩阵，\(1\)和\(-1\)都是\(\vb{A}\)的特征值，
则\(\vb{A}\)的属于\(1\)的特征向量都与\(\vb{A}\)的属于\(-1\)的特征向量正交.
\begin{proof}
设\(\vb\alpha\)是\(\vb{A}\)的属于\(1\)的特征向量，
\(\vb\beta\)是\(\vb{A}\)的属于\(-1\)的特征向量，
即\begin{equation*}
	\vb{A} \vb\alpha = \vb\alpha,
	\qquad
	\vb{A} \vb\beta = -\vb\beta.
\end{equation*}
那么\begin{equation*}
	\vb\alpha^T = (\vb{A} \vb\alpha)^T = \vb\alpha^T \vb{A}^T,
	\qquad
	\vb\beta = -A \vb\beta,
\end{equation*}
从而有\begin{equation*}
	\vb\alpha^T \vb\beta
	= (\vb\alpha^T \vb{A}^T) (-A \vb\beta)
	= - \vb\alpha^T (\vb{A}^T \vb{A}) \vb\beta
	= - \vb\alpha^T \vb\beta,
\end{equation*}
因此\(\vb\alpha^T \vb\beta = 0\).
\end{proof}
\end{proposition}

\begin{example}
设\(\vb{Q}=(\AutoTuple{\vb\alpha}{n})\)是\(n\)阶实矩阵，
则\(\vb{Q}\)是正交矩阵的充分必要条件是\(\AutoTuple{\vb\alpha}{n}\)是\(\mathbb{R}^{n \times 1}\)的规范正交基.
\begin{proof}
在\(\vb{Q}\)是\(n\)阶实矩阵的前提下，\begin{align*}
	&\text{\(\vb{Q}\)是正交矩阵}
	\iff \vb{Q}^T\vb{Q} = \vb{Q}\vb{Q}^T = \vb{E} \\
	&\iff \vb{E} = \begin{bmatrix}
		\vb\alpha_1^T \\ \vb\alpha_2^T \\ \vdots \\ \vb\alpha_n^T
	\end{bmatrix} (\AutoTuple{\vb\alpha}{n})
	= \begin{bmatrix}
		\vb\alpha_1^T \vb\alpha_1 & \vb\alpha_1^T \vb\alpha_2 & \dots & \vb\alpha_1^T \vb\alpha_n \\
		\vb\alpha_2^T \vb\alpha_1 & \vb\alpha_2^T \vb\alpha_2 & \dots & \vb\alpha_2^T \vb\alpha_n \\
		\vdots & \vdots & & \vdots \\
		\vb\alpha_n^T \vb\alpha_1 & \vb\alpha_n^T \vb\alpha_2 & \dots & \vb\alpha_n^T \vb\alpha_n
	\end{bmatrix} \\
	&\iff \vb\alpha_i^T \vb\alpha_j = (\vb\alpha_i,\vb\alpha_j)
	= \left\{ \begin{array}{ll}
		1, & i=j, \\
		0, & i \neq j,
	\end{array} \right. i,j=1,2,\dotsc,n \\
	&\iff \text{\(\AutoTuple{\vb\alpha}{n}\)是规范正交基}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

可以看出，正交矩阵是由一系列初等矩阵\(\vb{P}(i,j)\)的乘积.

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P152 习题4.6 4.
设\(\vb{A}\)是实数域上的\(n\)阶矩阵.
证明：如果\(\vb{A}\)具有\begin{enumerate}
	\item \(\vb{A}\)是正交矩阵，
	\item \(\vb{A}\)是对称矩阵，
	\item \(\vb{A}\)是对合矩阵，
\end{enumerate}
这三个性质中的任意两个性质，
则必有第三个性质.
%TODO
\end{example}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P152 习题4.6 5.
证明：如果正交矩阵\(\vb{A}\)是上三角矩阵，
则\(\vb{A}\)一定是对角矩阵，
并且其主对角元是\(\pm1\).
%TODO
\end{example}
