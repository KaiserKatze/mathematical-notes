\section{正交矩阵}
在平面上取一个直角坐标系\(Oxy\)，
设向量\(\a,\b\)的坐标分别是\((a_1,a_2),(b_1,b_2)\).
如果\(\a,\b\)都是单位向量，并且互相垂直，
那么它们的坐标满足：\[
	\begin{split}
		a_1^2+a_2^2=1, \qquad
		a_1b_1+a_2b_2=0, \\
		b_1a_1+b_2a_2=0, \qquad
		b_1^2+b_2^2=1,
	\end{split}
\]
这组等式可以写成一个矩阵等式：\[
	\begin{bmatrix}
		a_1 & a_2 \\
		b_1 & b_2
	\end{bmatrix}
	\begin{bmatrix}
		a_1 & b_1 \\
		a_2 & b_2
	\end{bmatrix}
	= \begin{bmatrix}
		1 & 0 \\
		0 & 1
	\end{bmatrix}.
\]
如果记\(\A=(\a^T,\b^T)\)，
那么上式又可写为\[
	\A^T\A=\E.
\]
根据\(\a,\b\)的几何意义，
我们很自然地把矩阵\(\A\)称为“正交矩阵”.

这一节我们来研究正交矩阵的性质，尤其是它的行（列）向量组的特性.

\subsection{正交向量组}
\begin{definition}
在欧几里得空间中，如果
\begin{itemize}
	\item 向量组\(A=\{\AutoTuple{\a}{m}\}\)不含零向量，即\(\z \notin A\)；
	\item \(A\)中向量两两正交，即\(\VectorInnerProductDot{\vb\alpha_i}{\vb\alpha_j} = 0\ (i \neq j)\)，
\end{itemize}
则称\(A\)为一个\DefineConcept{正交向量组}，简称\DefineConcept{正交组}.
由单位向量构成的正交组叫做\DefineConcept{规范正交组}或\DefineConcept{标准正交组}.
称含有\(n\)个向量的规范正交组
\[
	\AutoTuple{\e}{n}
\]
为\(\mathbb{R}^n\)的一个\DefineConcept{规范正交基}%
或\DefineConcept{标准正交基}（orthonormal basis）.
%@see: https://mathworld.wolfram.com/OrthonormalBasis.html
\end{definition}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》二填空题/第15题
已知向量\(\vb\alpha_1 = \begin{bmatrix}
	1 \\ 0 \\ 1 \\ 1
\end{bmatrix},
\vb\alpha_2 = \begin{bmatrix}
	-1 \\ -1 \\ 0 \\ 1
\end{bmatrix},
\vb\alpha_3 = \begin{bmatrix}
	0 \\ 1 \\ -1 \\ 1
\end{bmatrix},
\vb\beta = \begin{bmatrix}
	1 \\ 1 \\ 1 \\ -1
\end{bmatrix},
\vb\gamma = k_1 \vb\alpha_1 + k_2 \vb\alpha_2 + k_3 \vb\alpha_3\)，
若\(\vb\gamma^T \vb\alpha_i = \vb\beta^T \alpha_i\ (i=1,2,3)\)，
计算\(k_1^2 + k_2^2 + k_3^2\).
\begin{solution}
注意到\(\vb\alpha_1^T \vb\alpha_2
= \vb\alpha_2^T \vb\alpha_3
= \vb\alpha_3^T \vb\alpha_1
= 0\)，
\(\AutoTuple{\vb\alpha}{3}\)是一个正交向量组，
于是\begin{equation*}
	\vb\gamma^T \vb\alpha_i
	= k_i \abs{\vb\alpha_i}^2
	% \(\abs{\vb\alpha_i}^2 = 3\)
	= 3 k_i
	\quad(i=1,2,3).
\end{equation*}
又因为\begin{equation*}
	\vb\beta^T \vb\alpha_1 = 1,
	\qquad
	\vb\beta^T \vb\alpha_2 = -3,
	\qquad
	\vb\beta^T \vb\alpha_3 = -1,
\end{equation*}
所以\(k_1 = \frac13,
k_2 = -1,
k_3 = -\frac13\)，
从而有\(k_1^2 + k_2^2 + k_3^2
= \frac{11}9\).
\end{solution}
\end{example}

\subsection{正交矩阵}
\begin{definition}\label{definition:正交矩阵.正交矩阵的定义}
%@see: 《高等代数（第三版 上册）》（丘维声） P145 定义1
%@see: 《线性代数》（张慎语、周厚隆） P107 定义6
设\(\Q \in M_n(\mathbb{R})\)，
\(\E\)是实数域上的\(n\)阶单位矩阵.
若\(\Q\)满足\begin{equation}\label{equation:正交矩阵.正交矩阵的定义式}
	\Q^T \Q = \E,
\end{equation}
则称“\(\Q\)是\(n\)阶\DefineConcept{正交矩阵}（orthogonal matrix）”.
%@see: https://mathworld.wolfram.com/OrthogonalMatrix.html
\end{definition}

\begin{property}
若\(\A,\B\)都是\(n\)阶正交矩阵，
则\begin{itemize}
	\item \(\A\)的行列式\(\det\A\)的绝对值等于\(1\)，
	即\begin{equation}\label{equation:正交矩阵.正交矩阵的行列式}
		\abs{\det\A}=1.
	\end{equation}

	\item \(\A\)可逆.

	\item \(\A\)的转置\(\A^T\)以及它的逆\(\A^{-1}\)满足
	\begin{equation}\label{equation:正交矩阵.正交矩阵的转置等于正交矩阵的逆}
		\A^{-1}=\A^T.
	\end{equation}

	\item \(\A\B\)也是正交矩阵.
\end{itemize}
\begin{proof}
在正交矩阵的定义式 \labelcref{equation:正交矩阵.正交矩阵的定义式} 等号两端分别取行列式，
利用\cref{theorem:行列式.矩阵乘积的行列式,theorem:行列式.性质1} 得\[
	\abs{\det\A}^2
	=\abs{\det\A^T} \abs{\det\A\vphantom{^T}}
	=\abs{\det(\A^T \A)}
	=\abs{\det\E}
	=1,
\]
开方，得\(\abs{\det\A}=1\).

因为\(\det\A\neq0\)，
\(\A\)是非奇异矩阵，
所以由\cref{theorem:逆矩阵.矩阵可逆的充分必要条件1} 可知，正交矩阵\(\A\)可逆.

由\hyperref[definition:可逆矩阵.可逆矩阵的定义]{可逆矩阵的定义}有\(\A^{-1}\A=\E\)，
与\hyperref[equation:正交矩阵.正交矩阵的定义式]{正交矩阵的定义式}
\(\A^T\A=\E\)比较可知\(\A^{-1}=\A^T\).

利用矩阵乘法的结合律，
便得\[
	(\A\B)(\A\B)^T
	= (\A\B)(\B^T\A^T)
	= \A(\B\B^T)\A^T
	= \A\E\A^T
	= \A\A^T
	= \E.
	\qedhere
\]
\end{proof}
\end{property}

\begin{example}
由于单位矩阵\(\E\)满足\[
	\E^T=\E, \qquad
	\E^T \E = \E \E^T = \E,
\]
因此\(\E\)也是正交矩阵.
\end{example}

\begin{proposition}
正交矩阵\(\Q\)的伴随矩阵\(\Q^*\)满足\[
	\Q^*
	= \left\{ \begin{array}{rc}
		\Q^T, & \abs{\Q}>0, \\
		-\Q^T, & \abs{\Q}<0.
	\end{array} \right.
\]
\begin{proof}
由\cref{theorem:逆矩阵.逆矩阵的唯一性}
可知\(\Q^* = \abs{\Q \Q^{-1}}\).
再由\cref{equation:正交矩阵.正交矩阵的转置等于正交矩阵的逆}
可知\(\Q^* = \abs{\Q \Q^T}\).
最后由\cref{equation:正交矩阵.正交矩阵的行列式}
就有\(\Q^* = \pm\Q^T\).
\end{proof}
\end{proposition}
\begin{example}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
%@see: 《2013年全国硕士研究生入学统一考试（数学一）》二填空题/第13题
设\(\A\)是实数域上的\(n\ (n>2)\)阶非零矩阵，
\(\A^T\)是\(\A\)的转置矩阵，\(\A^*\)是\(\A\)的伴随矩阵.
证明：\begin{itemize}
	\item 如果\(\A^T=\A^*\)，则\(\A\)是正交矩阵，且\(\abs{\A}=1\).
	\item 如果\(\A^T+\A^*=0\)，则\(\A\)是正交矩阵，且\(\abs{\A}=-1\).
\end{itemize}
%TODO proof
% \begin{proof}
% 假设\(\A^T=\A^*\)，
% 那么\[
% 	\A \A^T
% 	= \A \A^*
% 	%\cref{equation:行列式.伴随矩阵.恒等式1}
% 	= \abs{\A} \E.
% 	\eqno(1)
% \]
% 又因为\[
% 	\abs{\A} \abs{\A^T}
% 	%\cref{theorem:行列式.性质1}
% 	= \abs{\A}^2,
% 	\qquad
% 	\abs{\abs{\A} \E}
% 	%\cref{theorem:行列式.性质2.推论2}
% 	= \abs{\A}^n,
% \]
% 所以\[
% 	\abs{\A}^2 (1 - \abs{\A}^{n-2}) = 0,
% \]
% 解得\(\abs{\A}=0\)或\(\abs{\A}=1\).
% \end{proof}
\end{example}

\begin{proposition}\label{theorem:正交矩阵.正交矩阵的多项式的行列式1}
行列式小于零的正交矩阵\(\A\)与单位矩阵\(\E\)之和的行列式\(\abs{\A+\E}\)等于零.
\begin{proof}
见\cref{example:正交矩阵.行列式小于零的正交矩阵与单位矩阵之和的行列式等于零}.
\end{proof}
\end{proposition}
\begin{proposition}\label{theorem:正交矩阵.正交矩阵的多项式的行列式2}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
设\(\A\)是\(n\)阶正交矩阵.
证明：\begin{itemize}
	\item 如果\(n\)是偶数，且\(\abs{\A}<0\)，则\(\abs{\A-\E} = 0\).
	\item 如果\(n\)是奇数，且\(\abs{\A}>0\)，则\(\abs{\A-\E} = 0\).
\end{itemize}
\begin{proof}
由\cref{equation:正交矩阵.正交矩阵的行列式} 可知，
当\(\abs{\A}<0\)时\(\abs{\A}=\abs{\A^T}=-1\)，
当\(\abs{\A}>0\)时\(\abs{\A}=\abs{\A^T}=1\).

假设\(\A\)是偶数阶正交矩阵，且\(\abs{\A}<0\)，
则\begin{align*}
	\abs{\A^T} \abs{\A-\E}
	%\cref{theorem:行列式.矩阵乘积的行列式}
	= \abs{\A^T (\A-\E)}
	%\cref{equation:矩阵的乘法.左分配律}
	= \abs{\E-\A^T}
	%\cref{theorem:行列式.性质1}
	%\cref{theorem:矩阵的转置.性质2}
	= \abs{\E-\A}
	%\cref{theorem:行列式.性质2.推论2}
	= (-1)^n \abs{\A-\E}
	= \abs{\A-\E};
\end{align*}
又因为\(\abs{\A^T} \abs{\A-\E} = -\abs{\A-\E}\)，
所以\begin{equation*}
	\abs{\A-\E}
	= -\abs{\A-\E},
\end{equation*}
于是\(\abs{\A-\E} = 0\).

假设\(\A\)是奇数阶正交矩阵，且\(\abs{\A}>0\)，
则同理可知\(\abs{\A-\E} = 0\)成立.
\end{proof}
\end{proposition}
\begin{remark}
由\cref{theorem:正交矩阵.正交矩阵的多项式的行列式1,theorem:正交矩阵.正交矩阵的多项式的行列式2} 可知，
当\(\A\)是奇数阶正交矩阵时，总有\[
	\abs{\A+\E} \abs{\A-\E} = 0.
\]
另外还可以看出，
行列式小于零的正交矩阵必有一个特征值为\(-1\)，
行列式大于零的奇数阶正交矩阵必有一个特征值为\(1\)，
行列式小于零的偶数阶正交矩阵必有一个特征值为\(1\).
\end{remark}
\begin{proposition}
%@see: https://www.bilibili.com/video/BV1eG411L7xU/
设\(\A\)是正交矩阵，\(1\)和\(-1\)都是\(\A\)的特征值，
则\(\A\)的属于\(1\)的特征向量都与\(\A\)的属于\(-1\)的特征向量正交.
\begin{proof}
设\(\vb\alpha\)是\(\A\)的属于\(1\)的特征向量，
\(\vb\beta\)是\(\A\)的属于\(-1\)的特征向量，
即\[
	\A \vb\alpha = \vb\alpha,
	\qquad
	\A \vb\beta = -\vb\beta.
\]
那么\[
	\vb\alpha^T = (\A \vb\alpha)^T = \vb\alpha^T \A^T,
	\qquad
	\vb\beta = -A \vb\beta,
\]
从而有\[
	\vb\alpha^T \vb\beta
	= (\vb\alpha^T \A^T) (-A \vb\beta)
	= - \vb\alpha^T (\A^T \A) \vb\beta
	= - \vb\alpha^T \vb\beta,
\]
因此\(\vb\alpha^T \vb\beta = 0\).
\end{proof}
\end{proposition}

\begin{example}
设\(\Q=(\AutoTuple{\a}{n})\)是\(n\)阶实矩阵，
则\(\Q\)是正交矩阵的充分必要条件是\(\AutoTuple{\a}{n}\)是\(\mathbb{R}^{n \times 1}\)的规范正交基.
\begin{proof}
在\(\Q\)是\(n\)阶实矩阵的前提下，\begin{align*}
	&\text{\(\Q\)是正交矩阵}
	\iff \Q^T\Q = \Q\Q^T = \E \\
	&\iff \E = \begin{bmatrix}
		\a_1^T \\ \a_2^T \\ \vdots \\ \a_n^T
	\end{bmatrix} (\AutoTuple{\a}{n})
	= \begin{bmatrix}
		\a_1^T \a_1 & \a_1^T \a_2 & \dots & \a_1^T \a_n \\
		\a_2^T \a_1 & \a_2^T \a_2 & \dots & \a_2^T \a_n \\
		\vdots & \vdots & & \vdots \\
		\a_n^T \a_1 & \a_n^T \a_2 & \dots & \a_n^T \a_n
	\end{bmatrix} \\
	&\iff \a_i^T \a_j = (\a_i,\a_j)
	= \left\{ \begin{array}{ll}
		1, & i=j, \\
		0, & i \neq j,
	\end{array} \right. i,j=1,2,\dotsc,n \\
	&\iff \text{\(\AutoTuple{\a}{n}\)是规范正交基}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

可以看出，正交矩阵是由一系列初等矩阵\(\P(i,j)\)的乘积.

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P152 习题4.6 4.
设\(\A\)是实数域上的\(n\)阶矩阵.
证明：如果\(\A\)具有\begin{enumerate}
	\item \(\A\)是正交矩阵，
	\item \(\A\)是对称矩阵，
	\item \(\A\)是对合矩阵，
\end{enumerate}
这三个性质中的任意两个性质，
则必有第三个性质.
%TODO
\end{example}

\begin{example}
%@see: 《高等代数（第三版 上册）》（丘维声） P152 习题4.6 5.
证明：如果正交矩阵\(\A\)是上三角矩阵，
则\(\A\)一定是对角矩阵，
并且其主对角元是\(\pm1\).
%TODO
\end{example}
