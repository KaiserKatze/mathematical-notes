\section{方差}
\subsection{方差的定义及计算}
\begin{definition}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P97 定义2.4.1
若期望\(E[X-E(X)]^2\)存在，
称为“\(X\)的\DefineConcept{方差}（variance）”，
%@see: https://mathworld.wolfram.com/Variance.html
记为\(D(x)\)或\(\operatorname{Var}(X)\)，
即\begin{equation}\label{equation:随机变量的数字特征.方差的定义式}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P97 (2.4.3)
	D(X) \defeq E[X-E(X)]^2.
\end{equation}
把\(D(x)\)的正平方根\(\sqrt{D(X)}\)
称为“\(X\)的\DefineConcept{标准差}（standard deviation）”.
%@see: https://mathworld.wolfram.com/StandardDeviation.html
\end{definition}

\begin{theorem}
对于随机变量\(X\)，
\begin{itemize}
	\item 当\(X\)为\DefineConcept{离散型随机变量}，
	其分布律为\(p_k = P(X=x_k)\ (k=1,2,\dotsc)\)，
	则\begin{equation}\label{equation:随机变量的数字特征.离散型方差的计算式}
		D(X) = \sum_{k=1}^\infty [x_k - E(X)]^2 p_k;
	\end{equation}

	\item 当\(X\)为\DefineConcept{连续型随机变量}，
	有密度函数\(f(x)\)，
	则\begin{equation}\label{equation:随机变量的数字特征.连续型方差的计算式}
		D(X) = \int_{-\infty}^{+\infty} [x - E(X)]^2 f(x) \dd{x}.
	\end{equation}
\end{itemize}
\end{theorem}

\begin{corollary}\label{theorem:随机变量的数字特征.常用的方差的计算式}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 定理2.4.7
对于随机变量\(X\)，有\begin{equation}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 (2.4.4)
	D(X) = E(X^2) - E^2(X).
\end{equation}
\begin{proof}
利用二项式定理展开\([X-E(X)]^2\)，
注意到\(E(X)\)是固定的数而不再是随机变量，
再依据\cref{theorem:随机变量的数字特征.数学期望的性质2} 即有：
\begin{align*}
	D(X) &= E[X-E(X)]^2
	= E\{X^2 - 2E(X) \cdot X + E^2(X)\} \\
	&= E(X^2) - 2E(X) \cdot E(X) + E^2(X) \\
	&= E(X^2) - E^2(X).
	\qedhere
\end{align*}
\end{proof}
\end{corollary}

\begin{proposition}\label{theorem:随机变量的数字特征.泊松分布的方差}
设\(X \sim P(\lambda)\)，
则\(D(X) = \lambda\).
\begin{proof}
直接计算得\begin{align*}
	E[X(X-1)]
	&= \sum_{k=0}^\infty {k(k-1) \frac{\lambda^k}{k!} e^{-\lambda}}
	= \lambda^2 e^{-\lambda} \sum_{k=2}^\infty {\frac{\lambda^{k-2}}{(k-2)!}} \\
	&\xlongequal{n=k-1} \lambda^2 e^{-\lambda} \sum_{n=0}^\infty {\frac{\lambda^n}{n!}}
	= \lambda^2 e^{-\lambda} e^\lambda = \lambda^2. \\
	D(X)
	&= E(X^2) - E^2(X)
	= E[X(X-1)] + E(X) - E^2(X) \\
	&= \lambda^2 + \lambda - \lambda^2 = \lambda.
	\qedhere
\end{align*}
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:随机变量的数字特征.伽马分布的方差}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P101 例2.4.8
设\(X \sim \Gamma(\alpha,\beta)\)，
则\(D(X) = \frac{\alpha}{\beta^2}\).
\begin{proof}
\def\inti{\int_0^{+\infty}}%
直接计算得
\begin{align*}
	E(X^2) &= \int_0^{+\infty} x^2
		\frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x} \dd{x} \\
	&= \frac{1}{\beta^2 \Gamma(\alpha)}
		\int_0^{+\infty} (\beta x)^{\alpha+1} e^{-(\beta x)} \dd(\beta x) \\
	&= \frac{\Gamma(\alpha+2)}{\beta^2 \Gamma(\alpha)}
	= \frac{(\alpha+1) \alpha \Gamma(\alpha)}{\beta^2 \Gamma(\alpha)}
	= \frac{(\alpha+1) \alpha}{\beta^2}. \\
	D(X) &= E(X^2) - E^2(X)
	= \frac{\alpha (\alpha+1)}{\beta^2} - \left( \frac{\alpha}{\beta} \right)^2
	= \frac{\alpha}{\beta^2}.
	\qedhere
\end{align*}
\end{proof}
\end{proposition}

\begin{proposition}\label{theorem:随机变量的数字特征.指数分布的方差}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P101 例2.4.8
设\(X \sim e(\lambda)\)，
则\(D(X) = \frac{1}{\lambda^2}\).
\begin{proof}
既然\(e(\lambda) = \Gamma(1,\lambda)\)，结果不言自喻.
\end{proof}
\end{proposition}

\subsection{方差的性质}
\begin{property}\label{theorem:随机变量的数字特征.方差的性质1}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 定理2.4.5
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 定理2.4.6
设\(C,a,b\)是常数，随机变量\(X\)存在方差\(D(X)\)，
则\begin{itemize}
	\item \(D(C) = 0\)；
	\item \(D(aX+b) = a^2 D(X)\).
\end{itemize}
\end{property}

\begin{property}\label{theorem:随机变量的数字特征.方差的性质2}
设随机变量\(X\)、\(Y\)相互独立，
且它们的方差都存在，
则\[
	D(X \pm Y) = D(X) + D(Y).
\]
\end{property}

\begin{corollary}\label{theorem:随机变量的数字特征.方差的性质3}
若随机变量\(\AutoTuple{X}{n}\)相互独立，
且它们的方差都存在，
而\(C_1,C_2,\dotsc,C_n\)都是常数，
则\[
	D\left( \sum_{i=1}^n C_i X_i \right)
	= \sum_{i=1}^n C_i^2 \cdot D(X_i).
\]
\end{corollary}

\begin{theorem}
设\(X \sim B(1,p)\)，则\(D(X) = p(1-p)\).
%TODO proof
\end{theorem}

\begin{theorem}\label{theorem:随机变量的数字特征.二项分布的方差}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 例2.4.6
设\(X \sim B(n,p)\)，则\(D(X) = np(1-p)\).
%TODO proof
\end{theorem}

\begin{theorem}\label{theorem:随机变量的数字特征.均匀分布的方差}
%@see: 《概率论与数理统计》（茆诗松、周纪芗、张日权） P100 例2.4.7
设\(X \sim U(a,b)\)，则\(E(X) = \frac{a+b}{2}\)，\(D(X) = \frac{(b-a)^2}{12}\).
\begin{proof}
直接计算得\begin{align*}
	E(X) &= \int_{-\infty}^{+\infty} x f(x) \dd{x}
	= \int_a^b x \frac{1}{b-a} \dd{x}
	= \frac{1}{b-a} \frac{1}{2} (x^2)_a^b
	= \frac{a+b}{2}, \\
	E(X^2) &= \int_{-\infty}^{+\infty} x^2 f(x) \dd{x}
	= \int_a^b x^2 \frac{1}{b-a} \dd{x}
	= \frac{1}{b-a} \frac{1}{3} (x^3)_a^b
	= \frac{a^2+ab+b^2}{3}, \\
	D(X) &= E(X^2) - E^2(X)
	= \frac{(a-b)^2}{12}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:随机变量的数字特征.几何分布的方差}
设\(X \sim G(p)\)，则\(D(X) = \frac{q}{p^2}\).
\begin{proof}
记\(q = 1-p\)，则\(p_k = pq^{k-1}\ (k=1,2,\dotsc)\).
因为\begin{align*}
	\sum_{k=1}^\infty (k+1)kpq^{k-1}
	&= p \sum_{k=1}^\infty \dv[2]{q}(q^{k+1})
	= p \dv[2]{q}(\sum_{k=1}^\infty q^{k+1}) \\
	&= p \dv[2]{q}(\lim_{n\to\infty} \frac{q^2-q^{n+2}}{1-q})
	= p \dv[2]{q}(\frac{q^2}{1-q})
	= \frac{2}{p^2}, \\
\end{align*}
所以\begin{align*}
	E(X^2) &= \sum_{k=1}^\infty k^2 pq^{k-1}
	= \sum_{k=1}^\infty [(k+1)k-k] pq^{k-1}
	= \frac{2}{p^2} - \frac{1}{p}, \\
	D(X) &= E(X^2) - E^2(X)
	= \frac{2}{p^2} - \frac{1}{p} - \frac{1}{p^2}
	= \frac{q}{p^2}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

\begin{proposition}\label{theorem:随机变量的数字特征.超几何分布的方差}
设\(X \sim H(n,m,N)\)，
则\(D(X) = \frac{n m}{N} \left( 1 - \frac{M}{N} \right) \frac{N - n}{N - 1}\).
%TODO proof
\end{proposition}

\begin{example}
设随机变量\(X\)的概率分布为\(P(X=k) = \frac{C}{k!}\ (k=0,1,2,\dotsc)\)，求\(E(X^2)\).
\begin{solution}
由\hyperref[theorem:随机变量及其分布.离散型随机变量的密度函数的性质]{规范性}%
和\cref{equation:无穷级数.幂级数展开式1} 可知\[
	\sum_{k=0}^\infty \frac{C}{k!}
	= C \sum_{k=1}^\infty \eval{\frac{x^k}{k!}}_{x=1}
	= C \eval{e^x}_{x=1}
	= C e = 1
	\implies
	C = e^{-1}.
\]
那么随机变量\(X\)的分布为\[
	P(X=k) = \frac{1^k}{k!} e^{-1} \quad(k=0,1,2,\dotsc)
\]
将其与\hyperref[equation:离散型分布.泊松分布的分布律]{泊松分布的分布律}作比较，
可知\(X \sim P(1)\)，
因此\(E(X) = D(X) = 1\)，
从而有\[
	E(X^2) = D(X) + E^2(X) = 1 + 1 = 2.
\]
\end{solution}
\end{example}

\begin{proposition}\label{theorem:随机变量的数字特征.正态分布的数字特征}
设随机变量\(X \sim N(\mu,\sigma^2)\)，
则\(X\)的期望与方差分别为\[
	E(X) = \mu,
	\qquad
	D(X) = \sigma^2.
\]
\begin{proof}
设\(Y \sim N(0,1)\)，则有\begin{align*}
	E(Y) &= \int_{-\infty}^{+\infty} y \cdot \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} \dd{y}
	= 0, \\
	D(Y) &= E(Y^2)
	= \int_{-\infty}^{+\infty} y^2 \cdot \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} \dd{y} \\
	&= \frac{2}{\sqrt{2\pi}} \int_0^{+\infty} y^2 e^{-\frac{y^2}{2}} \dd{y} \\
	&\xlongequal{t=y^2/2} \frac{2}{\sqrt{2\pi}} \int_0^{+\infty} 2 t e^{-t} \frac{\sqrt{2}}{2} t^{-\frac{1}{2}} \dd{t} \\
	&=\frac{2}{\sqrt{\pi}} \int_0^{+\infty} t^{\frac{1}{2}} e^{-t} \dd{t} \\
	&= \frac{2}{\sqrt{\pi}} \Gamma\left(\frac{3}{2}\right)
	= \frac{2}{\sqrt{\pi}} \cdot \frac{1}{2} \Gamma\left(\frac{1}{2}\right)
	= 1.
\end{align*}
由\hyperref[definition:正态分布.正态分布的定义]{正态分布的定义}可知，
\(Y = \frac{X-\mu}{\sigma}\)，
\(X = \sigma Y + \mu\)，
从而\[
	E(X) = E(\sigma Y + \mu) = \sigma E(Y) + \mu = \mu,
\]\[
	D(X) = D(\sigma Y + \mu) = \sigma^2 D(Y) = \sigma^2.
	\qedhere
\]
\end{proof}
\end{proposition}

\begin{example}
设随机变量\(X\)的分布函数为\[
	F(x) = \frac{3}{10} \Phi(x) + \frac{7}{10} \Phi\left(\frac{x-1}{2}\right),
\]
其中\(\Phi(x)\)是标准正态分布的分布函数，求\(E(X)\).
\begin{solution}
对\(F(x)\)求导得\[
	f(x) = F'(x)
	= \frac{3}{10} \phi(x)
		+ \frac{7}{10} \phi\left(\frac{x-1}{2}\right) \frac{1}{2},
\]
其中\(\phi(x)\)是标准正态分布的密度函数.
那么\begin{align*}
	E(X) &= \int_{-\infty}^{+\infty} x f(x) \dd{x} \\
	&= \int_{-\infty}^{+\infty} x \frac{3}{10} \phi(x) \dd{x}
	+ \int_{-\infty}^{+\infty} x \frac{7}{10} \phi\left(\frac{x-1}{2}\right) \frac{1}{2} \dd{x} \\
	&\xlongequal{y=(x-1)/2} \frac{3}{10} \cdot 0
	+ \frac{7}{10} \int_{-\infty}^{+\infty} (2y+1) \phi(y) \dd{y}
	= \frac{7}{10}.
\end{align*}
\end{solution}
\end{example}

\begin{proposition}\label{theorem:正态分布与自然指数分布族.正态分布的线性性质}
设随机变量\(X \sim N(\mu,\sigma^2)\)，
当\(b \neq 0\)时，
有\begin{equation}
	Y = a+bX \sim N(a+b\mu,b^2\sigma^2).
\end{equation}
\begin{proof}
令\[
	Z = \frac{Y-(a+b\mu)}{\abs{b}\sigma}.
\]

当\(b > 0\)时，\[
	Z = \frac{(a+bX)-(a+b\mu)}{b\sigma}=\frac{X-\mu}{\sigma},
\]
故\(Z \sim N(0,1)\).

当\(b < 0\)时，\[
Z = \frac{(a+bX)-(a+b\mu)}{-b\sigma}=-\frac{X-\mu}{\sigma},
\]
故\(Z \sim N(0,1)\).

综上所述，\(Y \sim N(a+b\mu,b^2\sigma^2)\).
\end{proof}
\end{proposition}
