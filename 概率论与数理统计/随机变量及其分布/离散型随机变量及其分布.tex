\section{离散型随机变量及其分布}
\subsection{离散型随机变量及其分布的概念与性质}
\begin{definition}
若随机变量\(X\)的所有可能取值为有限个或可数无穷多个值，则称\(X\)为\DefineConcept{离散型随机变量}.
\end{definition}

\begin{definition}
设离散型随机变量\(X\)的取值为\(\AutoTuple{x}{n},\dotsc\)，
且\(X\)取各值的概率为\[
	p_k = P(X=x_k),
	\quad k=1,2,\dotsc,
\]
称上式为离散型随机变量\(X\)的\DefineConcept{概率分布}，
或\DefineConcept{概率函数}，
也可称为\DefineConcept{分布律}.
\end{definition}

这样，概率分布刻画了离散型随机变量的统计规律性.

\(X\)的概率分布可用表格或矩阵表示，即
\begin{center}
	\begin{tabular}{c|*5c}
		\hline
		\(X\) & \(x_1\) & \(x_2\) & ... & \(x_n\) & ... \\ \hline
		\(p_k\) & \(p_1\) & \(p_2\) & ... & \(p_n\) & ... \\ \hline
	\end{tabular}
\end{center}
或
\[
	X \sim \begin{pmatrix}
		x_1 & x_2 & \dots & x_n & \dots \\
		p_1 & p_2 & \dots & p_n & \dots
	\end{pmatrix}.
\]

\begin{property}\label{theorem:随机变量及其分布.离散型随机变量的密度函数的性质}
离散型随机变量的概率分布有如下的性质：
\begin{enumerate}
	\item 非负性
	\(p_k \geq 0, \quad k = 1,2,\dots\)；

	\item 归一性
	\(\sum_k p_k = 1\).
\end{enumerate}
\end{property}

这两个性质也是离散型随机变量概率分布的特征，
即对任何一个满足以上两性质的数列\(\{p_k\}\)，
都存在一个离散型随机变量\(X\)及数列\(\{x_k\}\)，
使得\[
	P(X=x_k) = p_k,
	\quad k=1,2,\dotsc.
\]

易见离散型随机变量的概率分布与分布函数是相互确定的.
当已知概率分布\[
	p_k = P(X=x_k),
	\quad k=1,2,\dotsc,
\]
注意到事件\((X=x_k)\ (k=1,2,\dotsc)\)是两两互斥的，有\begin{equation}
	F(x) = P(X \leq x)
	= P\left[ \bigcup_{x_k \leq x} (X = x_k) \right]
	= \sum_{x_k \leq x} p_k.
\end{equation}

反之，当已知离散型随机变量\(X\)的分布函数\(F(x)\)，
则\(X\)的取值点\(x_k\)为\(F(x)\)的间断点，
且\(p_k = P(X=x_k)\)为\(F(x)\)在\(x_k\)处的跃度，
从而可得\(X\)的概率分布.

\subsection{常见离散型分布}

以下几个概率分布是最常见、应用最广泛的离散型随机变量的概率分布，其中二项分布和泊松分布尤为重要.

\subsubsection{几何分布}
\begin{definition}
在\(n\)重伯努利试验中，若试验可一直重复下去，叫做\DefineConcept{可列重伯努利试验}.
\end{definition}

\begin{definition}
若随机变量\(X\)取值为\(1,2,\dotsc\)，
且\begin{equation}\label{equation:离散型分布.几何分布的分布律}
	P(X=k) = p q^{k-1}, \quad k=1,2,\dotsc,
\end{equation}其中\(0 < p < 1\)，\(q = 1-p\)，
则称\(X\)服从参数为\(p\)的\DefineConcept{几何分布}，
记为\(X \sim G(p)\).
\end{definition}

几何分布的随机变量\(X\)的意义是在可列重伯努利试验中，
事件在前\(X-1\)次试验时不发生而在第\(X\)次试验时发生的概率.

\subsubsection{超几何分布}
\begin{definition}
设\(N\)、\(n\)、\(m\)为正整数，且\(n \leq N\)，\(m \leq N\)，
若随机变量\(X\)服从分布律\begin{equation}\label{equation:离散型分布.超几何分布的分布律}
	P(X=k) = \frac{C_m^k C_{N-m}^{n-k}}{C_N^n}, \quad k=0,1,\dotsc,n,
\end{equation}
则称\(X\)服从\DefineConcept{超几何分布}，
记为\(X \sim H(n,m,N)\)，
其中\(n\)、\(n\)、\(m\)为参数.
\end{definition}

超几何分布的随机变量\(X\)的意义是：
假设一个口袋中有红白两种颜色共计\(N\)个球，其中有\(m\)个红球；
现在我们不放回地从袋中取出\(n\)个球，则取出的红球数为\(X\).

\subsubsection{二项分布}
\begin{definition}
若\(X\)取值为\(0,1,\dotsc,n\)，
且\begin{equation}\label{equation:离散型分布.二项分布的分布律}
	P(X=k) = C_n^k p^k q^{n-k},
	\quad k=0,1,\dotsc,n,
\end{equation}
其中\(0 < p < 1\)，\(q = 1-p\)，
则称\(X\)服从\DefineConcept{二项分布}，
记为\(X \sim B(n,p)\).

特别地，当\(n = 1\)时，二项分布\(B(1,p)\)称为~\DefineConcept{0-1分布}，
即\[
	X \sim \begin{pmatrix} 0 & 1 \\ q & p \end{pmatrix},
\]
或写为\[
	P(X=k) = p^k q^{1-k}, \quad k=0,1.
\]
\end{definition}

二项分布的随机变量\(X\)的意义是\(n\)重伯努利试验中“成功”的次数.
假设一个口袋中有红白两种颜色共计\(N\)个球，其中有\(m\)个红球；
现在我们有放回地从袋中取出\(n\)个球，则取出的红球数为\(X\).

\begin{example}
一同学参加英语期末考试，进入考场后才发现耳机没有电池，
于是他在听力部分每题4个选项中随机选一个答案作为正确的答案，
求：\begin{enumerate}
	\item 他在20道听力题中一个也没有选对的概率；
	\item 他在20道听力题中至少选对12个的概率.
\end{enumerate}
\begin{solution}
设\(X\)表示他在20个听力题中选对的题目数，
则\(X\)表示20重伯努利试验中“成功”的次数，
即\(X \sim B(20, 1/4)\).
这样所求的概率为\begin{enumerate}
	\item \(P(X=0) = C_{20}^0 \left(\frac14\right)^0 \left(1-\frac14\right)^{20} = 0.003\ 2\).
	\item \(P(X \geq 12) = \sum_{k=12}^{20} \left(\frac14\right)^k \left(1-\frac14\right)^{20-k} = 0.000\ 9\).
\end{enumerate}
\end{solution}
\end{example}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》二填空题/第16题
设随机变量\(X\)与\(Y\)相互独立，
且\(X \sim B(1,1/3),
Y \sim B(2,1/2)\)，
计算\(P(X=Y)\).
\begin{solution}
随机变量\(X\)与\(Y\)的取值范围分别是\(\{0,1\},\{0,1,2\}\)，
那么\begin{equation*}
	P(X=Y) = P(X=0,Y=0) + P(X=1,Y=1).
\end{equation*}
因为\(X\)与\(Y\)相互独立，
所以\begin{gather*}
	P(X=0,Y=0) = P(X=0) P(Y=0), \\
	P(X=1,Y=1) = P(X=1) P(Y=1).
\end{gather*}
因为\begin{align*}
	P(X=0) &= C_1^0 \left( \frac13 \right)^0 \left( 1-\frac13 \right)^1
	= \frac23, \\
	P(X=1) &= C_1^1 \left( \frac13 \right)^1 \left( 1-\frac13 \right)^0
	= \frac13, \\
	P(Y=0) &= C_2^0 \left( \frac12 \right)^0 \left( 1-\frac12 \right)^2
	= \frac14, \\
	P(Y=1) &= C_2^1 \left( \frac12 \right)^1 \left( 1-\frac12 \right)^1
	= \frac12,
\end{align*}
所以\(P(X=Y) = \frac23 \cdot \frac14 + \frac13 \cdot \frac12
= \frac13\).
\end{solution}
\end{example}

\begin{theorem}
当\(N\)很大时，二项概率与超几何概率有\[
	\frac{C_m^k C_{N-m}^{n-k}}{C_N^n}
	\approx
	C_n^k p^k (1-p)^{n-k}, \quad k=0,1,\dotsc,n,
\]
其中\(p=\frac{m}{N}\).
也就是说，当\(N\)很大时，不放回抽取可视为有放回抽取.
%TODO proof
\end{theorem}

\subsubsection{泊松分布}
\begin{theorem}[泊松定理]\label{theorem:泊松分布.泊松定理}
设随机变量\(X_n \sim B(n,p_n)\)，
\(0 < p_n < 1\)，
且满足\(n p_n = \lambda\)，
则\begin{equation}
	\lim_{n\to\infty} P(X_n=k)
	= \frac{\lambda^k}{k!} e^{-\lambda},
	\quad k=0,1,\dotsc.
\end{equation}
\begin{proof}
因为\begin{align*}
	P(X_n=k) &= C_n^k p_n^k (1-p_n)^{n-k}
	= \frac{1}{k!} n(n-1)\dotsm(n-k+1)
	\left(\frac{\lambda}{n}\right)^k
	\left(1-\frac{\lambda}{n}\right)^{n-k} \\
	&= \frac{1}{k!}
	\cdot \frac{n(n-1)\dotsm(n-k+1)}{n^k}
	\cdot \lambda^k
	\cdot \left(1-\frac{\lambda}{n}\right)^n
	\cdot \left(1-\frac{\lambda}{n}\right)^{-k},
\end{align*}
其中\(\lambda\)是与\(n\)无关的数，
而\(k\)是任意给定的非负整数，
从而\begin{gather*}
	\lim_{n\to\infty} \frac{n(n-1)\dotsm(n-k+1)}{n^k}
	= \lim_{n\to\infty} \frac{n}{n}
	\cdot \lim_{n\to\infty} \frac{n-1}{n}
	\dotsm \lim_{n\to\infty} \frac{n-k+1}{n}
	= 1^k = 1, \\
	\lim_{n\to\infty} \left(1-\frac{\lambda}{n}\right)^{-k}
	= \left(1-\lim_{n\to\infty} \frac{\lambda}{n}\right)^{-k}
	= 1^{-k} = 1, \\
	\lim_{n\to\infty} \left(1-\frac{\lambda}{n}\right)^n
	= \lim_{n\to\infty}
	\left(1-\frac{\lambda}{n}\right)^{\frac{n}{\lambda} \cdot \lambda}
	= e^{-\lambda},
\end{gather*}
所以\[
	\lim_{n\to\infty} P(X_n=k)
	= \frac{\lambda^k}{k!} e^{-\lambda},
	\quad k=0,1,\dotsc.
	\qedhere
\]
\end{proof}
\end{theorem}

注意到泊松定理中极限值\(\frac{\lambda^k}{k!} e^{-\lambda} > 0\ (k=0,1,\dotsc)\)，
且\(\sum_{k=0}^\infty \frac{\lambda^k}{k!} e^{-\lambda} = 1\)，
满足非负性和规范性，从而可以据此定义一个分布.

\begin{definition}
若随机变量\(X\)可能的取值为\(0,1,2,\dotsc\)，
且\begin{equation}\label{equation:离散型分布.泊松分布的分布律}
	P(X=k) = \frac{\lambda^k}{k!} e^{-\lambda},
	\quad k=0,1,\dotsc,
\end{equation}
其中\(\lambda > 0\)为常数，
则称\(X\)服从泊松分布，
记为\(X \sim P(\lambda)\).
\end{definition}

由泊松定理可见，当\(p\)较小（通常要求\(p \leq 0.1\)），
而\(n\)较大（通常要求\(n \geq 50\)）时，
二项分布的概率函数近似于泊松分布的概率函数，
即\[
	P_n(k) = C_n^k p^k (1-p)^{n-k}
	\approx \frac{\lambda^k}{k!} e^{-\lambda},
	\quad k=0,1,\dotsc,n,
\]
其中\(\lambda = n p\).

\subsubsection{负二项分布}
\begin{definition}
在可列重伯努利试验中，
假设每次试验成功的概率为\(p\ (0<p<1)\).
设\(X\)表示第\(r\)次成功所在的试验次数，
则\begin{equation}\label{equation:离散型分布.负二项分布的分布律}
	P(X=k) = C_{k-1}^{r-1} p^r (1-p)^{k-r},
	\quad k=r,r+1,\dotsc.
\end{equation}
称这个分布为\DefineConcept{负二项分布}（negative binomial distribution），
记作\(X \sim NB(r,p)\)，
其中参数\(r\)称为\DefineConcept{停止参数}（stopping parameter）.
%@see: https://mathworld.wolfram.com/NegativeBinomialDistribution.html
%@see: https://www.sciencedirect.com/topics/mathematics/pascal-distribution
\end{definition}

几何分布\(G(p)\)等价于负二项分布\(NB(1,p)\).
