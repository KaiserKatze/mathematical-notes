\section{充分统计量}
%@see: 《数理统计教程》（王兆军，邹长亮） P29
统计量的引入，是为了简化繁杂的样本.
但是在利用统计量进行统计推断时，
一个自然的问题是：
既然我们对样本的某些属性感兴趣，
那么我们采用的统计量是否囊括了所有与这些属性有关的信息？
1922年，费舍尔与爱丁顿两人，
就利用样本估计正态总体\(N(\mu,\sigma^2)\)的标准差的问题，展开了激烈争辩，
后者主张用\begin{equation}\label{equation:充分统计量.爱丁顿主张的统计量}
	\sqrt{\frac\pi2}
	\frac1n
	\sum_{i=1}^n \abs{X_i - \overline{X}}
\end{equation}
进行估计，
前者则主张用\begin{equation}\label{equation:充分统计量.费舍尔主张的统计量}
	\sqrt{
		\frac{1}{n-1} \sum_{i=1}^n (X_i-\overline{X})^2
	}
\end{equation}
进行估计.
费舍尔认为“\cref{equation:充分统计量.费舍尔主张的统计量}
包含了样本中有关\(\sigma\)的全部信息，
而\cref{equation:充分统计量.爱丁顿主张的统计量} 则没有”.
这就是“充分统计量”的思想源泉.

\begin{definition}
%@see: 《数理统计教程》（王兆军，邹长亮） P31 定义1.4.1
设\(F_\theta\)是总体\(X\)的分布函数，
其中\(\theta\)是未知参数.
设\(\AutoTuple{X}{n}\)是取自总体\(X\)的一个样本，
其观测值\(\AutoTuple{x}{n}\)未知.
如果当统计量\(T = T(\AutoTuple{X}{n})\)的观测值
\(T(\AutoTuple{x}{n})\)等于\(t\)时
样本\((\AutoTuple{X}{n})\)的条件概率分布
与总体分布\(F_\theta\)或参数\(\theta\)无关，
即条件概率分布的表达式中不含\(\theta\)，
则称“统计量\(T\)是分布族\(\Set{ F_\theta \given \theta \in \Theta }\)的\DefineConcept{充分统计量}（sufficient statistic）”
或“统计量\(T\)是参数\(\theta\)的\DefineConcept{充分统计量}”.
\end{definition}

\begin{example}
%@see: 《数理统计教程》（王兆军，邹长亮） P30 例1.4.2
设\(X_1,\dotsc,X_n\)独立同分布于二项分布\(B(1,p)\)，
其中\(0<p<1,n>2\).
试问\(
	T_1 \defeq \sum_{i=1}^n X_i,
	T_2 \defeq X_1 + X_2
\)是不是参数\(p\)的充分统计量.
\begin{solution}
由题意有，样本分布为\begin{equation*}
	P(X_1=x_1,\dotsc,X_n=x_n)
	= p^{x_1+\dotsb+x_n}
	(1-p)^{n-(x_1+\dotsb+x_n)},
\end{equation*}
且\(T_1 \sim B(n,p)\)，
故当\(T_1 = t\)时样本的条件分布为\begin{align*}
	&P(X_1=x_1,\dotsc,X_n=x_n \vert T_1 = t) \\
	&= \frac{
		P\left(
			X_1=x_1,
			X_2=x_2,
			X_3=x_3,
			\dotsc,
			X_{n-1}=x_{n-1},
			X_n=t-(x_1+\dotsb+x_{n-1})
		\right)
	}{
		P(T_1=t)
	} \\
	&= \frac{p^t (1-p)^{n-t}}{C_n^t p^t (1-p)^{n-t}}
	= (C_n^t)^{-1}.
\end{align*}
显然\(P(X_1=x_1,\dotsc,X_n=x_n \vert T_1 = t) = (C_n^t)^{-1}\)与参数\(p\)无关，
该条件分布中已经没有关于\(p\)的任何信息了，
或者说，样本中关于\(p\)的所有信息都包含在统计量\(T_1\)中了.
因此\(T_1\)是\(p\)的充分统计量.
但是对于统计量\(T_2\)而言，
由于\(T_2 \sim B(2,p)\)，
所以\begin{align*}
	&P(X_1=x_1,\dotsc,X_n=x_n \vert T_2 = t) \\
	&= \frac{
		P\left(
			X_1=x_1,
			X_2=t-x_1,
			X_3=x_3,
			\dotsc,
			X_{n-1}=x_{n-1},
			X_n=x_n
		\right)
	}{
		P(T_2=t)
	} \\
	&= \frac{
		p^{t+(x_3+\dotsb+x_n)}
		(1-p)^{n-t-(x_3+\dotsb+x_n)}
	}{
		C_2^t p^t (1-p)^{2-t}
	}
	= (C_2^t)^{-1} p^{x_3+\dotsb+x_n} (1-p)^{n-2-(x_3+\dotsb+x_n)}.
\end{align*}
显然\(P(X_1=x_1,\dotsc,X_n=x_n \vert T_2 = t)\)与\(p\)有关，
说明\(T_2\)没有把样本中关于\(p\)的所有信息都包含进来，
\(T_2\)不是\(p\)的充分统计量.
\end{solution}
\end{example}

\begin{example}
%@see: 《数理统计教程》（王兆军，邹长亮） P31 例1.4.3
设\(X_1,\dotsc,X_n\)独立同分布于几何分布\(G(p)\)，
其中\(0<p<1\).
证明：\(T \defeq \sum_{i=1}^n X_i\)是参数\(p\)的充分统计量.
%TODO proof
\end{example}

\begin{example}
%@see: 《数理统计教程》（王兆军，邹长亮） P32 例1.4.4
设\(X_1,\dotsc,X_n\)独立同分布于泊松分布\(P(\lambda)\).
证明：\(T \defeq \sum_{i=1}^n X_i\)是参数\(\lambda\)的充分统计量.
%TODO proof
\end{example}

\begin{example}
%@see: 《数理统计教程》（王兆军，邹长亮） P33 例1.4.5
设\(X_1,\dotsc,X_n\)独立同分布于正态分布\(N(\mu,1)\).
证明：\(T \defeq \sum_{i=1}^n X_i\)是参数\(\mu\)的充分统计量.
%TODO proof
\end{example}

从上例可以看出，对于正态总体\(N(\mu,\sigma^2)\)，
如果\(\mu,\sigma^2\)都未知，
则利用定义求解充分统计量比较困难.
另外，从上面的例子也可以看出，
想要求取充分统计量，
就必须首先猜测一个统计量，
之后再用定义证明它.
显然这种方法不便于使用.
于是有如下的定理.
\begin{theorem}\label{theorem:充分统计量.因子分解定理}
%@see: 《数理统计教程》（王兆军，邹长亮） P33 定理1.4.1（因子分解定理）
给定含有未知参数\(\theta\)的分布族\(\mathcal{F} \defeq \Set{ F_\theta \given \theta \in \Theta }\)
（如果\(\mathcal{F}\)是离散型，那么\(F_\theta\)表示累积分布函数；
如果\(\mathcal{F}\)是连续型，那么\(F_\theta\)表示概率密度函数），
设\(\AutoTuple{X}{n}\)独立同分布于\(F_\theta\)，\(T\)是一个统计量，
则\(T\)是\(\theta\)的充分统计量的充分必要条件是：
样本分布\(F_\theta(x_1,\dotsc,x_n)\)满足分解式\begin{equation*}
%@see: 《数理统计教程》（王兆军，邹长亮） P33 (1.4.2)
	F_\theta(x_1,\dotsc,x_n)
	= g_\theta(t)
	h(x_1,\dotsc,x_n),
\end{equation*}
其中\(t = T(x_1,\dotsc,x_n)\)，
而\(h(x_1,\dotsc,x_n)\)不依赖于参数\(\theta\).
%TODO proof
\end{theorem}

我们把\cref{theorem:充分统计量.因子分解定理}
称为\DefineConcept{因子分解定理}.
%@see: 《数理统计教程》（王兆军，邹长亮） P34
% 该定理是费舍尔于20世纪20年代提出的，
% 它的严格证明及一般形式是Halmos与Savage于1949年给出的.

\begin{theorem}
%@see: 《数理统计教程》（王兆军，邹长亮） P36 定理1.4.2（次序统计量的充分性）
给定分布族\(\mathcal{F}\)，
取\(F \in \mathcal{F}\)，
设\(\AutoTuple{X}{n}\)独立同分布于\(F_\theta\)，
则次序统计量\(X_{(1)},\dotsc,X_{(n)}\)是充分的.
%TODO proof David 1981
\end{theorem}

\begin{definition}
%@see: 《数理统计教程》（王兆军，邹长亮） P36 定义1.4.2（极小充分统计量）
设\(S\)是分布族\(\mathcal{F}\)的一个充分统计量.
如果对于\(\mathcal{F}\)的任意一个充分统计量\(T\)，
存在单值函数\(F\)，
使得\(S = f(T)\)，
则称“\(S\)是分布族\(\mathcal{F}\)的\DefineConcept{极小充分统计量}”.
\end{definition}
\begin{remark}
极小充分统计量和充分统计量一样，都不是唯一的.
\end{remark}

\begin{proposition}
设\(S\)是分布族\(\mathcal{F}\)的一个充分统计量，
\(f\)是一个双射，
则\(f(S)\)也是分布族\(\mathcal{F}\)的一个充分统计量.
%TODO proof
\end{proposition}
