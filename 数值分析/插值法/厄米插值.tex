\section{厄米插值}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35
有时候我们不仅希望插值函数\(P\)与目标函数\(f\)的函数值在插值节点上相等，
还希望它们的高阶导数值也在插值节点上相等.
满足上述要求的插值多项式，
称为\DefineConcept{厄米插值多项式}.

\subsection{重节点差商，泰勒插值}
\begin{theorem}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35 定理3
设\(f \in C^n[a,b]\)，
给定相异的\(n+1\)个节点\(
	a \leq x_0 < x_1 < \dotsb < x_n \leq b
\)，
则\((x_0,\dotsc,x_n) \mapsto f[x_0,\dotsc,x_n]\)是连续函数.
%TODO proof
\end{theorem}

根据差商的定义，如果\(f \in C^1[a,b]\)且\(x \neq x_0\)，则有\begin{equation*}
	\lim_{x \to x_0} f[x_0,x]
	= \lim_{x \to x_0} \frac{f(x) - f(x_0)}{x - x_0}
	= f'(x_0).
\end{equation*}
由此定义\begin{equation}
	f[x_0,x_0]
	\defeq
	\lim_{x \to x_0} f[x_0,x],
\end{equation}
称之为\DefineConcept{重节点\(x_0\)的一阶差商}.
类似地，如果\(f \in C^2[a,b]\)且\(x \neq x_0\)，则有\begin{equation*}
	f[x_0,x_0,x]
	= \frac{f[x_0,x] - f[x_0,x_0]}{x - x_0},
	\qquad
	\lim_{x \to x_0} f[x_0,x_0,x]
	= \frac12 f''(x_0).
\end{equation*}
由此定义\begin{equation}
	f[x_0,x_0,x_0]
	\defeq
	\lim_{x \to x_0} f[x_0,x_0,x],
\end{equation}
称之为\DefineConcept{重节点\(x_0\)的二阶差商}.
一般地，如果\(f \in C^n[a,b]\)，定义\begin{equation}
	f[\underbrace{x_0,\dotsc,x_0}_{\text{$n+1$个}}]
	\defeq
	\lim_{x \to x_0} f[\underbrace{x_0,\dotsc,x_0}_{\text{$n$个}},x],
\end{equation}
称之为\DefineConcept{重节点\(x_0\)的\(n\)阶差商}.
显然有\begin{equation}\label{equation:厄米插值.重节点的高阶差商与高阶导数的关系}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35 (4.1)
	f[\underbrace{x_0,\dotsc,x_0}_{\text{$n+1$个}}]
	= \frac1{n!} f^{(n)}(x_0).
\end{equation}

在\hyperref[equation:牛顿插值.牛顿差商插值多项式]{牛顿差商插值多项式}中，
若令\(x_i \to x_0\ (i=1,2,\dotsc,n)\)，
则由\cref{equation:厄米插值.重节点的高阶差商与高阶导数的关系}
可得泰勒多项式\begin{equation}\label{equation:厄米插值.泰勒插值多项式}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35 (4.2)
	P_n(x)
	= f(x_0)
	+ f'(x_0) (x-x_0)
	+ \dotsb
	+ \frac{f^{(n)}(x_0)}{n!} (x-x_0)^n.
\end{equation}
它实际上是在点\(x_0\)附近逼近\(f(x)\)的一个带导数的插值多项式，
它满足条件\begin{equation}\label{equation:厄米插值.泰勒插值多项式的高阶导数}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35 (4.3)
	P_n^{(k)}(x_0)
	= f^{(k)}(x_0)
	\quad(k=0,1,2,\dotsc,n).
\end{equation}
我们把\cref{equation:厄米插值.泰勒插值多项式} 称为\DefineConcept{泰勒插值多项式}，
它就是一个厄米插值多项式，
它的余项为\begin{equation*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P35 (4.4)
	R_n(x)
	= \frac{f^{(n+1)}(\xi)}{(n+1)!} (x-x_0)^{n+1}
	\quad(a < \xi < b).
\end{equation*}
它与\hyperref[equation:拉格朗日插值.拉格朗日插值余项]{拉格朗日插值余项}中
令\(x_i \to x_0\ (i=1,2,\dotsc,n)\)的结果一致.
实际上泰勒插值是牛顿插值的极限形式，
是只在一点\(x_0\)给出\(n+1\)个插值条件 \labelcref{equation:厄米插值.泰勒插值多项式的高阶导数}
得到的\(n\)次厄米插值多项式.

一般地，只要给出\(m+1\)个插值条件（包括函数值和导数值），
就可以造出次数不超过\(m\)次的厄米插值多项式.
由于导数条件各不相同，这里就不给出一般的厄米插值公式，只讨论两个典型的例子.

\subsection{厄米插值的应用 --- 三点三次厄米插值}
先考虑满足条件\begin{equation*}
	P(x_i) = f(x_i)
	\ (i=0,1,2)
	\quad\text{和}\quad
	P'(x_1) = f'(x_1)
\end{equation*}
的插值多项式及其余项表达式.

由给定条件，可以确定次数不超过3的插值多项式.
由于该多项式通过点\(
	(x_0,f(x_0)),
	(x_1,f(x_1)),
	(x_2,f(x_2))
\)，
所以它的形式为\begin{equation*}
	P(x)
	= f(x_0)
	+ f[x_0,x_1] (x-x_0)
	+ f[x_0,x_1,x_2] (x-x_0)(x-x_1)
	+ A (x-x_0)(x-x_1)(x-x_2),
\end{equation*}
其中\(A\)是待定常数，
可以根据条件\(P'(x_1) = f'(x_1)\)予以确定，
即\begin{equation*}
	A = \frac{
		f'(x_1) - f[x_0,x_1] - (x_1-x_0) f[x_0,x_1,x_2]
	}{
		(x_1-x_0)(x_1-x_2)
	}.
\end{equation*}
为了求出余项\(R(x) = f(x) - P(x)\)的表达式，
可以设\begin{equation*}
	R(x)
	\defeq f(x) - P(x)
	= k(x) (x-x_0) (x-x_1)^2 (x-x_2),
\end{equation*}
其中\(k(x)\)是待定函数.
构造\begin{equation*}
	\phi(t)
	\defeq
	f(t) - P(t) - k(x) (t-x_0) (t-x_1)^2 (t-x_2),
\end{equation*}
显然\(\phi(x_j) = 0\ (j=0,1,2)\)且\(\phi'(x_1) = \phi(x) = 0\).
故\(\phi(t)\)在\((a,b)\)内有5个零点（其中二重根算两个）.
假设\(f\)具有较好的可微性，
那么只要反复应用罗尔定理，
可得\(\phi^{(4)}(t)\)在\((a,b)\)内至少有一个零点\(\xi\)，
故\begin{equation*}
	\phi^{(4)}(\xi) = f^{(4)}(\xi) - 4! k(x) = 0,
\end{equation*}
于是\begin{equation*}
	k(x) = \frac1{4!} f^{(4)}(\xi),
\end{equation*}
余项表达式为\begin{equation*}
	R(x) = \frac1{4!} f^{(4)}(\xi) (x-x_0) (x-x_1)^2 (x-x_2),
\end{equation*}
其中\(\xi\)位于\(x_0,x_1,x_2\)和\(x\)所界定的范围内.
