\section{牛顿插值}
当数据增加或减少时，
拉格朗日插值法就非常不方便了，
这是因为之前的计算结果全都作废了，计算要全部从头开始.
因此，为了计算简便，就可以使用牛顿插值法.

\subsection{差商}  % 亦称\DefineConcept{均差}
\begin{definition}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30 定义2
设函数\(f\colon \mathbb{R} \to \mathbb{R}\).
\begin{itemize}
	\item 把\(f(x_i)\)
	称为“函数\(f\)关于点\(x_i\)的\DefineConcept{零阶差商}”，
	记作\(f[x_i]\).

	\item 把\begin{equation*}
		\frac{f(x_j) - f(x_i)}{x_j - x_i}
	\end{equation*}
	称为“函数\(f\)关于点\(x_i,x_j\)的\DefineConcept{一阶差商}”，
	记作\(f[x_i,x_j]\).

	\item 把\begin{equation*}
		\frac{f[x_i,x_k] - f[x_i,x_j]}{x_k - x_j}
	\end{equation*}
	称为“函数\(f\)关于点\(x_i,x_j,x_k\)的\DefineConcept{二阶差商}”，
	记作\(f[x_i,x_j,x_k]\).

	\item 把\begin{equation*}
	%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30 (3.3)
		\frac{f[x_0,\dotsc,x_{k-2},x_k] - f[x_0,\dotsc,x_{k-2},x_{k-1}]}{x_k - x_{k-1}}
	\end{equation*}
	称为“函数\(f\)关于点\(x_0,\dotsc,x_k\)的 \DefineConcept{\(k\)阶差商}”，
	记作\(f[x_0,\dotsc,x_k]\).
\end{itemize}
%@see: https://mathworld.wolfram.com/DifferenceQuotient.html
\end{definition}
\begin{remark}
在\(k\)阶差商的定义式中，
分子中的被减数\(f[x_0,\dotsc,x_{k-2},x_k]\)中没有符号\(x_{k-1}\)，
与此同时，
分子中的减数\(f[x_0,\dotsc,x_{k-2},x_{k-1}]\)中没有符号\(x_k\)，
这正好与分母\(x_k - x_{k-1}\)的顺序相反.
\end{remark}

\begin{property}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30
\(k\)阶差商\(f[x_0,\dotsc,x_k]\)
可以表示为函数值\(f(x_0),\dotsc,f(x_k)\)的线性组合，
即\begin{equation}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30 (3.4)
	f[x_0,\dotsc,x_k]
	= \sum_{j=0}^k
	\frac{f(x_j)}{
		\prod_{0 \leq i \leq k, i \neq j}
		(x_j - x_i)
	}.
\end{equation}
\end{property}

\begin{property}[差商的对称性]
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30
\(k\)阶差商\(f[x_0,\dotsc,x_k]\)的取值
与数据的编号次序无关，
即\begin{equation}
	f[x_0,\dotsc,x_i,\dotsc,x_j,\dotsc,x_k]
	= f[x_0,\dotsc,x_j,\dotsc,x_i,\dotsc,x_k].
\end{equation}
\end{property}

\begin{property}
\(k\)阶差商\(f[x_0,\dotsc,x_k]\)还可以表示为\begin{equation}\label{equation:牛顿插值.差商的计算式}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30 (3.3)'
	f[x_0,\dotsc,x_k]
	= \frac{f[x_1,\dotsc,x_{k-1},x_k] - f[x_0,x_1,\dotsc,x_{k-1}]}{x_k - x_0}.
\end{equation}
\end{property}

\begin{property}
若\(f\)在\([a,b]\)上存在\(n\)阶导数，
且\(x_0,\dotsc,x_n \in (a,b)\)，
则\begin{equation}\label{equation:牛顿插值.差商与导数的关系}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P30 (3.5)
	f[x_0,\dotsc,x_n]
	= \frac{f^{(n)}(\xi)}{n!}
	\quad(a \leq \xi \leq b).
\end{equation}
\end{property}

\begin{property}[莱布尼茨公式]
%@credit: {gemini}
设\(u,v\)都是定义在\(D\)上的一元实值函数，
给定\(k+1\ (k\geq0)\)个点\(x_0,\dotsc,x_k \in D\)，
则\begin{equation}
	(u \cdot v)[x_0,x_1,\dotsc,x_k]
	= \sum_{i=0}^k
	( u[x_0,x_1,\dotsc,x_i] )
	\cdot ( v[x_i,x_{i+1},\dotsc,x_k] ).
\end{equation}
\begin{proof}
对差商的阶数\(k\)运用数学归纳法.

当\(k=0\)时，
由零阶差商的定义有\(
	(u v)[x_0]
	= u(x_0) v(x_0)
	= u[x_0] v[x_0]
\).

当\(k=1\)时，
由一阶差商的定义有\begin{equation*}
	(u v)[x_0, x_1]
	= \frac{(u v)(x_1) - (u v)(x_0)}{x_1 - x_0}
	= \frac{u(x_1)v(x_1) - u(x_0)v(x_0)}{x_1 - x_0},
\end{equation*}
而\begin{align*}
	&\hspace{-20pt}
	u[x_0] v[x_0, x_1] + u[x_0, x_1] v[x_1]
	= u[x_0] \frac{v(x_1)-v(x_0)}{x_1-x_0} + \frac{u(x_1)-u(x_0)}{x_1-x_0} v[x_1] \\
	&= \frac{u(x_0)v(x_1) - u(x_0)v(x_0)}{x_1 - x_0}
		+ \frac{u(x_1)v(x_1) - u(x_0)v(x_1)}{x_1 - x_0} \\
	&= \frac{u(x_1)v(x_1) - u(x_0)v(x_0)}{x_1 - x_0},
\end{align*}
所以\begin{equation*}
	(u v)[x_0, x_1] = u[x_0] v[x_0, x_1] + u[x_0, x_1] v[x_1].
\end{equation*}

假设命题对任意小于\(k\)阶的差商成立，
那么\begin{gather*}
	(u \cdot v)[x_1,\dotsc,x_{k-1},x_k]
	= \sum_{i=1}^k
	( u[x_1,x_2,\dotsc,x_i] )
	\cdot ( v[x_i,x_{i+1},\dotsc,x_k] ),
	\\
	(u \cdot v)[x_0,x_1,\dotsc,x_{k-1}]
	= \sum_{i=0}^{k-1}
	( u[x_0,x_1,\dotsc,x_i] )
	\cdot ( v[x_i,x_{i+1},\dotsc,x_{k-1}] ).
\end{gather*}
由\cref{equation:牛顿插值.差商的计算式} 有\begin{equation*}
	(u v)[x_0,x_1,\dotsc,x_{k-1},x_k]
	= \frac{
		(u v)[x_1,\dotsc,x_{k-1},x_k]
		- (u v)[x_0,x_1,\dotsc,x_{k-1}]
	}{
		x_k - x_0
	}.
\end{equation*}
要证\(
	S_k
	\defeq
	\sum_{i=0}^k
	( u[x_0,x_1,\dotsc,x_i] )
	\cdot ( v[x_i,x_{i+1},\dotsc,x_k] )
\)
与\((u \cdot v)[x_0,x_1,\dotsc,x_{k-1},x_k]\)相等，
只需证\begin{equation*}
	(x_k - x_0) S_k
	= (u v)[x_1,\dotsc,x_{k-1},x_k]
	- (u v)[x_0,x_1,\dotsc,x_{k-1}].
\end{equation*}

下面利用差商的递推公式，
对\(S_k\)的每一项\(( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] )\)进行分解.

因为\(x_k - x_0 = (x_k - x_i) + (x_i - x_0)\)，
所以\begin{align*}
	&\hspace{-20pt}
	(x_k - x_0) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= (x_k - x_i) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&\hspace{20pt}
	+ (x_i - x_0) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ).
\end{align*}
由\cref{equation:牛顿插值.差商的计算式} 有\begin{gather*}
	( v[x_i,x_{i+1},\dotsc,x_k] ) \cdot (x_k - x_i)
	= v[x_{i+1},\dotsc,x_k]
	- v[x_i,\dotsc,x_{k-1}],
	\\
	( u[x_0,x_1,\dotsc,x_i] ) \cdot (x_i - x_0)
	= u[x_1,\dotsc,x_i]
	- u[x_0,\dotsc,x_{i-1}],
\end{gather*}
所以\begin{align*}
	&\hspace{-20pt}
	(x_k - x_0) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_{i+1},\dotsc,x_k] - v[x_i,\dotsc,x_{k-1}] ) \\
	&\hspace{20pt}
	+ ( u[x_1,\dotsc,x_i] - u[x_0,\dotsc,x_{i-1}] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ),
\end{align*}
于是\begin{align*}
	&\hspace{-20pt}
	(x_k - x_0) S_k
	= \sum_{i=0}^k (x_k - x_0) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= \sum_{i=0}^k [(x_k - x_i) + (x_i - x_0)] \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= \sum_{i=0}^k (x_k - x_i) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&\hspace{20pt}
		+ \sum_{i=0}^k (x_i - x_0) \cdot ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= \sum_{i=0}^k ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_{i+1},\dotsc,x_k] - v[x_i,\dotsc,x_{k-1}] ) \\
	&\hspace{20pt}
		+ \sum_{i=0}^k ( u[x_1,\dotsc,x_i] - u[x_0,\dotsc,x_{i-1}] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&= \sum_{i=0}^k ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_{i+1},\dotsc,x_k] ) \\
	&\hspace{20pt}
		- \sum_{i=0}^k ( u[x_0,x_1,\dotsc,x_i] ) \cdot ( v[x_i,\dotsc,x_{k-1}] ) \\
	&\hspace{20pt}
		+ \sum_{i=0}^k ( u[x_1,\dotsc,x_i] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	&\hspace{20pt}
		- \sum_{i=0}^k ( u[x_0,\dotsc,x_{i-1}] ) \cdot ( v[x_i,x_{i+1},\dotsc,x_k] ) \\
	%TODO
	&= \sum_{i=1}^k ( u[x_1,\dotsc,x_i] ) \cdot ( v[x_i,\dotsc,x_k] )
		- \sum_{i=0}^{k-1} ( u[x_0,\dotsc,x_i] ) \cdot ( v[x_i,\dotsc,x_{k-1}] ) \\
	&= (u v)[x_1,\dotsc,x_{k-1},x_k]
	- (u v)[x_0,x_1,\dotsc,x_{k-1}],
\end{align*}
也就是说\begin{equation*}
	S_k
	= \frac{
		(u v)[x_1,\dotsc,x_{k-1},x_k]
		- (u v)[x_0,x_1,\dotsc,x_{k-1}]
	}{
		x_k - x_0
	}
	= (u \cdot v)[x_0,x_1,\dotsc,x_k].
	\qedhere
\end{equation*}
\end{proof}
\end{property}

当我们利用\cref{equation:牛顿插值.差商的计算式} 逐阶计算差商，
可得\begin{align*}
	f[x_0,x_1,x_2]
	&= \frac{f[x_1,x_2] - f[x_0,x_1]}{x_2 - x_0}, \\
	f[x_1,x_2,x_3]
	&= \frac{f[x_2,x_3] - f[x_1,x_2]}{x_3 - x_1}, \\
	f[x_0,x_1,x_2,x_3]
	&= \frac{f[x_1,x_2,x_3] - f[x_0,x_1,x_2]}{x_3 - x_0}.
\end{align*}
根据上述计算结果，我们可以列出一张表：\begin{center}
	\begin{tblr}{*3c|*3c}
		\hline
		\(k\) & \(x_k\) & \(f(x_k)\) & 一阶差商 & 二阶差商 & 三阶差商 \\
		\hline
		0 & \(x_0\) & \(f(x_0)\) \\
		1 & \(x_1\) & \(f(x_1)\) & \(f[x_0,x_1]\) \\
		2 & \(x_2\) & \(f(x_2)\) & \(f[x_1,x_2]\) & \(f[x_0,x_1,x_2]\) \\
		3 & \(x_3\) & \(f(x_3)\) & \(f[x_2,x_3]\) & \(f[x_1,x_2,x_3]\) & \(f[x_0,x_1,x_2,x_3]\) \\
		\hline
	\end{tblr}
\end{center}
我们把上述表格称为\DefineConcept{差商表}.

\subsection{牛顿差商插值多项式}
我们把\begin{align}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P31 (3.6)
	N_n(x)
	&\defeq
	\sum_{j=0}^n f[x_0,\dotsc,x_j] \prod_{i=0}^{j-1} (x-x_i)
		\label{equation:牛顿插值.牛顿差商插值多项式} \\
	&= f(x_0)
	+ f[x_0,x_1] (x-x_0)
	+ f[x_0,x_1,x_2] (x-x_0)(x-x_1)
		\notag \\
	&\hspace{20pt}+ \dotsb
	+ f[x_0,\dotsc,x_n] (x-x_0)\dotsm(x-x_{n-1})
		\notag
\end{align}
称为\DefineConcept{牛顿差商插值多项式}，
把截断误差\begin{align}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P31 (3.7)
	R_n(x)
	&\defeq
	f(x) - N_n(x)
		\notag \\
	&= f[x,x_0,\dotsc,x_n] (x-x_0)\dotsm(x-x_n)
		\label{equation:牛顿插值.牛顿差商插值多项式的余项}
\end{align}
称为“牛顿差商插值多项式\(N_n\)的\DefineConcept{余项}”.

根据插值多项式的唯一性可知，
\cref{equation:牛顿插值.牛顿差商插值多项式的余项}
与\hyperref[equation:拉格朗日插值.拉格朗日插值余项]{拉格朗日插值余项}是等价的.
事实上，利用差商与导数的关系 \labelcref{equation:牛顿插值.差商与导数的关系}
便可由\cref{equation:牛顿插值.牛顿差商插值多项式的余项}
推出\hyperref[equation:拉格朗日插值.拉格朗日插值余项]{拉格朗日插值余项}.
但是\cref{equation:牛顿插值.牛顿差商插值多项式的余项} 更具一般性，
因为当\(f\)的导数不存在时，它仍然适用.

容易证明：\begin{gather*}
	N_0(x)
	= f[x_0], \\
	N_{k+1}(x)
	= N_k(x) + (x-x_0)\dotsm(x-x_k) \cdot f[x_0,\dotsc,x_k]
	\quad(k=0,1,2,\dotsc,n-1).
\end{gather*}

\subsection{差分}
牛顿差商插值多项式适用于节点分布不规律的情形.
如果节点是等距的，
那么插值公式可以简化.

\begin{definition}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P33
设函数\(f\colon \mathbb{R} \to \mathbb{R}\)，
给定等距节点\(x_i = x_0 + i h\ (i=0,1,2,\dotsc,n)\).
\begin{itemize}
	\item 把\(h\)称为\DefineConcept{步长}.

	\item 把\(f(x_{k+1}) - f(x_k)\)
	称为\DefineConcept{一阶向前差分}，
	记作\(\vartriangle f_k\).

	\item 把\(f(x_k) - f(x_{k-1})\)
	称为\DefineConcept{一阶向后差分}，
	记作\(\triangledown f_k\).

	\item 把\(f(x_{k+\frac12}) - f(x_{k-\frac12})\)
	称为\DefineConcept{一阶中心差分}，
	记作\(\delta f_k\).

	\item 把\(\vartriangle f_{k+1} - \vartriangle f_k\)
	称为\DefineConcept{二阶向前差分}，
	记作\(\vartriangle^2 f_k\).

	\item 把\(\triangledown f_k - \triangledown f_{k-1}\)
	称为\DefineConcept{二阶向后差分}，
	记作\(\triangledown^2 f_k\).

	\item 把\(\delta f_{k+\frac12} - \delta f_{k-\frac12}\)
	称为\DefineConcept{二阶中心差分}，
	记作\(\delta^2 f_k\).

	\item 把\(\vartriangle^{m-1} f_{k+1} - \vartriangle^{m-1} f_k\)
	称为 \DefineConcept{\(m\)阶向前差分}，
	记作\(\vartriangle^m f_k\).

	\item 把\(\triangledown^{m-1} f_k - \triangledown^{m-1} f_{k-1}\)
	称为 \DefineConcept{\(m\)阶向后差分}，
	记作\(\triangledown^m f_k\).

	\item 把\(\delta^{m-1} f_{k+\frac12} - \delta^{m-1} f_{k-\frac12}\)
	称为 \DefineConcept{\(m\)阶中心差分}，
	记作\(\delta^m f_k\).

	\item 把映射\(I\colon g(x_k) \mapsto g(x_k)\)
	称为\DefineConcept{不变算子}.

	\item 把映射\(E\colon g(x_k) \mapsto g(x_{k+1})\)
	称为\DefineConcept{移位算子}.
\end{itemize}
\end{definition}

\begin{property}
向前差分与不变算子、移位算子的关系：\begin{equation*}
	\vartriangle = E - I.
\end{equation*}
\end{property}

\begin{property}
向后差分与不变算子、移位算子的关系：\begin{equation*}
	\triangledown = I - E^{-1}.
\end{equation*}
\end{property}

\begin{property}
中心差分与不变算子、移位算子的关系：\begin{equation*}
	\delta = E^{1/2} - E^{-1/2}.
\end{equation*}
\end{property}

差分可以用函数值表示，即\begin{gather*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P33 (3.9)
	\vartriangle^n f(x_k)
	= (E - I)^n f(x_k)
	= \sum_{j=0}^n (-1)^j C_n^j E^{n-j} f(x_k)
	= \sum_{j=0}^n (-1)^j C_n^j f(x_{n+k-j}), \\
	\triangledown^n f(x_k)
	= (I - E^{-1})^n f(x_k)
	= \sum_{j=0}^n (-1)^{n-j} C_n^j E^{j-n} f(x_k)
	= \sum_{j=0}^n (-1)^{n-j} C_n^j f(x_{k+j-n}).
\end{gather*}
反过来，函数值也可以用差分表示，即\begin{gather*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P33 (3.10)
	f(x_{n+k})
	= E^n f(x_k)
	= (I + \vartriangle)^n f(x_k)
	= \left( \sum_{j=0}^n C_n^j \vartriangle^j \right) f(x_k).
\end{gather*}

差分与差商满足以下关系：\begin{gather*}
	f[x_k,x_{k+1}]
	= \frac{f(x_{k+1}) - f(x_k)}{x_{k+1} - x_k}
	= \frac{\vartriangle f_k}{h}, \\
	f[x_k,x_{k+1},x_{k+2}]
	= \frac{f[x_{k+1},x_{k+2}] - f[x_k,x_{k+1}]}{x_{k+2} - x_k}
	= \frac{\vartriangle^2 f_k}{2 h^2}, \\
	f[x_{k-1},x_k]
	= \frac{f(x_k) - f(x_{k-1})}{x_k - x_{k-1}}
	= \frac{\triangledown f_k}{h}, \\
	f[x_{k-2},x_{k-1},x_k]
	= \frac{f[x_{k-1},x_k] - f[x_{k-2},x_{k-1}]}{x_k - x_{k-2}}
	= \frac{\triangledown^2 f_k}{2 h^2}.
\end{gather*}
一般地，有\begin{gather}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P33 (3.11)
	f[x_k,\dotsc,x_{k+m}]
	= \frac1{m! h^m} \vartriangle^m f_k,
		\label{equation:牛顿插值.用向前差分表示差商} \\
	f[x_{k-m},\dotsc,x_k]
	= \frac1{m! h^m} \triangledown^m f_k.
\end{gather}

差分与导数满足以下关系：\begin{equation*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P33 (3.12)
	\vartriangle^n f_k
	= h^n f^{(n)}(\xi)
	\quad(x_k < \xi < x_{k+n}).
\end{equation*}

\subsection{牛顿差分插值多项式}
结合\cref{equation:牛顿插值.用向前差分表示差商,equation:牛顿插值.牛顿差商插值多项式} 两式，
并令\(x \defeq x_0 + t h\)，便得\begin{equation}\label{equation:牛顿插值.牛顿前插公式}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P34 (3.13)
	P_n(x_0 + t h)
	= f_0
	+ t \vartriangle f_0
	+ \frac{t(t-1)}{2!} \vartriangle^2 f_0
	+ \dotsb
	+ \frac{t(t-1)\dotsm(t-n+1)}{n!} \vartriangle^n f_0.
\end{equation}
我们把\cref{equation:牛顿插值.牛顿前插公式}
称为\DefineConcept{牛顿前插公式}.
由\cref{equation:牛顿插值.牛顿差商插值多项式的余项}
可得它的余项为\begin{equation}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P34 (3.14)
	R_n(x)
	= \frac{t(t-1)\dotsm(t-n)}{(n+1)!} h^{n+1} f^{(n+1)}(\xi)
	\quad(x_0 < \xi < x_n).
\end{equation}
