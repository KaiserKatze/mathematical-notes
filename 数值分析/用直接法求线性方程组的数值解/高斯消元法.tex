\section{高斯消元法}
\subsection{高斯消元法}
设\begin{equation*}
	A \defeq \begin{bmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & a_{2n} \\
		\vdots & \vdots & & \vdots \\
		a_{n1} & a_{n2} & \dots & a_{nn} \\
	\end{bmatrix},
	\qquad
	X \defeq \begin{bmatrix}
		x_1 \\ x_2 \\ \vdots \\ x_n \\
	\end{bmatrix},
	\qquad
	B \defeq \begin{bmatrix}
		b_1 \\ b_2 \\ \vdots \\ b_n \\
	\end{bmatrix},
\end{equation*}
为了求解线性方程组\(A X = B\)，
我们首先构造增广矩阵，令\(C^{(1)} \defeq (A,B)\)，
接着采取以下算法，执行\(n-1\)个步骤，其中第\(k\ (k=1,2,\dotsc,n-1)\)步的执行细节为：\begin{itemize}
		\item 假设矩阵\(C^{(k)}\)的\((k,k)\)元素\(a^{(k)}_{kk} \neq 0\)，
		那么计算乘数\begin{equation*}
			m^{(k)}_i \defeq \frac{a^{(k)}_{ik}}{a^{(k)}_{kk}}
			\quad(i=k+1,k+2,\dotsc,n);
		\end{equation*}

		\item 再作初等行变换，令\begin{align*}
			a^{(k+1)}_{ik}
			&\defeq 0
			&(i=k+1,k+2,\dotsc,n), \\
			a^{(k+1)}_{ij}
			&\defeq a^{(k)}_{ij} - m^{(k)}_i a^{(k)}_{kj}
			&(i=k+1,k+2,\dotsc,n;j=k+1,k+2,\dotsc,n), \\
			b^{(k+1)}_i
			&\defeq b^{(k)}_i - m^{(k)}_i b^{(k)}_k
			&(i=k+1,k+2,\dotsc,n);
		\end{align*}

		\item 然后重新组成矩阵\begin{equation*}
			C^{(k+1)}
			\defeq
			\begin{bmatrix}
				a^{(k+1)}_{11} & a^{(k+1)}_{12} & \dots & a^{(k+1)}_{1n} & b^{(k+1)}_1 \\
				a^{(k+1)}_{21} & a^{(k+1)}_{22} & \dots & a^{(k+1)}_{2n} & b^{(k+1)}_2 \\
				\vdots & \vdots & & \vdots & \vdots \\
				a^{(k+1)}_{n1} & a^{(k+1)}_{n2} & \dots & a^{(k+1)}_{nn} & b^{(k+1)}_n \\
			\end{bmatrix}.
		\end{equation*}
	\end{itemize}
在执行了上述步骤以后，得到一个阶梯形矩阵\begin{align*}
	C^{(n)}
	= \begin{bmatrix}
		a^{(n)}_{11} & a^{(n)}_{12} & \dots & a^{(n)}_{1n} & b^{(n)}_1 \\
		0 & a^{(n)}_{22} & \dots & a^{(n)}_{2n} & b^{(n)}_2 \\
		\vdots & \vdots & & \vdots & \vdots \\
		0 & 0 & \dots & a^{(n)}_{nn} & b^{(n)}_n \\
	\end{bmatrix},
\end{align*}
基于此，开始回代求解\(X \defeq (x_1,x_2,\dotsc,x_n)^T\)：\begin{align*}
	x_n &\defeq b^{(n)}_n / a^{(n)}_{nn}, \\
	x_k &\defeq \left( b^{(k)}_k - \sum_{j=k+1}^n a^{(k)}_{kj} x_j \right) \bigg/ a^{(k)}_{kk}
	&(k=n-1,n-2,\dotsc,2,1).
\end{align*}

在上述算法中，
第\(k\)步消元时，为了计算\(m^{(k)}_i\)用了\(n-k\)次除法，
为了计算\(a^{(k+1)}_{ij}\)用了\((n-k)^2\)次乘法，
为了计算\(b^{(k+1)}_i\)用了\(n-k\)次乘法，
于是消元过程总共用了\(
	\sum_{k=1}^{n-1} (n-k)^2
	+ 2 \sum_{k=1}^{n-1} (n-k)
	= \frac13 n^3 + \frac12 n^2 - \frac56 n
\)次乘除法，
加上回代过程总共用了\(
	\sum_{k=1}^n k
	= \frac12 n (n+1)
\)次乘除法，
那么消元过程和回代过程一共用了\(
	\frac13 n^3 + n^2 - \frac13 n
\)次乘除法；
另外，判断主对角线上的元素是否为零，
以及在断定主对角线上的元素为零以后作行交换，
这两种操作各自最多有\(
	\sum_{k=1}^{n-1} (n-k)
	= \frac12 n (n-1)
\)次.

\subsection{高斯消元法与LU分解的联系}
容易看出，上述高斯消元法的第\(1\)步中用到的初等行变换矩阵的乘积等于\begin{equation*}
	L_1
	\defeq
	\begin{bmatrix}
		1 \\
		-m^{(1)}_2 & 1 \\
		-m^{(1)}_3 && 1 \\
		\vdots &&& \ddots \\
		-m^{(1)}_n &&&& 1 \\
	\end{bmatrix},
\end{equation*}
类似地，第\(k\ (k=1,2,\dotsc,n-1)\)步中用到的初等行变换矩阵的乘积等于\begin{equation*}
	L_k
	\defeq
	\begin{bmatrix}
		1 \\
		& \ddots \\
		&& 1 \\
		&& -m^{(k)}_{k+1} & 1 \\
		&& \vdots && \ddots \\
		&& -m^{(k)}_n &&& 1 \\
	\end{bmatrix}.
\end{equation*}
记\(L^{-1} \defeq L_{n-1} L_{n-2} \dotsm L_2 L_1\)，
结合前面的讨论，我们可以确信：
如果将\(C^{(n)}\)分块为\begin{equation*}
	C^{(n)} = (U,B^{(n)}),
\end{equation*}
其中\begin{equation*}
	U
	\defeq
	\begin{bmatrix}
		a^{(n)}_{11} & a^{(n)}_{12} & \dots & a^{(n)}_{1n} \\
		0 & a^{(n)}_{22} & \dots & a^{(n)}_{2n} \\
		\vdots & \vdots & & \vdots \\
		0 & 0 & \dots & a^{(n)}_{nn} \\
	\end{bmatrix},
	\qquad
	B^{(n)}
	\defeq
	\begin{bmatrix}
		b^{(n)}_1 \\
		b^{(n)}_2 \\
		\vdots \\
		b^{(n)}_n \\
	\end{bmatrix},
\end{equation*}
那么\(L^{-1} B\)等于向量\(B^{(n)}\)，
\(L^{-1} A\)等于上三角矩阵\(U\)，或者\(A = L U\)，
其中\begin{equation*}
	L
	\defeq
	L_1^{-1} L_2^{-1} \dotsm L_{n-1}^{-1}
	=
	\begin{bmatrix}
		1 \\
		m^{(1)}_2 & 1 \\
		m^{(1)}_3 & m^{(2)}_3 & 1 \\
		\vdots & \vdots & \vdots & \ddots \\
		m^{(1)}_n & m^{(2)}_n & m^{(3)}_n & \dots & 1 \\
	\end{bmatrix}.
\end{equation*}

\subsection{列主元消去法}
我们可以看出，
当\(a^{(k)}_{kk}\)等于零时，
根本无法计算乘数\(m^{(k)}_i \defeq \frac{a^{(k)}_{ik}}{a^{(k)}_{kk}}\)；
当\(a^{(k)}_{kk}\)非常接近零时，
乘数\(m^{(k)}_i \defeq \frac{a^{(k)}_{ik}}{a^{(k)}_{kk}}\)的计算会有很大的误差，
导致其他元素的数量级严重增长和舍入误差的扩散，
使得计算结果不可靠.

于是，在第\(k\)步计算乘数\(m^{(k)}_i\)之前，
我们首先在第\(k\)列选取绝对值最大的元素作为主元，
令\begin{equation*}
	i_k \defeq \argmax_{k \leq i \leq n} \abs{ a_{ik} },
\end{equation*}
然后交换第\(k\)行与第\(i_k\)行，
再继续后续步骤.

现在我们用初等行变换矩阵的乘积来表述列主元消去法.
显然\begin{equation*}
	A^{(k+1)} = L_k I_{k,i_k} A^{(k)},
	\qquad
	B^{(k+1)} = L_k I_{k,i_k} B^{(k)},
\end{equation*}
于是\begin{align*}
	U
	&= (L_n I_{n,i_n})
		(L_{n-1} I_{n-1,i_{n-1}})
		(L_{n-2} I_{n-2,i_{n-2}})
		\dotsm
		(L_1 I_{1,i_i})
		A \\
	&= L_n
	(I_{n,i_n} L_{n-1} I_{n,i_n})
	(I_{n,i_n} I_{n-1,i_{n-1}} L_{n-2} I_{n-1,i_{n-1}} I_{n,i_n}) \\
	&\hspace{20pt}
	\dotsm
	(I_{n,i_n} \dotsm I_{1,i_1} L_1 I_{1,i_1} \dotsm I_{n,i_n})
	(I_{n,i_n} I_{n-1,i_{n-1}} \dotsm I_{1,i_1})
	A.
\end{align*}
记\begin{align*}
	\widetilde{L}_n
	&\defeq
	L_n, \\
	\widetilde{L}_k
	&\defeq
	I_{n,i_n} \dotsm I_{k+1,i_{k+1}} L_k I_{k+1,i_{k+1}} \dotsm I_{n,i_n}
	\quad(k=1,2,\dotsc,n-1), \\
	P
	&\defeq
	I_{n,i_n} I_{n-1,i_{n-1}} \dotsm I_{1,i_1}, \\
	L
	&\defeq
	(\widetilde{L}_n \widetilde{L}_{n-1} \dotsm \widetilde{L}_1)^{-1}
\end{align*}
则\begin{equation*}
	L U = P A.
\end{equation*}
于是我们可以得出如下结论.
\begin{theorem}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P152 定理8（列主元三角分解定理）
如果\(A \in M_n(F)\)是非奇异矩阵，
则存在置换矩阵\(P \in M_n(F)\)，
存在单位下三角矩阵\(L \in M_n(F)\)，
存在上三角矩阵\(U \in M_n(F)\)，
使得\begin{equation*}
	P A = L U.
\end{equation*}
\end{theorem}
