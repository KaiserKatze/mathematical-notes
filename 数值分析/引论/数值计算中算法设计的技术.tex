\section{数值计算中算法设计的技术}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P13
在数值计算中，算法设计的好坏，不但影响计算结果的精度，还会影响计算时间的长度.
下面给出几个具有代表性的算法，让我们一起学习它们的基本原则.

\subsection{多项式求值的秦九韶算法}
让我们考虑下面这个问题：
给定\(n\)次多项式\begin{equation}\label{equation:数值计算算法设计.秦九韶算法待计算的多项式}
	p(x)
	\defeq
	a_0 x^n + a_1 x^{n-1} + \dotsb + a_{n-1} x + a_n
	\quad(a_0\neq0),
\end{equation}
求\(p(x^*)\).

若直接计算每一项\(a_i x^{n-i}\)再相加，
总共需要\begin{equation*}
	\sum_{i=0}^n (n-i)
	= \frac{n(n+1)}{2}
	= O(n^2)
\end{equation*}
次乘法和\(n\)次加法.

但是，如果利用递推公式\begin{equation}\label{equation:数值计算算法设计.秦九韶算法递推公式1}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P13 (4.1)
	\begin{cases}
		b_0 = a_0, \\
		b_i = b_{i-1} x^* + a_i
		\quad(i=1,2,\dotsc,n),
	\end{cases}
\end{equation}
计算出\(b_n\)，那么就会发现\(p(x^*)\)恰与\(b_n\)相等.
这个算法便是秦九韶算法.
用它计算\(n\)次多项式\(p(x^*)\)只需要\(n\)次乘法和\(n\)次加法，
乘法次数由\(O(n^2)\)降为\(O(n)\)，
并且只需要\(n+2\)个存储单元.
秦九韶算法是计算多项式函数值的最佳算法，
它是南宋数学家秦九韶于1247年提出的.
% 国外称此算法为 Horner 算法（1819年提出）.

秦九韶算法还可以用于计算\(p'(x^*)\).
由递推公式 \labelcref{equation:数值计算算法设计.秦九韶算法递推公式1} 可知\begin{equation*}
	\begin{cases}
		a_0 = b_0, \\
		a_i = b_i - b_{i-1} x^*
		\quad(i=1,2,\dotsc,n),
	\end{cases}
\end{equation*}
代入\cref{equation:数值计算算法设计.秦九韶算法待计算的多项式} 得\begin{align*}
	p(x)
	&= b_0 x^n + (b_1 - b_0 x^*) x^{n-1} + \dotsb + (b_{n-1} - b_{n-2} x^*) x + (b_n - b_{n-1} x^*) \\
	&= (b_0 x^{n-1} + b_1 x^{n-2} + \dotsb + b_{n-1}) x
		- (b_0 x^{n-1} + \dotsb + b_{n-2} x + b_{n-1}) x^*
		+ b_n \\
	&= (b_0 x^{n-1} + b_1 x^{n-2} + \dotsb + b_{n-2} x + b_{n-1}) (x - x^*) + b_n,
\end{align*}
记\(q(x) \defeq b_0 x^{n-1} + b_1 x^{n-2} + \dotsb + b_{n-2} x + b_{n-1}\)，
则\begin{equation*}
	p(x) = (x - x^*) q(x) + p(x^*),
\end{equation*}
求导得\begin{equation*}
	p'(x) = q(x) + (x - x^*) q'(x),
\end{equation*}
从而\begin{equation*}
	p'(x^*) = q(x^*),
\end{equation*}
正如我们刚刚对\(p(x)\)运用秦九韶算法得到
递推公式 \labelcref{equation:数值计算算法设计.秦九韶算法递推公式1} 一样，
现在对\(q(x)\)运用秦九韶算法可得递推公式\begin{equation*}
	\begin{cases}
		c_0 = b_0, \\
		c_i = c_{i-1} x^* + b_i
		\quad(i=1,2,\dotsc,n-1),
	\end{cases}
\end{equation*}
于是\(p'(x^*) = q(x^*) = c_{n-1}\).

\subsection{迭代法与开方求值}
迭代法是一种按同一公式重复计算、逐次逼近真值的算法，
是数值计算普遍运用的重要方法.
以开方运算为例，它不是四则运算，
因此在计算机上求某个数的平方根的数值时，
就要利用迭代法将其转化为四则运算.

%\cref{example:收敛准则.迭代法计算开平方}
取定\(a>0\)，求\(\sqrt{a}\)等价于解方程\(x^2-a=0\).
于是我们将“求解\(a\)的平方根的数值”这个问题
转化为了一个方程求根问题.
现在，取\(x_0>0\)，
令\(\increment x \defeq x - x_0\)，
那么方程\(x^2-a=0\)化为\begin{equation*}
	(x_0 + \increment x)^2 = a,
	\quad\text{即}\quad
	x_0^2 + 2 x_0 \increment x + (\increment x)^2 = a.
\end{equation*}
当\(\increment x\)足够小时，
\((\increment x)^2\)可以忽略不计，
从而有\begin{equation*}
	x_0^2 + 2 x_0 \increment x \approx a,
	\quad\text{即}\quad
	\increment x
	\approx \frac{a - x_0^2}{2 x_0}
	= \frac12 \left( \frac{a}{x_0} - x_0 \right),
\end{equation*}
于是\begin{equation*}
	x = x_0 + \increment x
	\approx \frac12 \left( \frac{a}{x_0} + x_0 \right).
\end{equation*}
记\begin{equation*}
	x_1 \defeq \frac12 \left( \frac{a}{x_0} + x_0 \right).
\end{equation*}
这里\(x_1\)不是\(\sqrt{a}\)的真值，它也是对真值\(x = \sqrt{a}\)的近似.
重复上述过程可得迭代公式\begin{equation*}
	x_{k+1} \defeq \frac12 \left( \frac{a}{x_k} + x_k \right)
	\quad(k=0,1,2,\dotsc).
\end{equation*}
由\cref{example:收敛准则.迭代法计算开平方}
我们已经知道\(\lim_{k\to\infty} x_k = \sqrt{a}\).
上述迭代公式在每次迭代时只做一次除法、一次加法与一次移位，计算量很小.
