\section{误差定性分析与避免误差危害}
数值运算中的误差分析是个很重要又很复杂的问题.
上一节我们虽然讨论不精确数据运算结果的误差限，
但是它只适用于简单情形，
然而一个工程或科学计算问题往往需要运算成千上万次，
由于每一步运算都有误差，
所以每一步都做误差分析是不可能的，也是不科学的，
这是因为误差积累有正有负，
绝对值有大有小，
都按最坏情况估计误差限，
得到的结果就会比实际误差大很多，
这种保守的误差估计不能反映实际误差积累.
考虑到误差分布的随机性，
有人用概率统计方法，
将数据和运算中的舍入误差视为服从某种分布的随机变量，
然后确定计算结果的误差分布，
这样得到的误差估计更接近实际.
我们把这种方法称为\DefineConcept{概率分析法}.

\subsection{算法的数值稳定性}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P10 定义3
用一个算法进行计算，
如果初始数据或输入数据的误差在计算中传播，使得计算结果的舍入误差增长很快，
那么就说这个算法是\DefineConcept{数值不稳定的}；
反之，如果计算结果的舍入误差不增长，
则称这个算法是\DefineConcept{数值稳定的}.

\subsection{病态问题与条件数}
给定一个数值问题，
输入数据的微小扰动（即误差）
引起输出数据（即问题解）相对误差很大，
那么这个数值问题就叫做\DefineConcept{病态问题}.
例如，计算函数值\(f(x)\)时，
假设\(x\)有扰动\(\increment x = x^* - x\)，
\(x\)的相对误差为\(\frac{\increment x}{x}\)，
函数值\(f(x)\)的相对误差为\(\frac{f(x^*) - f(x)}{f(x)}\)，
又假设差商\(\frac{f(x^*) - f(x)}{\increment x}\)约等于微商\(f'(x)\)，
那么\(f(x)\)与\(x\)的相对误差比值为\begin{equation*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P10 (3.3)
	\abs{\frac{f(x^*) - f(x)}{f(x)}}
	\bigg/
	\abs{\frac{\increment x}{x}}
	= \abs{\frac{x}{f(x)} \cdot \frac{f(x^*) - f(x)}{\increment x}}
	\approx \abs{\frac{x f'(x)}{f(x)}}.
\end{equation*}
我们把\begin{equation*}
	C_p
	\defeq
	\abs{\frac{x f'(x)}{f(x)}}
\end{equation*}
称为计算函数值问题的\DefineConcept{条件数}.
自变量相对误差\(\frac{\increment x}{x}\)一般不会太大.
如果条件数\(C_p\)很大，
将引起函数值相对误差\(\frac{f(x^*) - f(x)}{f(x)}\)很大，
出现这种情况的问题就是病态问题.

例如，取\(f(x) \defeq x^n\)，
则\(C_p = \abs{\frac{x \cdot n x^{n-1}}{x^n}} = n\)，
这表示计算结果的相对误差相交于输入数据可能放大\(n\)倍.
具体地，取\(n \defeq 10\)，
令准确值\(x \defeq 1\)，令近似值\(x^* \defeq 1.02\)，
则自变量相对误差为\(2\%\)，
函数值相对误差为\(24\%\)，
这时\(f(x)\)的计算问题可以认为是病态的.

一般地，当条件数\(C_p \geq 10\)时，
我们就认为问题是病态的，
并且\(C_p\)越大病态越严重.

\begin{example}

%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P11 例6
求解线性方程组\begin{equation*}
	\begin{cases}
		x + \alpha y = 1, \\
		\alpha x + y = 0.
	\end{cases}
\end{equation*}
\begin{solution}
当\(\alpha = 1\)时，系数行列式为零，方程无解.
但是当\(\alpha \neq 1\)时，解得\begin{equation*}
	x = \frac{1}{1-\alpha^2},
	\qquad
	y = -\frac{\alpha}{1-\alpha^2}.
\end{equation*}
当\(\alpha \approx 1\)时，若输入数据\(\alpha\)有微小扰动（误差），则解的误差就会很大》
实际上，把\(x = \frac{1}{1-\alpha^2}\)看成\(\alpha\)的函数，
那么条件数为\begin{equation*}
	C_p = \abs{\frac{\alpha x'(\alpha)}{x(\alpha)}}
	= \abs{\frac{2\alpha^2}{1-\alpha^2}}.
\end{equation*}
假如输入数据的准确值为\(\alpha = 0.99\)，
那么条件数为\(C_p \approx 100\)，
因此本问题是病态的.
\end{solution}
\end{example}

应该注意到的是，病态问题不是计算方法引起的，
而是数值问题自身固有的，
因此，对数值问题首先要分清问题是否病态，
对于病态问题就必须采取相应的特殊方法以减少误差危害.

\subsection{避免误差危害}
数值计算中，通常不采用数值不稳定算法.
在设计算法时，还应该尽量避免误差危害，防止有效数字损失.
通常要避免两个相近的数相减、用绝对值很小的数做除数，
还要注意运算次序和减少运算次数.
