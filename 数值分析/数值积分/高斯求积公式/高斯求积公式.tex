\section{高斯求积公式}
当我们用求积公式\(\sum_{k=0}^n A_k f(x_k)\)近似\(\int_a^b f(x) \dd{x}\)时，
\(\sum_{k=0}^n A_k f(x_k)\)实际上含有\(2(n+1)\)个待定参数：\begin{equation*}
	x_0,x_1,\dotsc,x_n
	\quad\text{和}\quad
	A_0,A_1,\dotsc,A_n.
\end{equation*}
只不过，在前几节中，我们讨论的是“机械”求积公式，
这类公式的特点是\(x_k\)是等距节点，
这就使\(x_0,x_1,\dotsc,x_n\)不再是待定参数，
这时插值型求积公式\(\sum_{k=0}^n A_k f(x_k)\)至少具有\(n\)次代数精度.
但是，如果适当选取求积节点，那么有可能使求积公式具有\(2n+1\)次代数精度.

下面我们首先考虑一个例子.
\begin{example}
\setcounter{equation}{0}%
\renewcommand{\theequation}{\arabic{equation}}%
假设我们想要用求积公式\(A_0 f(x_0) + A_1 f(x_1)\)近似\(\int_{-1}^1 f(x) \dd{x}\)，
假设该求积公式对\(x^n\ (n=0,1,2,3)\)精确成立，
则有\begin{gather}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P117 (6.2)
	A_0 + A_1 = 2, \\
	A_0 x_0 + A_1 x_1 = 0, \\
	A_0 x_0^2 + A_1 x_1^2 = 2/3, \\
	A_0 x_0^3 + A_1 x_1^3 = 0.
\end{gather}
用(4)式减去(2)式乘\(x_0^2\)，
得\begin{equation}
	A_1 x_1 (x_1^2 - x_0^2) = 0,
\end{equation}
由此得\(x_1 = \pm x_0\).

用\(x_0\)乘(1)式减(2)式，
得\begin{equation}
	A_1 (x_0 - x_1) = 2 x_0.
\end{equation}
用(3)式减去\(x_0\)乘(2)式，
得\begin{equation}
	A_1 x_1 (x_1 - x_0) = 2/3.
\end{equation}
将(6)式代入(7)式，得\begin{equation}
	x_0 x_1 = -1/3.
\end{equation}
由此可知\(x_0\)与\(x_1\)异号，故\begin{equation}
	x_1 = - x_0.
\end{equation}
将(9)式代回(8)式，得\(x_1^2 = 1/3\)，
于是可以取\(x_0 = -\sqrt3/3\)和\(x_1 = \sqrt3/3\)，
那么\begin{equation}
	A_1 = \frac{2 x_0}{x_0 - x_1}
	= 1.
\end{equation}
再将上式代回(1)式，得\(A_0 = 1\).

综上所述，我们可以用\(f(-\sqrt3/3) + f(\sqrt3/3)\)近似\(\int_{-1}^1 f(x) \dd{x}\).

当\(f(x) = x^4\)时，
有\begin{equation*}
	f(-\sqrt3/3) + f(\sqrt3/3)
	= 2/9
	\neq
	\int_{-1}^1 f(x) \dd{x}
	= 2/5,
\end{equation*}
所以求积公式\(f(-\sqrt3/3) + f(\sqrt3/3)\)的代数精度为\(3\).
\end{example}

实际上求积公式\(A_0 f(x_0) + A_1 f(x_1)\)的代数精度不可能超过\(3\)，
这是因为对于任意给定的两个积分节点\(x_0,x_1 \in [-1,1]\)，
4次多项式函数\(f(x) \defeq (x - x_0)^2 (x - x_1)^2\)的积分为\begin{equation*}
	\int_{-1}^1 f(x) \dd{x}
	% = 2 x_0^2 x_1^2 + \frac23 x_0^2 + \frac83 x_0 x_1 + \frac23 x_1^2 + \frac25
	= \frac23 \left( x_0 + x_1 \right)^2
	+ 2 \left( x_0 x_1 + \frac13 \right)^2
	+ \frac{8}{45}
	> 0,
\end{equation*}
而\(f(x_0) = f(x_1) = 0\)，
故近似值为\(A_0 f(x_0) + A_1 f(x_1) = 0\)，
它表明两个节点的求积公式的最高代数精度为\(3\).
以此类推，我们可以如下结论.
\begin{theorem}
含\(n+1\)个节点的求积公式\(\sum_{k=0}^n A_k f(x_k)\)的代数精度最高为\(2n+1\)次.
%TODO
\end{theorem}

\begin{definition}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P118 定义4
如果在近似积分\(\int_a^b \rho(x) f(x) \dd{x}\)时，
求积公式\(\sum_{k=0}^n A_k f(x_k)\)具有\(2n+1\)次代数精度，
则把它称为\DefineConcept{高斯求积公式}，
把它的节点\(x_k\ (k=0,1,2,\dotsc,n)\)称为\DefineConcept{高斯点}.
\end{definition}

根据上述定义，要使求积公式具有\(2n+1\)次代数精度，
则必定成立\begin{equation}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P118 (6.5)
	\sum_{k=0}^n A_k f(x_k)
	= \int_a^b \rho(x) x^m \dd{x}
	\quad(m=0,1,2,\dotsc,2n,2n+1).
\end{equation}
理论上，只要给定权函数\(\rho\)，就可以求出右边的积分，
再根据上面的方程组解出\(A_k\)和\(x_k\).
但是由于上式是关于\(A_k\)和\(x_k\)的非线性方程组，
在\(n>1\)时求解就已经很困难了，
因此我们通常是在已经提前确定了节点\(x_k\)的位置以后，
再根据上述方程组求解\(A_k\)，
这时它变成关于\(A_k\)的线性方程组.
下面讨论如何选取节点\(x_k\)，才能使求积公式具有\(2n+1\)次代数精度.

给定\(n+1\)个节点\(a = x_0 < x_1 < \dotsb < x_n = b\)，
被积函数\(f\)的拉格朗日插值多项式为\begin{equation*}
	L_n(x) \defeq \sum_{k=0}^n f(x_k) ~ l_k(x),
\end{equation*}
其中\begin{equation*}
	l_k(x) \defeq \prod_{0 \leq i \leq n, i \neq k} \frac{x - x_i}{x_k - x_i}
	\quad(k=0,1,2,\dotsc,n),
\end{equation*}
则\begin{equation*}
	f(x) = \sum_{k=0}^n f(x_k) ~ l_k(x) + \frac{1}{(n+1)!} ~ f^{(n+1)}(\xi(x)) ~ \omega_{n+1}(x)
	\quad(a < \xi(x) < b).
\end{equation*}
用\(\rho(x)\)乘上式，并积分，得\begin{equation*}
%@see: 《数值分析（第5版）》（李庆扬、王能超、易大义） P118 (6.6)
	\int_a^b \rho(x) ~ f(x) \dd{x}
	= \sum_{k=0}^n A_k f(x_k) + \frac{1}{(n+1)!} \int_a^b \rho(x) ~ f^{(n+1)}(\xi(x)) ~ \omega_{n+1}(x) \dd{x},
\end{equation*}
其中\begin{equation*}
	A_k \defeq \int_a^b \rho(x) ~ l_k(x) \dd{x}.
\end{equation*}
显然余项为\begin{equation*}
	R[f] \defeq \frac{1}{(n+1)!} \int_a^b \rho(x) ~ f^{(n+1)}(\xi(x)) ~ \omega_{n+1}(x) \dd{x}.
\end{equation*}
当\(f(x) = x^m\ (m=0,1,2,\dotsc,n)\)时，有\(R[f] = 0\)，
此时有\begin{equation*}
	\int_a^b \rho(x) ~ f(x) \dd{x}
	= \sum_{k=0}^n A_k f(x_k).
\end{equation*}
这就说明求积公式至少具有\(n\)次代数精度.

高斯求积公式与机械求积公式的最大区别：
机械求积公式中未知待定的量仅有求积系数，
高斯求积公式中未知待定的量除了求积系数以外还有求积节点.

% 非线性方程组的求解：因式分解、替换、消元法

% 高斯--勒让德求积公式 重要

% 辛普森公式对节点的取法没有要求
% 高斯求积公式对节点的取法有要求，节点必须是某个正交多项式（例如勒让德多项式、第一类切比雪夫多项式等）的零点
% 高斯求积公式的精度比辛普森公式的精度更高，所需的节点数更少
