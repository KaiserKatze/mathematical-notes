\chapter{微分方程概论}
函数是客观事物的内部联系在数量方面的反映.利用函数关系又可以对客观事物的规律性进行研究.因此如何寻求函数关系，在实践中具有重要的意义.在许多问题中，往往不能直接找出所需要的函数关系，但是根据问题所提供的情况，有时可以列出含有要找的函数及其导数的关系式.这样的关系式就是所谓微分方程.微分方程建立以后，对它进行研究，找出未知函数来，这就是解微分方程.本章主要介绍微分方程的一些基本概念和几种常用的微分方程的解法.

\section{微分方程的基本概念}
\subsection{微分方程的基本概念}
\begin{definition}
一般地，含有自变量、未知函数、未知函数的导数（或偏导数）的方程叫做\DefineConcept{微分方程}（differential equation）.
如果微分方程中的未知函数是一元实值函数\(y = y(x)\)，则称其为\DefineConcept{常微分方程}（ordinary differential equation）.
如果微分方程中的未知函数是多元实值函数\(y = y(\v{x}{m})\)，则称其为\DefineConcept{偏微分方程}（partial differential equation）.

微分方程中所出现的未知函数的最高阶导数（或偏导数）的阶数，称为微分方程的\DefineConcept{阶}（order）.
\end{definition}

常微分方程的一般形式为：
\begin{equation}\label{equation:微分方程.微分方程的一般形式}
F\left( x,y,y',y'',\dotsc,y^{(n)} \right)=0.
\end{equation}
根据定义，微分方程 \labelcref{equation:微分方程.微分方程的一般形式} 中所出现的未知函数\(y = y(x)\)的最高阶导数\(y^{(n)}\)的阶数\(n\)就是微分方程 \labelcref{equation:微分方程.微分方程的一般形式} 的阶.

如果微分方程 \labelcref{equation:微分方程.微分方程的一般形式} 左边是关于未知函数\(y\)及其导数\(y',y'',\dotsc,y^{(n)}\)的一次有理整式，那么称其为\(n\)阶\textbf{线性常微分方程}（n-th order linear ordinary differential equation）；
否则称其为\(n\)阶\textbf{非线性常微分方程}（n-th order nonlinear ordinary differential equation）.

如果能从方程 \labelcref{equation:微分方程.微分方程的一般形式} 中解出最高阶导数，则可得微分方程
\begin{equation}\label{equation:微分方程.分离出最高阶导数}
y^{(n)} = f\left( x,y,y',y'',\dotsc,y^{(n-1)} \right).
\end{equation}
像这样的微分方程称为\(n\)阶\textbf{显式常微分方程}（n-th order explicit ordinary differential equation）.
本章讨论的微分方程都是显式常微分方程.

\(n\)阶线性常微分方程的一般形式为
\begin{equation}\label{equation:微分方程.线性常微分方程的一般形式}
y^{(n)} + a_1(x) \cdot y^{(n-1)}
+ \dotsb + a_{n-1}(x) y'
+ a_n(x) y
= f(x),
\end{equation}
其中\(a_i(x)\ (i=1,2,\dotsc,n)\)和\(f(x)\)是关于\(x\)的已知函数.
称\(f(x)\)为微分方程 \labelcref{equation:微分方程.线性常微分方程的一般形式} 的\textbf{非齐次项}（non-homogeneous term）.
当\(f(x) = 0\)时，我们称微分方程 \labelcref{equation:微分方程.线性常微分方程的一般形式} 为\(n\)阶线性齐次常微分方程（n-th order linear homogeneous ordinary differential equation）；
否则，称其为\(n\)阶线性非齐次常微分方程（n-th order linear non-homogeneous ordinary differential equation）.

\begin{definition}
设函数\(y=\varphi(x)\)在区间\(I\subseteq\mathbb{R}\)上有\(n\)阶连续导数.
如果对于\(\forall x \in I\)有\[
F[x,\varphi(x),\varphi'(x),\dotsc,\varphi^{(n)}(x)]\equiv0,
\]那么称函数\(y=\varphi(x)\)为“微分方程 \labelcref{equation:微分方程.微分方程的一般形式} 在区间\(I\)上的\DefineConcept{解}（solution）”.

如果\(n\)阶微分方程的解中含有任意常数\(\v{C}{n}\)，且任意常数的个数与微分方程的阶数相同\footnote{%
这里所说的任意常数是相互\textbf{独立的}（independent），%
就是说，它们不能合并而使得任意常数的个数减少；%
或者说，\(\varphi,\varphi',\dotsc,\varphi^{(n-1)}\)关于\(\v{C}{n}\)的“雅克比行列式”不为零，即\[
\jacobi{\varphi,\varphi',\dotsc,\varphi^{(n-1)}}{\v{C}{n}} \neq 0.
\]}，这样的解\[
y = \varphi(x;\v{C}{n})
\]叫做微分方程的\DefineConcept{通解}（general solution）；
否则称其为微分方程的\DefineConcept{特解}（special solution）.
\end{definition}

由于通解中含有任意常数，所以它还不能完全确定地反映某一客观事物的规律性.要完全确定地反映客观事物的规律性，必须确定这些常数的值.为此，要根据问题的实际情况，提出确定这些常数的条件.

如果微分方程是\cemph{一阶}的，通常用来确定任意常数的条件是\[
y(x_0) = y_0,
\]其中\(x_0,y_0\)都是给定的值；如果微分方程是\cemph{二阶}的，通常用来确定任意常数的条件是\[
y(x_0) = y_0,
\qquad
y'(x_0) = y'_0,
\]其中\(x_0,y_0,y'_0\)都是给定的值；以此类推.上述这种条件叫做\DefineConcept{初始条件}.确定了通解中的任意常数以后，就得到微分方程的\DefineConcept{特解}.

特别地，求一阶微分方程\(y'=f(x,y)\)满足初始条件\(y(x_0) = y_0\)的特解这样一个问题，叫做一阶微分方程的\DefineConcept{初值问题}，记作\[
\left\{ \begin{array}{l}
y' = f(x,y), \\
y(x_0) = y_0.
\end{array} \right.
\]

微分方程的任意特解在平面上表现为一条曲线，叫做微分方程的\DefineConcept{积分曲线}（integral curve）或\DefineConcept{解曲线}（solution curve）.
同样地，微分方程的通解在平面上表现为一族曲线，叫做微分方程的\DefineConcept{积分曲线族}（family of integral curves）或\DefineConcept{解曲线族}（family of solution curves）.

上述一阶微分方程的初值问题的几何意义，就是求通过点\(\opair{x_0,y_0}\)的那条积分曲线.二阶微分方程的初值问题\[
\left\{ \begin{array}{l}
y'' = f(x,y,y'), \\
y(x_0) = y_0, \\
y'(x_0) = y'_0
\end{array} \right.
\]的几何意义，是求微分方程的通过点\(\opair{x_0,y_0}\)且在该点处的切线斜率为\(y'_0\)的那条积分曲线.

\begin{example}
试验证：函数\[
x = C_1 \cos kt + C_2 \sin kt
\]是微分方程\[
\dv[2]{x}{t} + k^2 x = 0
\]的解.
\begin{solution}
求出函数\(x(t)\)的导数，得\[
\dv{x}{t} = -k C_1 \sin kt + k C_2 \cos kt,
\]\[
\dv[2]{x}{t} = -k^2 C_1 \cos kt - k^2 C_2 \sin kt.
\]代入微分方程得\[
-k^2 (C_1 \cos kt + C_2 \sin kt) + k^2 (C_1 \cos kt + C_2 \sin kt)
\equiv 0.
\]
函数\(x(t)\)代入微分方程后称为一个恒等式，故它就是微分方程的解.
\end{solution}
\end{example}

\subsection{微分方程的解的存在性}
\begin{definition}
设函数系\(S\)包含所有定义在某个区间\(D = [a,b]\)上的函数，即\[
S = \Set{ F(x) \given x \in D }.
\]

如果\[
\exists M>0, \forall x\in[a,b], \forall F \in S : \abs{F(x)} < M,
\]则称集合\(S\)为该区间上的\textbf{有界}函数系.

如果\[
\forall\varepsilon>0, \exists\delta>0, \forall F \in S, \forall x_1,x_2\in[a,b] \bigl[
\abs{x_1-x_2} < \delta \implies \abs{F(x_1)-F(x_2)} < \varepsilon
\bigr],
\]则称集合\(S\)是在该区间上\textbf{等度连续的}\footnote{尽管有很多相似之处，但是一定注意“等度连续”与“一致连续”的区别：“等度连续”的对象是函数系，“一致连续”的对象是函数.}.

称\[
\sup\limits_{F_1,F_2 \in S} \abs{F_1(x)-F_2(x)}
\]为集合\(S\)在区间\([a,b]\)上的\textbf{宽度}.
\end{definition}

\begin{lemma}[阿尔泽拉-阿斯科拉引理]
任何在区间\([a,b]\)上有界且等度连续的函数系\(S\)都包含在此区间上一致收敛的函数列.
\end{lemma}

\begin{theorem}
设函数\(f(x,y)\)在\(Oxy\)平面的某个有界闭区域\(D\)上连续，%
那么对于\(D\)中任意一个内点\(\opair{x_0,y_0}\)，%
总存在着函数\(y = \varphi(x)\)，在点\(x_0\)的某个邻域内满足微分方程\[
\dv{y}{x} = f(x,y),
\]且同时有\(y_0 = \varphi(x_0)\).
\end{theorem}

\subsection{微分方程的解的唯一性}

\section{一阶微分方程}
我们首先讨论一阶微分方程\[
y' = f(x,y)
\eqno{(1)}
\]的一些解法.

\subsection{可分离变量的微分方程}
一阶微分方程\(y' = f(x,y)\)有时也写成如下的对称形式\[
P(x,y)\dd{x}+Q(x,y)\dd{y}=0.
\eqno{(2)}
\]在方程(2)中，变量\(x\)与\(y\)对称，它既可看作是以\(x\)为自变量、\(y\)为因变量的方程\[
\dv{y}{x} = -\frac{P(x,y)}{Q(x,y)}
\]（这时\(Q(x,y)\neq0\)）；也可看作是以\(y\)为自变量、\(x\)为因变量的方程\[
\dv{x}{y} = -\frac{Q(x,y)}{P(x,y)}
\]（这时\(P(x,y)\neq0\)）.

对于有的一阶微分方程（例如\(\dv{y}{x} = 2x\)）可以直接在两端积分得到它的通解.
但是并不是所有的一阶微分方程都能这样求解，例如\(\dv{y}{x} = 2xy^2\)就不能这样做，这是因为这个方程的右端含有与\(x\)存在函数关系的变量\(y\)，积分\(\int 2xy^2 \dd{x}\)求不出来.
但如果将这个方程变形为\(\frac{\dd{y}}{y^2}=2x\dd{x}\)，使得变量\(x\)与\(y\)分离在等式的两端，再两端积分即得\[
-\frac{1}{y} = x^2+C
\quad\text{或}\quad
y = -\frac{1}{x^2+C},
\]其中\(C\)是任意常数.
可以验证上述函数确实满足原来的一阶微分方程\(\dv{y}{x} = 2xy^2\)，且含有一个任意常数，所以它是原方程的通解.

\begin{definition}[可分离变量的微分方程]
一般地，如果一阶微分方程能化成\[
g(y)\dd{y}=f(x)\dd{x}
\eqno{(3)}
\]的形式，那么称原方程为\DefineConcept{可分离变量的微分方程}.
\end{definition}

假定方程(3)中的函数\(g(y)\)和\(f(x)\)是连续的.设\(y=\varphi(x)\)是方程(3)的解，将它代入(3)中得到恒等式\[
g[\varphi(x)] \varphi'(x) \dd{x} = f(x) \dd{x}.
\]将上式两端积分，并由\(y=\varphi(x)\)引进变量\(y\)，得\[
\int g(y) \dd{y} = \int f(x) \dd{x}.
\]设\(G(y)\)及\(F(x)\)依次为\(g(y)\)及\(f(x)\)的原函数，于是有\[
G(y) = F(x) + C.
\eqno{(4)}
\]因此方程(3)的解满足关系式(4).反之，如果\(y = \Phi(x)\)是由关系式(4)所确定的隐函数，那么在\(g(y)\neq0\)的条件下，\(y=\Phi(x)\)也是方程(3)的解，事实上，由\hyperref[theorem:多元函数微分法.隐函数存在定理1]{隐函数的求导法}可知，当\(g(y)\neq0\)时，\[
\Phi'(x) = \frac{F'(x)}{G'(y)} = \frac{f(x)}{g(y)},
\]这就表示函数\(y = \Phi(x)\)满足方程(3).所以，如果已分离变量的方程(3)中，\(g(y)\)和\(f(x)\)是连续的，且\(g(y)\neq0\)，那么(3)式两端积分后得到的关系式(4)，就用隐式给出了方程(3)的解，(4)式就叫做微分方程(3)的\DefineConcept{隐式解}.又由于关系式(4)中含有任意常数，因此(4)式所确定的隐函数是方程(3)的通解，所以(4)式叫做微分方程(3)的\DefineConcept{隐式通解}（当\(f(x)\neq0\)时，(4)式所确定的隐函数\(x=\Psi(y)\)也可认为是方程(3)的解）.

\begin{example}
放射性元素铀由于不断地有原子放射出微粒子而变成其他元素，铀的含量就不断减少，这种现象叫衰变.由原子物理学知道，铀的衰变速度与当时未衰变的铀原子的含量\(M\)成正比.已知\(t=0\)时，铀的含量为\(M_0\)，求在衰变过程中铀含量\(M(t)\)随时间\(t\)变化的规律.
\begin{solution}
铀的衰变速度就是\(M(t)\)对时间\(t\)的导数\(\dv{M}{t}\).由于铀的衰变速度与其含量成正比，故得微分方程\[
\dv{M}{t} = -\lambda M,
\]其中\(\lambda > 0\)是常数，叫做衰变系数，\(\lambda\)前置负号是由于当\(t\)增加时\(M\)单调减少，即\(\dv{M}{t} < 0\)的缘故.对这个微分方程分离变量，得\[
\frac{\dd{M}}{M} = -\lambda \dd{t}.
\]两端积分\[
\int \frac{\dd{M}}{M} = -\lambda \int \dd{t},
\]以\(\ln C\)表示任意常数，考虑到\(M>0\)，得\[
\ln M = -\lambda t + \ln C,
\]即\[
M = C e^{-\lambda t}.
\]这就是原方程的通解.将初始条件\[
\eval{M}_{t=0} = M_0
\]代入上式，得\[
M_0 = C e^0 = C,
\]所以\(M = M_0 e^{-\lambda t}\).这就是所求铀的衰变规律 —— 铀的含量随时间的增加而按指数规律衰减.
\end{solution}
\end{example}

\subsection{齐次方程}
\begin{definition}[齐次方程]
如果一阶微分方程能化成\[
\dv{y}{x}=\varphi\left(\frac{y}{x}\right)
\eqno{(5)}
\]的形式，那么称该方程为\textbf{齐次方程}.
\end{definition}

使用换元法，在齐次方程\[
\dv{y}{x}=\varphi\left(\frac{y}{x}\right)
\]中引入新的未知函数\[
u=\frac{y}{x},
\eqno{(6)}
\]就可以将其化为可分离变量的方程.
这是因为由(6)有\[
y = ux,
\qquad
\dv{y}{x} = u + x \dv{u}{x},
\]代入方程(5)，便得方程\[
u + x \dv{u}{x} = \varphi(u),
\]即\[
x \dv{u}{x} = \varphi(u) - u.
\]分离变量，得\[
\frac{\dd{u}}{\varphi(u) - u} = \frac{\dd{x}}{x}.
\]对两端积分，得\[
\int \frac{\dd{u}}{\varphi(u) - u} = \int \frac{\dd{x}}{x}.
\]求出积分后，再以\(\frac{y}{x}\)代替\(u\)，便得齐次方程的通解.

\begin{example}
解方程\[y^2+x^2 \dv{y}{x} = xy \dv{y}{x}.\]
\begin{solution}
原方程可写成\[
\dv{y}{x} = \frac{y^2}{xy-x^2} = \frac{(y/x)^2}{y/x-1},
\]因此原方程是齐次方程.
令\(u=y/x\)，则\[
y=ux, \qquad \dv{y}{x} = u + x \dv{u}{x},
\]于是原方程变为\[
u+x \dv{u}{x} = \frac{u^2}{u-1},
\]即\[
x \dv{u}{x} = \frac{u}{u-1}.
\]分离变量，得\[
\left(1-\frac{1}{u}\right) \dd{u} = \frac{\dd{x}}{x}.
\]两端积分，得\[
u - \ln\abs{u} + C = \ln\abs{x},
\]或\[
\ln\abs{xu} = u + C.
\]以\(y/x\)代上式中的\(u\)，变得方程的通解为\[
\ln\abs{y} = \frac{y}{x} + C.
\]
\end{solution}
\end{example}

\begin{example}
设曲线\(y = y(x)\ (x>0)\)经过点\(\opair{1,2}\)，该曲线上任一点\(P\opair{x,y}\)到\(y\)轴的距离等于该点处的切线在\(y\)轴上的截距.
求曲线方程\(y(x)\).
\begin{solution}
设\(\opair{x,y}\)处的切线方程为\(Y-y=y'(X-x)\)，令\(X=0\)得\(Y=y-y'x\)，这就是切线在\(y\)轴上的截距，因此得到微分方程\(x = y-y'x\).
整理得\(\frac{y}{x}-1=y'\)，可见这是一个齐次方程，解得\(y=x(C-\ln x)\ (x>0)\).
代入\(y(1)=2\)，得\(C=2\)，于是曲线方程为\(y=x(2-\ln x)\).
\end{solution}
\end{example}

\subsection{可化为齐次的微分方程}
方程\[
\dv{y}{x} = \frac{ax + by + c}{a_1 x + b_1 y + c_1}
\eqno{(7)}
\]当\(c=c_1=0\)时是齐次的，否则不是齐次的.
在非齐次的情形下，可用下列代换把它化为齐次方程：
先令\(x = X + h\)，\(y = Y + k\)，其中\(h\)和\(k\)是待定的常数.于是\(\dd{x}=\dd{X}\)，\(\dd{y}=\dd{Y}\)，从而原方程化为\[
\dv{Y}{X} = \frac{aX+bY+ah+bk+c}{a_1 X+b_1 Y+a_1 h+b_1 k+c_1}
\]

如果关于\(h,k\)的代数方程组\[
\left\{ \begin{array}{l}
ah+bk+c = 0 \\
a_1 h+b_1 k+c_1 = 0
\end{array} \right.
\eqno{(8)}
\]的系数行列式\(\begin{vmatrix} a & b \\ a_1 & b_1 \end{vmatrix} \neq 0\)，那么可以解出唯一的\(h\)及\(k\)，从而将微分方程(7)化为齐次方程\[
\dv{Y}{X} = \frac{aX+bY}{a_1 X+b_1 Y}.
\eqno{(9)}
\]求出齐次方程(9)的通解后，在通解中以\(x-h\)代\(X\)，\(y-k\)代\(Y\)，便得方程(7)的通解.

如果代数方程组(8)的系数行列式\(\begin{vmatrix} a & b \\ a_1 & b_1 \end{vmatrix} = 0\)，那么代数方程组(8)视\(c,c_1\)的取值情况要么无解，要么有无穷多解.
当代数方程组(8)无解时，上述方法不能应用，不过可以令\footnote{这里假设\(a \neq 0, b \neq 0\).}\[
\frac{a_1}{a} = \frac{b_1}{b} = \lambda,
\]从而将方程(7)化为\[
\dv{y}{x} = \frac{(ax+by)+c}{\lambda(ax+by)+c_1}
\]引入新变量\(v=ax+by\)，则\[
\dv{v}{x} = a + b \dv{y}{x}
\quad\text{或}\quad
\dv{y}{x} = \frac{1}{b} \left(\dv{v}{x} - a\right).
\]于是微分方程(7)称为可分离变量的微分方程\[
\frac{1}{b} \left(\dv{v}{x} - a\right) = \frac{v + c}{\lambda v + c_1}.
\]

上述解法可以应用于更一般的微分方程\[
\dv{y}{x} = f\left(\frac{ax+by+c}{a_1 x+b_1 y+c_1}\right).
\eqno{(10)}
\]

对形如\[
\dv{y}{x} = x f\left(\frac{y}{x^2}\right)
\]的微分方程，可令\(u = y/x^2\).

对形如\[
\dv{y}{x} = \frac{1}{x^2} f(xy)
\quad\text{或}\quad
\dv{y}{x} = \frac{y}{x} f(xy)
\]的微分方程，可令\(u = xy\).

对形如\[
\dv{y}{x} = f(ax+by+c)
\]的微分方程，可令\(u = ax+by+c\).

\subsection{一阶线性微分方程}\label{section:微分方程.一阶线性微分方程}
形如\[
\dv{y}{x} + P(x) y = Q(x)
\eqno{(11)}
\]的方程叫做\textbf{一阶线性微分方程}，因为它对于未知函数\(y\)及其导数是一次方程.
如果\(Q(x) \equiv 0\)，则称方程(11)为齐次的；
如果\(Q(x) \not\equiv 0\)，则称方程(11)为非齐次的.

设(11)为非齐次线性方程.
为了求出非齐次线性方程(11)的解，我们先把\(Q(x)\)换成零而写出方程\[
\dv{y}{x} + P(x) y = 0.
\eqno{(12)}
\]方程(12)叫做\cemph{对应于}非齐次线性方程(11)的齐次线性方程.
方程(12)是可分离变量的，分离变量后得\[
\frac{\dd{y}}{y} = -P(x) \dd{x},
\]两端积分，得\[
\ln{\abs{y}} = -\int P(x) \dd{x} + C_1,
\]或\[
y = C e^{ -\int P(x) \dd{x} }
\quad(C = \pm e^{C_1}),
\]这是对应的齐次线性方程(12)的通解\footnote{这里记号\(\int P(x) \dd{x}\)表示\(P(x)\)的某个确定的原函数.}

现在我们使用所谓“常数变易法”来求非齐次线性方程(11)的通解.
这方法是把(12)的通解中的\(C\)换成\(x\)的未知函数\(u(x)\)，即作变换\[
y = u e^{ -\int P(x)\dd{x} },
\eqno{(13)}
\]于是\[
\dv{y}{x} = \dv{u}{x} e^{ -\int P(x) \dd{x} } - u P(x) e^{ -\int P(x) \dd{x} }.
\eqno{(14)}
\]将(13)和(14)代入方程(11)得\[
\dv{u}{x} e^{ -\int P(x) \dd{x} }
- u P(x) e^{ -\int P(x) \dd{x} }
+ P(x) u e^{ -\int P(x) \dd{x} }
= Q(x),
\]即\[
\dv{u}{x} e^{ -\int P(x) \dd{x} } = Q(x),
\qquad
\dv{u}{x} = Q(x) e^{ \int P(x) \dd{x} }.
\]两端积分，得\[
u = \int Q(x) e^{ \int P(x) \dd{x} } \dd{x} + C.
\]将上式代入(13)，便得非齐次线性方程(11)的通解\[
y = e^{ -\int P(x) \dd{x} }
\left( \int Q(x) e^{ \int P(x) \dd{x} } \dd{x} + C \right).
\eqno{(15)}
\]

将(15)式改写为两项之和\[
y = C e^{ -\int P(x) \dd{x} } + e^{ -\int P(x) \dd{x} } \int Q(x) e^{ \int P(x) \dd{x} } \dd{x},
\]上式右端第一项是对应的齐次线性方程(12)的通解，第二项是非齐次线性方程(11)的一个特解（在(11)的通解(15)中取\(C=0\)便得到这个特解）.
由此可知，一阶非齐次线性方程的通解等于对应的齐次方程的通解与非齐次方程的一个特解之和.

\begin{example}
求方程\[
\dv{y}{x} - \frac{2y}{x+1} = (x+1)^{5/2}
\]的通解.
\begin{solution}
这是一个一阶非齐次线性方程.先求对应的齐次方程的通解.\[
\dv{y}{x} - \frac{2}{x+1} y = 0,
\]\[
\frac{\dd{y}}{y} = \frac{2 \dd{x}}{x+1},
\]\[
\ln\abs{y} = 2\ln\abs{x+1}+ \ln\abs{C_1},
\]\[
y = C_1 (x+1)^2.
\]

用常数变易法，把\(C_1\)换成\(u\)，即令\(y = u(x+1)^2\)，那么\[
\dv{y}{x} = \dv{u}{x} (x+1)^2 + 2u(x+1),
\]代入所给非齐次方程，得\[
u' = (x+1)^{1/2}.
\]两端积分，得\[
u = \frac{2}{3} (x+1)^{3/2} + C.
\]故所求方程通解为\[
y = (x+1)^2 \left[
\frac{2}{3} (x+1)^{3/2} + C
\right].
\]
\end{solution}
\end{example}

在上一小节中，对于齐次方程\(y' = f(y/x)\)，我们通过变量代换\(y = xu\)，把它化为变量可分离的方程，然后分离变量，经积分求得通解.
在本小节中，对于一阶非齐次线性方程\[
y' + P(x) y = Q(x),
\]我们通过解对应的齐次线性方程找到变量代换\[
y = u e^{- \int P(x) \dd{x}},
\]利用这一代换，把非齐次线性方程化为变量可分离的方程，然后经积分求得通解.

利用变量代换（因变量的变量代换或自变量的变量代换），把一个微分方程化为变量可分离的方程，或化为已知其求解步骤的方程，这是解微分方程最常用的方法.

\begin{example}
解方程\[
x y' + y = x^2 + 3x + 2.
\]
\begin{solution}
将原方程变形为\[
y' + \frac{1}{x} y = x + 3 + \frac{2}{x}.
\]
对应的齐次方程\[
y' + \frac{1}{x} y = 0
\]又可变形为\[
\frac{\dd{y}}{y} = -\frac{\dd{x}}{x},
\]积分得\[
\ln\abs{y} = -\ln\abs{x} + C_1
\quad\text{或}\quad
y = C_2 e^{-\ln\abs{x}}
= C_2 \frac{1}{\abs{x}}.
\]
应用常数变易法，令\(y = \frac{u}{\abs{x}}\)，那么\[
\dv{y}{x} = \frac{u' \abs{x} - u(\abs{x})'}{x^2}.
\]代回原方程得\[
\frac{u' \abs{x} - u(\abs{x})'}{x^2}
+ \frac{1}{x} \frac{u}{\abs{x}}
= x + 3 + \frac{2}{x},
\]或\[
\def\arraystretch{1.5} \left\{ \begin{array}{cc}
\frac{u' x - u}{x^2}
+ \frac{1}{x} \frac{u}{x}
= x + 3 + \frac{2}{x},
& x>0, \\
\frac{u' (-x) + u}{x^2}
- \frac{1}{x} \frac{u}{x}
= x + 3 + \frac{2}{x},
& x<0.
\end{array} \right.
\]整理得\[
\def\arraystretch{1.5}
u' = \left\{ \begin{array}{rc}
x^2 + 3x + 2,
& x>0, \\
-(x^2 + 3x + 2),
& x<0.
\end{array} \right.
\]积分得\[
\def\arraystretch{1.5}
u = \left\{ \begin{array}{rc}
\frac{1}{3} x^3 + \frac{3}{2} x^2 + 2x + C_3,
& x>0, \\
-(\frac{1}{3} x^3 + \frac{3}{2} x^2 + 2x) + C_4,
& x<0.
\end{array} \right.
\]由此，原方程的通解为\[
y = \frac{1}{3} x^2 + \frac{3}{2} x + 2 + \frac{C}{x}.
\]
\end{solution}
\end{example}

\subsection{伯努利方程}
形如\[
\dv{y}{x} + P(x) y = Q(x) y^n \quad (n \neq 0,1)
\eqno{(16)}
\]的方程叫做\DefineConcept{伯努利方程}.
当\(n=0\)或\(n=1\)时，这是线性微分方程.
当\(n\neq0,1\)时，这方程不是线性的，但是通过变量的代换，可以把它化为线性的.
事实上，以\(y^n\)除方程(16)两端，得\[
y^{-n} \dv{y}{x} + P(x) y^{1-n} = Q(x),
\eqno{(17)}
\]容易看出，上式左端第一项与\(\dv{x}(y^{1-n})\)只差一个常数因子\(1-n\)，因此我们引入新的因变量\(z = y^{1-n}\)，那么\[
\dv{z}{x} = (1-n) y^{-n} \dv{y}{x}.
\]用\((1-n)\)乘方程(17)的两端，再通过上述代换便得线性方程\[
\dv{z}{x} + (1-n) P(x) z = (1-n) Q(x).
\]求出该方程的通解后，以\(y^{1-n}\)代\(z\)便得到伯努利方程的通解.

特别地，当\(n>0\)时，\(y\)可以取为\(0\)，而\(y=0\)恰好也满足方程(16).

\begin{example}
求方程\[
\dv{y}{x} + \frac{y}{x} = a y^2 \ln x
\]的通解.
\begin{solution}
以\(y^2\)除方程的两端，得\[
y^{-2} \dv{y}{x} + \frac{1}{2} y^{-1} = a \ln x,
\]即\[
- \dv{x}(y^{-1}) + \frac{1}{x} y^{-1} = a \ln x.
\]令\(z = y^{-1}\)，则上述方程成为\[
\dv{z}{x} - \frac{1}{x} z = -a \ln x.
\]这是一个线性方程，它的通解为\[
z = x \left[ C - \frac{a}{2} \ln^2 x \right].
\]以\(y^{-1}\)代\(z\)，得所求方程的通解为\[
yx \left[ C - \frac{a}{2} \ln^2 x \right] = 1.
\]
\end{solution}
\end{example}

\subsection{利用幂级数求解一阶微分方程}
给定一阶微分方程\[
\def\arraystretch{1.5}
\left\{ \begin{array}{l}
\dv{y}{x} = f(x,y) \\
\eval{y}_{x=x_0} = y_0 \\
\end{array} \right.
\]其中函数\(f(x,y)\)是\((x-x_0)\)、\((y-y_0)\)的多项式\[
f(x,y) = a_{00} + a_{10} (x-x_0) + a_{01} (y-y_0) + \dotsb + a_{lm} (x-x_0)^l (y-y_0)^m.
\]那么可以设所求的特解可展开为\((x-x_0)\)的幂级数：\[
y = y_0 + a_1 (x-x_0) + a_2 (x-x_0)^2 + \dotsb + a_n (x-x_0)^n + \dotsb,
\]其中\(\v{a}{n},\dotsc\)是待定系数.把上式代回原微分方程（组）中，%
便得一恒等式，比较所得恒等式两端\((x-x_0)\)的同次幂的系数，就可确定待定系数取值，即求得原微分方程（组）的特解.

\section{高阶微分方程}
从这一节起我们将讨论二阶及二阶以上的微分方程，即所谓的\cemph{高阶微分方程}.

\subsection{可降阶的高阶微分方程}
对于有些高阶微分方程，我们可以通过代换将它化成较低阶的方程来求解.
以二阶微分方程\[
y'' = f(x,y,y')
\eqno{(1)}
\]而论，如果我们能设法作代换把它从二阶降为一阶，那么就有可能应用前面几节中所讲的方法来求出它的解了.

下面介绍三种容易降阶的高阶微分方程的求解方法.

\subsubsection{\texorpdfstring{形如\(y^{(n)} = f(x)\)}{由自变量确定n阶导数}的微分方程}
微分方程\[
y^{(n)} = f(x)
\eqno{(2)}
\]的右端仅含有自变量\(x\).
容易看出，只要把\(y^{(n-1)}\)作为新的未知函数，那么(2)式就是新未知函数的一阶微分方程.
两边积分，就得到一个\(n-1\)阶的微分方程\[
y^{(n-1)} = \int f(x) \dd{x} \dd{x} + C_1.
\]
同理可得\[
y^{(n-2)} = \int \left[ \int f(x) \dd{x} + C_1 \right] \dd{x} + C_2.
\]依此法继续进行，接连积分\(n\)次，便得方程(2)的含有\(n\)个任意常数的通解.

\begin{example}
求微分方程\[
y''' = e^{2x} - \cos x
\]的通解.
\begin{solution}
对所给方程接连积分三次，得\[
y'' = \frac{1}{2} e^{2x} - \sin x + C,
\]\[
y' = \frac{1}{4} e^{2x} + \cos x + C x + C_2,
\]\[
y = \frac{1}{8} e^{2x} + \sin x + C_1 x^2 + C_2 x + C_3.
\]这就是所求的通解.
\end{solution}
\end{example}

\subsubsection{\texorpdfstring{形如\(y'' = f(x,y')\)}{由自变量与一阶导数确定二阶导数}的微分方程}
微分方程\[
y'' = f(x, y')
\eqno{(3)}
\]的右端不显含未知函数\(y\).
如果设\(y' = p\)，那么\[
y'' = \dv[2]{y}{x} = \dv{p}{x} = p',
\]而方程(3)就成为\[
p' = f(x, p),
\]这是一个关于变量\(x\)、\(p\)的一阶微分方程.
设其通解为\[
p = \varphi(x, C_1),
\]但是\(p = \dv{y}{x}\)，因此又得到一个一阶微分方程\[
\dv{y}{x} = \varphi(x, C_1).
\]对它进行积分，便得方程(3)的通解为\[
y = \int \varphi(x, C_1) \dd{x} + C_2.
\]

\begin{example}
求微分方程\[
(1+x^2) y'' = 2xy'
\]满足初始条件\[
\eval{y}_{x=0} = 1,
\qquad
\eval{y'}_{x=0} = 3
\]的特解.
\begin{solution}
所给方程是\(y'' = f(x, y')\)型的.
设\(y' = p\)，代入方程并分离变量后，有\[
\frac{\dd{p}}{p} = \frac{2x}{1+x^2} \dd{x}.
\]两端积分，得\[
\ln\abs{p} = \ln(1+x^2) + C,
\]即\(p = y' = C_1(1+x^2)\ (C_1 = \pm e^C)\).
由条件\(\eval{y'}_{x=0}=3\)，得\(C_1 = 3\)，所以\[
y' = 3(1+x^2).
\]两端再积分，得\[
y = x^3 + 3x + C_2.
\]又由条件\(\eval{y}_{x=0}=1\)，得\(C_2=1\)，于是所求的特解为\[
y = x^3 + 3x + 1.
\]
\end{solution}
\end{example}

\begin{example}
设有一均匀、柔软的绳索，两端固定，绳索仅受重力的作用而下垂.
试问该绳索在平衡状态时是怎样的曲线？
\begin{solution}
设绳索的最低点为\(A\).取\(y\)轴通过点\(A\)铅直向上，并取\(x\)轴水平向右，且\(\abs{OA}\)等于某个定值.
设绳索曲线的方程为\(y = \varphi(x)\).
考察绳索上点\(A\)到另一点\(M\opair{x,y}\)间的一段弧\(\arc{AM}\)，设其长为\(s\).
假定绳索的线密度为\(\rho\)，则弧\(\arc{AM}\)所受重力为\(\rho gs\).
由于绳索是柔软的，因而在点\(A\)处的张力沿水平的切线方向，其大小设为\(H\)；
在点\(M\)处的张力沿该点处的切线方向，设其倾角为\(\theta\)，其大小为\(T\).
因作用于弧段\(\arc{AM}\)的外力相互平衡，把作用于弧\(\arc{AM}\)上的力沿铅锤及水平两方向分解，得\[
T \sin\theta = \rho gs,
\qquad
T \cos\theta = H.
\]将此两式相除，得\[
\tan\theta = \frac{1}{a} s \quad(a = \frac{H}{\rho g}).
\]由于\(\tan\theta = y'\)，\(s = \int_0^x \sqrt{1+y'^2} \dd{x}\)，代入上式即得\[
y' = \frac{1}{a} \int_0^x \sqrt{1+y'^2} \dd{x}.
\]将上式两端对\(x\)求导，便得\(y = \varphi(x)\)满足的微分方程\[
y'' = \frac{1}{a} \sqrt{1+y'^2}.
\]

取原点\(O\)到点\(A\)的距离为定值\(a\)，即\(\abs{OA}=a\)，那么初始条件为\[
\eval{y}_{x=0} = a, \qquad \eval{y'}_{x=0} = 0.
\]

设\(y' = p\)，则\(y'' = \dv{p}{x}\)，代回微分方程，并分离变量，得\[
\frac{\dd{p}}{\sqrt{1+p^2}} = \frac{\dd{x}}{a}.
\]两端积分，得\[
\ln(p+\sqrt{1+p^2}) = \frac{x}{a} + C_1.
\]把条件\(\eval{y'}_{x=0} = \eval{p}_{x=0} = 0\)代入上式，得\(C_1 = 0\)，于是上式成为\[
\ln(p+\sqrt{1+p^2}) = \frac{x}{a},
\]解得\[
p = \frac{1}{2} \left( e^{x/a} - e^{-x/a} \right),
\]即\[
y' = \frac{1}{2} \left( e^{x/a} - e^{-x/a} \right).
\]两端再积分，便得\[
y = \frac{a}{2} \left( e^{x/a} - e^{-x/a} \right) + C_2.
\]将条件\(\eval{y}_{x=0} = a\)代入上式，得\(C_2 = 0\).
于是该绳索的形状可由曲线方程\begin{equation}\label{equation:微分方程.悬链线}
y = \frac{a}{2} \left( e^{x/a} - e^{-x/a} \right)
\end{equation}来表示.
这曲线叫做\DefineConcept{悬链线}.
\end{solution}
\end{example}

\subsubsection{\texorpdfstring{形如\(y'' = f(y,y')\)}{由因变量与一阶导数确定二阶导数}的微分方程}
方程\[
y'' = f(y, y')
\eqno{(4)}
\]中不显含自变量\(x\).
为了求出它的解，我们令\(y'=p\)，并利用复合函数的求导法则把\(y''\)化为对\(y\)的导数，即\[
y'' = \dv{p}{x} = \dv{p}{y} \cdot \dv{y}{x} = p \dv{p}{y}.
\]这样，方程(4)就成为\[
p \dv{p}{y} = f(y, p).
\]这是一个关于变量\(y\)、\(p\)的一阶微分方程.
设它的通解为\[
y' = p = \varphi(y, C_1),
\]分离变量并积分，便得方程(4)的通解为\[
\int \frac{\dd{y}}{\varphi(y,C_1)} = x + C_2.
\]

\begin{example}
设有一质量为\(m\)的物体，在空中由静止开始下落，如果空气阻力为\(R = cv\)（其中\(c\)是常数，\(v\)是物体运动的速度），试求物体下落的距离\(s\)与时间\(t\)的函数关系.
\begin{solution}
物体的加速度\(\dv{v}{t}\)与速度\(v\)满足\[
m \dv{v}{t} = mg - cv.
\]当\(mg>cv\)时，有\[
\frac{m}{mg-cv} \dd{v} = \dd{t},
\]即\[
-\frac{m}{c} \frac{1}{mg-cv} \dd(mg-cv) = \dd{t},
\]两端积分，得\[
-\frac{m}{c} \ln(mg-cv) = t + C_1
\quad\text{或}\quad
v = \frac{mg}{c} - \frac{1}{c} C_2 e^{-\frac{c}{m} t}.
\]代入初始条件\(\eval{v}_{t=0} = 0\)，则有\(C_2 = mg\)，那么上式即为\[
v = \frac{mg}{c} \left( 1 - e^{-\frac{c}{m} t} \right).
\]再积分，得\[
s(t) = \int_0^t v \dd{t}
= \int_0^t \frac{mg}{c} \left( 1 - e^{-\frac{c}{m} t} \right) \dd{t} \\
= \frac{mg}{c} \left( t + \frac{m}{c} e^{-\frac{c}{m} t} \right) + C_3.
\]
代入初始条件\(\eval{s}_{t=0} = 0\)，则有\(C_3 = -\frac{m^2}{c^2} g\)，那么上式即为\[
s(t) = \frac{mg}{c} \left( t + \frac{m}{c} e^{-\frac{c}{m} t} - \frac{m}{c} \right).
\]
\end{solution}
\end{example}

\begin{example}
设函数\(y(x)\)具有二阶导数，且曲线\(l: y=y(x)\)与直线\(y=x\)相切于原点.
记\(\alpha\)为曲线\(l\)在点\(\opair{x,y}\)处的倾角，且\(\dv{\alpha}{x}=\dv{y}{x}\)，求\(y(x)\)的表达式.
\begin{solution}
由导数的几何意义可知，\(\tan\alpha=y'\)，那么\(\sec^2\alpha \dv{\alpha}{x} = y''\)，即\[
\dv{\alpha}{x} = \frac{y''}{\sec^2\alpha}
= \frac{y''}{1+\tan^2\alpha}
= \frac{y''}{1+y'^2}.
\]由题意有，\(\frac{y''}{1+y'^2} = y'\)，令\(y' = p, y'' = p\dv{p}{y}\)，得\[
p\dv{p}{y} = p(1+p^2),
\]\[
\dv{p}{y} = 1+p^2,
\]\[
\dd{y} = \frac{\dd{p}}{1+p^2},
\]\[
\arctan p = y + C_1,
\]\[
p = \tan(y+C_1) = y',
\]因为曲线\(l: y=y(x)\)与直线\(y=x\)相切于原点，\(y(0) = 0\)，\(y'(0) = 1\)，代入得\(\tan C_1 = 1\)，那么可取\(C_1 = \pi/4\)，于是\(y' = \tan(y+\pi/4)\).%
因此\[
\cot(y+\frac{\pi}{4}) \dd{y} = \dd{x},
\]\[
\ln\abs{\sin(y+\frac{\pi}{4})} = x + C_2,
\]\[
\sin(y+\frac{\pi}{4}) = C_3 e^x,
\]又因为\(y(0) = 0\)，代入得\(\sqrt{2}/2 = C_3\)，于是\[
y = \arcsin(\frac{\sqrt{2}}{2} e^x) - \frac{\pi}{4}.
\]
\end{solution}
\end{example}

\subsection{高阶线性微分方程}
本节讨论在实际问题中应用得较多的所谓高阶线性微分方程.
讨论时以二阶线性微分方程为主.

\DefineConcept{二阶线性微分方程}的一般形式为
\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的一般形式}
\dv[2]{y}{x} + P(x) \dv{y}{x} + Q(x) y = f(x).
\end{equation}
\begin{enumerate}
\item 如果\(f(x) \equiv 0\)，则称该微分方程为\cemph{齐次的}；
\item 如果\(f(x) \not\equiv 0\)，则称该微分方程为\cemph{非齐次的}.
\end{enumerate}

下面来讨论二阶线性微分方程的解的一些性质，这些性质可以推广到\(n\)阶线性方程\begin{equation}\label{equation:微分方程.n阶线性微分方程的一般形式}
y^{(n)} + a_1(x) y^{(n-1)} + \dotsb + a_{n-1}(x) y' + a_n(x) y = f(x).
\end{equation}

要研究线性微分方程的解的结构，首先讨论二阶齐次线性方程\begin{equation}\label{equation:微分方程.二阶齐次线性微分方程的一般形式}
y'' + P(x) y' + Q(x) y = 0.
\end{equation}

\begin{theorem}
如果函数\(y_1(x)\)与\(y_2(x)\)是方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的两个解，那么\begin{equation}\label{equation:微分方程.二阶齐次线性微分方程的通解的结构}
y = C_1 y_1(x) + C_2 y_2(x)
\end{equation}也是方程的解，其中\(C_1\)、\(C_2\)是任意常数.
\end{theorem}

解 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 从形式上来看含有\(C_1\)与\(C_2\)两个任意常数，但它不一定是方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
例如，设\(y_1(x)\)是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的的一个解，则\(y_2(x)=2 y_1(x)\)也是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的的解.
这时解 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 成为\(y = C_1 y_1(x) + 2 C_2 y_1(x)\)，可以把它改写成\(y = C y_1(x)\)，其中\(C = C_1 + 2 C_2\).
这显然不是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
那么在什么情况下 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 才是方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解呢？
要解决这个问题，还得引入一个新的概念，即“函数组的线性相关与线性无关”.

\begin{definition}
设\(y_1(x),y_2(x),\dotsc,y_n(x)\)为定义在区间\(I\)上的\(n\)个函数.
如果存在\(n\)个不全为零的常数\(k_1,k_2,\dotsc,k_n\)，使得当\(x \in I\)时有恒等式\[
k_1 y_1+k_2 y_2+ \dotsb +k_n y_n \equiv 0
\]成立，那么称这\(n\)个函数在区间\(I\)上\DefineConcept{线性相关}；否则称之为\DefineConcept{线性无关}.
\end{definition}

\begin{example}
函数\(1,\cos^2 x, \sin^2 x\)在整个数轴上是线性相关的.
因为取\(k_1=1,k_2=k_3=-1\)，就有恒等式\[
1 - \cos^2 x - \sin^2 x \equiv 0.
\]

函数\(1,x,x^2\)在任何区间\((a,b)\)内是线性无关的.
因为如果\(k_1,k_2,k_3\)不全为零，那么在该区间内至多只有两个\(x\)值能使二次三项式\[
k_1 + k_2 x + k_3 x^2
\]为零；而要使它恒等于零，必须\(k_1,k_2,k_3\)全为零.
\end{example}

应用上述概念可知，对于两个函数的情形，它们线性相关与否，只要看它们的比是否为常数：
如果比为常数，那么它们就线性相关；否则就线性无关.

有了一组函数线性相关或线性无关的概念后，我们有如下关于二阶齐次线性微分方程的通解结构的定理.
\begin{theorem}\label{theorem:微分方程.二阶齐次线性微分方程的通解结构}
如果\(y_1(x)\)与\(y_2(x)\)是方程\(y''+P(x)y'+Q(x)y=0\)的两个线性无关的特解，那么\[
y = C_1 y_1(x) + C_2 y_2(x) \quad(C_1,C_2\text{是任意常数})
\]就是该微分方程的通解.
\end{theorem}

\begin{example}
方程\(y'' + y = 0\)是二阶齐次线性方程（这里\(P(x)\equiv0, Q(x)\equiv1\)）.
容易验证，\(y_1 = \cos x\)与\(y_2 = \sin x\)是所给方程的两个解，且\[
\frac{y_2}{y_1} = \frac{\sin x}{\cos x} = \tan x \not\equiv\text{常数},
\]即它们是线性无关的.
因此方程\(y'' + y = 0\)的通解为\[
y = C_1 \cos x + C_2 \sin x.
\]
\end{example}

\cref{theorem:微分方程.二阶齐次线性微分方程的通解结构} 不难推广到\(n\)阶齐次线性方程.
\begin{corollary}\label{theorem:微分方程.n阶齐次线性微分方程的通解结构}
如果\(y_1(x),y_2(x),\dotsc,y_n(x)\)是\(n\)阶齐次线性方程\[
y^{(n)} + a_1(x) y^{(n-1)} + \dotsb + a_{n-1}(x) y' + a_n(x) y = 0
\]的\(n\)个线性无关的解，那么此方程的通解为\[
y = C_1 y_1(x) + C_2 y_2(x) + \dotsb + C_n y_n(x)
\]其中\(C_1,C_2,\dotsc,C_n\)为任意常数.
\end{corollary}

下面讨论二阶非齐次线性方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} .
我们把方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 叫做与非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 对应的齐次方程.

在前面我们已经看到，一阶非齐次线性微分方程的通解由两部分构成：
一部分是对应的齐次方程的通解；另一部分是非齐次方程本身的一个特解.
实际上，不仅一阶非齐次线性微分方程的通解具有这样的结构，而且二阶及更高阶的非齐次线性微分方程的特解也具有同样的结构.
\begin{theorem}\label{theorem:微分方程.二阶非齐次线性微分方程的通解结构}
设\(y^*(x)\)是二阶非齐次线性微分方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的一个特解.
\(Y(x)\)是与 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 对应的齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解，那么\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解结构}
y=Y(x)+y^*(x)
\end{equation}是二阶非齐次线性微分方程的通解.
\end{theorem}

非齐次线性微分方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的特解有时可用下述定理来帮助求出.
\begin{theorem}\label{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理}
设非齐次线性方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的右端\(f(x)\)是两个函数之和，即\[
y''+P(x)y'+Q(x)y=f_1(x)+f_2(x);
\]而\(y_1^*(x)\)与\(y_2^*(x)\)分别是方程\[
y''+P(x)y'+Q(x)y=f_1(x)
\]与\[
y''+P(x)y'+Q(x)y=f_2(x)
\]的特解，那么\(y_1^*(x)+y_2^*(x)\)就是原方程的特解.
\end{theorem}

\cref{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理} 通常称为线性微分方程的解的\cemph{叠加原理}.

\cref{theorem:微分方程.二阶非齐次线性微分方程的通解结构} 和\cref{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理} 也可推广到\(n\)阶非齐次线性方程，这里不再赘述.

在前面为了解一阶非齐次线性方程，我们采用了常数变易法.
该方法的特点是：如果\(C y_1(x)\)是齐次线性方程的通解，那么，可以利用变换\(y = u y_1(x)\)（这变换是把齐次方程的通解中的任意常数\(C\)换成未知函数\(u(x)\)而得到的）去解非齐次线性方程.
这一方法也适用于解高阶线性方程.下面就二阶线性方程来作讨论.

\begin{enumerate}
\item%第一种情况
如果已知齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解为\[
Y(x) = C_1 y_1(x) + C_2 y_2(x),
\]那么，可以用如下的常数变易法去求非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解：
令\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解设想}
y = y_1(x) v_1 + y_2(x) v_2,
\end{equation}要确定未知函数\(v_1(x)\)及\(v_2(x)\)使\cref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 所表示的函数满足非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} .
为此，对\cref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 求导，得\[
y' = y_1 v_1' + y_2 v_2' + y_1' v_1 + y_2' v_2.
\]由于两个未知函数\(v_1,v_2\)只需使\cref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 所表示的函数满足一个关系式 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} ，所以可规定它们再满足一个关系式.
从\(y'\)的上述表示式可以看出，为了使\(y''\)的表示式中不含\(v_1''\)和\(v_2''\)，可设\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的额外条件1}
y_1 v_1' + y_2 v_2' = 0,
\end{equation}从而\[
y' = y_1' v_1 + y_2' v_2,
\]再求导，得\[
y'' = y_1' v_1' + y_2' v_2' + y_1'' v_1 + y_2'' + v2.
\]把\(y,y',y''\)代入方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} ，得\[
y_1' v_1' + y_2' v_2' + y_1'' v_1 + y_2'' v_2
+P(y_1' v_1 + y_2' v_2) + Q(y_1 v_1 + y_2 v_2) = f,
\]整理得\[
y_1' v_1' + y_2' v_2'
+ (y_1'' + P y_1' + Q y_1) v_1
+ (y_2'' + P y_2' + Q y_2) v_2
= f.
\]注意到\(y_1,y_2\)是齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，故上式即为\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的额外条件2}
y_1' v_1' + y_2' v_2' = f.
\end{equation}
联立方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的额外条件1} 与 \labelcref{equation:微分方程.二阶非齐次线性微分方程的额外条件2} ，在系数行列式\[
W = \begin{vmatrix} y_1 & y_2 \\ y_1' & y_2' \end{vmatrix}
= y_1 y_2' - y_1 y_2 \neq0
\]时，可解得\[
v_1' = -\frac{y_2 f}{W},
\qquad
v_2' = \frac{y_1 f}{W}.
\]
对上两式积分（假定\(f\)连续），得\[
v_1 = C_1 + \int \left(-\frac{y_2 f}{W}\right) \dd{x},
\qquad
v_2 = C_2 + \int \frac{y_1 f}{W} \dd{x}.
\]

于是非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解为\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解.形式1}
y = C_1 y_1 + C_2 y_2 - y_1 \int \frac{y_2 f}{W} \dd{x} + y_2 \int \frac{y_1 f}{W} \dd{x}.
\end{equation}

\item%第二种情况
如果只知齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的一个不恒为零的解\(y_1(x)\)，那么，利用变换\(y = u y_1(x)\)，可把非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 化为一阶线性方程.

事实上，把\[
y = y_1 u, \qquad y' = y_1 u' + y_1' u, \qquad y'' = y_1 u'' + 2 y_1' u' + y_1'' u
\]代入方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} ，得\[
(y_1 u'' + 2y_1' u' + y_1'' u) + P\cdot(y_1 u' + y_1' u) + Q \cdot y_1 u = f,
\]即\[
y_1 u'' + (2y_1' + P y_1) u' + (y_1'' + P y_1' + Q y_1) u = f,
\]由于\(y_1'' + P y_1' + Q y_1 \equiv 0\)，故上式为\[
y_1 u'' + (2 y_1' + P y_1) u' = f.
\]令\(u' = z\)，上式即化为一阶线性方程\begin{equation}\label{equation:微分方程.降为一阶的二阶线性微分方程}
y_1 z' + (2 y_1' + P y_1) z = f.
\end{equation}

把方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 化为方程 \labelcref{equation:微分方程.降为一阶的二阶线性微分方程} 以后，按\hyperref[section:微分方程.一阶线性微分方程]{一阶线性方程的解法}，设求得方程 \labelcref{equation:微分方程.降为一阶的二阶线性微分方程} 的通解为\[
z = C_2 Z(x) + z^*(x),
\]积分得\[
u = C_1 + C_2 U(x) + u^*(x),
\]其中\(U'(x) = Z(x), [u^*(x)]' = z^*(x)\)，上式乘以\(y_1(x)\)，便得方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解.形式2}
y = C_1 y_1(x) + C_2 U(x) y_1(x) + u^*(x) y_1(x).
\end{equation}
上述方法显然也适用于求齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
\end{enumerate}

\begin{example}
已知齐次方程\((x-1)y'' - xy' + y = 0\)的通解为\(Y(x) = C_1 x + C_2 e^x\)，求非齐次方程\((x-1)y'' - xy' + y = (x-1)^2\)的通解.
\begin{solution}
把所给方程写成标准形式\[
y'' - \frac{x}{x-1} y' + \frac{1}{x-1} y = x-1.
\]

应用常数变易法，令\(y = x v_1 + e^x v_2\).由\[
\left\{ \begin{array}{l}
x v_1' + e^x v_2' = 0, \\
v_1' + e^x v_2' = x-1,
\end{array} \right.
\]解得\(v_1' = -1, v_2' = x e^{-x}\).
再积分，得\(v_1 = C_1 - x, v_2 = C_2 - (x+1) e^{-x}\).
于是所求非齐次方程的通解为\[
y = C_1 x + C_2 e^x - (x^2+x+1).
\]
\end{solution}
\end{example}

\begin{example}
已知\(y_1(x) = e^x\)是齐次方程\(y'' - 2y' + y = 0\)的解，求非齐次方程\(y'' - 2y' + y = x^{-1} e^x\)的通解.
\begin{solution}
令\(y = e^x u\)，则\(y' = e^x (u'+u), y'' = e^x (u''+2u'+u)\).
代入非齐次方程，得\[
e^x (u''+2u'+u) - 2e^x (u'+u) + e^x u = \frac{1}{x} e^x,
\]即\(e^x u'' = x^{-1} e^x, u'' = x^{-1}\).

这里不需再作变换去化为一阶线性方程，只要直接积分，便得\[
u' = C + \ln\abs{x},
\qquad
u = C_1 + C x + x\ln\abs{x} - x,
\]即\(u = C_1 + C_2 x + x \ln\abs{x}\ (C_2=C-1)\).
\end{solution}
\end{example}

\subsection{常系数齐次线性微分方程}\label{section:微分方程.常系数齐次线性微分方程}
先讨论二阶常系数齐次线性微分方程的解法，再把二阶方程的解法推广到\(n\)阶.

\subsubsection{二阶常系数齐次线性微分方程}

\begin{definition}
在二阶齐次线性微分方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 中，如果\(y'\)、\(y\)的系数\(P(x)\)、\(Q(x)\)均为常数，即 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 成为\begin{equation}\label{equation:微分方程.二阶常系数齐次线性微分方程的一般形式}
y''+py'+qy=0
\end{equation}
其中\(p\)、\(q\)是常数，则称 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 为\DefineConcept{二阶常系数齐次线性微分方程}.
如果\(p\)、\(q\)不全为常数，称 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 为\DefineConcept{二阶变系数齐次线性微分方程}.
\end{definition}

由上节讨论可知，要找微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解，可以先求出它的两个解\(y_1, y_2\)，如果\(\frac{y_2}{y_1} \not\equiv \text{常数}\)，即\(y_1\)与\(y_2\)线性无关，那么\(y = C_1 y_1 + C_2 y_2\)就是方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解.

当\(r\)为常数时，指数函数\(y = e^{r x}\)和它的各阶导数都只相差一个常数因子.
由于指数函数有这个特点，因此我们用\(y = e^{rx}\)来尝试，看能否选取适当的常数\(r\)，使\(y = e^{rx}\)满足方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} .

对\(y = e^{rx}\)求导\footnote{当\(r\in\mathbb{C}\)，\(x\)为实变数时，导数公式\(\dv{x} e^{rx} = r e^{rx}\)仍成立.}，得到\[
y' = r e^{rx}, \qquad y'' = r^2 e^{rx}.
\]把\(y,y',y''\)代入方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} ，得\[
(r^2 + pr + q) e^{rx} = 0.
\]由于\(e^{rx}\neq0\)，所以\begin{equation}\label{equation:微分方程.二阶常系数齐次线性微分方程的特征方程}
r^2 + pr + q = 0.
\end{equation}

由此可见，只要\(r\)满足代数方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} ，函数\(y = e^{rx}\)就是微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的解，我们把代数方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 叫做微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的\DefineConcept{特征方程}.
注意到特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 是一个二次代数方程，其中\(r^2, r\)的系数及常数项恰好依次是微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 中\(y'',y',y\)的系数.

特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 的两个根\(r_1,r_2\)可以用公式\[
r_{1,2} = \frac{-p \pm\sqrt{p^2-4q}}{2}
\]求出.它们有三种不同的情形：\begin{enumerate}
\item 当\(p^2-4q>0\)时，\(r_1,r_2\)是两个不相等的实根：\[
r_1 = \frac{-p +\sqrt{p^2-4q}}{2}, \qquad
r_2 = \frac{-p -\sqrt{p^2-4q}}{2};
\]
\item 当\(p^2-4q=0\)时，\(r_1,r_2\)是两个相等的实根：\[
r_1 = r_2 = -\frac{p}{2};
\]
\item 当\(p^2-4q<0\)时，\(r_1,r_2\)是一对共轭复根：\[
r_1 = \alpha+\iu\beta, \qquad r_2 = \alpha-\iu\beta,
\]其中\(\alpha=-p/2\)，\(\beta=\sqrt{4q-p^2}/2\).
\end{enumerate}

相应地，微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解也有三种不同的情形.分别讨论如下：\begin{enumerate}
\item 特征方程有两个不相等的实根：\(r_1 \neq r_2\).

由上面的讨论知道，\(y_1 = e^{r_1 x}\)和\(y_2 = e^{r_2 x}\)是微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的两个解，并且\(\frac{y_2}{y_1} = \frac{e^{r_2 x}}{e^{r_1 x}} = e^{(r_2-r_1) x}\)不是常数，因此微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解为\[
y = C_1 e^{r_1 x} + C_2 e^{r_2 x}.
\]

\item 特征方程有两个相等的实根：\(r_1 = r_2\).

这时，只得到微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的一个解\[
y_1 = e^{r_1 x}.
\]为了得出微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解，还需求出另一个解\(y_2\)，并且要求\(\frac{y_2}{y_1}\)不是常数.

设\(\frac{y_2}{y_1} = u(x)\)，即\(y_2 = e^{r_1 x} u(x)\).
下面来求\(u(x)\).

对\(y_2\)求导，得\[
y' = e^{r_1 x} (u' + r_1 u),
\qquad
y'' = e^{r_1 x} (u'' + 2 r_1 u' + r_1^2 u),
\]将\(y_2,y_2',y_2''\)代入微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} ，得\[
e^{r_1 x} [(u'' + 2 r_1 u' + r_1^2 u) + p(u' + r_1 u) + qu] = 0,
\]约去\(e^{r_1 u}\)，并以\(u'',u',u\)为准合并同类项，得\[
u'' + (2 r_1 + p) u' + (r_1^2 + p r_1 + q) u = 0.
\]由于\(r_1\)是特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 的二重根，因此\(r_1^2 + p r_1 + q = 0\)，且\(2 r_1 + p = 0\)，于是得\[
u'' = 0.
\]因为这里只要得到一个不为常数的解，所以不妨选取\(u = x\)，由此得到微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的另一个解\[
y_2 = x e^{r_1 x}.
\]

从而微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解为\[
y = C_1 e^{r_1 x} + C_2 x e^{r_1 x}
= (C_1 + C_2 x) e^{r_1 x}.
\]

\item 特征方程有一对共轭复根：\(r_1 = \alpha+\iu\beta, r_2 = \alpha-\iu\beta \ (\beta\neq0)\).

这时，\(y_1 = e^{(\alpha+\iu\beta)x}, y_2 = e^{(\alpha-\iu\beta)x}\)是微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的两个解，但它们是复值函数形式.
为了得出实值函数形式的解，先利用欧拉公式\(e^{\iu\theta} = \cos\theta+\iu\sin\theta\)，把\(y_1,y_2\)改写为\[
y_1 = e^{(\alpha+\iu\beta)x} = e^{\alpha x} \cdot e^{\iu\beta x}
= e^{\alpha x} (\cos\beta x + \iu \sin\beta x),
\]\[
y_2 = e^{(\alpha-\iu\beta)x} = e^{\alpha x} \cdot e^{-\iu\beta x}
= e^{\alpha x} (\cos\beta x - \iu \sin\beta x),
\]由于复值函数\(y_1\)与\(y_2\)之间成共轭关系，因此，取它们的和除以\(2\)就得到它们的实部；
取它们的差除以\(2\iu\)就得到它们的虚部.
由于方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的解符合叠加原理，所以实值函数\[
\overline{y}_1 = \frac{1}{2} (y_1 + y_2) = e^{\alpha x} \cos\beta x,
\]\[
\overline{y}_2 = \frac{1}{2\iu} (y_1 - y_2) = e^{\alpha x} \sin\beta x
\]还是微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的解，且\[
\frac{\overline{y}_1}{\overline{y}_2}
= \frac{e^{\alpha x} \cos\beta x}{e^{\alpha x} \sin\beta x}
= \cot\beta x
\]不是常数，所以微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解为\[
y = e^{\alpha x} (C_1 \cos\beta x + C_2 \sin\beta x).
\]
\end{enumerate}

综上所述，求二阶常系数齐次线性微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解的步骤如下：
\begin{enumerate}
\item[第一步] 写出微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} .

\item[第二步] 求出特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 的两个根\(r_1,r_2\).

\item[第三步] 根据特征方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的特征方程} 的两个根的不同情形，按照下列表格写出微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解：
\end{enumerate}

\begin{center}
\begin{tabular}{c|c}
\hline
特征方程\(r^2+pr+q=0\)的判别式\(\Delta\)取值 & 微分方程\(y''+py'+qy = 0\)的通解 \\ \hline
\(\Delta = p^2 - 4q > 0\) & \(y = C_1 e^{r_1 x} + C_2 e^{r_2 x}\) \\
\(\Delta = p^2 - 4q = 0\) & \(y = (C_1 + C_2 x) e^{r_1 x}\) \\
\(\Delta = p^2 - 4q < 0\) & \(y = e^{ax} (C_1 \cos{\beta x} + C_2 \sin{\beta x})\) \\ \hline
\end{tabular}
\end{center}

\begin{example}
求微分方程\(y'' - 2y' - 3y = 0\)的通解.
\begin{solution}
所给微分方程的特征方程为\(r^2-2r-3=0\)，其根\(r_1=-1, r_2=3\)是两个不同的实根，因此所求通解为\[
y = C_1 e^{-x} + C_2 e^{3x}.
\]
\end{solution}
\end{example}

\begin{example}
若微分方程\(y''+ay'+by=0\)的解在\((-\infty,+\infty)\)上有界，求常数\(a,b\)的取值范围.
\begin{solution}
微分方程\(y''+ay'+by=0\)的特征方程为\(\lambda^2 + a\lambda+b = 0\).

当\(\Delta=a^2-4b>0\)时，特征方程有两个不同的实根\(\lambda_1,\lambda_2\)，且\(\lambda_1,\lambda_2\)至少有一个不等于零.
只要常数\(C_1,C_2\)都不为零，那么微分方程的通解\(y = C_1 e^{\lambda_1 x} + C_2 e^{\lambda_2 x}\)在\((-\infty,+\infty)\)内无界.

当\(\Delta=a^2-4b=0\)时，特征方程有两个相同的实根\(\lambda=-a/2\).
只要常数\(C_2\neq0\)，那么微分方程的通解\(y = C_1 e^{-ax/2} + C_2 x e^{-ax/2}\)在\((-\infty,+\infty)\)内无界.

当\(\Delta=a^2-4b<0\)时，特征方程有两个共轭复根\(\lambda_{1,2}=-\frac{a}{2}\pm\frac{\sqrt{4b-a^2}}{2}\iu\)，微分方程的通解为\[
y = e^{-\frac{a}{2}x} \left( C_1 \cos\frac{\sqrt{4b-a^2}}{2}x + C_2 \sin\frac{\sqrt{4b-a^2}}{2}x \right),
\]此时，要使该通解在\((-\infty,+\infty)\)内有界，则必有\(a = 0, b > 0\).
\end{solution}
\end{example}

\subsubsection{\texorpdfstring{\(n\)}{n}阶常系数齐次线性微分方程}

上面讨论二阶常系数齐次线性微分方程所用的方法以及方程的通解的形式，可推广到\(n\)阶常系数齐次线性微分方程上去，对此我们不再详细讨论，只简单地叙述于下：

\(n\)阶常系数齐次线性微分方程的一般形式是\[
y^{(n)} + p_1 y^{(n-1)} + p_2 y^{(n-2)} + \dotsb + p_{n-1} y' + p_n y = 0,
\]其中\(p_1,p_2,\dotsc,p_{n-1},p_n\)都是常数.

有时我们用记号\(D\)（叫做\DefineConcept{微分算子}）表示对\(x\)求导的运算\(\dv{x}\)，把\(\dv{y}{x}\)记作\(Dy\)，把\(\dv[n]{y}{x}\)记作\(D^n y\)，并把上述方程记作\[
(D^n + p_1 D^{n-1} + p_2 D^{n-2} + \dotsb + p_{n-1} D + p_n) y = 0.
\]

再记\[
L(D) = D^n + p_1 D^{n-1} + p_2 D^{n-2} + \dotsb + p_{n-1} D + p_n,
\]称之为微分算子\(D\)的\(n\)次多项式.
于是上述方程又可记作\[
L(D) y = 0.
\]

如同讨论二阶常系数齐次线性微分方程那样，令\[
y = e^{rx}.
\]
由于\[
D e^{rx} = r e^{rx},\dotsc,D^n e^{rx} = r^n e^{rx},
\]故\(L(D) e^{rx} = L(r) e^{rx}\).
因此把\(y = e^{rx}\)代入微分方程，得\[
L(r) e^{rx} = 0.
\]由此可见，如果选取\(r\)是\(n\)次代数方程（叫做\(n\)阶常系数齐次线性微分方程的特征方程）\[
L(r) = 0 \quad\text{即}\quad r^n + p_1 r^{n-1} + p_2 r^{n-2} + \dotsb + p_{n-1} r + p_n = 0
\]的根，那么作出的函数\(y = e^{rx}\)就是微分方程的一个解.

\begin{center}
\begin{tabular}{p{3cm}|p{9cm}}
\hline
特征方程的根 & 微分方程通解中的对应项 \\ \hline
单实根\(r\) & 给出一项：\(C e^{rx}\) \\ \hline
一对单复根\newline\(r_{1,2}=\alpha\pm\iu\beta\)
	& 给出两项：\(e^{\alpha x} (C_1 \cos\beta x + C_2 \sin\beta x)\) \\ \hline
\(k\)重实根\(r\)
	& 给出\(k\)项：\(e^{rx} (C_1 + C_2 x + \dotsb + C_k x^{k-1})\) \\ \hline
一对\(k\)重复根\newline\(r_{1,2}=\alpha\pm\iu\beta\)
	& 给出\(2k\)项：\(e^{\alpha x} [ (C_1+C_2 x+\dotsb+C_k x^{k-1}) \cos\beta x + (D_1+D_2 x+\dotsb+D_k x^{k-1})\sin\beta x ]\)
\\ \hline
\end{tabular}
\end{center}

根据代数学基本定理，\(n\)次代数方程有\(n\)个根.
而特征方程的每一个根都对应着通解中的一项，且每项各含一个任意常数.
这样就得到\(n\)阶常系数齐次线性微分方程的通解\[
y = C_1 y_1 + C_2 y_2 + \dotsb + C_n y_n.
\]

\subsection{常系数非齐次线性微分方程}\label{section:微分方程.常系数非齐次线性微分方程}
本节着重讨论二阶常系数非齐次线性微分方程的解法，并对\(n\)阶方程的解法作必要的说明.

二阶常系数非齐次线性微分方程的一般形式是\begin{equation}\label{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式}
y'' + p y' + q y = f(x),
\end{equation}
其中\(p,q\)是常数.

由\cref{theorem:微分方程.二阶非齐次线性微分方程的通解结构} 可知，求二阶常系数非齐次线性微分方程的通解，归结为求对应的齐次方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的通解和非齐次方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 本身的一个特解.
由于\hyperref[section:微分方程.常系数齐次线性微分方程]{二阶常系数齐次线性微分方程的通解的求法}已经得到解决，所以这里只需讨论求二阶常系数非齐次线性微分方程的一个特解\(y^*\)的方法.

本节只介绍当方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 中的\(f(x)\)取两种常见形式时求\(y^*\)的方法.
这种方法的特点是不用积分就可求出\(y^*\)来，它叫做\cemph{待定系数法}.
\(f(x)\)的两种形式是\begin{enumerate}
\item \(f(x) = e^{\lambda x} P_m(x)\)，其中\(\lambda\)是常数，\(P_m(x)\)是一个\(m\)次多项式：\[
P_m(x) = a_0 x^m + a_1 x^{m-1} + \dotsb + a_{m-1} x + a_m;
\]
\item \(f(x) = e^{\lambda x} [ \varphi_m(x) \cos\omega x + \psi_n(x) \sin \omega x ]\)，其中\(\lambda,\omega\)是常数，\(\varphi_m(x),\psi_n(x)\)分别是\(x\)的\(m\)次、\(n\)次多项式，且至多有一个为零.
\end{enumerate}

\subsubsection{\texorpdfstring{\(f(x) = e^{\lambda x} P_m(x)\)型}{第一类：指数函数与幂级数的乘积}}
我们知道，方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 的特解\(y^*\)是使 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 称为恒等式的函数.
怎样的函数能使 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 称为恒等式呢？
因为 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 右端\(f(x)\)是多项式\(P_m(x)\)与指数函数\(e^{\lambda x}\)的乘积，而多项式与指数函数乘积的导数仍然是多项式与指数函数的乘积，因此，我们推测\(y^* = Q(x) e^{\lambda x}\)（其中\(Q(x)\)是某个多项式）可能是方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 的特解.
把\(y^*, (y^*)', (y^*)''\)代入方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} ，然后考虑能否选取适当的多项式\(Q(x)\)，使得\(y^* = Q(x) e^{\lambda x}\)满足方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} .
为此，将\begin{align*}
y^* &= Q(x) e^{\lambda x}, \\
(y^*)' &= e^{\lambda x} [ \lambda Q(x) + Q'(x) ], \\
(y^*)'' &= e^{\lambda x} [ \lambda^2 Q(x) + 2\lambda Q'(x) + Q''(x) ]
\end{align*}
代入方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 并消去\(e^{\lambda x}\)，得\begin{equation}\label{equation:微分方程.常系数非齐次线性微分方程.中间步骤1}
Q''(x) + (2\lambda+p) Q'(x) + (\lambda^2+p\lambda+q) Q(x) = P_m(x).
\end{equation}
\begin{enumerate}
\item 如果\(\lambda\)不是 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 的特征方程\(r^2+pr+q=0\)的根，即\(\lambda^2+p\lambda+q\neq0\)，由于\(P_m(x)\)是一个\(m\)次多项式，要使 \labelcref{equation:微分方程.常系数非齐次线性微分方程.中间步骤1} 的两端恒等，那么可令\(Q(x)\)为另一个\(m\)次多项式\(Q_m(x) = b_0 x^m + b_1 x^{m-1} + \dotsb + b_{m-1} x + b_m\)，代入 \labelcref{equation:微分方程.常系数非齐次线性微分方程.中间步骤1} ，比较等式两端\(x\)同次幂的系数，就得到以\(b_0,b_1,\dotsc,b_m\)作为未知数的\(m+1\)个方程的联立方程组.
从而可以定出这些\(b_i\ (i=0,1,\dotsc,m)\)，并得到所求的特解\[
y^* = Q_m(x) e^{\lambda x}.
\]

\item 如果\(\lambda\)是特征方程\(r^2+pr+q=0\)的单根，即\(\lambda^2+p\lambda+q=0\)，但\(2\lambda+p\neq0\)，要使 \labelcref{equation:微分方程.常系数非齐次线性微分方程.中间步骤1} 的两端恒等，那么\(Q'(x)\)必须是\(m\)次多项式.
此时可令\[
Q(x) = x Q_m(x),
\]并且可用同样的方法来确定\(Q_m(x)\)的系数\(b_i\ (i=0,1,\dotsc,m)\).

\item 如果\(\lambda\)是特征方程\(r^2+pr+q=0\)的重根，即\(\lambda^2+p\lambda+q=2\lambda+p=0\)，要使 \labelcref{equation:微分方程.常系数非齐次线性微分方程.中间步骤1} 的两端恒等，那么\(Q''(x)\)必须是\(m\)次多项式.
此时可令\[
Q(x) = x^2 Q_m(x),
\]并用同样的方法来确定\(Q_m(x)\)中的系数.
\end{enumerate}

综上所述，我们有如下结论：

如果\(f(x) = P_m(x) e^{\lambda x}\)，则二阶常系数非齐次线性微分方程 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程的一般形式} 具有形如\begin{equation}\label{equation:微分方程.二阶常系数齐次线性微分方程.特解1}
y^* = x^k Q_m(x) e^{\lambda x}
\end{equation}的特解，其中\(Q_m(x)\)是与\(P_m(x)\)同次（\(m\)次）的多项式，而\(k\)按“\(\lambda\)不是特征方程的根”“\(\lambda\)是特征方程的单根”或“\(\lambda\)是特征方程的重根”三种情形依次取为0、1或2.

上述结论可推广到\(n\)阶常系数非齐次线性微分方程，但要注意 \labelcref{equation:微分方程.二阶常系数齐次线性微分方程.特解1} 中的\(k\)是特征方程含根\(\lambda\)的重复次数（即若\(\lambda\)不是特征方程的根，则\(k\)取为0；若\(\lambda\)是特征方程的\(s\)重根，则\(k\)取为\(s\)）.

\begin{example}
求微分方程\(y''-2y'-3y=3x+1\)的一个特解.
\begin{solution}
这是二阶常系数非齐次线性微分方程，且函数\(f\)是\(P_m(x) e^{\lambda x}\)型（其中\(P_m(x) = 3x+1, \lambda=0\).

与所给方程对应的齐次方程为\[
y''-2y'-3y=0,
\]它的特征方程为\[
r^2-2r-3=0.
\]

由于这里\(\lambda=0\)不是特征方程的根，所以应设特解为\[
y^* = b_0 x + b_1.
\]将其代入所给方程，得\[
-3 b_0 x - 2 b_0 - 3 b_1 = 3x+1,
\]比较两端\(x\)同次幂的系数，得\[
-3 b_0 = 3, \qquad -2 b_0 - 3 b_1 = 1,
\]即\(b_0=-1, b_1=1/3\).
于是求得一个特解为\[
y^* = -x + \frac{1}{3}.
\]
\end{solution}
\end{example}

\begin{example}
求微分方程\(y'' - \lambda^2 y = e^{\lambda x} + e^{-\lambda x}\ (\lambda>0)\)的特解.
\begin{solution}
解齐次方程\(y'' - \lambda^2 y = 0\)的特征方程\(r^2 - \lambda^2 = 0\)得\(r = \pm\lambda\).

因为\(\lambda\)是特征方程的单根，那么可以设非齐次方程\(y'' - \lambda^2 y = e^{\lambda x}\)的特解为\[
y^*_1 = x e^{\lambda x} a,
\]其中\(a\)为常数，且满足\(2\lambda a = 1\)即\(a = \frac{1}{2\lambda}\).

同理可设非齐次方程\(y'' - \lambda^2 y = e^{-\lambda x}\)的特解为\[
y^*_2 = x e^{-\lambda x} b,
\]其中\(b\)为常数，且满足\(-2\lambda b = 1\)即\(b = -\frac{1}{2\lambda}\).

综上，由\hyperref[theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理]{叠加原理}，微分方程\(y'' - \lambda^2 y = e^{\lambda x} + e^{-\lambda x}\ (\lambda>0)\)的特解为\[
y^*_1 + y^*_2 = x e^{\lambda x} a + x e^{-\lambda x} b
= x(a e^{\lambda x} + b e^{-\lambda x}).
\]
\end{solution}
\end{example}

\subsubsection{\texorpdfstring{\(f(x) = e^{\lambda x} [ \varphi_m(x) \cos\omega x + \psi_n(x) \sin \omega x ]\)型}{第二类：指数函数与三角函数的乘积}}
应用欧拉公式\[
\cos\theta = \frac{1}{2}(e^{\iu\theta}+e^{-\iu\theta}),
\qquad
\sin\theta = \frac{1}{2\iu}(e^{\iu\theta}-e^{-\iu\theta}),
\]把\(f(x)\)表成复变指数函数的形式，有\begin{align*}
f(x) &= e^{\lambda x} ( \varphi_m \cos \omega x + \psi_n \sin \omega x ) \\
&= e^{\lambda x} \left(
\varphi_m \frac{e^{\iu\omega x}+e^{-\iu\omega x}}{2}
+ \psi_n \frac{e^{\iu\omega x}-e^{-\iu\omega x}}{2\iu}
\right) \\
&= \left(\frac{\varphi_m}{2}+\frac{\psi_n}{2\iu}\right) e^{(\lambda+\iu\omega)x}
+ \left(\frac{\varphi_m}{2}-\frac{\psi_n}{2\iu}\right) e^{(\lambda-\iu\omega)x} \\
&= P e^{(\lambda+\iu\omega)x}
+ \overline{P} e^{(\lambda-\iu\omega)x},
\end{align*}
其中\[
P = P(x) = \frac{\varphi_m}{2} - \frac{\psi_n}{2}\iu,
\qquad
\overline{P} = \overline{P}(x) = \frac{\varphi_m}{2}+\frac{\psi_n}{2}\iu
\]是互成共轭\footnote{如果说两个\(n\)次多项式\(\alpha_n(x) = a_0 x^n + a_1 x^{n-1} + \dotsb + a_n\)与\(\beta_n(x) = b_0 x^n + b_1 x^{n-1} + \dotsb + b_n\)\textbf{互成共轭}，那么它们的对应项系数是共轭复数，即\(a_i = \overline{b_i}\ (i=0,1,\dotsc,n)\).}的\(N = \max\{m,n\}\)次多项式.

应用上一目的结果，对于\(f(x)\)中的第一项\(P e^{(\lambda+\iu\omega)x}\)，可求出一个\(N\)次多项式\(Q = Q_N(x)\)，使得\(y_1^* = x^k Q e^{(\lambda+\iu\omega)x}\)为方程\[
y'' + p y' + q y = P e^{(\lambda+\iu\omega)x}
\]的特解，其中\(k\)按“\(\lambda+\iu\omega\)不是特征方程的根”或“\(\lambda+\iu\omega\)是特征方程的单根”依次取0或1.
由于\(f(x)\)的第二项\(\overline{P} e^{(\lambda-\iu\omega)x}\)与第一项\(P e^{(\lambda+\iu\omega)x}\)成共轭，所以与\(y_1^*\)成共轭的函数\(y_2^* = x^k \overline{Q} e^{(\lambda-\iu\omega)x}\)必然是方程\[
y'' + p y' + q y = \overline{P}(x) e^{(\lambda-\iu\omega)x}
\]的特解，这里\(\overline{Q}\)表示与\(Q\)成共轭的\(N\)次多项式.

于是，根据\cref{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理} ，方程 \labelcref{equation:微分方程.二阶常系数非齐次线性微分方程的一般形式} 具有形如\[
y^* = x^k Q e^{(\lambda+\iu\omega)x} + x^k \overline{Q} e^{(\lambda-\iu\omega)x}
\]的特解.
因为\(Q e^{(\lambda+\iu\omega)x}\)与\(\overline{Q} e^{(\lambda-\iu\omega)x}\)共轭，所以上式可写为实函数的形式：\begin{equation}\label{equation:微分方程.二阶常系数齐次线性微分方程.特解2}
y^* = x^k e^{\lambda x} (\Phi \cos\omega x + \Psi \sin\omega x),
\end{equation}其中\(\Phi,\Psi\)都是\(N\)次多项式.

\subsection{欧拉方程}
变系数的线性微分方程一般来说都是不容易求解的.
但是有些特殊的变系数线性微分方程则可以通过变量代换化为常系数线性微分方程，因而容易求解，欧拉方程就是其中的一种.

形如\begin{equation}\label{equation:微分方程.欧拉方程的一般形式}
x^n y^{(n)} + p_1 x^{n-1} y^{(n-1)} + \dotsb + p_{n-1} x y' + p_n y = f(x)
\end{equation}的方程（其中\(p_1,p_2,\dotsc,p_n\)为常数），叫做\DefineConcept{欧拉方程}.

作变换\[
x = e^t \quad\text{或}\quad t = \ln x,
\]将自变量\(x\)换成\(t\)\footnote{这里仅在\(x>0\)范围内求解.%
如果要在\(x<0\)内求解，则可作变换\(x=-e^t\)或\(t=\ln(-x)\)，所得结果与\(x>0\)内的结果相类似.}，%
我们有\begin{align*}
\dv{y}{x} &= \dv{y}{t} \cdot \dv{t}{x} = \frac{1}{x} \dv{y}{t}, \\
\dv[2]{y}{x} &= \frac{1}{x^2} \left( \dv[2]{y}{t} - \dv{y}{t} \right), \\
\dv[3]{y}{x} &= \frac{1}{x^3} \left( \dv[3]{y}{t} - 3 \dv[2]{y}{t} + 2 \dv{y}{t} \right).
\end{align*}

如果采用记号\(D\)表示对\(t\)求导的运算\(\dv{t}\)，那么上述计算结果可以写成\begin{align*}
x y' &= Dy, \\
x^2 y'' &= \dv[2]{y}{t} - \dv{y}{t}
	= \left(\dv[2]{t} - \dv{t}\right)y \\
	&= (D^2 - D)y = D(D-1)y, \\
x^3 y''' &= \dv[3]{y}{t} - 3 \dv[2]{y}{t} + 2 \dv{y}{t} \\
	&= (D^3-3D^2+2D)y = D(D-1)(D-2)y.
\end{align*}
一般地，有\(x^k y^{(k)} = D(D-1)\dotsm(D-k+1)y\).

把它代入欧拉方程 \labelcref{equation:微分方程.欧拉方程的一般形式} ，便得一个以\(t\)为自变量的常系数线性微分方程.
在求出这个方程的解后，把\(t\)换成\(\ln x\)，即得原方程的解.

\section{常系数线性微分方程组的解法}
前面讨论的是由一个微分方程求解一个未知函数的情形.
但在研究某些实际问题时，还会遇到由几个微分方程联立起来共同确定几个具有同一自变量的函数的情形.
这些联立的微分方程称为\DefineConcept{微分方程组}.

如果微分方程组中的每一个微分方程都是常系数线性微分方程，那么这种微分方程组就叫做\DefineConcept{常系数线性微分方程组}.

对于常系数线性微分方程组，我们可以用下述方法求它的解：\begin{enumerate}
\item[第一步] 从方程组中消去一些未知函数及其各阶导数，得到只含有一个未知函数的高阶常系数线性微分方程.
\item[第二步] 解此高阶微分方程，求出满足该方程的未知函数.
\item[第三步] 把已求得的函数代入原方程组，一般说来，不必经过积分就可求出其余的未知函数.
\end{enumerate}
