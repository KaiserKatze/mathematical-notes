\section{施托尔茨定理}
\begin{theorem}[施托尔茨定理I]\label{theorem:极限.施托尔茨定理1}
%@see: 《数学分析（第二版 上册）》（陈纪修） P49 定理2.3.3
设数列\(\{x_n\},\{y_n\}\).
若\(\{y_n\}\)是严格单调增加的正无穷大，
且\begin{equation*}
	\lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n}
	= C
	\in[-\infty,+\infty],
\end{equation*}
那么有\begin{equation*}
	\lim_{n\to\infty} \frac{x_n}{y_n}
	= C.
\end{equation*}
%TODO proof
% \begin{proof}
% 设\(\lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n} = C\in(-\infty,+\infty)\)，
% 故对\(\forall\epsilon>0\)，\(\exists N>0\)，当\(n > N\)时，有\begin{equation*}
% \abs{\frac{x_{n+1}-x_n}{y_{n+1}-y_n} - C} < \epsilon
% \end{equation*}成立，即\begin{equation*}
% C - \epsilon < \frac{x_{n+1}-x_n}{y_{n+1}-y_n} < C + \epsilon;
% \end{equation*}
% 由于\begin{equation*}
% \frac{
% (x_{N+1}-x_N)
% + (x_{N+2}-x_{N+1})
% + \dotsb
% + (x_{n+1}-x_n)
% }{
% (y_{N+1}-y_N)
% + (y_{N+2}-y_{N+1})
% + \dotsb
% + (y_{n+1}-y_n)
% }
% = \frac{x_{n+1}-x_N}{y_{n+1}-y_N},
% \end{equation*}再根据\cref{example:不等式.不同浓度的溶液的混合}，于是有\begin{equation*}
% C - \epsilon <
% \frac{x_{n+1}-x_N}{y_{n+1}-y_N}
% < C + \epsilon;
% \end{equation*}进而有\begin{equation*}
% \lim_{n\to\infty} \frac{x_{n+1}-x_N}{y_{n+1}-y_N}
% = \lim_{n\to\infty} \frac{\frac{x_{n+1}}{y_{n+1}}-\frac{x_N}{y_{n+1}}}{1-\frac{y_N}{y_{n+1}}}
% = C;
% \end{equation*}又因为\(\lim_{n\to\infty} y_n = +\infty\)，
% 注意到\(x_N\)、\(y_N\)是不随\(n\)变化的常数，
% 于是有\(\lim_{n\to\infty} \frac{x_N}{y_{n+1}}
% = \lim_{n\to\infty} \frac{y_N}{y_{n+1}}
% = 0\)，从而有\(\lim_{n\to\infty} \frac{x_{n+1}}{y_{n+1}} = C\).
% \end{proof}
\end{theorem}

\begin{theorem}[施托尔茨定理II]\label{theorem:极限.施托尔茨定理2}
设数列\(\{x_n\},\{y_n\}\).
若\(\{x_n\}\)是无穷小，
\(\{y_n\}\)是严格单调减少的无穷小，且\begin{equation*}
	\lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n}
	= C
	\in[-\infty,+\infty],
\end{equation*}
那么有\begin{equation*}
	\lim_{n\to\infty} \frac{x_n}{y_n}
	= C.
\end{equation*}
%TODO proof
\end{theorem}

\begin{remark}
% 在以后我们会觉察到，施托尔茨定理实际上是离散形式的洛必达法则.
可以证明：如果把上述定理中的极限值\(C\)改为不定号无穷大，则结论不成立.
\end{remark}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P50
利用施托尔茨定理重新证明\cref{example:极限.数列的算术平均的极限}.
\begin{proof}
令\(x_n=a_1+a_2+\dotsb+a_n,y_n=n\)，
由\cref{theorem:极限.施托尔茨定理1} 有\begin{equation*}
	\lim_{n\to\infty} \frac{x_n}{y_n}
	= \lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n}
	= \lim_{n\to\infty} \frac{a_{n+1}}{1}
	= a.
	\qedhere
\end{equation*}
\end{proof}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P50 例2.3.4
设\(p>-1\).
证明：\begin{equation}\label{equation:数列极限.重要极限X}
	\lim_{n\to\infty} \frac{1^p+2^p+\dotsb+n^p}{n^{p+1}}
	= \frac{1}{p+1}.
\end{equation}
\begin{proof}
令\(x_n=1^p+2^p+\dotsb+n^p,
y_n=n^{p+1}\)，
由\cref{theorem:极限.施托尔茨定理1} 有\begin{align*}
	\lim_{n\to\infty} \frac{x_n}{y_n}
	&= \lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n}
	= \lim_{n\to\infty} \frac{(n+1)^p}{(n+1)^{p+1} - n^{p+1}} \\
	&= \lim_{n\to\infty} \frac{n^p + p n^{p-1} + \dotsb + 1}
		{(p+1) n^p + \frac{1}{2} (p+1) p n^{p-1} + \dotsb + 1} \\
	&= \frac{1}{p+1}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P50 例2.3.5
设\(\lim_{n\to\infty} a_n = a\)，
求极限\(\lim_{n\to\infty} \frac{a_1+2a_2+\dotsb+na_n}{n^2}\).
\begin{solution}
令\(x_n=a_1+2a_2+\dotsb+na_n,
y_n=n^2\)，
由\cref{theorem:极限.施托尔茨定理1} 有\begin{equation*}
	\lim_{n\to\infty} \frac{x_n}{y_n}
	= \lim_{n\to\infty} \frac{x_{n+1}-x_n}{y_{n+1}-y_n}
	= \lim_{n\to\infty} \frac{(n+1)a_{n+1}}{(n+1)^2-n^2}
	= \lim_{n\to\infty} \frac{(n+1)a_{n+1}}{2n+1}
	= \frac12 a.
\end{equation*}
\end{solution}
\end{example}
