\section{可分离变量的微分方程}
我们首先讨论一阶微分方程\begin{equation}\label[first-order-ordinary-differential-equation]{equation:微分方程.一阶微分方程的一般形式}
%@see: 《高等数学（第六版 上册）》 P299 (1)
	y' = f(x,y)
\end{equation}的一些解法.

\cref{equation:微分方程.一阶微分方程的一般形式} 有时也写成如下的
对称形式\begin{equation}\label[differential-equation]{equation:微分方程.一阶微分方程的对称形式}
%@see: 《高等数学（第六版 上册）》 P299 (2)
	P(x,y) \dd{x} + Q(x,y) \dd{y} = 0.
\end{equation}
在\cref{equation:微分方程.一阶微分方程的对称形式} 中，
变量\(x\)与\(y\)对称，
它既可看作是以\(x\)为自变量、\(y\)为因变量的方程\begin{equation*}
	\dv{y}{x} = -\frac{P(x,y)}{Q(x,y)},
	\quad Q(x,y)\neq0,
\end{equation*}
也可看作是以\(y\)为自变量、\(x\)为因变量的方程\begin{equation*}
	\dv{x}{y} = -\frac{Q(x,y)}{P(x,y)},
	\quad P(x,y)\neq0.
\end{equation*}

对于有的一阶微分方程（例如\(\dv{y}{x} = 2x\)）可以直接在两端积分得到它的通解.
但是并不是所有的一阶微分方程都能这样求解，
例如，对于一阶微分方程\begin{equation*}
%@see: 《高等数学（第六版 上册）》 P299 (3)
	\dv{y}{x} = 2xy^2
\end{equation*}就不能这样做，
这是因为这个方程的右端含有与\(x\)存在函数关系的变量\(y\)，
积分\(\int 2xy^2 \dd{x}\)求不出来.
但如果将这个方程变形为\(\frac{\dd{y}}{y^2}=2x\dd{x}\)，
使得变量\(x\)与\(y\)分离在等式的两端，
再两端积分即得\begin{equation*}
%@see: 《高等数学（第六版 上册）》 P299 (4)
	-\frac{1}{y} = x^2+C
	\quad\text{或}\quad
	y = -\frac{1}{x^2+C},
\end{equation*}
其中\(C\)是任意常数.
可以验证上述函数确实满足原来的一阶微分方程\(\dv{y}{x} = 2xy^2\)，
且含有一个任意常数，所以它是原方程的通解.

\begin{definition}
如果\cref{equation:微分方程.一阶微分方程的一般形式}
能化成\begin{equation}\label[first-order-ordinary-differential-equation]{equation:微分方程.一阶微分方程的分离变量形式}
%@see: 《高等数学（第六版 上册）》 P300 (5)
	g(y) \dd{y} = f(x) \dd{x}
\end{equation}的形式，
那么称“\cref{equation:微分方程.一阶微分方程的一般形式}
是一个\DefineConcept{可分离变量的微分方程}”.
\end{definition}

假定\cref{equation:微分方程.一阶微分方程的分离变量形式} 中的函数\(g(y)\)和\(f(x)\)是连续的.
设\(y=\phi(x)\)是\cref{equation:微分方程.一阶微分方程的分离变量形式} 的解，
将它代入\cref{equation:微分方程.一阶微分方程的分离变量形式} 中得到恒等式\begin{equation*}
	g[\phi(x)] \phi'(x) \dd{x} = f(x) \dd{x}.
\end{equation*}
将上式两端积分，并由\(y=\phi(x)\)引进变量\(y\)，得\begin{equation*}
	\int g(y) \dd{y} = \int f(x) \dd{x}.
\end{equation*}
设\(G(y)\)及\(F(x)\)依次为\(g(y)\)及\(f(x)\)的原函数，
于是有\begin{equation}\label{equation:微分方程.一阶微分方程的分离变量形式.隐式解}
%@see: 《高等数学（第六版 上册）》 P300 (6)
	G(y) = F(x) + C.
\end{equation}
因此\cref{equation:微分方程.一阶微分方程的分离变量形式} 的解
满足\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} .
反之，如果\(y = \Phi(x)\)是
由\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} 所确定的隐函数，
那么在\(g(y)\neq0\)的条件下，
\(y=\Phi(x)\)也是\cref{equation:微分方程.一阶微分方程的分离变量形式} 的解，
事实上，由\hyperref[theorem:多元函数微分法.隐函数存在定理1]{隐函数的求导法}可知，
当\(g(y)\neq0\)时，\begin{equation*}
	\Phi'(x) = \frac{F'(x)}{G'(y)} = \frac{f(x)}{g(y)},
\end{equation*}
这就表示函数\(y = \Phi(x)\)满足\cref{equation:微分方程.一阶微分方程的分离变量形式}.
所以，如果已分离变量的\cref{equation:微分方程.一阶微分方程的分离变量形式} 中，
\(g(y)\)和\(f(x)\)是连续的，且\(g(y)\neq0\)，
那么\cref{equation:微分方程.一阶微分方程的分离变量形式}
两端积分后得到的\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} ，
就用隐式给出了\cref{equation:微分方程.一阶微分方程的分离变量形式} 的解，
\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} 就叫做
“\cref{equation:微分方程.一阶微分方程的分离变量形式} 的\DefineConcept{隐式解}”.
又由于\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} 中含有任意常数，
因此\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} 所确定的隐函数
是\cref{equation:微分方程.一阶微分方程的分离变量形式} 的通解，
所以\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解} 叫做
“\cref{equation:微分方程.一阶微分方程的分离变量形式} 的\DefineConcept{隐式通解}”.
当\(f(x)\neq0\)时，\cref{equation:微分方程.一阶微分方程的分离变量形式.隐式解}
所确定的隐函数\(x=\Psi(y)\)也可认为是\cref{equation:微分方程.一阶微分方程的分离变量形式} 的解.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P301 例2
放射性元素铀由于不断地有原子放射出微粒子而变成其他元素，铀的含量就不断减少，这种现象叫衰变.
由原子物理学知道，铀的衰变速度与当时未衰变的铀原子的含量\(M\)成正比.
已知\(t=0\)时，铀的含量为\(M_0\)，求在衰变过程中铀含量\(M(t)\)随时间\(t\)变化的规律.
\begin{solution}
铀的衰变速度就是\(M(t)\)对时间\(t\)的导数\(\dv{M}{t}\).
由于铀的衰变速度与其含量成正比，故得微分方程\begin{equation*}
%@see: 《高等数学（第六版 上册）》 P301 (8)
	\dv{M}{t} = -\lambda M,
\end{equation*}
其中\(\lambda > 0\)是常数，叫做衰变系数，
\(\lambda\)前置负号是由于当\(t\)增加时\(M\)单调减少，
即\(\dv{M}{t} < 0\)的缘故.对这个微分方程分离变量，得\begin{equation*}
	\frac{\dd{M}}{M} = -\lambda \dd{t}.
\end{equation*}两端积分\begin{equation*}
	\int \frac{\dd{M}}{M} = -\lambda \int \dd{t},
\end{equation*}
以\(\ln C\)表示任意常数，考虑到\(M>0\)，得\begin{equation*}
	\ln M = -\lambda t + \ln C,
\end{equation*}
即\begin{equation*}
	M = C e^{-\lambda t}.
\end{equation*}
这就是原方程的通解.将初始条件\begin{equation*}
	\eval{M}_{t=0} = M_0
\end{equation*}
代入上式，得\begin{equation*}
	M_0 = C e^0 = C,
\end{equation*}
所以\(M = M_0 e^{-\lambda t}\).
这就是所求铀的衰变规律 --- 铀的含量随时间的增加而按指数规律衰减.
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P315 习题7-4 6.
验证形如\begin{equation*}
	y f(xy) \dd{x} + x g(xy) \dd{y} = 0
\end{equation*}的微分方程，
可经变量代换\(v = xy\)化为可分离变量的方程，并求出其通解.
\begin{solution}
令\(v = xy\)，则\(y = v/x\)，
\(\dd{y} = \frac{x \dd{v} - v \dd{x}}{x^2}\)，
上述微分方程化为\begin{equation*}
	\frac{v}{x} f(v) \dd{x} + x g(v) \frac{x \dd{v} - v \dd{x}}{x^2} = 0,
\end{equation*}
整理得\begin{equation*}
	\frac{\dd{x}}{x}
	= \frac{g(v) \dd{v}}{v (g(v) - f(v))}.
\end{equation*}
积分得\begin{equation*}
	\ln\abs{x}
	= \int \frac{g(v)}{v (g(v) - f(v))} \dd{v} + C_1,
\end{equation*}
即\begin{equation*}
	x = C \exp\int \frac{g(v)}{v (g(v) - f(v))} \dd{v}.
\end{equation*}
最后代回\(v = xy\)即可.
\end{solution}
\end{example}

\begin{example}
%@see: 《2024年全国硕士研究生入学统一考试（数学一）》二填空题/第14题
求微分方程\(y'=\frac1{(x+y)^2}\)满足条件\(y(1)=0\)的解.
\begin{solution}
令\(x+y=u\)，
对\(x\)求导得\(u'=1+y'\)，
代入原方程并整理得\(\dv{u}{x}=\frac{1+u^2}{u^2}\)，
分离变量得\begin{equation*}
	\left( 1-\frac1{1+u^2} \right) \dd{u}
	= \dd{x},
\end{equation*}
积分得\(u-\arctan u=x+C\ (\text{$C$是常数})\)，
用\(x+y\)代\(u\)得\(y-\arctan(x+y)=C\).
代入初始条件可得\(C=-\frac\pi4\)，
于是原方程的解为\(x=\tan\left(y+\frac\pi4\right)-y\).
\end{solution}
\end{example}

\section{齐次方程}
有的一阶线性齐次微分方程可以化成\begin{equation}\label[differential-equation]{equation:微分方程.一阶齐次方程}
%@see: 《高等数学（第六版 上册）》 P305 (1)
	\dv{y}{x}=\phi\left(\frac{y}{x}\right)
\end{equation}的形式.

在解这类方程的时候，我们可以使用换元法，
在方程中引入新的未知函数\begin{equation}\label[differential-equation]{equation:微分方程.一阶齐次方程.中间步骤1}
%@see: 《高等数学（第六版 上册）》 P305 (2)
	u=\frac{y}{x},
\end{equation}
就可以将其化为可分离变量的方程.
这是因为由\cref{equation:微分方程.一阶齐次方程.中间步骤1} 有\begin{equation*}
	y = ux,
	\qquad
	\dv{y}{x} = u + x \dv{u}{x},
\end{equation*}
代入\cref{equation:微分方程.一阶齐次方程}，便得方程\begin{equation*}
	u + x \dv{u}{x} = \phi(u),
\end{equation*}
即\begin{equation*}
	x \dv{u}{x} = \phi(u) - u.
\end{equation*}
分离变量，得\begin{equation*}
	\frac{\dd{u}}{\phi(u) - u} = \frac{\dd{x}}{x}.
\end{equation*}
对两端积分，得\begin{equation*}
	\int \frac{\dd{u}}{\phi(u) - u} = \int \frac{\dd{x}}{x}.
\end{equation*}
求出积分后，再以\(\frac{y}{x}\)代替\(u\)，便得齐次方程的通解.

\begin{example}
解方程\begin{equation*}y^2+x^2 \dv{y}{x} = xy \dv{y}{x}.\end{equation*}
\begin{solution}
原方程可写成\begin{equation*}
	\dv{y}{x} = \frac{y^2}{xy-x^2} = \frac{(y/x)^2}{y/x-1},
\end{equation*}
因此原方程是齐次方程.
令\(u=y/x\)，
则\begin{equation*}
	y=ux, \qquad \dv{y}{x} = u + x \dv{u}{x},
\end{equation*}
于是原方程变为\begin{equation*}
	u+x \dv{u}{x} = \frac{u^2}{u-1},
\end{equation*}
即\begin{equation*}
	x \dv{u}{x} = \frac{u}{u-1}.
\end{equation*}
分离变量，得\begin{equation*}
	\left(1-\frac{1}{u}\right) \dd{u} = \frac{\dd{x}}{x}.
\end{equation*}
两端积分，得\begin{equation*}
	u - \ln\abs{u} + C = \ln\abs{x},
\end{equation*}或\begin{equation*}
	\ln\abs{xu} = u + C.
\end{equation*}
以\(y/x\)代上式中的\(u\)，
便得方程的通解为\begin{equation*}
	\ln\abs{y} = \frac{y}{x} + C.
\end{equation*}
\end{solution}
\end{example}

\begin{example}
设曲线\(y = y(x)\ (x>0)\)经过点\((1,2)\)，
该曲线上任一点\(P(x,y)\)到\(y\)轴的距离等于该点处的切线在\(y\)轴上的截距.
求曲线方程\(y(x)\).
\begin{solution}
设\((x,y)\)处的切线方程为\(Y-y=y'(X-x)\)，
令\(X=0\)得\(Y=y-y'x\)，
这就是切线在\(y\)轴上的截距，
因此得到微分方程\(x = y-y'x\).
整理得\(\frac{y}{x}-1=y'\)，
可见这是一个齐次方程，
解得\(y=x(C-\ln x)\ (x>0)\).
代入\(y(1)=2\)，
得\(C=2\)，
于是曲线方程为\(y=x(2-\ln x)\).
\end{solution}
\end{example}

\begin{example}
探照灯的聚光镜的镜面是一张旋转曲面，
它的形状由\(xOy\)坐标面上的一条曲线\(L\)绕\(x\)轴旋转而成.
按照工程师对聚光镜性能的要求，从点\(O\)处发出的一切光线，经它反射后都与旋转轴平行.
求曲线\(L\)的方程.
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			xmin=-3.5,xmax=5,
			ymin=0,ymax=5,
			axis equal=true,
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			xtick=\empty,
			ytick=\empty,
		]
			\pgfmathsetmacro{\pMx}{1}
			\pgfmathsetmacro{\pMy}{sqrt(4*(\pMx+1))}
			\pgfmathsetmacro{\pSx}{\pMx+3}
			\pgfmathsetmacro{\dvM}{2*\pMx/sqrt(4*(\pMx+1))}
			\pgfmathsetmacro{\pTx}{4}
			\pgfmathsetmacro{\pTy}{\pMy+\dvM*(\pTx-\pMx)}
			\pgfmathsetmacro{\pAx}{\pMx-\pMy/\dvM}
			\pgfmathsetmacro{\pNx}{\dvM*\pMy+\pMx}
			\draw[red](0,0)node[black,below left]{$O$}coordinate(O)
				--(\pMx,\pMy)node[black,above left]{$M$}coordinate(M)
				--(\pSx,\pMy)coordinate(S)node[black,below]{$S$};
			\draw(4,4)node{$L$};
			\begin{scope}[color=black!30]
				\draw(M)--(\pTx,\pTy)coordinate(T)node[black,above right]{$T$};
				\draw(M)--(\pAx,0)coordinate(A)node[black,below]{$A$};
				\draw(M)--(M|-O)coordinate(P)node[black,below]{$P$};
				\draw(M)--(\pNx,0)coordinate(N)node[black,below]{$N$};
			\end{scope}
			\begin{scope}[angle eccentricity=2,angle radius=.4cm]
				\draw pic["$\alpha$",draw=orange,-]{angle=P--A--M};
				\draw pic["$\alpha$",draw=orange,-]{angle=S--M--T};
				\draw pic["$\alpha$",draw=orange,-]{angle=A--M--O};
				\draw pic[draw=brown,angle radius=.2cm]{right angle=N--P--M};
				\draw pic[draw=brown,angle radius=.2cm]{right angle=N--M--T};
			\end{scope}
			\begin{scope}[color=blue,smooth]
				\addplot[domain=-1:0,samples=100]{sqrt(4*(x+1))};
				\addplot[domain=0:10,samples=50]{sqrt(4*(x+1))};
			\end{scope}
		\end{axis}
	\end{tikzpicture}
	\caption{}
	\label{figure:微分方程.齐次方程.例图1}
\end{figure}
\begin{solution}
如\cref{figure:微分方程.齐次方程.例图1}，建立平面直角坐标系.
根据对称性，我们只考虑曲线方程中\(y\geq0\)的部分.
设点\(M(x,y)\)是\(L\)上任意一点，
点\(O\)发出的某条光线经点\(M\)反射后是一条与\(x\)轴平行的直线\(MS\).
又设过点\(M\)的切线\(AT\)与\(x\)轴的夹角为\(\alpha\).
根据题意有，\(\angle SMT = \alpha\).
另一方面，\(\angle OMA\)是入射角的余角，\(\angle SMT\)是反射角的余角，
于是由光学中的反射定律有\(\angle OMA = \angle SMT = \alpha\)；
从而\(AO = OM\)，但\(AO = AP - OP = PM \cot\alpha - OP = \frac{y}{y'} - x\)，
而\(OM = \sqrt{x^2+y^2}\).
于是得微分方程\begin{equation*}
	\frac{y}{y'} - x = \sqrt{x^2+y^2}.
\end{equation*}
当\(y>0\)时，上式即为\begin{equation*}
	\dv{x}{y} = \frac{x}{y} + \sqrt{\left(\frac{x}{y}\right)^2 + 1},
\end{equation*}
这是齐次方程.
令\(v = \frac{x}{y}\)，
则\(x = yv\)，\(\dv{x}{y} = v + y \dv{v}{y}\)，
代入上式，得\begin{equation*}
	v + y \dv{v}{y} = v + \sqrt{v^2 + 1},
\end{equation*}
即\begin{equation*}
	y \dv{v}{y} = \sqrt{v^2 + 1}.
\end{equation*}
分离变量，得\begin{equation*}
	\frac{\dd{v}}{\sqrt{v^2+1}}
	= \frac{\dd{y}}{y}.
\end{equation*}
积分，得\begin{equation*}
	\ln(v+\sqrt{v^2+1}) = \ln y - \ln C,
\end{equation*}
或\begin{equation*}
	v + \sqrt{v^2+1} = \frac{y}{C}.
\end{equation*}

由\begin{equation*}
\left(\frac{y}{C} - v\right)^2 = v^2 + 1,
\end{equation*}得\begin{equation*}
	\frac{y^2}{C^2} - \frac{2yv}{C} = 1,
\end{equation*}
以\(yv=x\)代入上式，得\begin{equation*}
	y^2 = 2C(x+\frac{C}{2}).
\end{equation*}
可以看出，这是以\(x\)轴为对称轴、焦点在原点的抛物线.
\end{solution}
\end{example}

\section{可化为齐次的微分方程}
方程\begin{equation}\label[differential-equation]{equation:微分方程.可化为齐次的方程}
%@see: 《高等数学（第六版 上册）》 P307 (3)
	\dv{y}{x} = \frac{ax + by + c}{a_1 x + b_1 y + c_1}
\end{equation}
当\(c=c_1=0\)时是齐次的，否则不是齐次的.
在非齐次的情形下，可用下列代换把它化为齐次方程：
先令\(x = X + h\)，\(y = Y + k\)，
其中\(h\)和\(k\)是待定的常数.
于是\(\dd{x}=\dd{X}\)，\(\dd{y}=\dd{Y}\)，
而原方程化为\begin{equation*}
	\dv{Y}{X} = \frac{aX+bY+(ah+bk+c)}{a_1 X+b_1 Y+(a_1 h+b_1 k+c_1)}.
\end{equation*}

根据\hyperref[theorem:线性方程组.克拉默法则]{克拉默法则}，
如果关于\(h,k\)的代数方程组\begin{equation}\label{equation:微分方程.可化为齐次的方程.待定系数的代数方程}
	\left\{ \begin{array}{l}
		ah+bk+c = 0, \\
		a_1 h+b_1 k+c_1 = 0
	\end{array} \right.
\end{equation}的系数行列式\(\begin{vmatrix}
	a & b \\
	a_1 & b_1
\end{vmatrix} \neq 0\)，
那么可以解出唯一的\(h\)及\(k\)，
即\begin{equation*}
	h = -\frac{\begin{vmatrix}
		c & b \\
		c_1 & b_1
	\end{vmatrix}}{\begin{vmatrix}
		a & b \\
		a_1 & b_1
	\end{vmatrix}},
	\qquad
	k = -\frac{\begin{vmatrix}
		a & c \\
		a_1 & c_1
	\end{vmatrix}}{\begin{vmatrix}
		a & b \\
		a_1 & b_1
	\end{vmatrix}},
\end{equation*}
从而将\cref{equation:微分方程.可化为齐次的方程}
化为齐次方程\begin{equation}\label{equation:微分方程.可化为齐次的方程.换元得到的齐次方程1}
	\dv{Y}{X} = \frac{aX+bY}{a_1 X+b_1 Y}.
\end{equation}
求出齐次方程 \labelcref{equation:微分方程.可化为齐次的方程.换元得到的齐次方程1} 的通解后，
在通解中以\(x-h\)代\(X\)，\(y-k\)代\(Y\)，
便得\cref{equation:微分方程.可化为齐次的方程} 的通解.

如果代数方程组 \labelcref{equation:微分方程.可化为齐次的方程.待定系数的代数方程} 的
系数行列式\(\begin{vmatrix} a & b \\ a_1 & b_1 \end{vmatrix} = 0\)，
那么上述方法不能应用，不过可以令\footnote{这里假设\(a,b \neq 0\).}\begin{equation*}
	\frac{a_1}{a} = \frac{b_1}{b} = \lambda,
\end{equation*}
从而将\cref{equation:微分方程.可化为齐次的方程}
化为\begin{equation}\label{equation:微分方程.可化为齐次的方程.换元得到的齐次方程2}
	\dv{y}{x} = \frac{(ax+by)+c}{\lambda(ax+by)+c_1}.
\end{equation}
引入新变量\(v=ax+by\)，则\begin{equation*}
	\dv{v}{x} = a + b \dv{y}{x}
	\quad\text{或}\quad
	\dv{y}{x} = \frac{1}{b} \left(\dv{v}{x} - a\right).
\end{equation*}
于是\cref{equation:微分方程.可化为齐次的方程} 成为可分离变量的微分方程\begin{equation*}
	\frac{1}{b} \left(\dv{v}{x} - a\right)
	= \frac{v + c}{\lambda v + c_1}.
\end{equation*}

上述解法可以应用于更一般的微分方程\begin{equation}
	\dv{y}{x} = f\left(\frac{ax+by+c}{a_1 x+b_1 y+c_1}\right).
\end{equation}

对形如\begin{equation}
	\dv{y}{x} = x f\left(\frac{y}{x^2}\right)
\end{equation}的微分方程，
可令\(u = y/x^2\).

对形如\begin{equation}
	\dv{y}{x} = \frac{1}{x^2} f(xy)
	\quad\text{或}\quad
	\dv{y}{x} = \frac{y}{x} f(xy)
\end{equation}的微分方程，
可令\(u = xy\).

对形如\begin{equation}
	\dv{y}{x} = f(ax+by+c)
\end{equation}的微分方程，
可令\(u = ax+by+c\).

\section{一阶线性微分方程}\label{section:微分方程.一阶线性微分方程}
对于一阶线性非齐次微分方程\begin{equation}\label[first-order-linear-nonhomogeneous-ordinary-differential-equation]{equation:微分方程.一阶线性非齐次微分方程}
%@see: 《高等数学（第六版 上册）》 P310 (1)
	\dv{y}{x} + P(x) y = Q(x),
	\quad Q(x) \not\equiv 0,
\end{equation}
我们有如下的解法.

首先，我们把\(Q(x)\)换成零，
写出方程\begin{equation}\label[first-order-linear-homogeneous-ordinary-differential-equation]{equation:微分方程.一阶线性齐次微分方程}
%@see: 《高等数学（第六版 上册）》 P310 (2)
	\dv{y}{x} + P(x) y = 0.
\end{equation}
\cref{equation:微分方程.一阶线性齐次微分方程}
叫做“对应于\cref{equation:微分方程.一阶线性非齐次微分方程} 的线性齐次方程”.

\cref{equation:微分方程.一阶线性齐次微分方程} 是可分离变量的，分离变量后得\begin{equation*}
	\frac{\dd{y}}{y} = -P(x) \dd{x},
\end{equation*}
两端积分，得\begin{equation*}
	\ln{\abs{y}} = -\int P(x) \dd{x} + C_1,
\end{equation*}
或\begin{equation*}
	y = C e^{ -\int P(x) \dd{x} }
	\quad(C = \pm e^{C_1}),
\end{equation*}
这是\cref{equation:微分方程.一阶线性齐次微分方程} 的通解
\footnote{
	这里记号\(\int P(x) \dd{x}\)表示\(P(x)\)的某个确定的原函数.
}.

现在我们使用所谓“常数变易法”来求\cref{equation:微分方程.一阶线性非齐次微分方程} 的通解.
这方法是把\cref{equation:微分方程.一阶线性齐次微分方程} 的通解中的\(C\)换成\(x\)的未知函数\(u(x)\)，
即作变换\begin{equation}\label{equation:微分方程.一阶线性非齐次微分方程.中间步骤1}
%@see: 《高等数学（第六版 上册）》 P310 (3)
	y = u e^{ -\int P(x)\dd{x} },
\end{equation}
于是\begin{equation}\label{equation:微分方程.一阶线性非齐次微分方程.中间步骤2}
%@see: 《高等数学（第六版 上册）》 P311 (4)
	\dv{y}{x} = \dv{u}{x} e^{ -\int P(x) \dd{x} } - u P(x) e^{ -\int P(x) \dd{x} }.
\end{equation}
将\cref{equation:微分方程.一阶线性非齐次微分方程.中间步骤1}
和\cref{equation:微分方程.一阶线性非齐次微分方程.中间步骤2}
代入\cref{equation:微分方程.一阶线性非齐次微分方程}
得\begin{equation*}
	\dv{u}{x} e^{ -\int P(x) \dd{x} }
	- u P(x) e^{ -\int P(x) \dd{x} }
	+ P(x) u e^{ -\int P(x) \dd{x} }
	= Q(x),
\end{equation*}
即\begin{equation*}
	\dv{u}{x} e^{ -\int P(x) \dd{x} } = Q(x),
	\qquad
	\dv{u}{x} = Q(x) e^{ \int P(x) \dd{x} }.
\end{equation*}
两端积分，得\begin{equation*}
	u = \int Q(x) e^{ \int P(x) \dd{x} } \dd{x} + C.
\end{equation*}
将上式代入\cref{equation:微分方程.一阶线性非齐次微分方程.中间步骤1}，
便得\cref{equation:微分方程.一阶线性非齐次微分方程} 的通解\begin{equation}\label{equation:微分方程.一阶线性非齐次微分方程的通解}
	y = e^{ -\int P(x) \dd{x} } \left( \int Q(x) e^{ \int P(x) \dd{x} } \dd{x} + C \right).
\end{equation}
上式右端第一项是\cref{equation:微分方程.一阶线性齐次微分方程} 的通解，
第二项是\cref{equation:微分方程.一阶线性非齐次微分方程} 的一个特解.
由此可知，一阶非齐次线性方程的通解等于对应的齐次方程的通解与非齐次方程的一个特解之和.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P311 例1
求方程\begin{equation*}
	\dv{y}{x} - \frac{2y}{x+1} = (x+1)^{5/2}
\end{equation*}的通解.
\begin{solution}
这是一个一阶非齐次线性方程.
先求对应的齐次方程\(\dv{y}{x} - \frac{2}{x+1} y = 0\)的通解.
分离变量得\begin{equation*}
	\frac{\dd{y}}{y} = \frac{2 \dd{x}}{x+1},
\end{equation*}
积分得\begin{equation*}
	\ln\abs{y} = 2\ln\abs{x+1}+ \ln\abs{C_1},
\end{equation*}
即\begin{equation*}
	y = C_1 (x+1)^2.
\end{equation*}

用常数变易法，把\(C_1\)换成\(u\)，即令\(y = u(x+1)^2\)，那么\begin{equation*}
	\dv{y}{x} = \dv{u}{x} (x+1)^2 + 2u(x+1),
\end{equation*}
代入所给非齐次方程，得\begin{equation*}
	u' = (x+1)^{1/2}.
\end{equation*}
两端积分，得\begin{equation*}
	u = \frac{2}{3} (x+1)^{3/2} + C.
\end{equation*}
故所求方程通解为\begin{equation*}
	y = (x+1)^2 \left[
	\frac{2}{3} (x+1)^{3/2} + C
	\right].
\end{equation*}
\end{solution}
\end{example}

在上一小节中，对于齐次方程\(y' = f(y/x)\)，我们通过变量代换\(y = xu\)，把它化为变量可分离的方程，然后分离变量，经积分求得通解.
在本小节中，对于一阶非齐次线性方程\begin{equation*}
y' + P(x) y = Q(x),
\end{equation*}我们通过解对应的齐次线性方程找到变量代换\begin{equation*}
y = u e^{- \int P(x) \dd{x}},
\end{equation*}利用这一代换，把非齐次线性方程化为变量可分离的方程，然后经积分求得通解.

利用变量代换（因变量的变量代换或自变量的变量代换），把一个微分方程化为变量可分离的方程，或化为已知其求解步骤的方程，这是解微分方程最常用的方法.

\begin{example}
解方程\begin{equation*}
	x y' + y = x^2 + 3x + 2.
\end{equation*}
\begin{solution}
将原方程变形为\begin{equation*}
	y' + \frac{1}{x} y = x + 3 + \frac{2}{x}.
\end{equation*}
对应的齐次方程\begin{equation*}
	y' + \frac{1}{x} y = 0
\end{equation*}
又可变形为\begin{equation*}
	\frac{\dd{y}}{y} = -\frac{\dd{x}}{x},
\end{equation*}
积分得\begin{equation*}
	\ln\abs{y} = -\ln\abs{x} + C_1
	\quad\text{或}\quad
	y = C_2 e^{-\ln\abs{x}}
	= C_2 \frac{1}{\abs{x}}.
\end{equation*}
应用常数变易法，令\(y = \frac{u}{\abs{x}}\)，那么\begin{equation*}
	\dv{y}{x} = \frac{u' \abs{x} - u(\abs{x})'}{x^2}.
\end{equation*}
代回原方程得\begin{equation*}
	\frac{u' \abs{x} - u(\abs{x})'}{x^2}
	+ \frac{1}{x} \frac{u}{\abs{x}}
	= x + 3 + \frac{2}{x},
\end{equation*}
或\begin{equation*}
	\def\arraystretch{1.5}
	\left\{ \begin{array}{cc}
		\frac{u' x - u}{x^2}
		+ \frac{1}{x} \frac{u}{x}
		= x + 3 + \frac{2}{x},
		& x>0, \\
		\frac{u' (-x) + u}{x^2}
		- \frac{1}{x} \frac{u}{x}
		= x + 3 + \frac{2}{x},
		& x<0.
	\end{array} \right.
\end{equation*}
整理得\begin{equation*}
	\def\arraystretch{1.5}
	u' = \left\{ \begin{array}{rc}
		x^2 + 3x + 2,
		& x>0, \\
		-(x^2 + 3x + 2),
		& x<0.
	\end{array} \right.
\end{equation*}
积分得\begin{equation*}
	\def\arraystretch{1.5}
	u = \left\{ \begin{array}{rc}
		\frac{1}{3} x^3 + \frac{3}{2} x^2 + 2x + C_3,
		& x>0, \\
		-(\frac{1}{3} x^3 + \frac{3}{2} x^2 + 2x) + C_4,
		& x<0.
	\end{array} \right.
\end{equation*}
由此，原方程的通解为\begin{equation*}
	y = \frac{1}{3} x^2 + \frac{3}{2} x + 2 + \frac{C}{x}.
\end{equation*}
\end{solution}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1ECxGepEAZ/
求方程\begin{equation*}
	\dv{y}{x} = \frac{y}{x + y^4 \ln y}
\end{equation*}的通解.
\begin{solution}
取倒数得\begin{equation*}
	\dv{x}{y} - \frac{x}{y} = y^3 \ln y.
\end{equation*}
由对应的齐次方程\begin{equation*}
	\dv{x}{y} - \frac{x}{y} = 0
\end{equation*}解得\(x = C_1 y\ (\text{$C_1$是常数})\).
用常数变易法，令\(x = u y\)，
则\(\dv{x}{y} = u + y \dv{u}{y}\)，
代入原方程得\begin{equation*}
	u + y \dv{u}{y} = u + y^3 \ln y,
\end{equation*}
整理得\begin{equation*}
	\dd{u} = y^2 \ln y \dd{y},
\end{equation*}
积分得\begin{equation*}
	u = \frac13 y^3 \ln y - \frac19 y^3 + C.
\end{equation*}
那么原方程的通解为\begin{equation*}
	x = y \left( \frac13 y^3 \ln y - \frac19 y^3 + C \right).
\end{equation*}
%@Mathematica: DSolve[1/D[x[y], y] == y/(x[y] + y^4 Log[y]), x[y], y]
\end{solution}
\end{example}

\begin{example}
%@see: 《2018年全国硕士研究生入学统一考试（数学一）》三解答题/第18题
已知微分方程\(y' + y = f(x)\)，
其中\(f\)是\(\mathbb{R}\)上的周期为\(T\)的连续函数.
证明：方程存在唯一的以\(T\)为周期的解.
\begin{proof}
记\(P = 1,
Q = f(x)\)，
那么\(y' + y = f(x)\)的通解为\begin{equation*}
	%\cref{equation:微分方程.一阶线性非齐次微分方程的通解}
	Y = e^{-x} \left( \int f(x) e^x \dd{x} + C \right),
\end{equation*}
其中\(C\)是任意常数.
根据题意，我们需要证明通解\(Y\)中存在一个以\(T\)为周期的函数\(y\)，即\(y(x+T) = y(x)\).
于是可以假设函数\begin{equation*}
	y(x) = e^{-x} \left( \int_0^x f(t) e^t \dd{t} + C \right)
\end{equation*}是所求的以\(T\)为周期的函数，
其中\(C\)是待定参数.
因为\begin{align*}
	y(x+T) &= e^{-x-T} \left( \int_0^{x+T} f(t) e^t \dd{t} + C \right) \\
	&= e^{-x-T} \left( \int_0^T f(t) e^t \dd{t} + \int_T^{x+T} f(t) e^t \dd{t} + C \right) \\
	&\xlongequal{u=t-T}
	e^{-x-T} \left( \int_0^T f(t) e^t \dd{t} + \int_0^x f(u+T) e^{u+T} \dd{u} + C \right) \\
	% 利用\(f(u+T) = f(u)\)化简，把因子\(e^{-T}\)乘进去
	&= e^{-x} \left( e^{-T} \int_0^T f(t) e^t \dd{t} + \int_0^x f(u) e^u \dd{u} + C e^{-T} \right),
\end{align*}
所以\begin{align*}
	0 &= (y(x+T) - y(x)) e^x \\
	&= \left( e^{-T} \int_0^T f(t) e^t \dd{t} + \int_0^x f(u) e^u \dd{u} + C e^{-T} \right)
	- \left( \int_0^x f(t) e^t \dd{t} + C \right) \\
	&= e^{-T} \int_0^T f(t) e^t \dd{t} + C e^{-T} - C,
\end{align*}
整理得\begin{equation*}
	C (1 - e^{-T}) = e^{-T} \int_0^T f(t) e^t \dd{t},
\end{equation*}
解得\begin{equation*}
	C = \frac{e^{-T}}{1 - e^{-T}} \int_0^T f(t) e^t \dd{t}.
\end{equation*}
注意到线性微分方程的通解包含它的所有解，
故只要\(C\)唯一，则周期解\(y\)唯一.
\end{proof}
\end{example}

\begin{example}
%@see: http://www.youtube.com/watch?v=IZqwi0wJovM
解方程组\begin{equation*}
	\begin{cases}
		u_1' = -u_1 + 2u_2, \\
		u_2' = u_1 - 2u_2,
	\end{cases}
\end{equation*}
其中\(
	u_1(0) = 1,
	u_2(0) = 0
\).
\begin{solution}
这是一个一阶常系数线性方程组.
记\begin{equation*}
	U \defeq \begin{bmatrix}
		u_1 \\ u_2
	\end{bmatrix},
	\qquad
	U' \defeq \begin{bmatrix}
		u_1' \\ u_2'
	\end{bmatrix},
	\qquad
	D \defeq \begin{bmatrix}
		-1 & 2 \\
		1 & -2
	\end{bmatrix},
\end{equation*}
便得\(D' = D U\).
%@Mathematica: A = {{-1, 2}, {1, -2}};
%@Mathematica: Eigenvalues[A]
%@Mathematica: Eigenvectors[A]
易知\(\lambda_1=-3\)和\(\lambda_2=0\)是\(D\)的特征值，
\(x_1=(-1,1)^T\)和\(x_2=(2,1)^T\)是\(D\)的特征向量，
于是所求方程组的通解为\begin{equation*}
	U = C_1 e^{\lambda_1 t} x_1 + C_2 e^{\lambda_2 t} x_2
	= C_1 e^{-3t} \begin{bmatrix}
		-1 \\ 1
	\end{bmatrix}
	+ C_2 \begin{bmatrix}
		2 \\ 1
	\end{bmatrix},
\end{equation*}
其中\(C_1,C_2\)是任意常数.
代入\(U(0) \defeq (1,0)^T\)得\begin{equation*}
	U(0)
	= C_1 \begin{bmatrix}
		-1 \\ 1
	\end{bmatrix}
	+ C_2 \begin{bmatrix}
		2 \\ 1
	\end{bmatrix}
	= \begin{bmatrix}
		-1 & 2 \\
		1 & 1
	\end{bmatrix}
	\begin{bmatrix}
		C_1 \\ C_2
	\end{bmatrix}
	= \begin{bmatrix}
		1 \\ 0
	\end{bmatrix},
\end{equation*}
解得\(
	C_1 = -\frac13,
	C_2 = \frac13
\)，
即\(
	U(t)
	= -\frac13 e^{-3t} \begin{bmatrix}
		-1 \\ 1
	\end{bmatrix}
	+ \frac13 \begin{bmatrix}
		2 \\ 1
	\end{bmatrix}
\).
%@Mathematica: DSolve[{u1'[t] == -u1[t] + 2 u2[t], u2'[t] == u1[t] - 2 u2[t], u1[0] == 1, u2[0] == 0}, {u1[t], u2[t]}, t] // FullSimplify
\end{solution}
\end{example}

\section{伯努利方程}
方程\begin{equation}\label[differential-equation]{equation:微分方程.伯努利方程}
%@see: 《高等数学（第六版 上册）》 P314 (10)
	\dv{y}{x} + P(x) y = Q(x) y^n
\end{equation}
叫做\DefineConcept{伯努利方程}.
当\(n=0\)或\(n=1\)时，
\cref{equation:微分方程.伯努利方程} 就是一阶线性微分方程，
可以直接按\cref{section:微分方程.一阶线性微分方程}讲述的步骤解出该方程.
当\(n\neq0,1\)时，这方程不是线性的，
但是通过变量的代换，可以把它化为线性的.
事实上，以\(y^n\)除\cref{equation:微分方程.伯努利方程} 两端，
得\begin{equation}\label[differential-equation]{equation:微分方程.伯努利方程.中间步骤}
%@see: 《高等数学（第六版 上册）》 P314 (11)
	y^{-n} \dv{y}{x} + P(x) y^{1-n} = Q(x),
\end{equation}
容易看出，上式左端第一项与\(\dv{x}(y^{1-n})\)只差一个常数因子\(1-n\)，
因此我们引入新的因变量\(z = y^{1-n}\)，
那么\begin{equation*}
	\dv{z}{x} = (1-n) y^{-n} \dv{y}{x}.
\end{equation*}
用\((1-n)\)乘\cref{equation:微分方程.伯努利方程.中间步骤} 的两端，
再通过上述代换便得一阶线性微分方程\begin{equation}\label[differential-equation]{equation:微分方程.伯努利方程.换元后得到的方程}
	\dv{z}{x} + (1-n) P(x) z = (1-n) Q(x).
\end{equation}
求出\cref{equation:微分方程.伯努利方程.换元后得到的方程} 的通解后，
以\(y^{1-n}\)代\(z\)便得到伯努利方程的通解.

特别地，当\(n>0\)时，\(y\)可以取为\(0\)，
而\(y=0\)恰好也满足\cref{equation:微分方程.伯努利方程} .

\begin{example}
%@see: 《高等数学（第六版 上册）》 P314 例4
求方程\begin{equation*}
	\dv{y}{x} + \frac{y}{x} = a y^2 \ln x
\end{equation*}的通解.
\begin{solution}
以\(y^2\)除方程的两端，得\begin{equation*}
	y^{-2} \dv{y}{x} + \frac{1}{2} y^{-1} = a \ln x,
\end{equation*}
即\begin{equation*}
	- \dv{x}(y^{-1}) + \frac{1}{x} y^{-1} = a \ln x.
\end{equation*}
令\(z = y^{-1}\)，则上述方程成为\begin{equation*}
	\dv{z}{x} - \frac{1}{x} z = -a \ln x.
\end{equation*}
这是一个线性方程，它的通解为\begin{equation*}
	z = x \left[ C - \frac{a}{2} \ln^2 x \right].
\end{equation*}
以\(y^{-1}\)代\(z\)，得所求方程的通解为\begin{equation*}
	yx \left[ C - \frac{a}{2} \ln^2 x \right] = 1.
\end{equation*}
\end{solution}
\end{example}

% \section{一阶微分方程的幂级数解法}
% 给定一阶微分方程\begin{equation*}
% \def\arraystretch{1.5}
% \left\{ \begin{array}{l}
% \dv{y}{x} = f(x,y) \\
% \eval{y}_{x=x_0} = y_0 \\
% \end{array} \right.
% \end{equation*}其中函数\(f(x,y)\)是\((x-x_0)\)、\((y-y_0)\)的多项式\begin{equation*}
% f(x,y) = a_{00} + a_{10} (x-x_0) + a_{01} (y-y_0) + \dotsb + a_{lm} (x-x_0)^l (y-y_0)^m.
% \end{equation*}那么可以设所求的特解可展开为\((x-x_0)\)的幂级数：\begin{equation*}
% y = y_0 + a_1 (x-x_0) + a_2 (x-x_0)^2 + \dotsb + a_n (x-x_0)^n + \dotsb,
% \end{equation*}其中\(\AutoTuple{a}{n},\dotsc\)是待定系数.把上式代回原微分方程（组）中，
% 便得一恒等式，比较所得恒等式两端\((x-x_0)\)的同次幂的系数，就可确定待定系数取值，即求得原微分方程（组）的特解.
