\section{高阶线性微分方程的解的结构}
本节讨论在实际问题中应用得较多的所谓高阶线性微分方程.

\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
		\draw[ultra thick](-1,0)--(1,0);
		\foreach \i in {-5,...,4} {
			\draw({\i*.2},0)--++(5pt,5pt);
		}
		\pgfmathsetmacro{\b}{2}
		\draw(0,0)--(0,-\b)coordinate(A);
		\pgfmathsetmacro{\c}{.4}
		\foreach \i in {0,...,9} {
			\draw(-\c,-\b*.1*\i)--++(2*\c,-.1)--++(-2*\c,-.1);
		}
		\pgfmathsetmacro{\a}{1}
		\draw(A)--++(.5*\a,0)--++(0,-\a)--++(-\a,0)--++(0,\a)--(A);
		\coordinate(B)at($(A)+(0,-.5*\a)$);
		\fill(B)circle(2pt)node[left]{\(O\)};
		\draw[>=Stealth,->](B)--++(0,-1)node[right]{\(\vb{x}\)};
	\end{tikzpicture}
	\caption{}
	\label{figure:微分方程.重力场中的弹簧振子模型}
\end{figure}
\begin{example}
设有一个弹簧，它的上端固定，下端挂着一个质量为\(m\)的物体.
当物体处于静止状态时，作用在物体上的重力与弹力大小相等、方向相反.
这个位置就是物体的平衡位置.
如\cref{figure:微分方程.重力场中的弹簧振子模型}，
取\(x\)轴铅直向下，并取物体的平衡位置为坐标原点.

如果使物体具有一个初始速度\(v_0\neq0\)，
那么物体便离开平衡位置，并在平衡位置附近作上下振动.
在振动过程中，物体的位置\(x\)随时间\(t\)变化，
即\(x\)是\(t\)的函数：\(x=x(t)\).
要确定物体的振动规律，就要求出函数\(x=x(t)\).

由力学知道，弹簧使物体回到平衡位置的弹力\(f\)
（它不包括物体在平衡位置时和重力\(mg\)相平衡的那一部分弹力）
和物体离开平衡位置的位移\(x\)成正比：\begin{equation*}
	f = -cx,
\end{equation*}
其中\(c\)是弹簧的弹性系数，
负号表示弹力的方向和物体位移的方向相反.

另外，物体在运动过程中还收到阻尼介质（如空气）的阻力的作用，使得振动逐渐趋向停止.
由实验指导，阻力\(R\)的方向总与运动方向相反，
当运动速度不大时，其大小与物体运动的速度成正比：\begin{equation*}
	R = -\mu \dv{x}{t},
\end{equation*}
其中\(\mu\)是阻尼系数.

根据上述关于物体受力情况的分析，由牛顿第二定律得\begin{equation*}
	m \dv[2]{x}{t} = -cx -\mu \dv{x}{t}.
\end{equation*}
移项，并记\(2n=\frac{\mu}{m},
k^2=\frac{c}{m}\)，
则上式化为\begin{equation*}
	\dv[2]{x}{t}+2n\dv{x}{t}+k^2x=0.
\end{equation*}
这就是在有阻尼的情况下，物体自由振动的微分方程.

如果物体在振动过程中，还收到铅直干扰力\begin{equation*}
	F = H \sin pt
\end{equation*}的作用，则有\begin{equation*}
	\dv[2]{x}{t} + 2n \dv{x}{t} + k^2x = h \sin pt,
\end{equation*}
其中\(h=\frac{H}{m}\).
这就是受迫振动的微分方程.
\end{example}

下面来讨论形如
\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的一般形式}
	\dv[2]{y}{x} + P(x) \dv{y}{x} + Q(x) y = f(x)
\end{equation}
的二阶线性微分方程的解的一些性质，这些性质可以推广到\(n\)阶线性方程
\begin{equation}\label{equation:微分方程.n阶线性微分方程的一般形式}
	y^{(n)} + a_1(x) y^{(n-1)} + \dotsb + a_{n-1}(x) y' + a_n(x) y = f(x).
\end{equation}

要研究线性微分方程的解的结构，
首先讨论二阶齐次线性方程\begin{equation}\label{equation:微分方程.二阶齐次线性微分方程的一般形式}
	y'' + P(x) y' + Q(x) y = 0.
\end{equation}

\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P325 定理1
如果函数\(y_1(x)\)与\(y_2(x)\)是
二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的两个解，
那么\begin{equation}\label{equation:微分方程.二阶齐次线性微分方程的通解的结构}
	y = C_1 y_1 + C_2 y_2
\end{equation}
也是二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，
其中\(C_1\)、\(C_2\)是任意常数.
\begin{proof}
将\cref{equation:微分方程.二阶齐次线性微分方程的通解的结构}
代入\cref{equation:微分方程.二阶齐次线性微分方程的一般形式} 左端，
得\begin{align*}
	&\hspace{-20pt}
	[C_1 y_1'' + C_2 y_2'']
	+ P(x) [C_1 y_1' + C_2 y_2']
	+ Q(x) [C_1 y_1 + C_2 y_2] \\
	&= C_1 [y_1'' + P(x) y_1' + Q(x) y_1]
	+ C_2 [y_2'' + P(x) y_2' + Q(x) y_2].
\end{align*}
由于\(y_1,y_2\)都是二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，
上式右端方括号中的表达式都恒等于零，
因而整个式子恒等于零，
所以\cref{equation:微分方程.二阶齐次线性微分方程的通解的结构}
是\cref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解.
\end{proof}
\end{theorem}
从\cref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 可以看出，
二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解
成为一个线性空间.

%@see: 《高等数学（第六版 上册）》 P326
解 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 从形式上来看
含有\(C_1\)与\(C_2\)两个任意常数，
但它不一定是二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
例如，设\(y_1(x)\)是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的一个解，
则\(y_2(x)=2 y_1(x)\)也是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解.
这时解 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 成为\(y = C_1 y_1(x) + 2 C_2 y_1(x)\)，
可以把它改写成\(y = C y_1(x)\)，其中\(C = C_1 + 2 C_2\).
这显然不是 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
那么在什么情况下 \labelcref{equation:微分方程.二阶齐次线性微分方程的通解的结构} 才是%
二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解呢？
要解决这个问题，还得引入一个新的概念，即所谓“函数组的线性相关与线性无关”.

\begin{definition}
%@see: 《高等数学（第六版 上册）》 P326
设\(y_1(x),y_2(x),\dotsc,y_n(x)\)为定义在区间\(I\)上的\(n\)个函数.
如果存在\(n\)个不全为零的常数\(\AutoTuple{k}{n}\)，
使得当\(x \in I\)时，
有恒等式\begin{equation*}
	k_1 y_1+k_2 y_2+ \dotsb +k_n y_n \equiv 0
\end{equation*}成立，
那么称这\(n\)个函数在区间\(I\)上\DefineConcept{线性相关}；
否则称之为\DefineConcept{线性无关}.
\end{definition}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P326
函数\(1,\cos^2 x, \sin^2 x\)在整个数轴上是线性相关的.
因为取\(k_1=1,k_2=k_3=-1\)，就有恒等式\begin{equation*}
	1 - \cos^2 x - \sin^2 x \equiv 0.
\end{equation*}

函数\(1,x,x^2\)在任何区间\((a,b)\)内是线性无关的.
因为如果\(k_1,k_2,k_3\)不全为零，
那么在该区间内至多只有两个\(x\)值能使二次三项式\begin{equation*}
	k_1 + k_2 x + k_3 x^2
\end{equation*}为零；而要使它恒等于零，必须\(k_1,k_2,k_3\)全为零.
\end{example}

%@see: 《高等数学（第六版 上册）》 P326
应用上述概念可知，对于两个函数的情形，它们线性相关与否，只要看它们的比是否为常数：
如果比为常数，那么它们就线性相关；否则就线性无关.

有了一组函数线性相关或线性无关的概念后，
我们有如下关于二阶齐次线性微分方程的通解结构的定理.
\begin{theorem}\label{theorem:微分方程.二阶齐次线性微分方程的通解结构}
%@see: 《高等数学（第六版 上册）》 P326 定理2
如果\(y_1(x)\)与\(y_2(x)\)是
二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的
两个线性无关的特解，那么\begin{equation*}
	y = C_1 y_1(x) + C_2 y_2(x)
	\quad\text{\(C_1,C_2\)是任意常数}
\end{equation*}
就是二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
\end{theorem}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P326
方程\(y'' + y = 0\)是二阶齐次线性方程.
这里\begin{equation*}
	P(x)\equiv0,
	\qquad
	Q(x)\equiv1.
\end{equation*}
容易验证\begin{equation*}
	y_1 = \cos x
	\quad\text{与}\quad
	y_2 = \sin x
\end{equation*}
是所给方程的两个解，
且\begin{equation*}
	\frac{y_2}{y_1}
	= \frac{\sin x}{\cos x}
	= \tan x
\end{equation*}不是常数函数，
即它们是线性无关的.
因此方程\(y'' + y = 0\)的通解为\begin{equation*}
	y = C_1 \cos x + C_2 \sin x.
\end{equation*}
\end{example}
\begin{example}
%@see: 《高等数学（第六版 上册）》 P327
方程\((x-1) y'' - x y' + y = 0\)是二阶齐次线性方程.
这里\begin{equation*}
	P(x)=-\frac{x}{x-1},
	\qquad
	Q(x)=\frac1{x-1}.
\end{equation*}
容易验证\begin{equation*}
	y_1 = x
	\quad\text{与}\quad
	y_2 = e^x
\end{equation*}是所给方程的两个解，
且\begin{equation*}
	\frac{y_2}{y_1}
	= \frac{e^x}{x}
\end{equation*}不是常数函数，
即它们是线性无关的.
因此方程\((x-1) y'' - x y' + y = 0\)的通解为\begin{equation*}
	y = C_1 x + C_2 e^x.
\end{equation*}
\end{example}

\cref{theorem:微分方程.二阶齐次线性微分方程的通解结构} 不难推广到\(n\)阶齐次线性方程.
\begin{corollary}\label{theorem:微分方程.n阶齐次线性微分方程的通解结构}
%@see: 《高等数学（第六版 上册）》 P327 推论
如果\(y_1(x),y_2(x),\dotsc,y_n(x)\)是\(n\)阶齐次线性方程\begin{equation*}
	y^{(n)} + a_1(x) y^{(n-1)} + \dotsb + a_{n-1}(x) y' + a_n(x) y = 0
\end{equation*}的\(n\)个线性无关的解，
那么此方程的通解为\begin{equation*}
	y = C_1 y_1 + C_2 y_2 + \dotsb + C_n y_n,
\end{equation*}
其中\(\AutoTuple{C}{n}\)为任意常数.
\end{corollary}

下面讨论二阶非齐次线性方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}.
我们把二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 叫做%
“与非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 对应的齐次方程”.


在\cref{section:微分方程.一阶线性微分方程}我们已经看到，一阶非齐次线性微分方程的通解由两部分构成：
一部分是对应的齐次方程的通解；另一部分是非齐次方程本身的一个特解.
实际上，不仅一阶非齐次线性微分方程的通解具有这样的结构，
而且二阶及更高阶的非齐次线性微分方程的特解也具有同样的结构.
\begin{theorem}\label{theorem:微分方程.二阶非齐次线性微分方程的通解结构}
%@see: 《高等数学（第六版 上册）》 P327 定理3
设\(\hat{y}(x)\)是二阶非齐次线性微分方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的一个特解，
\(Y(x)\)是与 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 对应的
二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解，
那么\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解结构}
	y=Y(x)+\hat{y}(x)
\end{equation}是二阶非齐次线性微分方程的通解.
\begin{proof}
把\cref{equation:微分方程.二阶非齐次线性微分方程的通解结构}
代入\cref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 左端，
得\begin{align*}
	&\hspace{-20pt}
	(Y'' + \hat{y}'')
	+ P(x) (Y' + \hat{y}')
	+ Q(x) (Y + \hat{y}) \\
	&= [Y'' + P(x) Y' + Q(x) Y]
	+ [\hat{y}'' + P(x) \hat{y}' + Q(x) \hat{y}].
\end{align*}
由于\(Y\)是\cref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，
\(\hat{y}\)是\cref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的解，
可知上式右端第一个方括号内表达式恒等于零，第二个恒等于\(f(x)\).
这样，\(y = Y + \hat{y}\)使
\cref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的两端恒等，
说明\cref{equation:微分方程.二阶非齐次线性微分方程的通解结构}
是\cref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的解.

由于对应的二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解
\(Y = C_1 y_1 + C_2 y_2\)中含有两个任意常数，
所以\(y = Y + \hat{y}\)中也含有两个任意常数，
因此它就是二阶非齐次线性微分方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解.
\end{proof}
\end{theorem}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P327
方程\(y'' + y = x^2\)是二阶非齐次线性微分方程.
已知\(Y = C_1 \cos x + C_2 \sin x\)是对应的齐次方程\(y'' + y = 0\)的通解.
又容易验证\(\hat{y} = x^2 - 2\)是所给方程的一个特解.
因此\begin{equation*}
	y = C_1 \cos x + C_2 \sin x + x^2 - 2
\end{equation*}是所给方程的通解.
\end{example}

非齐次线性微分方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的特解
有时可用下述定理来帮助求出.
\begin{theorem}\label{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理}
设非齐次线性方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}
的右端\(f(x)\)是两个函数之和，即\begin{equation*}
	y''+P(x)y'+Q(x)y
	=f(x)
	=f_1(x)+f_2(x);
\end{equation*}而\(\hat{y}_1(x)\)与\(\hat{y}_2(x)\)分别是方程\begin{equation*}
	y''+P(x)y'+Q(x)y=f_1(x)
\end{equation*}与\begin{equation*}
	y''+P(x)y'+Q(x)y=f_2(x)
\end{equation*}的特解，那么\(\hat{y}_1(x)+\hat{y}_2(x)\)就是原方程的特解.
\end{theorem}

\cref{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理}
通常称为线性微分方程的解的\DefineConcept{叠加原理}.

\cref{theorem:微分方程.二阶非齐次线性微分方程的通解结构}
和\cref{theorem:微分方程.二阶非齐次线性微分方程的解的叠加原理}
也可推广到\(n\)阶非齐次线性方程，这里不再赘述.

在\cref{section:微分方程.一阶线性微分方程}为了解一阶非齐次线性方程，我们采用了常数变易法.
该方法的特点是：
如果\(C y_1(x)\)是齐次线性方程的通解，那么，
可以利用变换\(y = u y_1(x)\)（这变换是把齐次方程的通解中的
任意常数\(C\)换成未知函数\(u(x)\)而得到的）去解非齐次线性方程.
这一方法也适用于解高阶线性方程.
下面就二阶线性方程来作讨论.

\begin{enumerate}
	\item%第一种情况
	如果已知二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解为\begin{equation*}
		Y(x) = C_1 y_1(x) + C_2 y_2(x),
	\end{equation*}
	那么，可以用如下的“常数变易法”去求非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解：
	令\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解设想}
		y = y_1 v_1 + y_2 v_2,
	\end{equation}
	要确定未知函数\(v_1\)及\(v_2\)
	使函数 \labelcref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 满足
	非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}.
	为此，对函数 \labelcref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 求导，得\begin{equation*}
		y' = y_1 v_1' + y_2 v_2' + y_1' v_1 + y_2' v_2.
	\end{equation*}
	由于两个未知函数\(v_1,v_2\)
	只需使函数 \labelcref{equation:微分方程.二阶非齐次线性微分方程的通解设想} 满足
	一个关系式 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}，
	所以可规定它们再满足一个关系式.
	从\(y'\)的上述表示式可以看出，
	为了使\(y''\)的表示式中不含\(v_1''\)和\(v_2''\)，
	可设\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的额外条件1}
		y_1 v_1' + y_2 v_2' = 0,
	\end{equation}
	从而\begin{equation*}
		y' = y_1' v_1 + y_2' v_2,
	\end{equation*}
	再求导，得\begin{equation*}
		y'' = y_1' v_1' + y_2' v_2' + y_1'' v_1 + y_2'' v_2.
	\end{equation*}
	把\(y,y',y''\)代入非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}，
	得\begin{equation*}
		(y_1' v_1' + y_2' v_2' + y_1'' v_1 + y_2'' v_2)
		+P\cdot(y_1' v_1 + y_2' v_2) + Q\cdot(y_1 v_1 + y_2 v_2) = f,
	\end{equation*}
	整理得\begin{equation*}
		y_1' v_1' + y_2' v_2'
		+ (y_1'' + P y_1' + Q y_1) v_1
		+ (y_2'' + P y_2' + Q y_2) v_2
		= f.
	\end{equation*}
	注意到\(y_1,y_2\)是
	二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，
	故上式即为
	\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的额外条件2}
		y_1' v_1' + y_2' v_2' = f.
	\end{equation}
	联立方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的额外条件1}
	与 \labelcref{equation:微分方程.二阶非齐次线性微分方程的额外条件2}，
	得\begin{equation*}
		\left\{ \begin{array}{l}
			y_1 v_1' + y_2 v_2' = 0, \\
			y_1' v_1' + y_2' v_2' = f,
		\end{array} \right.
		\quad\text{即}\quad
		\begin{bmatrix}
			y_1 & y_2 \\
			y_1' & y_2'
		\end{bmatrix}
		\begin{bmatrix}
			v_1' \\ v_2'
		\end{bmatrix}
		= \begin{bmatrix}
			0 \\ f
		\end{bmatrix},
	\end{equation*}
	在系数行列式\begin{equation*}
		W = \begin{vmatrix} y_1 & y_2 \\ y_1' & y_2' \end{vmatrix}
		= y_1 y_2' - y_1 y_2 \neq0
	\end{equation*}时，
	利用\hyperref[theorem:线性方程组.克拉默法则]{克拉默法则}可解得\begin{equation*}
		v_1'
		= \frac1W \begin{vmatrix}
			0 & y_2 \\
			f & y_2'
		\end{vmatrix}
		= -\frac{y_2 f}{W},
		\qquad
		v_2'
		= \frac1W \begin{vmatrix}
			y_1 & 0 \\
			y_1' & f
		\end{vmatrix}
		= \frac{y_1 f}{W}.
	\end{equation*}
	对上两式积分（假定\(f\)连续），得\begin{equation*}
		v_1 = C_1 + \int \left(-\frac{y_2 f}{W}\right) \dd{x},
		\qquad
		v_2 = C_2 + \int \frac{y_1 f}{W} \dd{x}.
	\end{equation*}

	将\(v_1,v_2\)代回\cref{equation:微分方程.二阶非齐次线性微分方程的通解设想}，
	于是得到非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解
	\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解.形式1}
		y = C_1 y_1 + C_2 y_2
		- y_1 \int \frac{y_2 f}{W} \dd{x}
		+ y_2 \int \frac{y_1 f}{W} \dd{x}.
	\end{equation}

	\item%第二种情况
	如果只知齐次方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式}
	的一个不恒为零的解\(y_1(x)\)，
	那么利用变换\(y = u y_1(x)\)，
	可把非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}
	化为一阶线性方程.

	事实上，把\begin{equation*}
		y = y_1 u, \qquad y' = y_1 u' + y_1' u, \qquad y'' = y_1 u'' + 2 y_1' u' + y_1'' u
	\end{equation*}
	代入方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}，
	得\begin{equation*}
		(y_1 u'' + 2y_1' u' + y_1'' u) + P\cdot(y_1 u' + y_1' u) + Q \cdot y_1 u = f,
	\end{equation*}
	即\begin{equation*}
		y_1 u'' + (2y_1' + P y_1) u' + (y_1'' + P y_1' + Q y_1) u = f,
	\end{equation*}
	由于\(y_1\)是
	二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的解，
	即有\(y_1'' + P y_1' + Q y_1 \equiv 0\)，
	故上式化为\begin{equation*}
		y_1 u'' + (2 y_1' + P y_1) u' = f.
	\end{equation*}
	令\(u' = z\)，上式即化为一阶线性方程
	\begin{equation}\label{equation:微分方程.降为一阶的二阶线性微分方程}
		y_1 z' + (2 y_1' + P y_1) z = f.
	\end{equation}

	把二阶非齐次方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式}
	化为一阶方程 \labelcref{equation:微分方程.降为一阶的二阶线性微分方程} 以后，
	按\hyperref[section:微分方程.一阶线性微分方程]{一阶线性方程的解法}，
	设求得一阶方程 \labelcref{equation:微分方程.降为一阶的二阶线性微分方程} 的通解为\begin{equation*}
		u' = z = C_2 Z(x) + \hat{z}(x),
	\end{equation*}
	积分得\begin{equation*}
		u = C_1 + C_2 U(x) + \hat{u}(x),
	\end{equation*}
	其中\(U'(x) = Z(x), [\hat{u}(x)]' = \hat{z}(x)\).
	上式乘以\(y_1(x)\)，便得方程 \labelcref{equation:微分方程.二阶非齐次线性微分方程的一般形式} 的通解
	\begin{equation}\label{equation:微分方程.二阶非齐次线性微分方程的通解.形式2}
		y = C_1 y_1(x) + C_2 U(x) y_1(x) + \hat{u}(x) y_1(x).
	\end{equation}
	上述方法显然也适用于求
	二阶齐次线性方程 \labelcref{equation:微分方程.二阶齐次线性微分方程的一般形式} 的通解.
\end{enumerate}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P329 例3
已知齐次方程\((x-1)y'' - xy' + y = 0\)的通解为
\(Y(x) = C_1 x + C_2 e^x\)，
求非齐次方程\((x-1)y'' - xy' + y = (x-1)^2\)的通解.
\begin{solution}
把所给方程写成标准形式\begin{equation*}
	y'' - \frac{x}{x-1} y' + \frac{1}{x-1} y = x-1.
\end{equation*}

应用常数变易法，令\(y = x v_1 + e^x v_2\).由\begin{equation*}
	\left\{ \begin{array}{l}
		x v_1' + e^x v_2' = 0, \\
		v_1' + e^x v_2' = x-1,
	\end{array} \right.
\end{equation*}
解得\(v_1' = -1, v_2' = x e^{-x}\).
再积分，得\(v_1 = C_1 - x, v_2 = C_2 - (x+1) e^{-x}\).
于是所求非齐次方程的通解为\begin{equation*}
	y = C_1 x + C_2 e^x - (x^2+x+1).
\end{equation*}
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P330 例4
已知\(y_1(x) = e^x\)是齐次方程\(y'' - 2y' + y = 0\)的解，
求非齐次方程\(y'' - 2y' + y = x^{-1} e^x\)的通解.
\begin{solution}
令\(y = e^x u\)，
则\(y' = e^x (u'+u), y'' = e^x (u''+2u'+u)\).
代入非齐次方程，得\begin{equation*}
	e^x (u''+2u'+u) - 2e^x (u'+u) + e^x u = \frac{1}{x} e^x,
\end{equation*}
即\(e^x u'' = x^{-1} e^x, u'' = x^{-1}\).

这里不需再作变换去化为一阶线性方程，只要直接积分，便得\begin{equation*}
	u' = C + \ln\abs{x},
	\qquad
	u = C_1 + C x + x\ln\abs{x} - x,
\end{equation*}
即\(u = C_1 + C_2 x + x \ln\abs{x}\ (C_2=C-1)\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P331 习题7-6 5.
已知\(y_1(x) = e^x\)是齐次线性方程\begin{equation*}
	(2x-1)y'' - (2x+1)y' + 2y = 0
\end{equation*}的一个解，求此方程的通解.
\begin{solution}
将\(y_2(x) = u(x) e^x,
y_2'(x) = (u(x) + u'(x)) e^x,
y_2''(x) = (u(x) + 2 u'(x) + u''(x)) e^x\)代入原方程得\begin{equation*}
	(2x-1) (u(x) + 2 u'(x) + u''(x)) e^x
	- (2x+1) (u(x) + u'(x)) e^x
	+ 2 u(x) e^x
	= 0,
\end{equation*}
整理得\begin{equation*}
	(2x-1)u'' + (2x-3)u' = 0,
\end{equation*}
解得\(u = C_1 e^{-x} (2x+1) + C_2\)，
于是原方程的通解为\begin{equation*}
	Y(x) = (C_1 e^{-x} (2x+1) + C_2) e^x
	= C_1 (2x+1) + C_2 e^x.
\end{equation*}
\end{solution}
\end{example}
