\section{二元函数的泰勒公式}
\subsection{二元函数的泰勒公式}
在\cref{section:微分中值定理.泰勒公式}，我们已经知道：
若函数\(f(x)\)在含有\(x_0\)的某个开区间\((a,b)\)内具有直到\((n+1)\)阶的导数，
则当\(x\)在\((a,b)\)内时，
有下面的\(n\)阶泰勒公式\begin{align*}
	f(x) &= f(x_0) + f'(x_0) (x-x_0) \\
	&=\frac{f''(x_0)}{2!} (x-x_0)^2 + \dotsb + \frac{f^{(n)}(x_0)}{n!} (x-x_0)^n \\
	&=\frac{f^{(n+1)}[x_0+\theta(x-x_0)]}{(n+1)!} (x-x_0)^{n+1}
	\quad(0<\theta<1)
\end{align*}成立.
利用一元函数的泰勒公式，我们可用\(n\)次多项式来近似表达函数\(f(x)\)，
且误差是当\(x \to x_0\)时比\((x-x_0)^n\)高阶的无穷小.
对于多元函数来说，无论是为了理论的或实际计算的目的，
也都有必要考虑用多个变量的多项式来近似表达一个给定的多元函数，
并能具体地估算出误差的大小来.今以二元函数为例，
设\(z=f(x,y)\)在点\((x_0,y_0)\)的某一邻域内连续且有直到\((n+1)\)阶的连续偏导数，
\((x_0+h,y_0+k)\)为此邻域内任一点，
我们的问题就是要把函数\(f(x_0+h,y_0+k)\)近似地表达为\(h=x-x_0,k=y-y_0\)的\(n\)次多项式，
而由此所产生的误差是当\(\rho=\sqrt{h^2+k^2}\to0\)时比\(\rho^n\)高阶的无穷小.
为了解决这个问题，就要把一元函数的泰勒中值定理推广到多元函数的情形.

\begin{theorem}\label{theorem:多元函数微分法.二元函数的泰勒公式}
\def\oprt#1{%
	\left(h\pdv{x}+k\pdv{y}\right)%
	\ifx\relax#1\relax\else\ifnum1=0#1\relax\else^{#1}\fi\fi%
}
设\(z=f(x,y)\)在点\(P_0(x_0,y_0)\)的某一邻域\(U(P_0)\)内连续且有直到\((n+1)\)阶的连续偏导数，
点\((x_0+h,y_0+k) \in U(P_0)\)，
则有\begin{equation}\label{equation:多元函数微分法.二元函数的泰勒公式}
	f(x_0+h,y_0+k) = p_n + R_n,
\end{equation}
其中\begin{gather}
	p_n(x_0,y_0)
	=f(x_0,y_0)
	+ \sum_{i=1}^n \oprt{i} f(x_0,y_0),
	\label{equation:多元函数微分法.二元函数的泰勒多项式} \\
	R_n = \frac{1}{(n+1)!} \oprt{n+1} f(x_0+\theta h,y_0+\theta k)
	\quad (0 < \theta < 1),
	\label{equation:多元函数微分法.二元函数的泰勒公式的拉格朗日余项} \\
	\oprt{m} f(x_0,y_0)
	\defeq
	\sum_{p=0}^{m} C_m^p h^p k^{m-p}
		\eval{
			\frac{\partial^m f}{\partial x^p \partial y^{m-p}}
		}_{(x_0,y_0)}
	\quad(m=1,2,\dotsc).
\end{gather}

\rm
\cref{equation:多元函数微分法.二元函数的泰勒公式} 称为
“二元函数\(f(x,y)\)在点\(P_0(x_0,y_0)\)的\(n\)阶\DefineConcept{泰勒公式}”，
多项式 \labelcref{equation:多元函数微分法.二元函数的泰勒多项式} 称为\DefineConcept{泰勒多项式}，
而\(R_n\)的表达式 \labelcref{equation:多元函数微分法.二元函数的泰勒公式的拉格朗日余项}
称为\DefineConcept{拉格朗日余项}.
\end{theorem}
由二元函数的泰勒公式可知，
以泰勒多项式\(p_n\)近似表达函数\(f(x_0+h,y_0+k)\)时，
其误差为\(\abs{R_n}\).
由假设，函数的各\((n+1)\)阶偏导数都连续，
故它们的绝对值在点\((x_0,y_0)\)的某一邻域内斗不超过某一正常数\(M\).
于是，有如下的误差估计式\begin{align}
	\abs{R_n}
	&\leq \frac{M}{(n+1)!} (\abs{h}+\abs{k})^{n+1}
	= \frac{M}{(n+1)!} \rho^{n+1}
		\left( \frac{\abs{h}}{\rho} + \frac{\abs{k}}{\rho} \right)^{n+1}
		\notag \\
	&\leq \frac{M}{(n+1)!} (\sqrt{2})^{n+1} \rho^{n+1},
	\label{equation:多元函数微分法.二元函数的误差估计公式}
\end{align}
其中\(\rho=\sqrt{h^2+k^2}\).

由\cref{equation:多元函数微分法.二元函数的误差估计公式} 可知，
误差\(\abs{R_n}\)是当\(\rho\to0\)时比\(\rho^n\)高阶的无穷小.

当\(n=0\)时，\cref{equation:多元函数微分法.二元函数的泰勒公式} 成为
\begin{equation}\label{equation:多元函数微分法.二元函数的拉格朗日中值公式}
	f(x_0+h,y_0+k)
	= f(x_0,y_0)
	+ h f'_x(x_0+\theta h,y_0+\theta k)
	+ k f'_y(x_0+\theta h,y_0+\theta k),
\end{equation}
其中\(0<\theta<1\).
\cref{equation:多元函数微分法.二元函数的拉格朗日中值公式}
称为\DefineConcept{二元函数的拉格朗日中值公式}.
由\cref{equation:多元函数微分法.二元函数的拉格朗日中值公式}
可得以下结论：
\begin{proposition}
如果函数\(f\)的偏导数\(f'_x\)、\(f'_y\)在某一区域内都恒等于零，
则函数\(f\)在该区域内为一常数.
\end{proposition}

\begin{example}
求函数\(f(x,y) = \ln(1+x+y)\)在点\((0,0)\)的三阶泰勒公式.
\begin{solution}
\def\oprt#1{\left(h\pdv{x}+k\pdv{y}\right)\ifx\relax#1\relax\else^{#1}\fi}
因为\begin{gather*}
	f'_x(x,y) = f'_y(x,y) = \frac{1}{1+x+y}, \\
	f''_{xx}(x,y) = f''_{xy}(x,y) = f''_{yy}(x,y) = -\frac{1}{(1+x+y)^2}, \\
	\frac{\partial^3 f}{\partial x^p \partial y^{3-p}}
	= \frac{2!}{(1+x+y)^3}
	\quad(p=0,1,2,3), \\
	\frac{\partial^4 f}{\partial x^p \partial y^{4-p}}
	= -\frac{3!}{(1+x+y)^4}
	\quad(p=0,1,2,3,4),
\end{gather*}
所以\begin{gather*}
	\oprt{} f(0,0)
	= h f'_x(0,0) + k f'_y(0,0)
	= h+k, \\
	\oprt{2} f(0,0)
	= h^2 f''_{xx}(0,0) + 2hk f''_{xy}(0,0) + k^2 f''_{yy}(0,0)
	= -(h+k)^2, \\
	\oprt{3} f(0,0)
	= 2(h+k)^3.
\end{gather*}
又\(f(0,0) = 0\)，并将\(h=x\)和\(k=y\)代入，
便得\[
	\ln(1+x+y) = x+y-\frac{1}{2}(x+y)^2+\frac{1}{3}(x+y)^3+R_3,
\]
其中\begin{align*}
	R_3
	&= \frac{1}{4!} \left[\oprt{4} f(\theta h,\theta k)\right]_{\substack{h=x\\k=y}} \\
	&= -\frac{(x+y)^4}{4(1+\theta x+\theta y)^4}
	\quad(0<\theta<1).
\end{align*}
\end{solution}
\end{example}

\begin{example}
设\[
	f(x,y) = \begin{cases}
		\frac{1 - e^{x(x^2+y^2)}}{x^2+y^2}, & (x,y)\neq(0,0), \\
		0, & (x,y)=(0,0).
	\end{cases}
\]试证：\(f\)在\((0,0)\)处可微.
\begin{proof}
我们首先对\(g(h,k) = e^{h(h^2+k^2)} = e^{h^3+hk^2}\)应用二维泰勒公式.
由\[
	\pdv{g}{h} = (3h^2+k^2)e^{h^3+hk^2}, \qquad
	\pdv{g}{k} = 2hke^{h^3+hk^2},
\]得\[
	\eval{\pdv{g}{h}}_{(0,0)}
	= \eval{\pdv{g}{k}}_{(0,0)}
	= 0,
\]
故\[
	e^{h(h^2+k^2)} = 1 + o(\sqrt{h^2+k^2}).
\]
那么函数在\((0,0)\)的全增量可以写为
\begin{align*}
	\increment z
	= f(h,k)
	= \frac{1 - e^{h(h^2+k^2)}}{h^2+k^2}
	= 0 \cdot h + 0 \cdot k + \frac{o(\sqrt{h^2+k^2})}{h^2+k^2},
\end{align*}
因为\(\frac{o(\sqrt{h^2+k^2})}{h^2+k^2}\)是\(\sqrt{h^2+k^2}\)的无穷小，
所以\(f\)在点\((0,0)\)可微.
\end{proof}
\end{example}
