\section{偏导数}
\subsection{偏导数的概念}
\begin{definition}
%@see: 《高等数学（第六版 下册）》 P164 定义
%@see: 《数学分析（第二版 下册）》（陈纪修） P135 定义12.1.1
设开集\(D \subseteq \mathbb{R}^2\)，
函数\(f\colon D\to\mathbb{R}\)，
点\((x_0,y_0) \in D\).

如果极限\[
	\lim_{\increment x\to0}
	\frac{f(x_0+\increment x,y_0)-f(x_0,y_0)}{\increment x}
\]存在，
则称“函数\(f\)在点\((x_0,y_0)\)对\(x\)~\DefineConcept{可偏导}”，
并称此极限为
“函数\(f\)在点\((x_0,y_0)\)对\(x\)的\DefineConcept{偏导数}（partial derivative）”，
%@see: https://mathworld.wolfram.com/PartialDerivative.html
记作\[
	\eval{\pdv{f}{x}}_{\substack{x=x_0 \\ y=y_0}},
	\qquad
	\eval{\pdv{f}{x}}_{(x_0,y_0)},
	\quad\text{或}\quad
	f'_x(x_0,y_0).
\]

类似地，只要极限\[
	\lim_{\increment y\to0}
	\frac{f(x_0,y_0+\increment y)-f(x_0,y_0)}{\increment y}
\]存在，
就称“函数\(f\)在点\((x_0,y_0)\)对\(y\)可偏导”，
并把此极限称为“函数\(f\)在点\((x_0,y_0)\)对\(y\)的偏导数”，
记作\[
	\eval{\pdv{f}{y}}_{\substack{x=x_0 \\ y=y_0}},
	\qquad
	\eval{\pdv{f}{y}}_{(x_0,y_0)},
	\quad\text{或}\quad
	f'_y(x_0,y_0).
\]

如果函数\(f\)在\(D\)内每一点都对\(x\)可偏导，
则\(D\)中每一点\((x,y)\)与其相应的\(f\)对\(x\)的偏导数\(f'_x(x,y)\)的关系\[
	\Set{ ((x,y),f'_x(x,y)) \given (x,y) \in D }
\]称为“函数\(f\)对\(x\)的\DefineConcept{偏导函数}”，
记作\[
	\pdv{f}{x},
	\quad\text{或}\quad
	f'_x(x,y).
\]

类似地，可以定义函数\(f\)对\(y\)的偏导函数，
记作\[
	\pdv{f}{y},
	\quad\text{或}\quad
	f'_y(x,y).
\]
\end{definition}

正如导数有两种定义一样，
偏导数也有第二种定义：\begin{gather*}
	f'_x(x_0,y_0)
	\defeq
	\lim_{x \to x_0} \frac{f(x,y_0) - f(x_0,y_0)}{x - x_0}, \\
	f'_y(x_0,y_0)
	\defeq
	\lim_{y \to y_0} \frac{f(x_0,y) - f(x_0,y_0)}{y - y_0}.
\end{gather*}

偏导数的概念还可以推广到二元以上的函数.
\begin{definition}
设\(n\)元函数\(y=f(\AutoTuple{x}{n})\)在点\(P(\AutoTuple{a}{n})\)的某一邻域内有定义.
如果极限\[
	\lim_{\increment x_k\to0}
	\frac{f(a_1,\dotsc,a_k+\increment x_k,\dotsc,a_n)-f(a_1,\dotsc,a_k,\dotsc,a_n)}
	{\increment x_k}
	\quad (k=1,2,\dotsc,n)
\]存在，
则称此极限为“函数\(f\)在点\(P\)处对\(x_k\)的\DefineConcept{偏导数}”，
记作\[
	\pdv{f}{x_k}\eval_{\vb{x}=\vb{a}}
	\quad\text{或}\quad
	f'_k(\AutoTuple{a}{n}).
\]
\end{definition}

\begin{definition}
如果函数\(f\)在点\(P_0(\AutoTuple{a}{n})\)的某个邻域内每一点都对\(x_k\ (k=1,2,\dotsc,n)\)可偏导，
且偏导\(f'_k\ (k=1,2,\dotsc,n)\)在点\(P_0\)连续，
那么称“函数\(f\)在点\(P_0\)具有一阶连续偏导数
（\(f\) has \emph{continuous partial derivative} at \(P_0\)）”.
\end{definition}

可以证明，在计算任意二元函数\(f(x,y)\)在点\((x_0,y_0)\)处的偏导数
（以\(\eval{\pdv{f}{x}}_{(x_0,y_0)}\)为例）时，
可以先将不变量\(y_0\)代入，
将问题转化为计算一元函数\(z = f(x, y_0)\)的导数\(\eval{\dv{z}{x}}_{x=x_0}\).

\begin{example}
设函数\[
	f(x,y) = \left\{ \begin{array}{cl}
		\frac{xy}{\sqrt{x^2+y^2}}, & (x,y)\neq(0,0), \\
		0, & (x,y)=(0,0).
	\end{array} \right.
\]
计算\(f'_x(0,0)\)和\(f'_y(0,0)\).
\begin{solution}
由定义有\begin{align*}
	f'_x(0,0)
	&= \lim_{h\to0} \frac{f(0+h,0) - f(0,0)}{h} \\
	&= \lim_{h\to0} 0
	= 0, \\
	f'_y(0,0)
	&= \lim_{k\to0} \frac{f(0,0+k) - f(0,0)}{k} \\
	&= \lim_{k\to0} 0
	= 0.
\end{align*}
\end{solution}
\end{example}
\begin{example}
%@see: https://www.bilibili.com/video/BV1oJtWesEEd/
设函数\(z(x,y) = \frac{x \cos(y-1) - (y-1) \cos x}{1 + \sin x + \sin(y-1)}\)，
计算\(\eval{\pdv{z}{y}}_{(0,1)}\).
\begin{solution}
因为\[
	z(0,y) = \frac{-(y-1)}{1 + \sin(y-1)},
\]
所以\[
	\eval{\pdv{z}{y}}_{(0,1)}
	= \lim_{y\to1} \frac{z(0,y) - z(0,1)}{y - 1}
	= \lim_{y\to1} \frac{-1}{1 + \sin(y-1)}
	= -1.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P66 例5
已知理想气体的状态方程\[
	pV = RT,
\]
其中\(R\)为常量.
求证：\[
	\pdv{p}{V} \cdot \pdv{V}{T} \cdot \pdv{T}{p} = -1.
\]
\begin{proof}
因为\begin{gather*}
	p = \frac{RT}{V},
	\qquad
	\pdv{p}{V} = -\frac{RT}{V^2}; \\
	V = \frac{RT}{p},
	\qquad
	\pdv{V}{T} = \frac{R}{p}; \\
	T = \frac{pV}{R},
	\qquad
	\pdv{T}{p} = \frac{V}{R},
\end{gather*}
所以\[
	\pdv{p}{V} \cdot \pdv{V}{T} \cdot \pdv{T}{p}
	= -\frac{RT}{V^2} \cdot \frac{R}{p} \cdot \frac{V}{R}
	= -\frac{RT}{pV} = -1.
	\qedhere
\]
\end{proof}
\end{example}

我们知道，对一元函数来说，\(\dv{y}{x}\)可看做函数的微分\(\dd{y}\)与自变量的微分\(\dd{x}\)之商.
而上例表明，偏导数的记号是一个整体记号，不能看作分子与分母之商.

\subsection{偏导数的几何意义}
二元函数\(z=f(x,y)\)在点\((x_0,y_0)\)的偏导数有下述几何意义.
偏导数\(f'_x(x_0,y_0)\)的几何意义是
曲面\(z=f(x,y)\)被平面\(y=y_0\)所截得的曲线
在点\(M_0(x_0,y_0,f(x_0,y_0))\)处的切线对\(x\)轴的斜率.

\subsection{偏导数与连续性的关系}
我们已经知道，如果一元函数在某点具有导数，则它在该点必定连续.
但对于多元函数来说，即使各偏导数在某点都存在，也不能保证函数在该点连续.
这是因为各偏导数存在只能保证点\(P\)沿着平行于坐标轴的方向趋于\(P_0\)时，
函数值\(f(P)\)趋于\(f(P_0)\)，
但不能保证点\(P\)按任何方式趋于\(P_0\)时，
函数值\(f(P)\)都趋于\(f(P_0)\).

例如，函数\[
	f(x,y) = \left\{ \begin{array}{cl}
		\frac{xy}{x^2+y^2}, & (x,y)\neq(0,0), \\
		0, & (x,y)=(0,0)
	\end{array} \right.
\]
在点\((0,0)\)可偏导，
且\begin{gather*}
	f'_x(0,0) = \lim_{h\to0} \frac{f(0+h,0) - f(0,0)}{h} = \lim_{h\to0} 0 = 0, \\
	f'_y(0,0) = \lim_{k\to0} \frac{f(0,0+k) - f(0,0)}{k} = \lim_{k\to0} 0 = 0,
\end{gather*}
但是我们已经知道\(\lim_{(x,y)\to(0,0)} f(x,y)\)不存在，
于是\(f\)在点\((0,0)\)必定不连续.

\subsection{高阶偏导数}
\begin{definition}
设函数\(z=f(x,y)\)在区域\(D\)内具有偏导数\[
	\pdv{z}{x} = f_x(x,y), \qquad
	\pdv{z}{y} = f_y(x,y).
\]
如果\(f'_x(x,y)\)和\(f'_y(x,y)\)在区域\(D\)内的偏导数也存在，
则称它们是函数\(z=f(x,y)\)的\DefineConcept{二阶偏导数}.
按照对变量求导次序的不同有下列四个二阶偏导数：
\begin{gather*}
	\pdv{x}(\pdv{z}{x}) = \pdv[2]{z}{x} = f''_{xx}(x,y),
	\qquad
	\pdv{y}(\pdv{z}{x}) = \pdv{z}{x}{y} = f''_{xy}(x,y), \\
	\pdv{x}(\pdv{z}{y}) = \pdv{z}{y}{x} = f''_{yx}(x,y),
	\qquad
	\pdv{y}(\pdv{z}{y}) = \pdv[2]{z}{y} = f''_{yy}(x,y),
\end{gather*}
其中\(f''_{xy}(x,y)\)和\(f''_{yx}(x,y)\)
称为\DefineConcept{混合偏导数}（mixed partial derivative）.
%@see: https://mathworld.wolfram.com/MixedPartialDerivative.html
二阶及二阶以上的偏导数统称为\DefineConcept{高阶偏导数}.
\end{definition}

\begin{theorem}
如果函数\(z=f(x,y)\)的两个二阶混合偏导数\(\pdv{z}{y}{x}\)及\(\pdv{z}{x}{y}\)在区域\(D\)内连续，
那么在该区域内这两个二阶混合偏导数必相等.
\begin{proof}
根据偏导数的定义，我们有
\[
	\pdv{z(x,y)}{x}
	= \lim_{\increment x\to0} \frac{f(x+\increment x,y)-f(x,y)}{\increment x},
\]
	\[
	\pdv{z(x,y)}{y}
	= \lim_{\increment y\to0} \frac{f(x,y+\increment y)-f(x,y)}{\increment y}.
\]
于是，我们就有
\begin{align*}
	\pdv[2]{z}{x}{y}
	&= \lim_{\increment y\to0}
		\frac{1}{\increment y}\left[\pdv{z(x,y+\increment y)}{x} - \pdv{z(x,y)}{x}\right] \\
	&= \lim_{\increment y\to0}
		\frac{1}{\increment y}\left[\lim_{\increment x\to0} \frac{f(x+\increment x,y+\increment y)-f(x,y+\increment y)}{\increment x} - \lim_{\increment x\to0} \frac{f(x+\increment x,y)-f(x,y)}{\increment x}\right] \\
	&= \lim_{\increment y\to0}
		\frac{1}{\increment y}\left\{\lim_{\increment x\to0} \frac{[f(x+\increment x,y+\increment y)-f(x,y+\increment y)]-[f(x+\increment x,y)-f(x,y)]}{\increment x}\right\} \\
	&= \lim_{\increment y\to0} \lim_{\increment x\to0}
		\frac{f(x+\increment x,y+\increment y)-f(x,y+\increment y)-f(x+\increment x,y)+f(x,y)}{\increment x \cdot \increment y}, \\
	\pdv[2]{z}{y}{x}
	&= \lim_{\increment x\to0}
		\frac{1}{\increment x}\left[\pdv{z(x+\increment x,y)}{y} - \pdv{z(x,y)}{y}\right] \\
	&= \lim_{\increment x\to0}
		\frac{1}{\increment x}\left[\lim_{\increment y\to0} \frac{f(x+\increment x,y+\increment y)-f(x+\increment x,y)}{\increment y} - \lim_{\increment y\to0} \frac{f(x,y+\increment y)-f(x,y)}{\increment y}\right] \\
	&= \lim_{\increment x\to0}
		\frac{1}{\increment x}\left\{\lim_{\increment y\to0} \frac{[f(x+\increment x,y+\increment y)-f(x+\increment x,y)]-[f(x,y+\increment y)-f(x,y)]}{\increment y}\right\} \\
	&= \lim_{\increment x\to0} \lim_{\increment y\to0}
		\frac{f(x+\increment x,y+\increment y)-f(x+\increment x,y)-f(x,y+\increment y)+f(x,y)}{\increment x \cdot \increment y}, \\
\end{align*}
显然\[
	\pdv[2]{z}{x}{y} = \pdv[2]{z}{y}{x}.
	\qedhere
\]
\end{proof}
\end{theorem}
换句话说，二阶混合偏导数在连续的条件下与求导的次序无关.
同样地，高阶混合偏导数在连续的条件下也与求导的次序无关.

\begin{example}
验证函数\(z = \ln\sqrt{x^2+y^2}\)满足方程\[
	\pdv[2]{z}{x} + \pdv[2]{z}{y} = 0.
\]
\begin{proof}
因为\(z = \ln\sqrt{x^2+y^2} = \frac{1}{2} \ln(x^2+y^2)\)，
所以\begin{gather*}
	\pdv{z}{x} = \frac{x}{x^2+y^2},
	\qquad
	\pdv{z}{y} = \frac{y}{x^2+y^2}, \\
	\pdv[2]{z}{x} = \frac{(x^2+y^2)-x\cdot2x}{(x^2+y^2)^2}
	= \frac{y^2-x^2}{(x^2+y^2)^2}, \\
	\pdv[2]{z}{y} = \frac{(x^2+y^2)-y\cdot2y}{(x^2+y^2)^2}
	= \frac{x^2-y^2}{(x^2+y^2)^2},
\end{gather*}
因此\[
	\pdv[2]{z}{x} + \pdv[2]{z}{y}
	= \frac{y^2-x^2}{(x^2+y^2)^2} + \frac{x^2-y^2}{(x^2+y^2)^2}
	= 0.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
证明函数\(u = \frac{1}{r}\)满足方程\[
	\pdv[2]{u}{x} + \pdv[2]{u}{y} + \pdv[2]{u}{z} = 0,
\]
其中\(r = \sqrt{x^2+y^2+z^2}\).
\begin{proof}
显然有\begin{gather*}
	\pdv{u}{x} = -\frac{1}{r^2}\cdot\pdv{r}{x}
	= -\frac{1}{r^2}\cdot\frac{x}{r}
	= -\frac{x}{r^3}, \\
	\pdv[2]{u}{x} = -\frac{1}{r^3} + \frac{3x}{r^4}\cdot\pdv{r}{x}
	= -\frac{1}{r^3} + \frac{3x^2}{r^5}.
\end{gather*}
由于函数关于自变量的对称性，所以\[
	\pdv[2]{u}{y} = -\frac{1}{r^3} + \frac{3y^2}{r^5},
	\qquad
	\pdv[2]{u}{z} = -\frac{1}{r^3} + \frac{3z^2}{r^5},
\]
因此\[
	\pdv[2]{u}{x} + \pdv[2]{u}{y} + \pdv[2]{u}{z}
	= -\frac{3}{r^3} + 3\frac{x^2+y^2+z^2}{r^5}
	= -\frac{3}{r^3} + 3\frac{r^2}{r^5} = 0.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
验证函数\(r = \sqrt{x^2+y^2+z^2}\)满足\[
	\pdv[2]{r}{x} + \pdv[2]{r}{y} + \pdv[2]{r}{z} = \frac{2}{r}.
\]
\begin{proof}
显然有\begin{gather*}
	\pdv{r}{x} = \frac{2x}{2\sqrt{x^2+y^2+z^2}} = \frac{x}{\sqrt{x^2+y^2+z^2}}, \\
	\pdv[2]{r}{x} = \frac{\sqrt{x^2+y^2+z^2}-x\frac{2x}{2\sqrt{x^2+y^2+z^2}}}{x^2+y^2+z^2}
	= \frac{1}{r} - \frac{x^2}{r^3},
\end{gather*}
由于函数关于自变量的对称性，所以\[
	\pdv[2]{r}{y} = \frac{1}{r} - \frac{y^2}{r^3},
	\qquad
	\pdv[2]{r}{z} = \frac{1}{r} - \frac{z^2}{r^3},
\]
因此\[
	\pdv[2]{r}{x} + \pdv[2]{r}{y} + \pdv[2]{r}{z}
	= \frac{3}{r} - \frac{x^2+y^2+z^2}{r^3}
	= \frac{2}{r}.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
验证函数\(T = 2\pi\sqrt{\frac{l}{g}}\)满足方程\(l\pdv{T}{l}+g\pdv{T}{g}=0\).
\begin{solution}
因为\begin{gather*}
	\pdv{T}{l} = 2\pi \frac{1}{2\sqrt{l/g}} \frac{1}{g}
	= \pi \frac{1}{\sqrt{gl}}, \\
	\pdv{T}{g} = 2\pi \frac{1}{2\sqrt{l/g}} l \left(-\frac{1}{g^2}\right)
	= -\pi \frac{\sqrt{gl}}{g^2},
\end{gather*}
所以\[
	l \pdv{T}{l} + g \pdv{T}{g}
	= l \cdot \pi \frac{1}{\sqrt{gl}} - g \cdot \pi \frac{\sqrt{gl}}{g^2}
	= \pi \sqrt{\frac{l}{g}} - \pi \sqrt{\frac{l}{g}} = 0.
\]
\end{solution}
\end{example}

\begin{example}
验证函数\(z = \exp[-\left(\frac{1}{x}+\frac{1}{y}\right)]\)
满足方程\(x^2 \pdv{z}{x} + y^2 \pdv{z}{y} = 2z\).
%TODO
\end{example}

\begin{example}
验证函数\(y = e^{-k n^2 t}\)
满足方程\(\pdv{y}{t} = k \pdv[2]{y}{x}\).
%TODO
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1dJtWesESa/
设函数\[
	f(x,y) = \left\{ \begin{array}{cl}
		x y \frac{x^2 - y^2}{x^2 + y^2}, & (x,y)\neq(0,0), \\
		0, & (x,y)=(0,0),
	\end{array} \right.
\]
计算\(f''_{xy}(0,0) \cdot f''_{yx}(0,0)\).
\begin{solution}
因为\(f(x,0) = 0,
f(0,y) = 0\)，
所以\begin{gather*}
	f'_x(0,y) = \lim_{x\to0} \frac{f(x,y) - f(0,y)}{x - 0}
	= \lim_{x\to0} \frac{y (x^2 - y^2)}{x^2 + y^2}
	= -y, \\
	f'_y(x,0) = \lim_{y\to0} \frac{f(x,y) - f(x,0)}{y - 0}
	= \lim_{y\to0} \frac{x (x^2 - y^2)}{x^2 + y^2}
	= x,
\end{gather*}
于是\[
	f''_{xy}(0,y) = \pdv{y} f'_x(0,y) = -1,
	\qquad
	f''_{yx}(x,0) = \pdv{x} f'_y(x,0) = 1.
\]
因此\(f''_{xy}(0,0) \cdot f''_{yx}(0,0) = (-1)\cdot1 = -1\).
\end{solution}
\end{example}
