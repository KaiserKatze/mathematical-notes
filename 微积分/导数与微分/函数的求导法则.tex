\section{函数的求导法则}
\subsection{函数的和、差、积、商的求导法则}
\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P88 定理1
%@see: 《数学分析（第二版 上册）》（陈纪修） P134 定理4.3.1
%@see: 《数学分析（第二版 上册）》（陈纪修） P135 定理4.3.2
%@see: 《数学分析（第二版 上册）》（陈纪修） P136 定理4.3.3
%@see: 《数学分析（第二版 上册）》（陈纪修） P137 推论
如果函数\(u\)和\(v\)都在点\(x\)具有导数，
那么它们的和、差、积、商（除分母为零的点外）都在点\(x\)具有导数，
且\begin{itemize}
	\item \((u \pm v)' = u' \pm v'\)；
	\item \((uv)' = u'v + uv'\)；
	\item \(\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2}\ (v \neq 0)\).
\end{itemize}
\begin{proof}
显然有
\begin{itemize}
\item 函数\(u\)和\(v\)都在\(x\)可导，
也就是说\(u'(x)\)和\(v'(x)\)都存在，
所以利用\cref{theorem:极限.极限的四则运算法则} 便得
\begin{align*}
	&[u(x) \pm v(x)]'
	=\lim_{\increment x\to0}
		\frac{[u(x+\increment x) \pm v(x+\increment x)]-[u(x) \pm v(x)]}{\increment x} \\
	&=\lim_{\increment x\to0} \frac{u(x+\increment x)-u(x)}{\increment x}
		\pm \lim_{\increment x\to0} \frac{v(x+\increment x)-v(x)}{\increment x} \\
	&=u'(x) \pm v'(x).
\end{align*}

\item 因为\(v\)在点\(x\)可导，所以\(v\)在点\(x\)连续，于是\begin{equation*}
	\lim_{\increment x\to0} v(x+\increment x)
	= v\left(x+\lim_{\increment x\to0} \increment x\right)
	= v(x).
\end{equation*}
因此
\begin{align*}
	&[u(x) v(x)]'
	= \lim_{\increment x\to0}
		\frac{u(x+\increment x) v(x+\increment x) - u(x) v(x)}{\increment x} \\
	&= \lim_{\increment x\to0} \left[
		\frac{u(x+\increment x) - u(x)}{\increment x} v(x+\increment x)
		+ u(x) \frac{v(x+\increment x) - v(x)}{\increment x}
	\right] \\
	&= \lim_{\increment x\to0} \frac{u(x+\increment x) - u(x)}{\increment x}
		\lim_{\increment x\to0} v(x+\increment x)
		+ u(x) \lim_{\increment x\to0} \frac{v(x+\increment x)-v(x)}{\increment x} \\
	&= u'(x) v(x) + u(x) v'(x).
\end{align*}

\item 因为函数\(u\)和\(v\)都在\(x\)连续，
所以利用\cref{theorem:极限.连续函数的极限1} 便得
\begin{align*}
	&\left[ \frac{u(x)}{v(x)} \right]'
	= \lim_{\increment x\to0} \frac1{\increment x} \left[
		\frac{u(x+\increment x)}{v(x+\increment x)}
		- \frac{u(x)}{v(x)}
	\right] \\
	&= \lim_{\increment x\to0}
		\frac{u(x+\increment x) v(x) - u(x) v(x+\increment x)}
			{v(x+\increment x) v(x) \increment x} \\
	&= \lim_{\increment x\to0}
		\frac{[u(x+\increment x) - u(x)] v(x) - u(x) [v(x+\increment x) - v(x)]}
			{v(x+\increment x) v(x) \increment x} \\
	&= \lim_{\increment x\to0}
		\frac1{v(x+\increment x) v(x)} \left[
		\frac{u(x+\increment x) - u(x)}{\increment x} v(x)
		- u(x) \frac{v(x+\increment x) - v(x)}{\increment x}
	\right] \\
	&= \frac{u'(x) v(x) - u(x) v'(x)}{v^2(x)}.
	\qedhere
\end{align*}
\end{itemize}
\end{proof}
\end{theorem}

\begin{corollary}
如果函数\(u=u(x)\)在点\(x\)具有导数，
那么\begin{equation*}
	(C u)' = C u'.
\end{equation*}
\end{corollary}

\begin{corollary}
如果函数\(u=u(x)\)、\(v=v(x)\)和\(w=w(x)\)都在点\(x\)具有导数，
那么\begin{equation*}
	(uvw)'
	= [(uv)w]'
	= (uv)'w + (uv)w'
	= u'vw + uv'w + uvw'.
\end{equation*}
\end{corollary}

\begin{example}%\label{example:导数.正切函数的导数}
求正切函数\(y=\tan x\)的导数.
\begin{solution}
\((\tan x)'
= \dv{x}(\frac{\sin x}{\cos x})
= \frac{(\sin x)' \cos x - \sin x (\cos x)'}{(\cos x)^2}
= \frac{\cos^2 x + \sin^2 x}{\cos^2 x}
= \frac1{\cos^2 x}
= \sec^2 x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.余切函数的导数}
求余切函数\(y = \cot x\)的导数.
\begin{solution}
\((\cot x)'
= \dv{x}(\frac{\cos x}{\sin x})
= \frac{(\cos x)' \sin x - \cos x (\sin x)'}{(\sin x)^2}
= \frac{-\sin^2 x-\cos^2 x}{\sin^2 x}
= -\frac1{\sin^2 x}
= -\csc^2 x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.正割函数的导数}
求正割函数\(y=\sec x\)的导数.
\begin{solution}
\((\sec x)'
= \dv{x}(\frac1{\cos x})
= \frac{-(\cos x)'}{(\cos x)^2}
= \frac{\sin x}{\cos^2 x}
= \sec x \tan x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.余割函数的导数}
求余割函数\(y=\csc x\)的导数.
\begin{solution}
\((\csc x)'
= \dv{x}(\frac1{\sin x})
= \frac{-(\sin x)'}{(\sin x)^2}
= \frac{-\cos x}{\sin^2 x}
= -\csc x \cot x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲正弦函数的导数}
求双曲正弦函数\(y = \sinh x\)的导数.
\begin{solution}
\((\sinh x)'
= \dv{x}(\frac{e^x - e^{-x}}2)
= \frac{(e^x)' - (e^{-x})'}2
= \frac{e^x + e^{-x}}2
= \cosh x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲余弦函数的导数}
求双曲余弦函数\(y = \cosh x\)的导数.
\begin{solution}
\((\cosh x)'
= \dv{x}(\frac{e^x + e^{-x}}2)
= \frac{(e^x)' + (e^{-x})'}2
= \frac{e^x - e^{-x}}2
= \sinh x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲正切函数的导数}
求双曲正切函数\(y = \tanh x\)的导数.
\begin{solution}
\((\tanh x)'
= \dv{x}(\frac{\sinh x}{\cosh x})
= \frac{(\sinh x)' \cosh x - \sinh x (\cosh x)'}{(\cosh x)^2}
= \frac{\cosh^2 x - \sinh^2 x}{\cosh^2 x}
= \sech^2 x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲余切函数的导数}
求双曲余切函数\(y = \coth x\)的导数.
\begin{solution}
\((\coth x)'
= \dv{x}(\frac{\cosh x}{\sinh x})
= \frac{(\cosh x)' \sinh x - \cosh x (\sinh x)'}{(\sinh x)^2}
= \frac{\sinh^2 x - \cosh^2 x}{\sinh^2 x}
= -\csch^2 x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲正割函数的导数}
求双曲正割函数\(y = \sech x\)的导数.
\begin{solution}
\((\sech x)'
= \dv{x}(\frac1{\cosh x})
= -\frac{(\cosh x)'}{(\cosh x)^2}
= -\frac{\sinh x}{\cosh^2 x}
= -\tanh x \sech x\).
\end{solution}
\end{example}

\begin{example}%\label{example:导数.双曲余割函数的导数}
求双曲余割函数\(y = \csch x\)的导数.
\begin{solution}
\((\csch x)'
= \dv{x}(\frac1{\sinh x})
= -\frac{(\sinh x)'}{(\sinh x)^2}
= -\frac{\cosh x}{\sinh^2 x}
= -\coth x \csch x\).
\end{solution}
\end{example}

\subsection{反函数的求导法则}
\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P90 定理2
%@see: 《数学分析（第二版 上册）》（陈纪修） P137 定理4.3.4
如果函数\(f\)在区间\((a,b)\)内连续、严格单调、可导并且\(f'(x)\neq0\)，
则它的反函数\(f^{-1}\)在区间\((\alpha,\beta)\)内可导，
且\begin{equation*}
	[f^{-1}(y)]'=\frac1{f'(x)},
\end{equation*}
其中\(\alpha=\min\{f(a^+),f(b^-)\},
\beta=\max\{f(a^+),f(b^-)\}\).
\begin{proof}
因为函数\(f\)在\((a,b)\)上连续且严格单调，
由\hyperref[theorem:极限.连续函数的极限2]{反函数连续性定理}可知，
它的反函数\(f^{-1}\)在\((\alpha,\beta)\)上存在、连续且严格单调.
这时\begin{equation*}
	\increment y = f(x + \increment x) - f(x) \neq 0
	\iff
	\increment x = f^{-1}(y + \increment y) - f^{-1}(y) \neq 0,
\end{equation*}
并且当\(\increment y \to 0\)时有\(\increment x \to 0\).
因此\begin{align*}
	[f^{-1}(y)]'
	&= \lim_{\increment y \to 0}
		\frac{f^{-1}(y + \increment y) - f^{-1}(y)}{\increment y} \\
	&= \lim_{\increment x \to 0}
		\frac{\increment x}{f(x + \increment x) - f(x)} \\
	&= \left[
		\lim_{\increment x \to 0}
		\frac{f(x + \increment x) - f(x)}{\increment x}
	\right]^{-1}
	= \frac1{f'(x)}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

简单地说，反函数\(y=f^{-1}(x)\)的导数等于直接函数\(x=f(y)\)导数的倒数.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P91 例6
求\(y=\arcsin x\)的导数.
\begin{solution}
由直接函数\(x=\sin y\)，
\(x\)的取值范围是\(-1 \leq x \leq 1\)，
求导得\begin{equation*}
	\dv{x}{y}
	= \dv{y} \sin y
	= \cos y,
\end{equation*}
则\begin{equation*}
	\dv{y}{x}
	= \left(\dv{x}{y}\right)^{-1}
	= \frac1{\cos y}.
\end{equation*}
利用三角恒等式得到\begin{equation*}
	\cos^2 y = 1 - \sin^2 y,
\end{equation*}
开方得\begin{equation*}
	\cos y = \pm\sqrt{1 - \sin^2 y}.
\end{equation*}
现在我们要决定\(\cos y\)的符号.
因为反正弦函数\(y = \arcsin x\)的值域为\(-\frac\pi2 \leq y \leq \frac\pi2\)，
所以\(0 \leq \cos y \leq 1\)，
于是\(\cos y\)是非负的，
即\begin{equation*}
	\cos y
	= \sqrt{1 - \sin^2 y}
	= \sqrt{1 - x^2}.
\end{equation*}
最后，我们还要使\(\cos y\)的倒数有意义，
这就要求\(\sqrt{1-x^2}\neq0\)，
即\(x\neq\pm1\)必须成立.
考虑到\(-1 \leq x \leq 1\)，
\(x\)的取值范围就只能是\(-1 < x < 1\).
那么\begin{equation*}
	(\arcsin x)' = \frac1{\sqrt{1 - x^2}}
	\quad(-1<x<1).
\end{equation*}
\end{solution}
\end{example}

类似地，可得\begin{equation*}
	(\arccos x)' = \frac{-1}{\sqrt{1 - x^2}}
	\quad(-1<x<1).
\end{equation*}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P91 例7
求反正切函数\(y=\arctan x\)的导数.
\begin{solution}
由直接函数\(x=\tan y\)，有\begin{equation*}
	\dv{x}{y}
	= \dv{y} \tan y
	= \sec^2 y
	= 1 + \tan^2 y
	= 1 + x^2,
\end{equation*}
那么\begin{equation*}
	(\arctan x)' = \frac1{1+x^2}.
\end{equation*}
\end{solution}
\end{example}

类似地，可得反余切函数的导数为\begin{equation*}
	(\arccot x)' = -\frac1{1+x^2}.
\end{equation*}

\begin{example}
求反正割函数\(y=\arcsec x\)的导数.
\begin{solution}
由直接函数\(x=\sec y\)，有\begin{equation*}
	\dv{x}{y}
	= \sec y \tan y
	= x \sqrt{x^2-1},
\end{equation*}
那么\begin{equation*}
	(\arcsec x)' = \frac1{x \sqrt{x^2-1}}.
\end{equation*}
\end{solution}
\end{example}

类似地，可得反余割函数的导数为\begin{equation*}
	(\arccsc x)' = -\frac1{x \sqrt{x^2-1}}.
\end{equation*}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P92 例8
利用指数函数的导数公式\((a^x)' = a^x \ln a\)
计算对数函数\(y=\log_a x\)的导数，
其中\(a>0,a\neq1\).
\begin{solution}
由直接函数\(x=a^y\)，有\begin{equation*}
	\dv{x}{y} = \dv{y} a^y = a^y \ln a \neq 0,
\end{equation*}
那么\begin{equation*}
	(\log_a x)' = \frac1{a^y \ln a} = \frac1{x \ln a}.
\end{equation*}
\end{solution}
\end{example}

\begin{example}
求\(y = \arcsec x\)的导数.
\begin{solution}
由直接函数\(x=\sec y\)，有\begin{equation*}
	\dv{x}{y}
	= \sec y \tan y
	= \sec y \sqrt{\sec^2 y-1}
	= x \sqrt{x^2-1},
\end{equation*}
那么\begin{equation*}
	(\arcsec x)'
	= \frac1{x \sqrt{x^2-1}}.
\end{equation*}
\end{solution}
\end{example}

类似地，可得\begin{equation*}
	(\arccsc x)'
	= -\frac1{x \sqrt{x^2-1}}.
\end{equation*}

\begin{example}\label{example:导数.反双曲正弦函数的导数}
求反双曲正弦函数\(y = \arsinh x\)的导数.
\begin{solution}
由直接函数\(x = \sinh y = \frac{e^y - e^{-y}}2\)，有\begin{equation*}
	\dv{x}{y}
	= \cosh y
	= \sqrt{1 + \sinh^2 y}
	= \sqrt{1 + x^2}.
\end{equation*}
那么\begin{equation*}
	(\arsinh x)' = \frac1{\sqrt{1+x^2}}.
\end{equation*}
\end{solution}
\end{example}
\begin{remark}
由于\(\arsinh x = \ln(x+\sqrt{x^2+1})\)，
所以我们也可以直接求导得\begin{equation*}
	(\arsinh x)' = \frac{1+\frac{2x}{2\sqrt{x^2+1}}}{x+\sqrt{x^2+1}}
	= \frac1{\sqrt{1+x^2}}.
\end{equation*}
%@Mathematica: D[Log[x + Sqrt[1 + x^2]], x] // Simplify
\end{remark}

\begin{example}
求反双曲余弦函数\(y = \arcosh x\)的导数.
\begin{solution}
由直接函数\(x = \cosh y\)，有\begin{equation*}
	\dv{x}{y}
	= \sinh y
	= \sqrt{\cosh^2 y - 1}
	= \sqrt{x^2 - 1}
	\quad(x\geq1).
\end{equation*}
那么\begin{equation*}
	(\arcosh x)' = \frac1{\sqrt{x^2-1}}
	\quad(x>1).
\end{equation*}
\end{solution}
\end{example}

\begin{example}
求反双曲正切函数\(y = \artanh x\)的导数.
\begin{solution}
由直接函数\(x = \tanh y\)，有\begin{equation*}
	\dv{x}{y}
	= \sech^2 y
	= 1 - \tanh^2 y
	= 1 - x^2.
\end{equation*}
那么\begin{equation*}
	(\artanh x)' = \frac1{1-x^2}
	\quad(\abs{x}<1).
\end{equation*}
\end{solution}
\end{example}

\begin{example}
求反双曲余切函数\(y = \arcoth x\)的导数.
\begin{solution}
由直接函数\(x = \coth y\)，有\begin{equation*}
	\dv{x}{y} = -\csch^2 y
	= 1 - \coth^2 y
	= 1 - x^2.
\end{equation*}
那么\begin{equation*}
	(\arcoth x)' = \frac1{1-x^2}
	\quad(\abs{x}>1).
\end{equation*}
\end{solution}
\end{example}

\begin{example}%野题
设函数\begin{equation*}
	f(x) = \frac{\cos x}{3+\sin x}
	\quad(0<x<\pi).
\end{equation*}
求\(f\)的反函数\(f^{-1}\)在点\(x=0\)的导数.
\begin{solution}
首先计算\(f^{-1}(0)\).
解方程\(f(x) = 0\ (0<x<\pi)\)得\(x=\pi/2\).
于是\(f^{-1}\)在点\(x=0\)的导数
就是\(f\)在点\(x=\pi/2\)的导数的倒数，
即\begin{equation*}
	\eval{\dv{f^{-1}}{x}}_{x=0}
	= \left( \eval{\dv{f}{x}}_{x=\pi/2} \right)^{-1},
\end{equation*}
其中\begin{equation*}
	\eval{\dv{f}{x}}_{x=\pi/2}
	= \lim_{x\to\pi/2} \frac{f(x) - f(\pi/2)}{x - \pi/2}
	= \lim_{x\to\pi/2} \frac1{3+\sin x} \cdot \frac{\cos x}{x-\pi/2}
	= \frac14 \lim_{x\to\pi/2} \frac{-\sin x}{1}
	= -\frac14,
\end{equation*}
于是\begin{equation*}
	\eval{\dv{f^{-1}}{x}}_{x=0}
	= -4.
\end{equation*}
\end{solution}
\end{example}

\subsection{复合函数的求导法则}
\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P92 定理3
%@see: 《数学分析（第二版 上册）》（陈纪修） P142 定理4.4.1（复合函数求导法则）
如果函数\(u=g(x)\)在点\(x\)可导，
而函数\(y=f(u)\)在点\(u=g(x)\)可导，
则复合函数\(y=f[g(x)]\)在点\(x\)可导，
且其导数为\begin{equation*}
	\dv{y}{x} = f'(u) \cdot g'(x)
	\quad\text{或}\quad
	\dv{y}{x} = \dv{y}{u} \cdot \dv{u}{x}.
\end{equation*}
\end{theorem}

复合函数的求导法则可以推广到多个中间变量的情形.
设\(y=f(u)\)，\(u=\phi(v)\)，\(v=\psi(x)\)，
则复合函数\(y=f\{\phi[\psi(x)]\}\)的导数为\begin{equation*}
	\dv{y}{x} = \dv{y}{u} \cdot \dv{u}{v} \cdot \dv{v}{x}.
\end{equation*}

上述复合函数的求导公式也称作\DefineConcept{链式法则}（chain rule）.

\subsection{行列式函数的求导法则}
\begin{theorem}
\def\f#1{f_{#1}(x)}%
\def\g#1{f_{#1}'(x)}%
设函数\begin{equation*}
	f(x) = \begin{vmatrix}
		\f{11} & \f{12} & \dots & \f{1n} \\
		\vdots & \vdots & & \vdots \\
		\f{i1} & \f{i2} & \dots & \f{in} \\
		\vdots & \vdots & & \vdots \\
		\f{n1} & \f{n2} & \dots & \f{nn}
	\end{vmatrix}
\end{equation*}的任意分量函数都可导（即\(\f{ij}\ (i,j=1,2,\dotsc,n)\)可导），
那么\(f(x)\)可导，
且\begin{equation*}
	\dv{x} f(x)
	= \sum_{i=1}^n \begin{vmatrix}
		\f{11} & \f{12} & \dots & \f{1n} \\
		\vdots & \vdots & & \vdots \\
		\g{i1} & \g{i2} & \dots & \g{in} \\
		\vdots & \vdots & & \vdots \\
		\f{n1} & \f{n2} & \dots & \f{nn}
	\end{vmatrix}.
\end{equation*}
\end{theorem}

\subsection{对数导数}
\begin{definition}
设函数\(f\colon I \to \mathbb{R}, f \in D(I)\)，
我们把\begin{equation*}
	\dv{x} \ln f(x)
\end{equation*}称为“函数\(f\)的\DefineConcept{对数导数}（logarithmic derivative）”.
%@see: https://mathworld.wolfram.com/LogarithmicDerivative.html
\end{definition}
