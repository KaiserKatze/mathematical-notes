\section{高阶导数}
\subsection{函数的\texorpdfstring{\(n\)}{n}阶导数}
%@see: 《高等数学（第六版 上册）》 P99
%@see: 《数学分析（第二版 上册）》（陈纪修） P154
设\(X\subseteq\mathbb{R}\)，
函数\(f\colon X\to\mathbb{R}\)在点\(x_0\)可导，
且\(f\)的导数\(f'\)也在\(x_0\)可导，
即极限\[
	\lim_{h\to0} \frac{f'(x_0+h) - f'(x_0)}{h}
\]存在，
则称“函数\(f\)在点\(x_0\)~\DefineConcept{二阶可导}（twice differentiable）”
“\(f\)在点\(x_0\)的二阶导数存在”
“\(f\)在点\(x_0\)具有二阶导数”，
把\(f'\)的导数称为“函数\(f\)的\DefineConcept{二阶导数}（second derivative）”，
记作\[
	y''
	\quad\text{或}\quad
	\dv[2]{y}{x},
\]
即\[
	\dv[2]{y}{x}
	\defeq
	\dv{x}(\dv{f}{x}).
\]
相对地，把\(f\)的导数\(f'\)称为
“函数\(f\)的\DefineConcept{一阶导数}（first derivative）”.

类似地，
如果函数\(f\)的二阶导数\(f''\)在点\(x_0\)可导，
则称“函数\(f\)在点\(x_0\)~\DefineConcept{三阶可导}”
“\(f\)在点\(x_0\)的三阶导数存在”
“\(f\)在点\(x_0\)具有三阶导数”，
把\(f''\)的导数称为“函数\(f\)的\DefineConcept{三阶导数}（third derivative）”，
记作\[
	y'''
	\quad\text{或}\quad
	\dv[3]{y}{x}.
\]

如果函数\(f\)的三阶导数\(f'''\)在点\(x_0\)可导，
则称“函数\(f\)在点\(x_0\)~\DefineConcept{四阶可导}”
“\(f\)在点\(x_0\)的四阶导数存在”
“\(f\)在点\(x_0\)具有四阶导数”，
把\(f'''\)的导数称为“函数\(f\)的\DefineConcept{四阶导数}（fourth derivative）”，
记作\[
	y^{(4)}
	\quad\text{或}\quad
	\dv[4]{y}{x}.
\]

我们把二阶以上的导数统称\DefineConcept{高阶导数}（higher order derivative）.

%@see: 《数学分析（第二版 上册）》（陈纪修） P155 定义4.5.1
如果函数\(f\)的\(n-1\)阶导数\(f^{(n-1)}\)在点\(x_0\)可导，
则称“函数\(f\)在点\(x_0\)~\DefineConcept{\(n\)阶可导}”
“\(f\)在点\(x_0\)的\(n\)阶导数存在”
“\(f\)在点\(x_0\)具有\(n\)阶导数”，
把\(f^{(n-1)}\)的导数称为
“函数\(f\)的~\DefineConcept{\(n\)阶导数}（n-th derivative）”，
记作\[
	y^{(n)}
	\quad\text{或}\quad
	\dv[n]{y}{x},
\]
即\begin{equation}\label{equation:高阶导数.高阶导数的递归定义}
	\dv[n]{y}{x}
	\defeq
	\dv[n-1]{y}{x}
	\quad(n\geq2).
\end{equation}
我们把\cref{equation:高阶导数.高阶导数的递归定义} 称为~\DefineConcept{\(n\)阶导数的递归定义}.

由于当函数\(f\)在点\(x_0\)具有\(n\)阶导数时，
它的小于\(n\)阶的导数都存在，
于是称“\(f\)具有直到\(n\)阶导数”.

特别地，规定：\begin{equation}
	f^{(0)}(x) = f(x).
\end{equation}

和\cref{definition:导数.函数在开区间内可导,definition:导数.函数在闭区间上可导} 一样，
我们可以定义函数在某个区间上的可导性：
\begin{definition}
如果函数\(f\colon(a,b)\to\mathbb{R}\)在开区间\((a,b)\)内的每一个点\(n\)阶可导，
就称“函数\(f\)在开区间\((a,b)\)内\(n\)阶可导”.
\end{definition}
\begin{definition}
如果函数\(f\colon[a,b]\to\mathbb{R}\)在开区间\((a,b)\)内\(n\)阶可导，
且在点\(a\)的右\(n\)阶导数\(f^{(n)}_+(a)\)及在点\(b\)的左\(n\)阶导数\(f^{(n)}_-(b)\)都存在，
就说“函数\(f\)在闭区间\([a,b]\)上\(n\)阶可导”.
\end{definition}

\begin{proposition}
如果函数\(f\)在点\(x_0\)具有\(n\ (n\geq2)\)阶导数，
则\(f\)在点\(x_0\)的某个邻域内\(n-1\)阶可导.
\begin{proof}
根据定义，函数\(f\)在点\(x_0\)具有\(n\)阶导数，
当且仅当函数\(f\)的\(n-1\)阶导数在点\(x_0\)可导，
即极限\[
	\lim_{h\to0} \frac{f^{(n-1)}(x_0+h) - f^{(n-1)}(x_0)}{h}
\]存在且有限，
这就要求在\(x_0\)的某个邻域内表达式\(f^{(n-1)}(x_0+h)\)是有定义的，
因此\(f\)必定在点\(x_0\)的某个邻域内\(n-1\)阶可导.
\end{proof}
\end{proposition}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P155 例4.5.1
求\(y = e^x\)的\(n\)阶导函数.
\begin{solution}
由于\[
	(e^x)' = e^x,
\]
显然\[
	(e^x)'
	= (e^x)''
	= \dotsb
	= (e^x)^{(n)}
	= e^x.
\]
\end{solution}
\end{example}
类似可以得到\[
	(a^x)^{(n)}
	= a^x \ln^n a.
\]

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P155 例4.5.2
求\(y = \sin x\)和\(y = \cos x\)的\(n\)阶导函数.
\begin{solution}
因为\[
	(\sin x)' = \cos x
	= \sin\left(x + \frac\pi2\right),
\]
利用复合函数的求导法则\[
	(\sin x)'' = \dv{x} \sin\left(x+\frac\pi2\right)
	= \cos\left(x+\frac\pi2\right)
	= \sin\left(x+\frac{2\pi}2\right),
\]
以此类推，用数学归纳法容易证明\[
	(\sin x)^{(n)}
	= \sin\left(x+\frac{n\pi}2\right).
\]
\end{solution}
\end{example}
同理，\(y = \cos x\)的\(n\)阶导数为\[
	(\cos x)^{(n)}
	= \cos\left(x+\frac{n\pi}2\right).
\]

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P156 例4.5.3
求幂函数\(y = x^m\ (\text{$m$是正整数})\)的\(n\)阶导函数.
\begin{solution}
由幂函数的求导公式可得\[
	(x^m)' = m x^{m-1},
	\qquad
	(x^m)'' = m(m-1) x^{m-2},
\]
递归可得\begin{equation}
	(x^m)^{(n)} = \left\{ \begin{array}{cl}
		m(m-1)\dotsm(m-n+1) x^{m-n}, & n \leq m, \\
		0, & n > m.
	\end{array} \right.
\end{equation}
特别地，成立\begin{equation}
	(x^m)^{(m)} = m!.
\end{equation}
\end{solution}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P156 例4.5.4
求\(y = \ln x\)的\(n\)阶导函数.
\begin{solution}
因为\[
	(\ln x)' = \frac1x = x^{-1},
\]
于是\begin{gather*}
	(\ln x)'' = (x^{-1})' = -x^{-2}, \\
	(\ln x)''' = (-x^{-2})' = 2x^{-3},
\end{gather*}
递归可得\begin{gather}
	(\ln x)^{(n)}
	= (-1)^{n-1} \frac{(n-1)!}{x^n}, \\
	\left(\frac1x\right)^{(n)}
	= (\ln x)^{(n+1)}
	= (-1)^n \frac{n!}{x^{n+1}}.
\end{gather}
\end{solution}
\end{example}

\begin{example}
%@credit: {8b6edada-f2fd-4ae5-9020-eb533149a54c},{ce603838-a24d-4616-9395-d7b223e8cb72}
设函数\(f\)在点\(x=0\)具有\(n\)阶导数.
证明：\begin{equation}\label{equation:高阶导数.高阶导数与差分的联系}
	f^{(n)}(0)
	= \lim_{h\to0} \frac1{h^n} \sum_{k=0}^n (-1)^k C_n^k f((n-k)h).
\end{equation}
%TODO proof 狗狗说可以用归纳法证明
% \begin{proof}
% 当\(n=1\)时，\cref{equation:高阶导数.高阶导数与差分的联系} 成为\begin{equation*}
% 	f'(0) = \lim_{h\to0} \frac{f(h) - f(0)}h,
% \end{equation*}
% 它正是函数\(f\)在点\(x=0\)的一阶导数的定义式，自然成立.
% 假设\begin{equation*}
% 	f^{(n-1)}(0)
% 	= \lim_{h\to0} \frac1{h^{n-1}} \sum_{k=0}^{n-1} (-1)^k C_{n-1}^k f((n-1-k)h)
% \end{equation*}成立，
% 那么\begin{align*}
% 	f^{(n)}(0)
% 	% = \lim_{h\to0} \frac1{h^n} \sum_{k=0}^n (-1)^k C_n^k f((n-k)h).
% 	&= \lim_{x\to0} \frac{f^{(n-1)}(x) - f^{(n-1)}(0)}{x}
% \end{align*}
% \end{proof}
\end{example}

\subsection{高阶导数的运算规则}
\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P156 定理4.5.1
设\(f\)和\(g\)都是\(n\)阶可导函数，
则对任意常数\(c_1\)和\(c_2\)，
它们的线性组合\(c_1 f + c_2 g\)也是\(n\)阶可导的，
且满足\begin{equation}
	(c_1 f + c_2 g)^{(n)}
	= c_1 f^{(n)} + c_2 f^{(n)}.
\end{equation}
\end{theorem}

这个结论可以推广到有限个函数线性组合的情况：\begin{equation}
	\left[ \sum_{i=1}^n c_i f_i \right]^{(n)}
	= \sum_{i=1}^n c_i f_i^{(n)}.
\end{equation}

\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P157 定理4.5.2（Leibniz公式）
设\(f\)和\(g\)都是\(n\)阶可导函数，
则\begin{equation}\label{equation:导数与微分.莱布尼茨公式}
	(f \cdot g)^{(n)}
	= \sum_{k=0}^n C_n^k f^{(n-k)} g^{(k)},
\end{equation}
其中\(C_n^k \equiv \frac{n!}{k! (n-k)!}\)是组合系数.
%TODO proof
\end{theorem}
\cref{equation:导数与微分.莱布尼茨公式} 称为\DefineConcept{莱布尼茨公式}.

\subsection{高阶可导函数族}
\begin{definition}\label{definition:函数族.n阶可导函数族}
由区间\(I\)上全部的\(n\)阶可导函数组成的集合，
称作\(n\)阶\DefineConcept{可导函数族}，
记作\(D^n(I)\)，
即\[
	D^n(I)
	\defeq
	\Set*{
		f\in\mathbb{R}^I
		\given
		(\forall i\in[0,n-1]\cap\mathbb{Z})
		[f^{(i)} \in D(I)]
	}.
\]
\end{definition}

\begin{definition}\label{definition:函数族.n阶连续可导函数族}
由区间\(I\)上全部的\(n\)阶连续可导函数组成的集合，
称作\(n\)阶\DefineConcept{连续可导函数族}，
记作\(C^n(I)\)，即\[
	C^n(I)
	\defeq
	\Set*{
		f\in\mathbb{R}^I
		\given
		[f\in D^n(I)]
		\land
		[f^{(n)}\in C(I)]
	}.
\]
%@see: https://mathworld.wolfram.com/C-kFunction.html
\end{definition}

\begin{theorem}
如果函数\(f(x)\)在点\(x\)处具有\(n\)阶导数，
那么\(f(x)\)在点\(x\)的某一邻域内必定具有一切低于\(n\)阶的导数.
\end{theorem}
换句话说，\(C(I) \supseteq
D(I) = D^1(I) \supseteq
C^1(I) \supseteq
D^2(I) \supseteq
C^2(I) \supseteq
D^3(I) \supseteq
\dotsb\).

\subsection{光滑函数}
\begin{definition}\label{definition:函数族.光滑函数族}
定义：\begin{gather*}
	D^\infty (I) \defeq \bigcap_{n\geq1} D^n(I), \\
	C^\infty (I) \defeq \bigcap_{n\geq1} C^n(I).
\end{gather*}

称函数\(f \in C^\infty (I)\)为\(I\)上的\DefineConcept{光滑函数}（smooth function）.
\end{definition}

\begin{property}\label{theorem:函数族.光滑函数族的性质1}
\(D^\infty (I) = C^\infty (I)\).
\end{property}
