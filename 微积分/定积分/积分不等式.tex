\section{积分不等式}
%@see: https://loss.math.gatech.edu/10springtea/Lecture1.pdf
%@see: https://www2.math.upenn.edu/~brweber/Courses/2011/Math361/Notes/YMandH.pdf
%@see: https://pi.math.cornell.edu/~erin/analysis/lectures.pdf

\subsection{杨格不等式}
\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 10.
%@see: 《数学分析教程 （第3版 上册）》（史济怀） P305 例7
设\(f\)是在\([0,+\infty)\)上严格单调增加的连续函数，且\(f(0)=0\)，\(f^{-1}\)是\(f\)的反函数，
则对于\(\forall a,b>0\)有\begin{equation}
	\int_0^a f(x) \dd{x} + \int_0^b f^{-1}(y) \dd{y} \geq ab.
\end{equation}
当且仅当\(b = f(a)\)时上式取“\(=\)”号.
\begin{proof}
易知\(f^{-1}\)是在\([0,f(+\infty))\)上严格单调增加的连续函数，且\(f^{-1}(0) = 0\).
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			xmin=0,xmax=2,
			ymin=0,ymax=3,
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			enlarge x limits=0.1,
			enlarge y limits=0.1,
			x label style={at={(ticklabel* cs:1.00)}, inner sep=5pt, anchor=south},
			y label style={at={(ticklabel* cs:1.00)}, inner sep=2pt, anchor=west},
		]
			\addplot[color=blue,samples=50,smooth,domain=0:2]{x^2};
			\draw(1.5,1)--(0,1);
			\draw[dashed](1,1)--(1,0);
			\draw(1.5,0)--(1.5,2.25);
		\end{axis}
	\end{tikzpicture}\hspace{1cm}\begin{tikzpicture}
		\begin{axis}[
			xmin=0,xmax=2,
			ymin=0,ymax=3,
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			enlarge x limits=0.1,
			enlarge y limits=0.1,
			x label style={at={(ticklabel* cs:1.00)}, inner sep=5pt, anchor=south},
			y label style={at={(ticklabel* cs:1.00)}, inner sep=2pt, anchor=west},
		]
			\addplot[color=blue,samples=50,smooth,domain=0:2]{x^2};
			\draw[dashed](1,1)--(0,1);
			\draw(0,2)--({sqrt(2)},2);
			\draw(1,2)--(1,0);
		\end{axis}
	\end{tikzpicture}
	\caption{}
	\label{figure:积分不等式.杨格不等式}
\end{figure}
观察\cref{figure:积分不等式.杨格不等式} 中图形的面积关系即可确认不等式的正确性.
\end{proof}
\end{theorem}

\subsection{赫尔德不等式}
\begin{theorem}\label{theorem:定积分.赫尔德不等式}
%@see: 《数学分析（第二版 上册）》（陈纪修） P291 例7.2.2（Holder不等式）
%@see: 《数学分析教程 （第3版 上册）》（史济怀） P307 练习题7.3 3.
设\(f\)和\(g\)都在\([a,b]\)上连续，正数\(p,q\)满足\(\frac1p+\frac1q=1\)，
则\begin{equation}
	\int_a^b \abs{f(x)~g(x)} \dd{x}
	\leq \left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}
	\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q},
\end{equation}
当且仅当\(\abs{f}^p = B \abs{g}^q\ (\text{$B$是常数})\)时取“\(=\)”号.
\begin{proof}
当\(f(x) \equiv 0\)或\(g(x) \equiv 0\)时，上式显然成立.

当\(f(x) \not\equiv 0\)且\(g(x) \not\equiv 0\)时，
令\begin{equation*}
	\phi(x) = \frac{\abs{f(x)}}{\left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}},
	\qquad
	\psi(x) = \frac{\abs{g(x)}}{\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q}},
	\quad
	x\in[a,b].
\end{equation*}
由\hyperref[example:函数图像的绘制.杨格不等式]{杨格不等式}可得\begin{equation*}
	\phi(x)~\psi(x)
	\leq \frac1p \phi^p(x) + \frac1q \psi^q(x),
\end{equation*}
即\begin{equation*}
	\frac{\abs{f(x)~g(x)}}{
		\left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}
		\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q}
	}
	\leq \frac{\abs{f(x)}^p}{p \int_a^b \abs{f(x)}^p \dd{x}}
	+ \frac{\abs{g(x)}^q}{q \int_a^b \abs{g(x)}^q \dd{x}},
	\quad x\in[a,b].
\end{equation*}
对上式两边在\([a,b]\)上求积分，利用定积分的性质得\begin{equation*}
	\frac{
		\int_a^b \abs{f(x)~g(x)} \dd{x}
	}{
		\left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}
		\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q}
	}
	\leq \frac{\int_a^b \abs{f(x)}^p \dd{x}}{p \int_a^b \abs{f(x)}^p \dd{x}}
	+ \frac{\int_a^b \abs{g(x)}^q \dd{x}}{q \int_a^b \abs{g(x)}^q \dd{x}}
	= \frac1p + \frac1q = 1.
\end{equation*}
在上式两边同乘以\(\left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}
\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q}\)，
便得\begin{equation*}
	\int_a^b \abs{f(x)~g(x)} \dd{x}
	\leq \left[\int_a^b \abs{f(x)}^p \dd{x}\right]^{\frac1p}
	\left[\int_a^b \abs{g(x)}^q \dd{x}\right]^{\frac1q}.
	\qedhere
\end{equation*}
%TODO 没有证明取等条件
\end{proof}
\end{theorem}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P292 例7.2.3
设函数\(f \in D^2[a,b]\)，且\(f\left(\frac{a+b}2\right) = 0\).
记\(M = \sup_{a \leq x \leq b} \abs{f''(x)}\).
证明：\begin{equation*}
	\int_a^b f(x) \dd{x}
	\leq \frac{M(b-a)^3}{24}.
\end{equation*}
\begin{proof}
记\(c=\frac{a+b}2\).
函数\(f\)在\(x=c\)的带有拉格朗日余项的泰勒公式为\begin{align*}
	f(x) &= f(c) + f'(c) (x-c) + \frac12 f''(\xi) (x-c)^2 \\
	&= f'(c) (x-c) + \frac12 f''(\xi) (x-c)^2,
\end{align*}
其中\(a \leq \xi \leq b\).
对等式两边求积分，利用\(\int_a^b (x-c) \dd{x} = 0\)，得到\begin{align*}
	\int_a^b f(x) \dd{x}
	&= f'(c) \int_a^b (x-c) \dd{x} + \frac12 \int_a^b f''(\xi) (x-c)^2 \dd{x} \\
	&= \frac12 \int_a^b f''(\xi) (x-c)^2 \dd{x},
\end{align*}
于是\begin{align*}
	\abs{\int_a^b f(x) \dd{x}}
	&\leq \frac12 \int_a^b \abs{f''(\xi) (x-c)^2} \dd{x}
		\tag{\cref{theorem:定积分.定积分性质5推论2}} \\
	&\leq \frac{M}2 \int_a^b (x-c)^2 \dd{x}
		\tag{\hyperref[theorem:定积分.赫尔德不等式]{赫尔德不等式}} \\
	&= \frac{M(b-a)^3}{24}.
	\qedhere
\end{align*}
\end{proof}
\end{example}

\subsection{柯西--施瓦茨不等式}
我们首先证明被积函数\(f,g\)都是连续函数的情形.
\begin{theorem}
设函数\(f,g \in C[a,b]\)，
则\begin{equation}
	\left[ \int_a^b f(x)~g(x) \dd{x} \right]^2
	\leq
	\int_a^b f^2(x) \dd{x} \int_a^b g^2(x) \dd{x}.
\end{equation}
\begin{proof}
%@see: https://www.bilibili.com/video/BV1t2x4e2Eqw/
令\(F(t) = \int_a^t f^2(x) \dd{x} \int_a^t g^2(x) \dd{x}
- \left[ \int_a^t f(x)~g(x) \dd{x} \right]^2\)，
易见\(F(a) = 0\)，
且\begin{align*}
	F'(t) &= f^2(t) \int_a^t g^2(x) \dd{x}
	+ g^2(t) \int_a^t f^2(x) \dd{x}
	- 2 f(t)~g(t) \int_a^t f(x)~g(x) \dd{x} \\
	&= \int_a^t (f(t)~g(x)-f(x)~g(t))^2 \dd{x}
	\geq 0
	\quad(t \geq a),
\end{align*}
于是\(F\)在\([a,b]\)上单调增加，且\begin{equation*}
	F(b) = \int_a^b f^2(x) \dd{x} \int_a^b g^2(x) \dd{x}
	- \left[ \int_a^b f(x)~g(x) \dd{x} \right]^2
	\geq F(a) = 0.
	\qedhere
\end{equation*}
\end{proof}
\end{theorem}

接下来我们把条件弱化为被积函数\(f,g\)只是黎曼可积函数.
\begin{theorem}[柯西--施瓦茨不等式]\label{theorem:定积分.柯西--施瓦茨不等式}
%@see: 《数学分析习题课讲义（第2版 上册）》（谢惠民、恽自求、易法槐、钱定边） P346 命题11.2.2
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 12. (1)
%@see: 《数学分析教程 （第3版 上册）》（史济怀） P248 练习题6.2 10.
设函数\(f,g \in R[a,b]\)，
则\begin{equation}\label{equation:定积分.柯西--施瓦茨不等式}
	\left[ \int_a^b f(x)~g(x) \dd{x} \right]^2
	\leq
	\int_a^b f^2(x) \dd{x} \int_a^b g^2(x) \dd{x}.
\end{equation}
若函数\(f,g \in C[a,b]\)，
则上式“\(=\)”当且仅当“存在不全为零的常数\(\alpha\)和\(\beta\)，
使得\(\alpha f(x) = \beta g(x)\)”成立.
\begin{proof}
因为对任意实数\(t\)，
总有\begin{align*}
	&\hspace{-20pt}
	\int_a^b f^2(x) \dd{x}
	+ 2t \int_a^b f(x)~g(x) \dd{x}
	+ t^2 \int_a^b g^2(x) \dd{x} \\
	&= \int_a^b [ f(x) + t g(x) ]^2 \dd{x}
	\geq \int_a^b 0 \dd{x}
	= 0
	\tag1
\end{align*}
成立.
将(1)式视作关于\(t\)的一元二次多项式，
假设二次项系数\(\int_a^b g^2(x) \dd{x} > 0\)，
由于该多项式是非负的，故其判别式非正，即\begin{equation*}
	\left[ 2 \int_a^b f(x)~g(x) \dd{x} \right]^2
	- 4 \int_a^b g^2(x) \dd{x} \int_a^b f^2(x) \dd{x}
	\leq 0,
\end{equation*}移项并化简，
可得\cref{equation:定积分.柯西--施瓦茨不等式}.
如果二次项系数\(\int_a^b g^2(x) \dd{x} = 0\)，
那么\(g\)在其所有连续点上恒等于零.
由于可积函数的连续点稠密，
因此可以推出积分\(\int_a^b f(x)~g(x) \dd{x} = 0\)，
从而有\cref{equation:定积分.柯西--施瓦茨不等式} 成立.
\end{proof}
%\cref{theorem:不等式.柯西不等式}
\end{theorem}
\begin{remark}
\cref{theorem:定积分.柯西--施瓦茨不等式}
是\cref{theorem:定积分.赫尔德不等式} 当\(p=q=2\)时的特殊情形.
\end{remark}

\subsection{闵可夫斯基不等式}
\begin{theorem}[闵可夫斯基不等式]\label{theorem:定积分.闵可夫斯基不等式}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 12. (2)
设函数\(f,g \in C[a,b]\)，
则\begin{equation}\label{equation:定积分.闵可夫斯基不等式}
	\sqrt{ \int_a^b [f(x)+g(x)]^2 \dd{x} }
	\leq \sqrt{ \int_a^b [f(x)]^2 \dd{x} }
			+ \sqrt{ \int_a^b [g(x)]^2 \dd{x} }.
\end{equation}
%TODO proof
\end{theorem}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 13.
设函数\(f,g\)都在\([a,b]\)上连续，
且\(f(x)\geq0,
g(x)>0\).
证明：\begin{equation*}
	\lim_{n\to\infty} \left[ \int_a^b f^n(x)~g(x) \dd{x} \right]^{\frac1n}
	= \max_{a \leq x \leq b} f(x).
\end{equation*}
%TODO proof
\end{example}

\subsection{欧庇尔不等式}
\begin{theorem}[欧庇尔不等式]\label{theorem:定积分.欧庇尔不等式}
%@see: https://www.bilibili.com/video/BV18a411h7JA/
设函数\(f(x)\)在\([a,b]\)上有连续导数，\(f(a)=f(b)=0\)，
则\begin{equation}\label{equation:定积分.欧庇尔不等式}
	\int_a^b \abs{f(x) f'(x)} \dd{x}
	\leq \frac{b-a}{4}
	\int_a^b [f'(x)]^2 \dd{x}.
\end{equation}
\begin{proof}
由于\(f(a)=f(b)=0\)，所以\begin{itemize}
	\item 当\(x \in \left[a,c\right]\)时，
	\(\abs{f(x)} = \abs{\int_a^x f'(t) \dd{t}} \leq \int_a^x \abs{f'(t)} \dd{t} = F(x)\)；
	\item 当\(x \in \left[c,b\right]\)时，
	\(\abs{f(x)} = \abs{\int_b^x f'(t) \dd{t}} \leq \int_b^x \abs{f'(t)} \dd{t} = G(x)\),
\end{itemize}
其中\(c=\frac{a+b}{2}\).
从而，\begin{align*}
	\int_a^b \abs{f(x) f'(x)} \dd{x}
	&= \int_a^c \abs{f(x) f'(x)} \dd{x}
		+ \int_c^b \abs{f(x) f'(x)} \dd{x} \\
	&\leq \int_a^c F(x) F'(x) \dd{x}
		+ \int_c^b G(x) G'(x) \dd{x} \\
	&= \frac{1}{2} \left[ F^2(c) + G^2(c) \right].
\end{align*}
分别代入\(F(x)\)与\(G(x)\)的表达式，
可得\begin{equation*}
	F^2(c) = \left( \int_a^c \abs{f'(t)} \dd{t} \right)^2,
	\qquad
	G^2(c) = \left( \int_c^b \abs{f'(t)} \dd{t} \right)^2.
\end{equation*}
根据\hyperref[equation:定积分.柯西--施瓦茨不等式]{柯西--施瓦茨不等式}，
有\begin{align*}
	&\hspace{-20pt}\int_a^b{\abs{f(x) f'(x)} \dd{x}}
	\leq \frac{1}{2} \left[
		F^2(c)
		+ G^2(c)
		\right] \\
	&= \frac{1}{2} \left[
		\left(\int_a^c{\abs{f'(t)}\dd{t}}\right)^2
		+\left(\int_c^b{\abs{f'(t)}\dd{t}}\right)^2
		\right] \\
	&\leq \frac{1}{2} \left\{
		\int_a^c{1^2 \dd{x}}
		\int_a^c{[f'(x)]^2 \dd{x}}
		+\int_c^b{1^2 \dd{x}}
		\int_c^b{[f'(x)]^2 \dd{x}}
		\right\} \\
	&= \frac{b-a}{4} \int_a^b{[f'(x)]^2 \dd{x}}.
\end{align*}
\cref{equation:定积分.欧庇尔不等式} 当且仅当\begin{equation*}
	f(x) = \left\{ \begin{array}{cl}
		c(x-a), & x\in\left[a,c\right], \\
		-c(x-b), & x\in\left[c,b\right],
	\end{array} \right.
\end{equation*}时取等号，其中\(c\neq0\).
\end{proof}
%@see: https://doi.org/10.1007/978-94-011-3562-7
\end{theorem}

\subsection{贝尔曼--格朗沃尔不等式}
\begin{theorem}[贝尔曼--格朗沃尔不等式]\label{theorem:定积分.贝尔曼--格朗沃尔不等式}
%https://www.sciencedirect.com/topics/engineering/gronwall-bellman-inequality
设\(f(x),g(x),\phi(x)\)为\([a,b]\)上的连续函数，
\(g(x)\)单调递增，
\(\phi(x)\geq0\)，
且\begin{equation*}
	(\forall x \in [a,b])
	\left[
		f(x) \leq g(x) + \int_a^x \phi(t) f(t) \dd{t}
	\right],
\end{equation*}
那么\begin{equation*}
	(\forall x \in [a,b])
	\left[
		f(x) \leq g(x) e^{\int_a^x \phi(s) \dd{s}}
	\right].
\end{equation*}
\begin{proof}
设\(F(x) = \int_a^x \phi(t) f(t) \dd{t}\)，
则\begin{equation*}
	F'(x) = \phi(x) f(x) \leq \phi(x) g(x) + \phi(x) F(x),
\end{equation*}
移项得\(F'(x) - \phi(x) F(x) \leq \phi(x) g(x)\)，于是\begin{equation*}
	\dv{x}\left[F(x) e^{-\int_a^x \phi(t) \dd{t}}\right]
	\leq \phi(x) g(x) e^{-\int_a^x \phi(t) \dd{t}},
\end{equation*}\begin{equation*}
	F(x) \leq \int_a^x \phi(t) g(t) e^{\int_t^x \phi(s) \dd{s}} \dd{t}.
\end{equation*}
由于\(g(x)\)单调递增，
根据\hyperref[theorem:定积分.积分中值定理2]{积分第二中值定理}，
有\begin{align*}
	f(x) &\leq g(x) + F(x)
		\leq g(x) + \int_a^x \phi(t) g(t) e^{\int_t^x \phi(s) \dd{s}} \dd{t} \\
	&\leq g(x) + g(x) \int_a^x \phi(t) e^{\int_t^x \phi(s) \dd{s}} \dd{t} \\
	&= g(x) + g(x) \left[-e^{\int_t^ \phi(s) \dd{s}}\right]_a^x \\
	&= g(x) e^{\int_a^x \phi(s) \dd{s}}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}
