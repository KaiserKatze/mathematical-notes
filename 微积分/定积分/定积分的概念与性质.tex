\section{定积分的概念与性质}
\subsection{定积分的概念}
\begin{definition}
%@see: 《高等数学（第六版 上册）》 P225 定义
%@see: 《数学分析（第二版 上册）》（陈纪修） P275 定义7.1.1
设函数\(f\colon[a,b]\to\mathbb{R}\)在闭区间\([a,b]\)上有界.
在\([a,b]\)中任意插入若干个分点\[
	a=x_0 < x_1 < x_2 < \dotsb < x_{n-1} < x_n = b,
\]
把区间\([a,b]\)分成\(n\)个小区间\[
	[x_0,x_1],[x_1,x_2],\dotsc,[x_{n-1},x_n],
\]
各个小区间的长度依次为\[
	\increment x_1=x_1-x_0,
	\increment x_2=x_2-x_1,
	\dotsc,
	\increment x_n=x_n-x_{n-1},
\]
在每个小区间\([x_{i-1},x_i]\)上任取一点\(\xi_i\ (x_{i-1} \leq \xi_i \leq x_i)\)，
作函数值\(f(\xi_i)\)与小区间长度\(\increment x_i\)的乘积
\(f(\xi_i)\increment x_i\ (i=1,2,\dotsc,n)\)，
并求和\[
	S = \sum_{i=1}^n f(\xi_i) \increment x_i,
\]
和\(S\)通常称为\DefineConcept{积分和}.
记\(\lambda=\max\{\increment x_1,\increment x_2,\dotsc,\increment x_n\}\).
如果不论对\([a,b]\)怎么划分，
也不论小区间\([x_{i-1},x_i]\)上点\(\xi_i\)怎样选取，
只要当\(\lambda\to0\)时，
和\(S\)总趋于确定的极限\(I\)，
那么称这个极限\(I\)为
“函数\(f\)在区间\([a,b]\)上的\DefineConcept{定积分}”，
记作\(\int_a^b f(x) \dd{x}\)，
即\begin{equation}
	\int_a^b f(x) \dd{x}
	\defeq
	\lim_{\lambda\to0} \sum_{i=1}^n f(\xi_i)\increment x_i,
\end{equation}
其中\(f(x)\)称为\DefineConcept{被积函数}，
\(f(x)\dd{x}\)称为\DefineConcept{被积表达式}，
\(x\)称为\DefineConcept{积分变量}，
\(a\)称为\DefineConcept{积分下限}，
\(b\)称为\DefineConcept{积分上限}，
\([a,b]\)称为\DefineConcept{积分区间}.
我们称“函数\(f\)在\([a,b]\)上\DefineConcept{黎曼可积}（integrable）”.
\end{definition}
以上积分定义又称为\DefineConcept{黎曼积分}.

注意：
当和\(\sum_{i=1}^n f(\xi_i) \increment x_i\)的极限
\(\lim_{\lambda\to0} \sum_{i=1}^n f(\xi_i) \increment x_i\)存在时，
其极限\(I\)仅与被积函数\(f\)及积分区间\([a,b]\)有关.
如果既不改变被积函数\(f\)，也不改变积分区间\([a,b]\)，
而只把积分变量\(x\)改写成其他字母，则和的极限\(I\)不变，也就是定积分的值不变，
即\[
	\int_a^b f(x) \dd{x}
	= \int_a^b f(t) \dd{t}
	= \int_a^b f(u) \dd{u}.
\]
换句话说，定积分的值只与被积函数及积分区间有关，而与积分变量的记法无关.

在上面对定积分的定义中，由于\([a,b]\)是区间，所以蕴含了\(a<b\)这一条件，
但是我们有时候需要计算的定积分\(\int_a^b f(x) \dd{x}\)满足\(a \geq b\).
因此，为了以后计算及应用方便起见，对定积分作以下补充规定：
交换定积分的上下限，定积分的绝对值不变而符号相反，即
\begin{equation}\label{equation:定积分.交换上下限改变定积分的符号}
	\int_a^b f(x) \dd{x}
	= - \int_b^a f(x) \dd{x}.
\end{equation}
由此我们得到一个结论：
定积分上下限相等时，定积分为零，即
\begin{equation}\label{equation:定积分.上下限相等的定积分为零}
    \int_a^a f(x) \dd{x} = 0.
\end{equation}

根据定积分定义判定定积分不存在的方法有两种：
\begin{itemize}
	\item 证明存在一种分法使得积分和极限不存在.
	\item 证明存在两种分法使得两个极限不相等.
\end{itemize}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P227 例1
利用定义计算定积分\(\int_0^1 x^2 \dd{x}\).
\begin{solution}
因为被积函数\(f(x) = x^2\)在积分区间\([0,1]\)上连续，而连续函数是可积的，
所以积分与区间\([0,1]\)的分法及点\(\xi_i\)的取法无关.
因此，为了便于计算，不妨把区间\([0,1]\)分成\(n\)等份，
分点为\(x_i = i/n,\,i=1,2,\dotsc,n-1\)；
这样，每个小区间\([x_{i-1},x_i]\)的长度\(\increment x_i = 1/n,\,i=1,2,\dotsc,n\)；
取\(\xi_i=x_i,\,i=1,2,\dotsc,n\).
于是积分和为\begin{align*}
	\sum_{i=1}^n f(\xi_i) \increment x_i
	&= \sum_{i=1}^n \xi_i^2 \increment x_i
	= \sum_{i=1}^n \left(\frac{i}{n}\right)^2 \frac{1}{n}
	= \frac{1}{n^3} \sum_{i=1}^n i^2 \\
	&= \frac{1}{n^3} \cdot \frac{1}{6} n(n+1)(2n+1) \\
	&= \frac{1}{6} \left(1+\frac{1}{n}\right) \left(2+\frac{1}{n}\right).
\end{align*}
当\(\lambda\to0\)时，\(n\to\infty\)，那么有\[
	\int_0^1 x^2 \dd{x}
	= \lim_{\lambda\to0} \sum_{i=1}^n f(\xi_i) \increment x_i
	= \lim_{n\to\infty}
		\frac{1}{6} \left(1+\frac{1}{n}\right) \left(2+\frac{1}{n}\right)
	= \frac{1}{3}.
\]
\end{solution}
\end{example}

\subsection{黎曼可积条件}
不是所有的有界函数都是可积的.
考虑狄利克雷函数\[
	D(x) = \left\{ \begin{array}{ll}
		1, & x \in \mathbb{Q}, \\
		0, & x \in \mathbb{R}-\mathbb{Q}.
	\end{array} \right.
\]
显然狄利克雷函数是有界的.
由于有理数和无理数在实数域中都是稠密的，
因此不论用区间\([0,1]\)的哪一个划分，在每一个小区间中一定是既有有理数又有无理数.
于是，当\(\xi_i\)全部取为有理数时，积分和等于\(1\)；
而当\(\xi_i\)全部取为无理数时，积分和等于\(0\).
两种情况下的积分和的极限虽然存在但是不相同，所以狄利克雷函数不是黎曼可积的.

下面我们来探求有界函数在\([a,b]\)上黎曼可积的充分必要条件.

记\[
	M \defeq \sup\Set{ f(x) \given x\in[a,b] }, \qquad
	m \defeq \inf\Set{ f(x) \given x\in[a,b] }.
\]
再记\[
	M_i \defeq \sup\Set{ f(x) \given x\in[x_{i-1},x_i] }, \qquad
	m_i \defeq \inf\Set{ f(x) \given x\in[x_{i-1},x_i] },
	\quad i=1,2,\dotsc,n.
\]
设\(P\)是\([a,b]\)的一个划分.
定义：\[
	\overline{S}(P) \defeq \sum_{i=1}^n M_i \increment x_i, \qquad
	\underline{S}(P) \defeq \sum_{i=1}^n m_i \increment x_i.
\]
把\(\overline{S}(P)\)与\(\underline{S}(P)\)分别称为
“相应于划分\(P\)的\DefineConcept{达布大和}”
与“相应于划分\(P\)的\DefineConcept{达布小和}”.
那么显然有\[
	\underline{S}(P)
	\leq \sum_{i=1}^n f(\xi_i) \increment x_i
	\leq \overline{S}(P).
\]
如果对于任意一种划分\(P\)，
当\(\lambda = \max\{\increment x_1,\dotsc,\increment x_n\} \to 0\)时，
\(\overline{S}(P)\)和\(\underline{S}(P)\)的极限都存在并且相等，
那么\(f\)是可积的，反之亦然.
下面我们来严格证明这一结论.

\begin{lemma}
%@see: 《数学分析（第二版 上册）》（陈纪修） P277 引理7.1.1
若在原有划分中加入分点形成新的划分，则大和不增，小和不减.
\end{lemma}

以下用\(\overline{\mathbb{S}}\)表示一切可能的划分所得到的大和的集合，
而\(\underline{\mathbb{S}}\)表示一切可能的划分所得到的小和的集合.
\begin{lemma}
%@see: 《数学分析（第二版 上册）》（陈纪修） P278 引理7.1.2
对于任意\(\overline{S}(P_1) \in \overline{\mathbb{S}}\)
和\(\underline{S}(P_2) \in \underline{\mathbb{S}}\)，
总有\[
	m(b-a)
	\leq \underline{S}(P_2)
	\leq \overline{S}(P_1)
	\leq M(b-a).
\]
\end{lemma}
可以看出，\(\overline{\mathbb{S}}\)和\(\underline{\mathbb{S}}\)都是有界的，
因此分别有下确界和上确界.
记\[
	L \defeq \inf\Set{ s \given s \in \overline{\mathbb{S}} }, \qquad
	l \defeq \sup\Set{ s \given s \in \underline{\mathbb{S}} },
\]
则对任意\(\overline{S}(P_1) \in \overline{\mathbb{S}}\)
和\(\underline{S}(P_2) \in \underline{\mathbb{S}}\)，\[
	\underline{S}(P_2)
	\leq l \leq L
	\leq \overline{S}(P_1).
\]
下面我们来证明，当\(\lambda\to0\)时，
达布大和与达布小和的极限确实存在，
且分别等于它们各自的下确界和上确界.
\begin{lemma}
%@see: 《数学分析（第二版 上册）》（陈纪修） P279 引理7.1.3（Darboux定理）
对任意在\([a,b]\)上有界的函数\(f\)，
恒有\[
	\lim_{\lambda\to0} \overline{S}(P) = L, \qquad
	\lim_{\lambda\to0} \underline{S}(P) = l.
\]
\end{lemma}

\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P280 定理7.1.1
有界函数\(f\)在\([a,b]\)上黎曼可积的充分必要条件是：
对于任意划分\(P\)，当\(\lambda\to0\)时，
达布大和与达布小和的极限相等.
\end{theorem}

若记\[
	\omega_i \defeq M_i - m_i
\]为\(f\)在\([x_{i-1},x_i]\)上的振幅，
则上述定理也可等价地表述为下面的定理.

\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P281 定理7.1.2
有界函数\(f\)在\([a,b]\)上黎曼可积的充分必要条件是：
对于任意划分，当\(\lambda\to0\)时，
成立\[
	\lim_{\lambda\to0} \sum_{i=1}^n \omega_i \increment x_i = 0.
\]
\end{theorem}

\begin{corollary}\label{theorem:定积分.黎曼可积条件.闭区间上的连续函数必定可积}
%@see: 《高等数学（第六版 上册）》 P226 定理1
%@see: 《数学分析（第二版 上册）》（陈纪修） P281 推论1
闭区间上的连续函数必定可积.
\end{corollary}

\begin{corollary}
%@see: 《数学分析（第二版 上册）》（陈纪修） P282 推论2
闭区间上的单调函数必定可积.
\end{corollary}

\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P283 定理7.1.3
有界函数\(f\)在\([a,b]\)可积的充分必要条件是：
对于任意给定的\(\epsilon>0\)，存在一种划分，使得相应的振幅满足\[
	\sum_{i=1}^n \omega_i \increment x_i < \epsilon.
\]
\end{theorem}

\begin{corollary}\label{theorem:定积分.黎曼可积条件.闭区间上只有有限个间断点的有界函数必定可积}
%@see: 《高等数学（第六版 上册）》 P227 定理2
%@see: 《数学分析（第二版 上册）》（陈纪修） P283 推论3
闭区间上只有有限个间断点的有界函数必定可积.
\end{corollary}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P285 习题 6.
设函数\(f\)在区间\([a,b]\)上可积，
且在\([a,b]\)上满足\(\abs{f(x)} \geq m > 0\ (\text{$m$是常数})\).
证明：函数\(x \mapsto [f(x)]^{-1}\)在\([a,b]\)上也可积.
%TODO proof
\end{example}

% \begin{remark}
% 有界函数\(f\)在\([a,b]\)上黎曼可积的充分必要条件是：
% \(f\)的全体间断点是零测度的.
% %TODO
% \end{remark}

\begin{definition}\label{definition:函数族.黎曼可积函数族}
由闭区间\([a,b]\)上全部的黎曼可积函数组成的集合，
称作\DefineConcept{黎曼可积函数族}\footnote{%
不作特别强调时，可以将其简称为\DefineConcept{黎曼可积函数族}.%
}，记作\(R[a,b]\).
\end{definition}

\subsection{定积分的几何意义}
在区间\([a,b]\)上\(f(x) \geq 0\)时，
定积分\(\int_a^b f(x) \dd{x}\)在几何上表示
由曲线\(y=f(x)\)、直线\(x=a\)、直线\(x=b\)与\(x\)轴所围成的曲边梯形的面积.
在区间\([a,b]\)上\(f(x) \leq 0\)时，
由曲线\(y=f(x)\)、直线\(x=a\)、直线\(x=b\)与\(x\)轴所围成的曲边梯形在\(x\)轴的下方，
定积分\(\int_a^b f(x) \dd{x}\)在几何上表示上述曲边梯形的面积的负值.

实际上，对于任意黎曼可积函数\(f\colon \mathbb{R} \to \mathbb{R}\)，
定积分\(\int_a^b f(x) \dd{x}\)还可以理解为非空集\(R[a,b]\)上的泛函.

\subsection{定积分的性质}
下面讨论定积分的性质.
下列各性质中积分上下限的大小，
如不特别指明，均不加限制；
并假定各性质中所列出的定积分都是存在的.
\begin{property}\label{theorem:定积分.定积分性质1}
%@see: 《高等数学（第六版 上册）》 P231 性质1
%@see: 《数学分析（第二版 上册）》（陈纪修） P286 性质1（线性性质）
\(\int_a^b [f(x) \pm g(x)] \dd{x}
= \int_a^b f(x) \dd{x} \pm \int_a^b g(x) \dd{x}\).
\begin{proof}
显然有\begin{align*}
	\int_a^b [f(x) \pm g(x)] \dd{x}
	&= \lim_{\lambda\to0}
		\sum_{i=1}^n [f(\xi_i) \pm g(\xi_i)] \increment x_i \\
	&= \lim_{\lambda\to0}
		\sum_{i=1}^n f(\xi_i) \increment x_i
		\pm
		\lim_{\lambda\to0}
		\sum_{i=1}^n g(\xi_i) \increment x_i \\
	&= \int_a^b f(x) \dd{x} \pm \int_a^b g(x) \dd{x}.
	\qedhere
\end{align*}
\end{proof}
\end{property}
上述性质对任意有限个函数都是成立的.

\begin{property}\label{theorem:定积分.定积分性质2}
%@see: 《高等数学（第六版 上册）》 P231 性质2
%@see: 《数学分析（第二版 上册）》（陈纪修） P286 性质1（线性性质）
对于任意实数\(k\)，
总有\(\int_a^b k f(x) \dd{x}
=k\int_a^b f(x) \dd{x}\).
\begin{proof}
显然有\begin{align*}
	\int_a^b k f(x) \dd{x}
	&= \lim_{\lambda\to0}
		\sum_{i=1}^n k f(\xi_i) \increment x_i \\
	&= k \lim_{\lambda\to0}
		\sum_{i=1}^n f(\xi_i) \increment x_i \\
	&= k \int_a^b f(x) \dd{x}.
	\qedhere
\end{align*}
\end{proof}
\end{property}

\begin{corollary}\label{theorem:定积分.定积分性质2推论1}
\(\int_a^b 0 \dd{x} = 0\).
\begin{proof}
在\cref{theorem:定积分.定积分性质2} 中，令\(k=0\)，便得.
\end{proof}
\end{corollary}

\begin{corollary}\label{theorem:定积分.定积分性质2推论2}
%@see: 《数学分析（第二版 上册）》（陈纪修） P286 推论
设\(f\)在\([a,b]\)上黎曼可积，
而\(g\)只在有限个点上与\(f\)的取值不相同，
则\(g\)也在\([a,b]\)上黎曼可积，
并且有\[
	\int_a^b f(x) \dd{x}
	= \int_a^b g(x) \dd{x}.
\]
\begin{proof}
取\(h(x) = f(x) - g(x)\)，
则\(h\)只在有限个点上不为零，除此以外处处为零.
因为\hyperref[theorem:定积分.黎曼可积条件.闭区间上只有有限个间断点的有界函数必定可积]{闭区间上只有有限个间断点的有界函数必定可积}，
所以\(h\)在\([a,b]\)上可积，
且\(\int_a^b h(x) \dd{x} = 0\).
再由定积分的线性性质 \labelcref{theorem:定积分.定积分性质1,theorem:定积分.定积分性质2}
可知\(g\)也在\([a,b]\)上可积，
且\[
	\int_a^b g(x) \dd{x}
	= \int_a^b (f(x) - h(x)) \dd{x}
	= \int_a^b f(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{corollary}
\begin{remark}
\cref{theorem:定积分.定积分性质2推论2} 说明：
在有限个点上改变一个可积函数的函数值，不会改变它的可积性和积分值.
\end{remark}

\begin{property}\label{theorem:定积分.定积分性质4}
%@see: 《高等数学（第六版 上册）》 P232 性质4
\(\int_a^b 1 \dd{x}
= \int_a^b \dd{x}
= b-a\).
%TODO proof
\end{property}

\begin{property}\label{theorem:定积分.乘积可积性}
%@see: 《数学分析（第二版 上册）》（陈纪修） P287 性质2（乘积可积性）
设\(f\)和\(g\)都在\([a,b]\)上黎曼可积，
则\(f \cdot g\)在\([a,b]\)上黎曼可积.
%TODO proof
% \begin{proof}
% 由于\(f\)和\(g\)都在\([a,b]\)上可积，
% 所以它们在\([a,b]\)上有界.
% 因此存在常数\(M>0\)，
% 满足\[
% 	\abs{f(x)} \leq M
% 	\quad\text{和}\quad
% 	\abs{g(x)} \leq M,
% 	x\in[a,b].
% \]
% 对\([a,b]\)的任意划分\[
% 	a = x_0 < x_1 < x_2 < \dotsb < x_n = b,
% \]
% 设
% \end{proof}
\end{property}
\begin{remark}
虽然“\(f\)和\(g\)都在\([a,b]\)上黎曼可积”蕴含“\(f \cdot g\)在\([a,b]\)上黎曼可积”，
但是，一般说来有\[
	\int_a^b f(x) g(x) \dd{x}
	\neq
	\left(
		\int_a^b f(x) \dd{x}
	\right) \cdot \left(
		\int_a^b g(x) \dd{x}
	\right).
\]
例如，虽然\[
	\int_a^b 1 \dd{x} = b-a, \qquad
	\int_a^b 2 \dd{x} = 2(b-a),
\]
但是\[
	\int_a^b 1\cdot2 \dd{x} = 2(b-a)
	\neq
	2(b-a)^2 = \left(\int_a^b 1 \dd{x}\right) \left(\int_a^b 2 \dd{x}\right).
\]
\end{remark}

\begin{property}\label{theorem:定积分.定积分性质3}
%@see: 《高等数学（第六版 上册）》 P231 性质3
%@see: 《数学分析（第二版 上册）》（陈纪修） P288 性质5（区间可加性）
设\(f\)在\([a,b]\)上黎曼可积，
则对任意一点\(c\in(a,b)\)成立\(f\)在\([a,c]\)和\([c,b]\)上都黎曼可积，
反过来\(f\)在\([a,c]\)和\([c,b]\)上都黎曼可积蕴含\(f\)在\([a,b]\)上黎曼可积，
并且\begin{equation}
	\int_a^b f(x) \dd{x}
	= \int_a^c f(x) \dd{x}
	+ \int_c^b f(x) \dd{x}.
\end{equation}
%TODO proof
\end{property}
上述性质表明定积分对于积分区间具有“可加性”.

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》二填空题/第14题
设连续函数\(f\)满足\(f(x+2)-f(x)=x\)，
且\(\int_0^2 f(x) \dd{x} = 0\)，
求\(\int_1^3 f(x) \dd{x}\).
\begin{solution}
由\cref{theorem:定积分.定积分性质3} 有\begin{align*}
	\int_1^3 f(x) \dd{x}
	&= \int_0^3 f(x) \dd{x}
	- \int_0^1 f(x) \dd{x} \\
	&= \int_0^2 f(x) \dd{x}
	+ \int_2^3 f(x) \dd{x}
	- \int_0^1 f(x) \dd{x} \\
	% 代入\(\int_0^2 f(x) \dd{x} = 0\)
	&= \int_2^3 f(x) \dd{x}
	- \int_0^1 f(x) \dd{x} \\
	% 代入\(\int_0^1 f(x+2) \dd{x} = \int_2^3 f(x) \dd{x}\)
	&= \int_0^1 f(x+2) \dd{x}
	- \int_0^1 f(x) \dd{x} \\
	%= \int_0^1 (f(x+2)-f(x)) \dd{x} \\
	&= \int_0^1 x \dd{x}
	= \eval{\frac12 x^2}_0^1
	= \frac12.
\end{align*}
\end{solution}
\end{example}

\begin{property}\label{theorem:定积分.定积分性质5}
%@see: 《高等数学（第六版 上册）》 P232 性质5
设\(f\)在\([a,b]\)上黎曼可积.
如果在区间\([a,b]\)上，\(f(x) \geq 0\)，
则\(\int_a^b f(x) \dd{x} \geq 0\).
\begin{proof}
因为\(f(x) \geq 0\)，
所以在区间\([a,b]\)上任取\(n\)个分点\(\AutoTuple{x}{n}\)使之满足\[
	a = x_0 \leq x_1 \leq x_2 \leq \dotsb \leq x_n \leq x_{n+1} = b,
\]
在各个小区间上任取一点\(\xi_i\in[x_i,x_{i+1}]\ (i=0,1,2,\dotsc,n)\)，
就有\[
	f(\xi_i)\geq0.
\]

又因为小区间\([x_i,x_{i+1}]\)的长度
\(\increment x_i = x_{i+1}-x_i \geq 0\ (i=0,1,2,\dotsc,n)\)，
因此\[
	\sum_{i=0}^n f(\xi_i) \increment x_i \geq 0,
\]
令\(\lambda = \max\{\increment x_0, \increment x_1, \dotsc, \increment x_n\}\)，
则由极限的保号性可得\[
	\int_a^b f(x) \dd{x}
	= \lim_{\lambda\to0} \sum_{i=0}^n f(\xi_i) \increment x_i \geq 0.
	\qedhere
\]
\end{proof}
\end{property}
\begin{remark}
\cref{theorem:定积分.定积分性质5} 表明定积分具有“保号性”.
同理可证：如果在区间\([a,b]\)上，黎曼可积函数\(f\)严格大于零，
则\(\int_a^b f(x) \dd{x} > 0\).
\end{remark}

\begin{example}
比较\(\int_0^1 \abs{\ln t} \ln^n(1+t) \dd{t}\)
与\(\int_0^1 t^n \abs{\ln t} \dd{t}\)的大小（\(n=1,2,\dotsc\)）.
\begin{solution}
直接相减得
\begin{align*}
	&\hspace{-20pt}
	\int_0^1 \abs{\ln t} \ln^n(1+t) \dd{t} - \int_0^1 t^n \abs{\ln t} \dd{t} \\
	&= \int_0^1 [\abs{\ln t} \ln^n(1+t) - t^n \abs{\ln t}] \dd{t} \\
	&= \int_0^1 \abs{\ln t} [\ln^n(1+t) - t^n] \dd{t}.
\end{align*}
注意到\(\ln t\)的自然定义域为\(t > 0\).
当\(0 < t \leq 1\)时，
\(\ln(1+t) < t\)，
\(\ln^n(1+t) < t^n\)，
\[
	\abs{\ln t} [\ln^n(1+t) - t^n] < 0,
\]\[
	\int_0^1 \abs{\ln t} [\ln^n(1+t) - t^n] \dd{t} < 0,
\]\[
	\int_0^1 \abs{\ln t} \ln^n(1+t) \dd{t} < \int_0^1 t^n \abs{\ln t} \dd{t}.
\]
\end{solution}
\end{example}

\begin{corollary}\label{theorem:定积分.定积分性质5推论1}
%@see: 《高等数学（第六版 上册）》 P232 推论1
%@see: 《数学分析（第二版 上册）》（陈纪修） P287 性质3（保序性）
设\(f\)和\(g\)都在\([a,b]\)上黎曼可积，
且在\([a,b]\)上恒有\(f(x) \leq g(x)\)，
则\[
	\int_a^b f(x) \dd{x} \leq \int_a^b g(x) \dd{x}.
\]
\begin{proof}
令\(\phi(x) = g(x) - f(x)\).
因为\(f(x) \leq g(x)\)，所以\(\phi(x) \geq 0\).
由\cref{theorem:定积分.定积分性质5} 得\[
	\int_a^b \phi(x) \dd{x} \geq 0,
\]
又由\cref{theorem:定积分.定积分性质1} 得\[
	\int_a^b \phi(x) \dd{x}
	= \int_a^b [g(x) - f(x)] \dd{x}
	= \int_a^b g(x) \dd{x} - \int_a^b f(x) \dd{x},
\]
所以\[
	\int_a^b g(x) \dd{x} - \int_a^b f(x) \dd{x} \geq 0,
\]
从而有\[
	\int_a^b g(x) \dd{x} \geq \int_a^b f(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{corollary}
\begin{remark}
容易看出，\cref{theorem:定积分.定积分性质5} 与\cref{theorem:定积分.定积分性质5推论1} 是等价命题.
而且同样可证：如果在区间\([a,b]\)上\(f(x)\)严格小于\(g(x)\)，
则\(\int_a^b f(x) \dd{x} < \int_a^b g(x) \dd{x}\).
\end{remark}

\begin{corollary}\label{theorem:定积分.定积分性质5推论2}
%@see: 《高等数学（第六版 上册）》 P233 推论2
%@see: 《数学分析（第二版 上册）》（陈纪修） P288 性质4（绝对可积性）
设\(f\)在\([a,b]\)上黎曼可积，
则\begin{equation}
	\abs{\int_a^b f(x) \dd{x}} \leq \int_a^b \abs{f(x)} \dd{x}.
\end{equation}
\begin{proof}
因为\[
	-\abs{f(x)} \leq f(x) \leq \abs{f(x)},
\]
那么由\cref{theorem:定积分.定积分性质5推论1,theorem:定积分.定积分性质2} 可得\[
	-\int_a^b \abs{f(x)} \dd{x}
	\leq
	\int_a^b f(x) \dd{x}
	\leq
	\int_a^b \abs{f(x)} \dd{x},
\]
即\[
	\abs{\int_a^b f(x) \dd{x}} \leq \int_a^b \abs{f(x)} \dd{x}.
	\qedhere
\]
\end{proof}
\end{corollary}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P236 习题5-1 12. (1)
设\(f \in C[a,b]\)，
在\([a,b]\)上\(f(x)\geq0\)，
且\(\int_a^b f(x) \dd{x} = 0\).
证明：在\([a,b]\)上\(f(x)\equiv0\).
\begin{proof}
用反证法.
假设在\([a,b]\)上\(f(x)\not\equiv0\)，
不妨设\(f(c)>0\ (a<c<b)\).
由于\(f\)连续，所以由连续性的定义可知\(\lim_{x \to c} f(x) = f(c)\).
再由\cref{theorem:极限.函数极限的局部保序性1.推论1} 可知，
存在\(\delta>0\)，使得当\(0<\abs{x-c}<\delta\)时，成立\[
	f(x) > \frac12 f(c).
\]
因为\(f(x)\geq0\)，
所以由\cref{theorem:定积分.定积分性质5} 可知\[
	\int_a^{c-\delta} f(x) \dd{x} \geq 0,
	\qquad
	\int_{c+\delta}^b f(x) \dd{x} \geq 0.
\]
于是\begin{align*}
	\int_a^b f(x) \dd{x}
	&= \left( \int_a^{c-\delta} + \int_{c-\delta}^{c+\delta} + \int_{c+\delta}^b \right) f(x) \dd{x}
	\geq \int_{c-\delta}^{c+\delta} f(x) \dd{x} \\
	&> \frac12 f(c) \int_{c-\delta}^{c+\delta} \dd{x}
	= \frac12 f(c) \cdot 2\delta
	> 0,
\end{align*}
与题设\(\int_a^b f(x) \dd{x} = 0\)矛盾！因此\(f(x)\equiv0\).
\end{proof}
\end{example}
\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P293 习题 5.
设\(f\)在\([a,b]\)上连续.
如果\(f\)在区间\([a,b]\)上非负且不恒为零，
则\(\int_a^b f(x) \dd{x} > 0\).
\begin{proof}
由于\(f\)在区间\([a,b]\)上非负且不恒为零，
不妨设\(c \in (a,b)\)且\(f(c)>0\)，
于是由\hyperref[definition:极限.函数在一点的连续性]{连续函数的定义}有\[
	\lim_{x \to c} f(x) = f(c) > 0.
\]
那么由\cref{theorem:极限.函数极限的局部保序性1.推论1} 可知，
存在\(\delta>0\)，当\(0 < \abs{x-c} < \delta\)时，满足\[
	f(x) > \frac12 f(c),
\]
于是由\cref{theorem:定积分.定积分性质5推论1,theorem:定积分.定积分性质5推论3} 得\[
	\int_a^b f(x) \dd{x}
	\geq \int_{c-\delta}^{c+\delta} f(x) \dd{x}
	\geq \int_{c-\delta}^{c+\delta} \frac12 f(c) \dd{x}
	= \frac12 f(c) \cdot 2 \delta
	> 0.
	\qedhere
\]
\end{proof}
\end{example}

\begin{corollary}\label{theorem:定积分.定积分性质5推论3}
设函数\(f\)是区间\([a,b]\)上的非负的黎曼可积函数，
那么对于\(\forall c,d\in(a,b)\)，
有\[
	c<d
	\implies
	\int_a^c f(x) \dd{x} \leq \int_a^d f(x) \dd{x}.
\]
\begin{proof}
根据\cref{theorem:定积分.定积分性质5}，
有\[
	\int_c^d f(x) \dd{x} \geq 0.
\]
再根据\cref{theorem:定积分.定积分性质3}，
有\[
	\int_a^c f(x) \dd{x}
	+ \int_c^d f(x) \dd{x}
	= \int_a^d f(x) \dd{x}.
\]
因此\[
	\int_a^c f(x) \dd{x}
	\leq
	\int_a^d f(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{corollary}

\begin{property}\label{theorem:定积分.定积分性质6}
%@see: 《高等数学（第六版 上册）》 P233 性质6
设\(M\)及\(m\)分别是函数\(f\)在区间\([a,b]\)上的最大值及最小值，
则\[
	m(b-a) \leq \int_a^b f(x) \dd{x} \leq M(b-a).
\]
\begin{proof}
因为\(m \leq f(x) \leq M\)，
所以由上述推论，
得\[
	m(b-a)
	= \int_a^b m \dd{x}
	\leq \int_a^b f(x) \dd{x}
	\leq \int_a^b M \dd{x}
	= M(b-a).
	\qedhere
\]
\end{proof}
\end{property}
上述性质说明，由被积函数在积分区间上的最大值及最小值，可以估计积分值的大致范围.

\subsection{积分中值定理}
\begin{theorem}[积分第一中值定理]\label{theorem:定积分.积分中值定理1}
%@see: 《数学分析（第二版 上册）》（陈纪修） P290 性质6（积分第一中值定理）
设\(f,g \in R[a,b]\)，
且\(g\)在\([a,b]\)上不变号，
记\[
	m \defeq \inf\Set{ f(x) \given x \in [a,b] }, \qquad
	M \defeq \sup\Set{ f(x) \given x \in [a,b] },
\]
那么\(\exists\mu\in[m,M]\)，
使得\begin{equation}
	\int_a^b f(x) g(x) \dd{x} = \mu \int_a^b g(x) \dd{x}.
\end{equation}
\begin{proof}
因为\(g\)在\([a,b]\)上不变号，
不妨设\(g(x)\geq0\).
于是有\[
	m g(x) \leq f(x) g(x) \leq M g(x).
\]
由\cref{theorem:定积分.定积分性质5推论1} 可得\[
	m \int_a^b g(x) \dd{x}
	\leq \int_a^b f(x) g(x) \dd{x}
	\leq M \int_a^b g(x) \dd{x}.
\]
由于\(\int_a^b f(x) g(x) \dd{x}\)
和\(\int_a^b g(x) \dd{x}\)都是常数，
因而必有某个\(\mu\in[m,M]\)，
使得\[
	\int_a^b f(x) g(x) \dd{x}
	= \mu \int_a^b g(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{theorem}

\begin{corollary}\label{theorem:定积分.积分中值定理1推论1}
%@see: 《数学分析（第二版 上册）》（陈纪修） P290 性质6（积分第一中值定理）
设\(f \in C[a,b]\)，
\(g \in R[a,b]\)，
且\(g\)在\([a,b]\)上不变号，
那么\(\exists\xi\in[a,b]\)，
使得\begin{equation}
	\int_a^b f(x) g(x) \dd{x}
	= f(\xi) \int_a^b g(x) \dd{x}.
\end{equation}
\begin{proof}
由\cref{theorem:定积分.积分中值定理1} 可知，
存在\(\mu\in[m,M]\)，
使得\[
	\int_a^b f(x) g(x) \dd{x}
	= \mu \int_a^b g(x) \dd{x}.
\]
因为\(f\)在\([a,b]\)上连续，
由\hyperref[theorem:极限.闭区间上连续函数的性质.介值定理2]{闭区间上连续函数的介值定理}可知，
存在\(\xi\in[a,b]\)使得\(f(\xi) = \mu\)，
因此\[
	\int_a^b f(x) g(x) \dd{x}
	= f(\xi) \int_a^b g(x) \dd{x}.
	\qedhere
\]
\end{proof}
\end{corollary}

\begin{figure}[htb]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			xmin=0,xmax=3,
			ymin=0,ymax=3,
			xtick={.5,1.5,2.5},
			xticklabels={$a$,$\xi$,$b$},
			ytick={1.5},
			yticklabels={$f(\xi)$},
		]
			\addplot[domain=.5:2.5]{(x-1.5)^3+1.5};
			\begin{scope}[dashed,black!30]
				\draw(.5,1.5)--(.5,0);
				\draw(2.5,2.5)--(2.5,0);
				\draw(1.5,1.5)--(1.5,0);
				\draw(2.5,1.5)--(0,1.5);
			\end{scope}
			\draw(2.5,2.5)node[left]{$y=f(x)$};
		\end{axis}
	\end{tikzpicture}
	\caption{}
	\label{figure:定积分.积分中值定理的几何意义}
\end{figure}

\begin{corollary}\label{theorem:定积分.积分中值定理1推论2}
%@see: 《高等数学（第六版 上册）》 P233 性质7（定积分中值定理）
%@see: 《数学分析（第二版 上册）》（陈纪修） P290
设函数\(f\)在\([a,b]\)上连续，
则\(\exists\xi\in[a,b]\)，
使\begin{equation}
	\int_a^b f(x) \dd{x} = f(\xi) (b-a).
\end{equation}
\begin{proof}
令\(g(x) \equiv 1\)，
由\cref{theorem:定积分.积分中值定理1推论1} 立即可得.
\end{proof}
\end{corollary}
\begin{remark}
%@see: 《高等数学（第六版 上册）》 P234
如\cref{figure:定积分.积分中值定理的几何意义} 所示，
\cref{theorem:定积分.积分中值定理1推论2} 的几何意义十分明确：
在区间\([a,b]\)上至少存在一点\(\xi\)，
使得以区间\([a,b]\)为底边、以曲线\(y=f(x)\)为曲边的曲边梯形的面积
等于同一底边而高为\(f(\xi)\)的一个矩形的面积.
\end{remark}
\begin{remark}
注意到\cref{theorem:定积分.积分中值定理1推论2} 中\(\xi\)的取值范围是\([a,b]\).
实际上，我们可以舍去端点，让\(\xi\)的取值范围变成\((a,b)\).
在下一节，我们就可以证明这个更强的结论 --- \cref{theorem:定积分.积分中值定理1推论2改进}.
\end{remark}
\begin{remark}
对于\cref{theorem:定积分.积分中值定理1推论2}，
我们需要注意到：
通常来说\(\xi\)不是唯一的.
只有当被积函数是严格单调函数时，\(\xi\)是\(x\)的函数，
例如：\begin{itemize}
	\item 由\(\int_0^x e^t \dd{t} = x e^\xi\)可得\(\xi = \ln\frac{e^x-1}{x}\)，
	而\(\lim_{x\to0} \frac{\xi}{x} = \frac12\).
	\item 由\(\int_0^x \ln t \dd{t} = x \ln\xi\)可得\(\xi = \frac{x}{e}\)，
	而\(\lim_{x\to0} \frac{\xi}{x} = \frac1e\).
\end{itemize}

一般地，假设\(f\)在\([0,x]\)上单调连续，
则\[
	\xi = f^{-1}\kern-2pt\left[ \frac1x \int_0^x f(t) \dd{t} \right].
\]
\end{remark}
\begin{definition}
把\begin{equation}
	\frac{1}{b-a} \int_a^b f(x) \dd{x}
\end{equation}
称为“函数\(f\)在区间\([a,b]\)上的\DefineConcept{平均值}”.
\end{definition}

\begin{example}
%@see: https://www.bilibili.com/video/BV1R627YaEom/
设函数\(f \in C[0,1]\).
证明：\(\lim_{n\to\infty} \int_0^1 f(\sqrt[n]{x}) \dd{x} = f(1)\).
\begin{proof}
因为\(f \in C[0,1]\)，
所以由\hyperref[theorem:极限.最值定理]{闭区间上的连续函数的有界性与最大值最小值定理}可知\[
	(\exists M>0)
	(\forall x\in[0,1])
	[\abs{f(x)} \leq M].
\]
由\hyperref[theorem:定积分.定积分性质5推论2]{绝对可积性}可知\[
	0 \leq \abs{\int_0^{\frac1n} f(\sqrt[n]{x}) \dd{x}}
	\leq \int_0^{\frac1n} \abs{f(\sqrt[n]{x})} \dd{x}
	\leq \int_0^{\frac1n} M \dd{x}
	= \frac{M}{n}
	\to 0\ (n\to\infty),
\]
所以由\hyperref[theorem:数列极限.夹逼准则]{夹逼准则}可知
\begin{equation*}
	\lim_{n\to\infty} \int_0^{\frac1n} f(\sqrt[n]{x}) \dd{x} = 0.
\end{equation*}

由\hyperref[theorem:定积分.积分中值定理1推论2]{积分中值定理}可知\[
	\int_{\frac1n}^1 f(\sqrt[n]{x}) \dd{x}
	= f(\sqrt[n]{\xi}) \cdot \left( 1-\frac1n \right),
\]
其中\(1/n \leq \xi \leq 1\)，
从而有\(\sqrt[n]{1/n} \leq \sqrt[n]{\xi} \leq 1\)，
由\cref{equation:数列极限.重要极限2} 有\(\sqrt[n]{1/n} \to 1\ (n\to\infty)\)，
所以由\hyperref[theorem:数列极限.夹逼准则]{夹逼准则}可得
\(\sqrt[n]{\xi} \to 1\ (n\to\infty)\)，
再由\hyperref[theorem:极限.连续函数的极限3]{连续性}可得
\(f(\sqrt[n]{\xi}) \to f(1)\)，
那么\[
	\lim_{n\to\infty} \int_{\frac1n}^1 f(\sqrt[n]{x}) \dd{x}
	= \lim_{n\to\infty} f(\sqrt[n]{\xi})
		\cdot \lim_{n\to\infty} \left( 1-\frac1n \right)
	= f(1).
\]

综上所述\[
	\lim_{n\to\infty} \int_0^1 f(\sqrt[n]{x}) \dd{x}
	= \lim_{n\to\infty} \left(
		\int_0^{\frac1n} f(\sqrt[n]{x}) \dd{x}
		+ \int_{\frac1n}^1 f(\sqrt[n]{x}) \dd{x}
	\right)
	= f(1).
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV11FqSY2Eub/
设函数\(f \in C[0,1]\)，且\(\int_0^1 f(x) \dd{x} = 0\).
证明：存在\(\xi\in(0,1)\)，使得\(f(\xi) = 2\xi \int_0^\xi f(t) \dd{t}\).
\begin{proof}
记\(F(x) = \int_0^x f(t) \dd{t}\).
%@Mathematica: DSolve[F'[x] == 2 x F[x], F[x], x]
%@Mathematica: DSolve[F'[x] == 2 x F[x] && F[1] == 0, F[x], x]
% 注意到所求结论是一个一阶线性微分方程\(F'(x) = 2x F(x)\).
% 因此可以构造一个辅助函数.
令\(\phi(x) = e^{-x^2} F(x)\).
因为\(\phi(0) = \phi(1) = 0\)，
所以由\hyperref[theorem:微分中值定理.罗尔定理]{罗尔定理}可知，
存在\(\xi\in(0,1)\)，
使得\(\phi'(\xi)
= e^{-\xi^2} (f(\xi) - 2\xi F(\xi))
= 0\)，
即\(f(\xi) = 2\xi \int_0^\xi f(t) \dd{t}\).
\end{proof}
\end{example}

\begin{theorem}[积分第二中值定理]\label{theorem:定积分.积分中值定理2}
%@see: 《数学分析（第二版 上册）》（陈纪修） P373 定理8.2.4（积分第二中值定理）
设\(f,g \in R[a,b]\)，
则\begin{itemize}
	\item 若\(f\)在\((a,b)\)上单调，
	则\(\exists \xi \in [a,b]\)，
	使得\[
		\int_a^b f(x) g(x) \dd{x}
		= f(a^+) \int_a^{\xi} g(x) \dd{x} + f(b^-) \int_{\xi}^b g(x) \dd{x}.
	\]
	\item 若\(f\)在\((a,b)\)上单调递减且\(f(x) \geq 0\)，
	则\(\exists \xi \in [a,b]\)，
	使得\[
		\int_a^b f(x) g(x) \dd{x}
		= f(a^+) \int_a^{\xi} g(x) \dd{x}.
	\]
	\item 若\(f\)在\((a,b)\)上单调递增且\(f(x) \geq 0\)，
	则\(\exists \xi \in [a,b]\)，
	使得\[
		\int_a^b f(x) g(x) \dd{x}
		= f(b^-) \int_{\xi}^b g(x) \dd{x}.
	\]
\end{itemize}
%TODO proof
\end{theorem}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 13.
设\(f \in R[a,b]\).
证明：等式\[
	\int_a^b f^2(x) \dd{x} = 0
\]成立的充分必要条件是：
对于函数\(f\)在\([a,b]\)上的所有连续点都有\(f(x)=0\).
%TODO proof
\end{example}

\begin{example}
%@see: 《数学分析教程 （第3版 上册）》（史济怀） P248 练习题6.2 8.
设\(f \in C[0,1]\)且\(f(x)>0\).
证明：\[
	\int_0^1 f(x) \dd{x}
	\int_0^1 \frac1{f(x)} \dd{x}
	\geq 1.
\]
%TODO proof
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 8.
设\(\phi\)在\([0,a]\)上连续，\(f\)在\((-\infty,+\infty)\)上二阶可导，且\(f''(x)\geq0\).
证明：\[
	f\left(\frac1a \int_0^a \phi(t) \dd{t}\right)
	\leq \frac1a \int_0^a f(\phi(t)) \dd{t}.
\]
%TODO proof
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P294 习题 11.
设函数\(f\)在\([a,b]\)上可积，
对于任意给定\(h\in\mathbb{R}\)有\(f_h(x) = f(x+h)\)在\([a,b]\)上可积.
证明：\[
	\lim_{h\to0} \int_a^b \abs{f_h(x)-f(x)} \dd{x} = 0.
\]
%TODO proof
\end{example}
