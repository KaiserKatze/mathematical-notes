\section{定积分的应用}
\subsection{直角坐标下的图形面积}
我们已经知道，由曲线\(y=f(x)\ (f(x)\geq0)\)及直线\(x=a\)和\(x=b\ (a<b)\)与\(x\)轴
所围成的曲边梯形的面积\(A\)是定积分\[
	A = \int_a^b f(x) \dd{x},
\]
其中被积表达式\(f(x) \dd{x}\)就是直角坐标系下的面积元素，
它表示高为\(f(x)\)、底为\(\dd{x}\)的一个矩形的面积.

应用定积分，不但可以计算曲边梯形面积，还可以计算一些比较复杂的平面图形的面积.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P275 例2
计算抛物线\(y^2=2x\)与直线\(y=x-4\)所围成的图形的面积.
\begin{solution}
先求抛物线和直线的交点，解方程组\[
	\left\{ \begin{array}{l}
		y^2=2x, \\
		y=x-4
	\end{array} \right.
\]得交点\((2,-2)\)和\((8,4)\)，
从而知道这图形在直线\(y=-2\)和\(y=4\)之间.
现在，选取纵坐标\(y\)为积分变量，
对应的积分区间为\([-2,4]\).
相应于\([-2,4]\)上任一小区间\([y,y+\dd{y}]\)的窄条面积
近似于高为\(\dd{y}\)、底为\((y+4)-\frac12y^2\)的窄矩形的面积，
从而得到面积元素\[
	\dd{A} = \left(y+4-\frac12y^2\right) \dd{y}.
\]
把这个面积元素作为被积表达式，在闭区间\([-2,4]\)上作定积分，
便得所求的面积为\begin{align*}
	A &= \int_{-2}^4 \left(y+4-\frac12y^2\right) \dd{y} \\
	&= \eval{\left[\frac12y^2+4y-\frac16y^3\right]}_{-2}^4 \\
	&= 18.
\end{align*}
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P276 例3
%@see: 《数学分析（第二版 上册）》（陈纪修） P315 例7.4.3
求椭圆\(\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\)所围成的图形的面积.
\begin{solution}
这椭圆关于两坐标轴都对称，所以椭圆所围成的图形的面积为\(A=4A_1\)，
其中\(A_1\)是该椭圆在第一象限部分与两坐标轴所围图形的面积\[
	A_1 = \int_0^a y \dd{x}.
\]
利用椭圆的参数方程\[
	\left\{ \begin{array}{l}
		x = a \cos t, \\
		y = a \sin t,
	\end{array} \right.
	\quad 0 \leq t \leq \frac\pi2,
\]
应用定积分换元法，
令\(x = a \cos t\)，
则\[
	y = b \sin t, \qquad
	\dd{x} = -a \sin t,
\]
且\(t \to \frac\pi2\ (x\to0),
t \to 0\ (x \to a)\)，
所以\begin{align*}
	A_1 &= \int_{\frac\pi2}^0 b \sin t (-a \sin t) \dd{t} \\
	&= -ab \int_{\frac\pi2}^0 \sin^2t \dd{t} \\
	&= ab \cdot \frac12 \cdot \frac\pi2
	= \frac14 \pi ab.
\end{align*}
于是\(A = 4 A_1 = \pi ab\).
\end{solution}
\end{example}

% 短摆线（curtate cycloid）
%@see: https://mathworld.wolfram.com/CurtateCycloid.html
% 参数方程：\begin{equation*}
% 	\left\{ \begin{array}{l}
% 		x = a \theta - b \sin\theta, \\
% 		y = a - b \cos\theta
% 	\end{array} \right.
%	\quad(b<a).
% \end{equation*}
% 长摆线（prolate cycloid）
%@see: https://mathworld.wolfram.com/ProlateCycloid.html
% 参数方程：\begin{equation*}
% 	\left\{ \begin{array}{l}
% 		x a \theta - b \sin\theta, \\
% 		y = a - b \cos\theta
% 	\end{array} \right.
% 	\quad(b>a).
% \end{equation*}
\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P316 例7.4.4
求摆线的一拱\[
	\left\{ \begin{array}{l}
		x = a (t - \sin t), \\
		y = a (1 - \cos t)
	\end{array} \right.
	\quad(0 \leq t \leq 2\pi)
\]与\(x\)轴所围区域的面积.
\begin{solution}
所求区域的面积为\[
	S = a^2 \int_0^{2\pi} (1-\cos t)^2 \dd{t}
	= a^2 \int_0^{2\pi} \left(
		1 - 2 \cos t + \frac{1 + \cos2t}2
	\right) \dd{t}
	= 3\pi a^2.
\]
\end{solution}
\end{example}

%@see: 《数学分析（第二版 上册）》（陈纪修） P315
若曲线的方程是用参数形式\[
	\left\{ \begin{array}{l}
		x = x(t), \\
		y = y(t)
	\end{array} \right.
	\quad(\alpha \leq t \leq \beta)
\]给出的，
\(x(t)\)在\([\alpha,\beta]\)上具有连续导数，
且\(x'(t)\neq0\).
那么曲线与\(x\)轴所围成的曲边梯形的面积为\begin{equation}
	S = \int_\alpha^\beta \abs{y(t) x'(t)} \dd{t}.
\end{equation}

\subsection{极坐标下的图形面积}
某些平面图形，用极坐标来计算它们的面积比较方便.

设由曲线\(\rho = \phi(\theta)\)
及射线\(\theta=\alpha\)、\(\theta=\beta\)围成一个平面图形（特别地，称其为“曲边扇形”），
现在要计算它的面积.
这里，\(\phi(\theta)\)在\([\alpha,\beta]\)上连续，且\(\phi(\theta)\geq0\).

由于当\(\theta\)在\([\alpha,\beta]\)上变动时，
极径\(\rho=\phi(\theta)\)也随之变动，
因此所求图形的面积不能直接利用扇形面积计算公式\[
    A = \frac{1}{2} R^2 \theta
\]来计算.

取极角\(\theta\)为积分变量，它的变化区间为\([\alpha,\beta]\).
相应于任一小区间\([\theta,\theta+\dd{\theta}]\)的窄曲边扇形的面积可以用
半径为\(\rho=\phi(\theta)\)、中心角为\(\dd{\theta}\)的扇形的面积来近似代替，
从而得到这窄曲边扇形面积的近似值，即曲边扇形的面积元素\begin{equation}
    \dd{A}
    = \frac{1}{2} [\phi(\theta)]^2 \dd{\theta}.
\end{equation}
考虑到\(A = \int \dd{A}\)，
只要以\(\frac{1}{2} [\phi(\theta)]^2 \dd{\theta}\)为被积表达式，
在闭区间\([\alpha,\beta]\)上作定积分，便得所求曲边扇形的面积为\begin{equation}
	A = \int_\alpha^\beta \frac{1}{2} [\phi(\theta)]^2 \dd{\theta}.
\end{equation}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P277 例4
计算阿基米德螺线\[
	\rho = a \theta, \quad a>0
\]上相应于\(\theta\)从\(0\)变到\(2\pi\)的一段弧与极轴所围成的图形的面积.
\begin{solution}
在指定的这段罗翔上，\(\theta\)的变化区间为\([0,2\pi]\).
相应于\([0,2\pi]\)上任一小区间\([\theta,\theta+\dd{\theta}]\)的窄曲边扇形的面积
近似于半径为\(a \theta\)、中心角为\(\dd{\theta}\)的圆扇形的面积，
从而得到面积元素\[
	\dd{A} = \frac12 (a \theta)^2 \dd{\theta}.
\]
于是所求面积为\[
	A = \int_0^{2\pi} \frac12 (a \theta)^2 \dd{\theta}
	= \eval{\frac16 a^2 \theta^3}_0^{2\pi}
	= \frac43 a^2 \pi^3.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P277 例5
计算心形线\[
	\rho = a (1 + \cos\theta), \quad a>0
\]所围成的图形的面积.
\begin{solution}
心形线所围成的图形对称于极轴，
因此所求图形的面积\(A\)是极轴以上部分图形面积\(A_1\)的两倍.
对于极轴以上部分的图形，\(\theta\)的变化区间为\([0,\pi]\).
相应于\([0,\pi]\)上任一小区间\([\theta,\theta+\dd{\theta}]\)的窄曲边扇形的面积
近似于半径为\(a (1 + \cos\theta)\)、中心角为\(\dd{\theta}\)的圆扇形的面积，
从而得到面积元素\[
	\dd{A} = \frac12 a^2 (1 + \cos\theta)^2 \dd{\theta}.
\]
于是\begin{align*}
	A_1 &= \int_0^\pi \frac12 a^2 (1 + \cos\theta)^2 \dd{\theta} \\
	&= \frac12 a^2 \int_0^\pi (1 + 2\cos\theta + \cos^2\theta) \dd{\theta} \\
	&= \frac12 a^2 \int_0^\pi \left(\frac32 + 2 \cos\theta + \frac12 \cos2\theta\right) \dd{\theta} \\
	&= \eval{\frac12 a^2 \left[\frac32 \theta + 2 \sin\theta + \frac14 \sin2\theta\right]}_0^\pi
	= \frac34 \pi a^2,
\end{align*}
因而所求面积为\[
	A = 2 A_1 = \frac32 \pi a^2.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P317 例7.4.6
求三叶玫瑰线\(\rho = a \sin3\theta\ (0 \leq \theta \leq \pi)\)所围区域的面积.
\begin{solution}
利用对称性，我们只求半叶“玫瑰”的面积，
这时\(\theta\)的变化范围是\(0 \leq \theta \leq \frac\pi6\).
于是\[
	S = 6 \cdot \frac{a^2}2 \int_0^{\frac\pi6} \sin^23\theta \dd{\theta}
	\xlongequal{\phi=3\theta} a^2 \int_0^{\frac\pi2} \sin^2\phi \dd{\phi}
	= \frac\pi4 a^2.
\]
\end{solution}
\end{example}

\begin{example}
求伯努利双纽线\((x^2+y^2)^2 = 2 a^2 x y\)所围成的图形的面积.
\begin{solution}
注意到\(F(x,y) = (x^2+y^2)^2 - 2 a^2 x y\)具有轮换对称性，
即伯努利双纽线\((x^2+y^2)^2 = 2 a^2 x y\)所围成的图形关于直线\(y=x\)对称，
所以它所围成的图形的面积
等于它与\(x\)轴、直线\(y=x\)所围成的图形的面积的4倍.
令\(x = \rho \cos\theta,
y = \rho \sin\theta\)，
则曲线方程化为\begin{equation*}
	\rho^4 = 2 a^2 \rho^2 \cos\theta \sin\theta,
\end{equation*}
消去\(\rho^2\)得\begin{equation*}
	\rho^2 = a^2 \sin2\theta.
\end{equation*}
伯努利双纽线\((x^2+y^2)^2 = 2 a^2 x y\)所围成的图形在第一象限部分所占据的角度范围为\begin{equation*}
	\sin2\theta \geq 0,
	\qquad
	0 \leq \theta \leq \frac\pi4,
\end{equation*}
即\begin{equation*}
	0 \leq \theta \leq \frac\pi4.
\end{equation*}
因此伯努利双纽线\((x^2+y^2)^2 = 2 a^2 x y\)所围成的图形的面积为\begin{equation*}
	S = 4 \int_0^{\frac\pi4} \frac12 a^2 \sin2\theta \dd{\theta}
	= a^2.
\end{equation*}
\end{solution}
%@Mathematica: RegionPlot[(x^2 + y^2)^2 <= 2 x y, {x, -1, 1}, {y, -1, 1}]
\end{example}
\begin{example}
求伯努利双纽线\((x^2+y^2)^2 = a^2(x^2-y^2)\)所围成的图形的面积.
\begin{solution}
注意到\(F(x,y) = (x^2+y^2)^2 - a^2(x^2-y^2)\)
既是关于变量\(x\)的偶函数，
也是关于变量\(y\)的偶函数，
所以它所围成的图形的面积
等于它所围成的图形在第一象限部分的面积的4倍.
令\(x = \rho \cos\theta,
y = \rho \sin\theta\)，
则曲线方程化为\begin{equation*}
	\rho^4 = a^2 (\rho^2 \cos^2\theta - \rho^2 \sin^2\theta),
\end{equation*}
消去\(\rho^2\)得\begin{equation*}
	\rho^2 = a^2 \cos2\theta.
\end{equation*}
伯努利双纽线\((x^2+y^2)^2 = a^2(x^2-y^2)\)所围成的图形在第一象限部分所占据的角度范围为\begin{equation*}
	\cos2\theta \geq 0,
	\qquad
	0 \leq \theta \leq \frac\pi2,
\end{equation*}
即\begin{equation*}
	0 \leq \theta \leq \frac\pi4.
\end{equation*}
因此伯努利双纽线\((x^2+y^2)^2 = a^2(x^2-y^2)\)所围成的图形的面积为\begin{equation*}
	S = 4 \int_0^{\frac\pi4} \frac12 a^2 \cos2\theta \dd{\theta}
	= a^2.
\end{equation*}
\end{solution}
%@Mathematica: RegionPlot[(x^2 + y^2)^2 <= x^2 - y^2, {x, -1, 1}, {y, -1, 1}]
\end{example}
\begin{example}
%@see: https://www.bilibili.com/video/BV1dbm6YwEBy/
求曲线\((x^2+y^2)^2 = a^2 x^2 - b^2 y^2\)所围成的图形的面积.
\begin{solution}
注意到\(F(x,y) = (x^2+y^2)^2 - a^2(x^2-y^2)\)
既是关于变量\(x\)的偶函数，
也是关于变量\(y\)的偶函数，
所以它所围成的图形的面积
等于它所围成的图形在第一象限部分的面积的4倍.
令\(x = \rho \cos\theta,
y = \rho \sin\theta\)，
则曲线方程化为\begin{equation*}
	\rho^4 = a^2 \rho^2 \cos^2\theta - b^2 \rho^2 \sin^2\theta,
\end{equation*}
消去\(\rho^2\)得\begin{equation*}
	\rho^2 = a^2 \cos^2\theta - b^2 \sin^2\theta.
\end{equation*}
曲线\((x^2+y^2)^2 = a^2 x^2 - b^2 y^2\)所围成的图形在第一象限部分所占据的角度范围为\begin{equation*}
	a^2 \cos^2\theta - b^2 \sin^2\theta \geq 0,
	\qquad
	0 \leq \theta \leq \frac\pi2,
\end{equation*}
即\begin{equation*}
	\tan^2\theta \leq \frac{a^2}{b^2}
	\quad\text{或}\quad
	0 \leq \theta \leq c = \arctan\frac{a^2}{b^2}.
\end{equation*}
因此曲线\((x^2+y^2)^2 = a^2 x^2 - b^2 y^2\)所围成的图形的面积为\begin{align*}
	S &= 4 \int_0^c \frac12 (a^2 \cos^2\theta - b^2 \sin^2\theta) \dd{\theta} \\
	% \int \sin^2 x \dd{x} = \frac{x}2 - \frac14 \sin 2x + C_3
	% \int \cos^2 x \dd{x} = \frac{x}2 + \frac14 \sin 2x + C_4
	%@Mathematica: 4 Integrate[1/2 (a^2 Cos[\[Theta]]^2 - b^2 Sin[\[Theta]]^2), {\[Theta], 0, c}] // Simplify
	&= c (a^2 - b^2) + \frac12 \sin2c (a^2 + b^2) \\
	%@Mathematica: % /. c -> ArcTan[a^2/b^2] // Simplify
	&= \frac{a^2 b^2 (a^2 + b^2)}{a^4 + b^4} + (a^2 - b^2) \arctan\frac{a^2}{b^2}.
\end{align*}
\end{solution}
\end{example}

\subsection{旋转体的体积}
\DefineConcept{旋转体}就是由一个平面图形绕着这平面内一条直线旋转一周而成的立体.
这条直线叫做\DefineConcept{旋转轴}.
圆柱可以看成是由矩形绕它的一条边旋转一周而成的立体.
圆锥可以看成是由直角三角形绕它的直角边旋转一周而成的立体.
圆台可以看成是由直角梯形绕它的直角腰旋转一周而成的立体.
球体可以看成是由半圆绕它的直径旋转一周而成的立体.
所以圆柱、圆锥、圆台、球体都是旋转体.

上述旋转体都可以看作是
由连续曲线\(y=f(x)\)、直线\(x=a\)和\(x=b\)及\(x\)轴所围成的曲边梯形
绕\(x\)轴旋转一周而成的立体.
现在我们考虑用定积分来计算这种旋转体的体积.

取横坐标\(x\)为积分变量，它的变化区间为\([a,b]\).
相应于\([a,b]\)上的任一小区间\([x,x+\dd{x}]\)的窄曲边梯形绕\(x\)轴旋转而成的薄片的体积
近似于以\(f(x)\)为底半径、\(\dd{x}\)为高的扁圆柱体的体积，
即体积元素\[
	\dd{V} = \pi [f(x)]^2 \dd{x}.
\]
以\(\pi [f(x)]^2 \dd{x}\)为被积表达式，
在闭区间\([a,b]\)上作定积分，
便得所求旋转体体积为\begin{equation}\label{equation:定积分.曲边梯形绕x轴旋转体的体积}
	V = \pi \int_a^b [f(x)]^2 \dd{x}.
\end{equation}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P278 例6
连接坐标原点\(O\)及点\(P(h,r)\)的直线、直线\(x=h\)及\(x\)轴围成一个直角三角形.
将它绕\(x\)轴旋转一周构成一个底半径为\(r\)、高为\(h\)的圆锥体.
计算着圆锥体的体积.
\begin{solution}
过原点\(O\)及点\(P(h,r)\)的直线方程为\[
	y = \frac{r}{h} x.
\]
取横坐标\(x\)为积分变量，它的变化区间为\([0,h]\).
圆锥体中相应于\([0,h]\)上任一小区间\([x,x+\dd{x}]\)的薄片的体积
近似于底半径为\(\frac{r}{h} x\)、高为\(\dd{x}\)的扁圆柱体的体积，
即体积元素\[
	\dd{V} = \pi \left(\frac{r}{h} x\right)^2 \dd{x}.
\]
于是所求圆锥体的体积为\[
	V = \int_0^h \pi \left(\frac{r}{h} x\right)^2 \dd{x}
	= \eval{\frac{\pi r^2 x^3}{3 h^2}}_0^h
	= \frac\pi3 r^2 h.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P279 例7
计算由椭圆\[
	\frac{x^2}{a^2}+\frac{y^2}{b^2}=1
\]所围成的图形绕\(x\)轴旋转一周而成的旋转体的体积.
\begin{solution}
这个旋转椭球体也可以看作是由半个椭圆\(y = \frac{b}{a} \sqrt{a^2-x^2}\)
及\(x\)轴围成的图形
绕\(x\)轴旋转一周而成的立体.

取\(x\)为积分变量，它的变化区间为\([-a,a]\).
旋转椭球体中相应于\([-a,a]\)上任一小区间\([x,x+\dd{x}]\)的薄片的体积，
近似于底半径为\(\frac{b}{a} \sqrt{a^2-x^2}\)、高为\(\dd{x}\)的扁圆柱体的体积，
即体积元素\[
	\dd{V} = \frac{\pi b^2}{a^2} (a^2-x^2) \dd{x}.
\]
于是所求旋转椭球体的体积为\[
	V = \int_{-a}^a \pi \frac{b^2}{a^2} (a^2-x^2) \dd{x}
	= \eval{\pi \frac{b^2}{a^2} \left(a^2x-\frac13x^3\right)}_{-a}^a
	= \frac43 \pi a b^2.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《2009年全国硕士研究生入学统一考试（数学一）》三解答题/第17题
椭球面\(S_1\)是椭圆\(\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1\)绕\(x\)轴旋转而成，
圆锥面\(S_2\)是由过点\(M_0(p,0)\)且与上述椭圆相切的直线绕\(x\)轴旋转而成，
其中\(p>a>0,b>0\)，
计算\(S_1\)与\(S_2\)之间的立体的体积.
\begin{solution}
椭圆上任意一点\((\xi,\eta)\)的切线方程为\[
	\frac{x\xi}{a^2} + \frac{y\eta}{b^2} = 1.
	\eqno(1)
\]
代入点\(M_0\)的坐标得\(\frac{p\xi}{a^2} = 1\)，
解得\[
%@Mathematica: Solve[{(x \[Xi])/a^2 + (y \[Eta])/b^2 == 1}, \[Xi]] /. {x -> p, y -> 0}
	\xi = \frac{a^2}{p}.
	\eqno(2)
\]
由于\((\xi,\eta)\)同时满足旋转椭球面方程，即\[
	\frac{\xi^2}{a^2} + \frac{\eta^2}{b^2} = 1,
\]
解出\(\eta\)的正根，得\[
%@Mathematica: Solve[\[Xi]^2/a^2 + \[Eta]^2/b^2 == 1, \[Eta]] /. %1[[1]]
	\eta = \frac{b}{p} \sqrt{p^2 - a^2}.
	\eqno(3)
\]
于是连接\(M\left( \frac{a^2}{p}, \frac{b}{p} \sqrt{p^2 - a^2} \right)\)与\(M_0\)的直线
就是上述椭圆切线\[
	l: y = \frac{\eta}{\xi - p} (x - p),
\]
而圆锥面\(S_2\)可以看作切线\(l\)绕\(x\)轴旋转所得.
因此\(S_1\)与\(S_2\)之间的立体的体积为\begin{align*}
%@ V1 = Integrate[((\[Eta] (x - p))/(\[Xi] - p))^2, {x, \[Xi], p}]
%@ V2 = Integrate[b^2 (1 - x^2/a^2), {x, \[Xi], a}]
	V &= \pi \int_\xi^p \left[ \frac{\eta}{\xi - p} (x - p) \right]^2 \dd{x}
	- \pi \int_\xi^a b^2 \left( 1 - \frac{x^2}{a^2} \right) \dd{x} \\
	&= \pi \left[ \frac{b^2 (a^2-p^2)^2}{3 p^3} - \frac{2 a b^2}{3} - \frac{a^4 b^2}{3 p^3} + \frac{a^2 b^2}{p} \right].
\end{align*}
\end{solution}
\end{example}

由连续曲线\(y=f(x)\)、直线\(x=a\)和\(x=b\)及\(x\)轴所围成的曲边梯形
绕\(y\)轴旋转一周而成的立体的体积为
\begin{equation}\label{equation:定积分.曲边梯形绕y轴旋转体的体积}
	V = 2\pi \int_a^b \abs{x f(x)} \dd{x}.
\end{equation}

\begin{theorem}[古尔丁体积定理]
%@see: http://www.shuxueji.com/w/1063
由平面图形绕与它共面的一条直线旋转一周而成的立体的体积为\begin{equation}
	V = S d,
\end{equation}
其中\(S\)是这个平面图形的面积，
\(d\)是这个平面图形的几何中心到旋转轴的距离.
%TODO proof
\end{theorem}

\subsection{平行截面面积为已知的立体的体积}
从计算旋转体体积的过程中可以看出：
如果一个立体不是旋转体，但我们知道该立体上垂直于某个轴的各个截面的面积，
那么，这个立体的体积也可以用定积分来计算.

取上述定轴为\(x\)轴，
并设该立体在过点\(x=a\)、\(x=b\)且垂直于\(x\)轴的两个平面之间.
以\(A(x)\)表示过点\(x\)且垂直于\(x\)轴的截面面积.
假定\(A(x)\)是\(x\)的连续函数.
这时，取\(x\)为积分变量，它的变化区间为\([a,b]\)；
立体中相应于\([a,b]\)上任一小区间\([x,x+\dd{x}]\)的一薄片的体积，
近似于底面积为\(A(x)\)、高为\(\dd{x}\)的扁柱体的体积，
即体积元素\[
	\dd{V} = A(x) \dd{x}.
\]
以\(A(x) \dd{x}\)为被积表达式，在闭区间\([a,b]\)上作定积分，
便得所求立体的体积\[
	V = \int_a^b A(x) \dd{x}.
\]

\begin{example}
%@see: 《高等数学（第六版 上册）》 P281 例9
一平面经过半径为\(R\)的圆柱体的底圆中心，并与底圆交成角\(\alpha\).
计算这平面截圆柱体所得立体的体积.
\begin{solution}
取这平面与圆柱体的底面的交线为\(x\)轴，
底面上过圆中心且垂直于\(x\)轴的直线为\(y\)轴.
那么，底圆的方程为\(x^2+y^2=R^2\).
立体中过\(x\)轴上的点\(x\)且垂直于\(x\)轴的截面是一个直角三角形.
它的两条直角边的长分别为\(y\)及\(y \tan\alpha\)，
即\(\sqrt{R^2-x^2}\)及\(\sqrt{R^2-x^2} \tan\alpha\).
因而截面积为\[
	A(x) = \frac12 (R^2-x^2) \tan\alpha,
\]
于是所求立体体积为\[
	V = \int_{-R}^R \frac12 (R^2-x^2) \tan\alpha \dd{x}
	= \frac12 \tan\alpha \eval{\left(R^2x-\frac13x^3\right)}_{-R}^R
	= \frac23 R^3 \tan\alpha.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P281 例10
求以半径为\(R\)的圆为底、平行且等于底圆直径的线段为顶、高为\(h\)的正劈锥体的体积.
\begin{solution}
取底圆所在的平面为\(xOy\)平面，圆心\(O\)为原点，并使\(x\)轴与正劈锥体的顶平行.
底圆的方程为\(x^2+y^2=R^2\).
过\(x\)轴上的点\(x\ (-R \leq x \leq R)\)作垂直于\(x\)轴的平面，
截正劈锥体得等腰三角形，这个截面的面积为\[
	A(x) = h \cdot y = h \sqrt{R^2-x^2},
\]
于是所求正劈锥体的体积为\[
	V = \int_{-R}^R A(x) \dd{x}
	= h \int_{-R}^R \sqrt{R^2-x^2} \dd{x}
	= 2 R^2 h \int_0^{\frac\pi2} \sin^2\theta \dd{\theta}
	= \frac{\pi R^2 h}2.
\]
由此可见，正劈锥体的体积等于同底同高的圆柱体体积的一半.
\end{solution}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1xT42167ni
计算由曲线\(y=\sqrt{x}\)与直线\(y=x\)所围成的图形绕直线\(y=x\)旋转一周而成的旋转体的体积.
\begin{solution}
先求抛物线和直线的交点，解方程组\[
	\left\{ \begin{array}{l}
		y=\sqrt{x}, \\
		y=x
	\end{array} \right.
\]得交点\((0,0)\)和\((1,1)\)，
从而知道这图形在直线\(x=0\)和\(x=1\)之间.
现在，选取横坐标\(x\)为积分变量，
对应的积分区间为\([0,1]\).
取抛物线上一点\(P(x,\sqrt{x})\)，
则点\(P\)到直线\(y=x\)的距离为\[
	r = \frac{\abs{x-\sqrt{x}}}{\sqrt2}.
\]
邻近点\(P\)的抛物线弧与直线夹成的窄曲边梯形绕直线旋转而成的薄片的体积
近似于底半径为\(r\)、高为\(\sqrt2 \dd{x}\)的扁圆柱体的体积，
即体积元素\[
	\dd{V} = \frac\pi2 (\sqrt{x}-x)^2 \cdot \sqrt2 \dd{x}.
\]
把这个体积元素作为被积表达式，在闭区间\([0,1]\)上作定积分，
便得所求的体积为\[
	V = \int_0^1 \frac\pi2 (\sqrt{x}-x)^2 \cdot \sqrt2 \dd{x}
	= \frac\pi{30\sqrt2}.
\]
\end{solution}
\end{example}

\subsection{平面曲线的弧长}
我们知道，圆的周长可以利用圆的内接正多边形（或外切正多边形）的周长在其边数诬陷增多时的极限来确定.
类似地，我们建立平面曲线的弧长的概念，并运用定积分计算平面曲线的弧长.

设\(A\)、\(B\)是平面曲线弧的两个端点.
在弧\(\Arc{AB}\)上依次任取分点\[
	A=M_0,M_1,M_2,\dotsc,M_{n-1},M_n=B,
\]并依次连接相邻的分点得一条折线.
当分点的数目无限增加且每个小段\(\Arc{M_{i-1}M_i}\)都缩向一点时，
如果此折线的长\[
	\sum_{i=1}^n \abs{M_{i-1} M_i}
\]的极限存在，
则称“极限\(\lim_{n\to\infty} \sum_{i=1}^n \abs{M_{i-1} M_i}\)是
曲线弧\(\Arc{AB}\)的\DefineConcept{弧长}”，
并称“曲线弧\(\Arc{AB}\)是\DefineConcept{可求长的}”.

\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P282 定理
光滑曲线弧是可求长的.
\end{theorem}

下面利用定积分的元素法来讨论平面光滑曲线弧长的计算公式.

设曲线弧由参数方程\[
	\left\{ \begin{array}{l}
	x = \phi(t), \\
	y = \psi(t)
	\end{array} \right.
	\quad(\alpha \leq t \leq \beta)
\]给出，
其中\(\phi\)、\(\psi\)在\([\alpha,\beta]\)上具有连续导数，
且\(\phi'\)、\(\psi'\)不同时为零.
现在来计算这曲线弧的长度.

取参数\(t\)为积分变量，它的变化区间为\([\alpha,\beta]\).
相应于\([\alpha,\beta]\)上任一小区间\([t,t+\dd{t}]\)的小弧段的长度\(\increment s\)
近似等于对应的弦的长度\(\sqrt{(\increment x)^2+(\increment y)^2}\)，
因为\[
	\increment x
	= \phi(t+\dd{t})-\phi(t)
	\approx \dd{x}
	= \phi'(t) \dd{t},
\]\[
	\increment y
	= \psi(t+\dd{t})-\psi(t)
	\approx \dd{y}
	= \psi'(t) \dd{t},
\]
所以，\(\increment s\)的近似值（弧微分）即弧长元素为\[
	\dd{s} = \sqrt{(\dd{x})^2 + (\dd{y})^2}
	= \sqrt{(\phi'(t))^2 + (\psi'(t))^2} \dd{t}.
\]
于是所求弧长为\begin{equation}
	s = \int_\alpha^\beta \sqrt{(\phi'(t))^2 + (\psi'(t))^2} \dd{t}.
\end{equation}

当曲线弧由直角坐标方程\[
	y = f(x) \quad(a \leq x \leq b)
\]给出，
其中\(f(x)\)在\([a,b]\)上具有一阶连续导数，
这时曲线弧有参数方程\[
	\left\{ \begin{array}{l}
		x = x, \\
		y = f(x)
	\end{array} \right.
	\quad(\alpha \leq t \leq \beta),
\]
从而所求弧长为\begin{equation}
	s = \int_a^b \sqrt{1+(y')^2} \dd{x}.
\end{equation}

当曲线弧由极坐标方程\[
	\rho=\rho(\theta)
	\quad(\alpha \leq \theta \leq \beta)
\]给出，
其中\(\rho(\theta)\)在\([\alpha,\beta]\)上具有连续导数，
则由直角坐标与极坐标的关系可得\[
	\left\{ \begin{array}{c}
		x = \rho(\theta) \cos\theta, \\
		y = \rho(\theta) \sin\theta
	\end{array} \right.
	\quad(\alpha \leq \theta \leq \beta).
\]
这就是以极角\(\theta\)为参数的曲线弧的参数方程.
而\begin{gather*}
	x'(\theta) = \rho'(\theta) \cos\theta - \rho(\theta) \sin\theta, \\
	y'(\theta) = \rho'(\theta) \sin\theta + \rho(\theta) \cos\theta.
\end{gather*}
于是，弧长元素为\begin{align*}
	\dd{s}
	&= \sqrt{(x'(\theta))^2 + (y'(\theta))^2} \dd{\theta} \\
	&= \sqrt{(\rho' \cos\theta - \rho \sin\theta)^2
		+ (\rho' \sin\theta + \rho \cos\theta)^2} \dd{\theta} \\
	&= \sqrt{(\rho')^2\cos^2\theta-2\rho'\rho\cos\theta\sin\theta+\rho^2\sin^2\theta
		+ (\rho')^2\sin^2\theta+2\rho'\rho\sin\theta\cos\theta+\rho^2\cos^2\theta} \dd{\theta} \\
	&= \sqrt{\rho^2 + (\rho')^2} \dd{\theta}.
\end{align*}
从而所求弧长为\begin{equation}
	s = \int_\alpha^\beta \sqrt{\rho^2(\theta) + (\rho'(\theta))^2} \dd{\theta}.
\end{equation}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P283 例12
计算摆线的一拱\[
	\left\{ \begin{array}{l}
		x = a (\theta - \sin\theta), \\
		y = a (1 - \cos\theta)
	\end{array} \right.
	\quad(0 \leq \theta \leq 2\pi)
\]的长度.
\begin{solution}
弧长元素为\begin{align*}
	\dd{s} &= \sqrt{a^2 (1 - \cos\theta)^2 + a^2 \sin^2\theta} \dd{\theta} \\
	&= a \sqrt{2 (1 - \cos\theta)} \dd{\theta}
	= 2 a \sin\frac\theta2 \dd{\theta}.
\end{align*}
从而，所求弧长\[
	s = \int_0^{2\pi} 2a \sin\frac\theta2 \dd{\theta}
	= -4a \eval{\left(\cos\frac\theta2\right)}_0^{2\pi}
	= 8a.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P283 例13
求阿基米德螺线\(\rho=a\theta\ (a>0)\)相应于\(0\leq\theta\leq2\pi\)一段的弧长.
%@Mathematica: PolarPlot[t, {t, 0, 2 Pi}]
\begin{solution}
弧长元素为\[
	\dd{s} = \sqrt{(a\theta)^2 + a^2} \dd{\theta}
	= a\sqrt{\theta^2+1} \dd{\theta},
\]
于是所求弧长为\[
	s = a \int_0^{2\pi} \sqrt{1+\theta^2} \dd{\theta}
	= \frac{a}{2} \left[
	2\pi\sqrt{1+4\pi^2} + \ln(2\pi+\sqrt{1+4\pi^2})
	\right].
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P287 习题6-2 28.
求对数螺线\(\rho=e^{\theta}\)相应于\(0\leq\theta\leq\pi\)一段的弧长.
%@Mathematica: PolarPlot[Exp[t], {t, 0, Pi}]
\begin{solution}
弧长元素为\[
	\dd{s} = \sqrt{e^{2\theta}+e^{2\theta}} \dd{\theta}
	= \sqrt{2}e^{\theta} \dd{\theta},
\]
于是所求弧长为\[
	s = \sqrt{2} \int_0^\pi e^{\theta} \dd{\theta}
	= \sqrt{2} (e^\pi-1).
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P287 习题6-2 30.
求心形线\(\rho=a(1+\cos\theta)\)的全长.
%@Mathematica: PolarPlot[1 + Cos[t], {t, 0, 2 Pi}]
\begin{solution}
弧长元素为\[
	\dd{s} = \sqrt{a^2(1+\cos\theta)^2+a^2\sin^2\theta} \dd{\theta}
	= a \sqrt{2(1+\cos\theta)} \dd{\theta},
\]
考虑到心形线\(\rho=a(1+\cos\theta)\)对称于极轴，
于是所求弧长为\[
	s = 2 \int_0^\pi a \sqrt{2(1+\cos\theta)} \dd{\theta}
	= 4a \int_0^\pi \cos\frac\theta2 \dd{\theta}
	= 8a.
\]
\end{solution}
\end{example}

\subsection{旋转面的表面积}
%@see: 《数学分析（第二版 上册）》（陈纪修） P324
设参数方程\[
	\left\{ \begin{array}{l}
		x = x(t), \\
		y = y(t)
	\end{array} \right.
	\quad(\alpha \leq t \leq \beta)
\]确定平面上一段光滑曲线\(C\)，
且在\([\alpha,\beta]\)上\(y(t) \geq 0\)，
它绕\(x\)轴旋转一周得到一个旋转曲面.

对区间\([\alpha,\beta]\)作划分：\[
	\alpha = t_0 < t_1 < t_2 < \dotsb < t_{n-1} < t_n = \beta.
\]
由此得到曲线上顺次排列的\(n+1\)个点\(P_0,P_1,\dotsc,P_n\).
记\(\increment S_i\)是连接\(P_{i-1}\)和\(P_i\)的直线段
绕\(x\)轴旋转一周得到的圆台的侧面面积，
即\[
	\increment S_i
	\defeq
	\pi [y(t_{i-1} + y(t_i))] \cdot \overline{P_{i-1} P_i}.
\]
若当\(\lambda=\max_{1 \leq i \leq n} \increment t_i \to 0\)时，
极限\[
	\lim_{\lambda\to0} \sum_{i=1}^n \increment S_i
\]存在，
且极限值与区间\([\alpha,\beta]\)的划分无关，
则称极限值为“曲线\(C\)绕\(x\)轴旋转一周所得旋转曲面的面积”.
可以证明：曲线\(C\)绕\(x\)轴旋转一周所得旋转曲面的面积为\begin{equation}
	S = 2\pi \int_\alpha^\beta y(t) \sqrt{[x'(t)]^2 + [y'(t)]^2} \dd{x}.
\end{equation}

\begin{theorem}[古尔丁表面积定理]
%@see: http://www.shuxueji.com/w/1063
由连续曲线\(y=f(x)\ (a \leq x \leq b)\)
绕\(x\)轴旋转一周而成的旋转面的表面积\begin{equation}
	S = 2\pi \int_a^b y \sqrt{1+\left(\dv{y}{x}\right)^2} \dd{x}.
\end{equation}
%TODO proof
\end{theorem}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P325 例7.4.13
求半径为\(a\)的球的表面积.
\begin{solution}
半径为\(a\)的球的表面积，
就是半径为\(a\)的圆的上半部分\(y=\sqrt{a^2-x^2}\)
绕\(x\)轴旋转一周所得的旋转曲面的面积.
于是球的表面积为\[
	S = 2\pi \int_{-a}^a y \sqrt{1+(y')^2} \dd{x}
	= 2\pi \int_{-a}^a \sqrt{a^2-x^2} \cdot
		\sqrt{1+\left(\frac{-x}{\sqrt{a^2-x^2}}\right)^2} \dd{x}
	= 4\pi a^2.
\]
\end{solution}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P325 例7.4.14
求摆线的一拱\[
	\left\{ \begin{array}{l}
		x = a (t - \sin t), \\
		y = a (1 - \cos t)
	\end{array} \right.
	\quad(0 \leq t \leq 2\pi)
\]绕\(x\)轴旋转一周所得旋转曲面的面积.
\begin{solution}
将摆线的参数方程代入旋转曲面面积公式，得\begin{align*}
	S &= 2\pi a^2 \int_0^{2\pi} (1-\cos t) \sqrt{(1-\cos t)^2 + \sin^2 t} \dd{t} \\
	&= 2\sqrt2 \pi a^2 \int_0^{2\pi} (1-\cos t) \sqrt{1-\cos t} \dd{t} \\
	&= 16\pi a^2 \int_0^{2\pi} \sin^3 \frac{t}{2} \dd(\frac{t}{2})
	= \frac{64}3 \pi a^2.
\end{align*}
\end{solution}
\end{example}
