\section{幂级数}
我们在本节学习函数项级数中简单而常见的一类函数项级数级数 --- “幂级数”.

\subsection{幂级数的概念}
\begin{definition}\label{definition:无穷级数.幂级数}
各项均是幂函数的函数项级数，
称为\DefineConcept{幂级数}（power series）.

称级数\begin{equation*}
	\sum_{n=0}^\infty a_n (x-x_0)^n
\end{equation*}为“幂级数的\DefineConcept{一般形式}”.

称级数\begin{equation*}
	\sum_{n=0}^\infty a_n x^n
\end{equation*}为“幂级数的\DefineConcept{标准形式}”.

这里，我们把常数\(\AutoTuple{a}[0]{n},\dotsc\)称为
“幂级数的\DefineConcept{系数}”.
\end{definition}

由于幂级数的一般形式只要作变量代换\(t = x - x_0\)就可化为它的标准形式，
因此，即便我们取标准形式来讨论，也并不影响一般性.

\subsection{幂级数的收敛半径}
现在我们来讨论：
对于一个给定的幂级数，
它的收敛域与发散域是怎样的？
即\(x\)取数轴上哪些点时幂级数收敛，
取哪些点时幂级数发散？
这就是幂级数的收敛性问题.

先看一个例子.
考察幂级数\begin{equation*}
	1+x^2+x^3+\dotsb+x^n+\dotsb
\end{equation*}的收敛性.
我们已经知道，
当\(\abs{x}<1\)时，
该级数收敛于\(\frac{1}{1-x}\)；
当\(\abs{x}\geq1\)时，
该级数发散.
因此，这个幂级数的收敛域是开区间\((-1,1)\)，
发散域是\((-\infty,-1]\cup[1,+\infty)\)，
并有\begin{equation*}
	\frac{1}{1-x} = 1+x+x^2+\dotsb+x^n+\dotsb
	\quad(-1<x<1).
\end{equation*}

在这个例子中我们看到，这个幂级数的收敛域是一个区间.
事实上，这个结论对于一般的幂级数也是成立的.
我们有如下的定理.

\begin{theorem}[阿贝尔第一定理]\label{theorem:无穷级数.阿贝尔定理1}
%@see: 《高等数学（第六版 下册）》 P271 定理1
%@see: 《数学分析（第二版 下册）》（陈纪修） P86 阿贝尔第一定理
%@see: 《数学分析教程（第3版 上册）》（史济怀） P234 定理15.4.1
如果级数\(\sum_{n=0}^\infty a_n x^n\)当\(x=x_0\neq0\)时收敛，
则满足\(\abs{x}<\abs{x_0}\)的一切\(x\)使之绝对收敛.
反之，如果级数\(\sum_{n=0}^\infty a_n x^n\)当\(x=x_0\)时发散，
则满足\(\abs{x}>\abs{x_0}\)的一切\(x\)使之发散.
\begin{proof}
先设\(x_0\)是幂级数\(\sum_{n=0}^\infty a_n x^n\)的收敛点，
即常数项级数\begin{equation*}
	a_0 + a_1 x_0 + a_2 x_0^2 + \dotsb + a_n x_0^n + \dotsb
\end{equation*}收敛.
根据级数收敛的必要条件，
这时有\begin{equation*}
	\lim_{n\to\infty} a_n x_0^n = 0;
\end{equation*}
于是\(\exists M > 0\)，使得\begin{equation*}
	\abs{a_n x_0^n} \leq M
	\quad(n=0,1,2,\dotsc).
\end{equation*}
这样幂级数\(\sum_{n=0}^\infty a_n x^n\)的一般项的绝对值\begin{equation*}
	\abs{a_n x^n} = \abs{a_n x_0^n \cdot \frac{x^n}{x_0^n}}
	= \abs{a_n x_0^n} \cdot \abs{\frac{x}{x_0}}^n
	\leq M \abs{\frac{x}{x_0}}^n.
\end{equation*}
因为当\(\abs{x}<\abs{x_0}\)时，
等比级数\(\sum_{n=0}^\infty M \abs{\frac{x}{x_0}}^n\)收敛，
所以级数\(\sum_{n=1}^\infty \abs{a_n x^n}\)收敛，
也就是级数\(\sum_{n=0}^\infty a_n x^n\)绝对收敛.

定理的第二部分可用反证法证明.
假设幂级数当\(x=x_0\)时发散而有一点\(x_1\)适合\(\abs{x_1}>\abs{x_0}\)使级数收敛，
则根据本定理的第一部分，当\(x=x_0\)时级数应收敛，这与假设矛盾.
\end{proof}
\end{theorem}

\cref{theorem:无穷级数.阿贝尔定理1} 表明，
如果幂级数在\(x=x_0\)处收敛，
则对\(\forall x\in(-\abs{x_0},\abs{x_0})\)，
幂级数都收敛；
如果幂级数在\(x=x_0\)处发散，
则对\(\forall x\in(-\infty,-\abs{x_0})\cup(\abs{x_0},+\infty)\)，
幂级数都发散.

设已给幂级数在数轴上既有收敛点（不仅是原点）也有发散点.
现在从原点出发沿数轴正方向走，最初只遇到收敛点，然后就只遇到发散点.
这两部分的界点可能是收敛点，也可能是发散点.
从原点出发沿数轴负方向走，情形相同.
利用\cref{theorem:无穷级数.阿贝尔定理1} 可以证明：原点两侧的两个界点到原点的距离是相等的.
像这样，我们就得到以下重要推论.
\begin{corollary}[柯西--阿达玛定理]\label{theorem:无穷级数.阿贝尔定理1推论}
%@see: 《数学分析教程（第3版 上册）》（史济怀） P235 定理15.4.2
%@see: 《高等数学（第六版 下册）》 P271 推论
%@see: 《数学分析（第二版 下册）》（陈纪修） P84 定理10.3.1（Cauchy-Hadamard定理）
给定幂级数\(\sum_{n=0}^\infty a_n x^n\)，
记\begin{equation*}
	\rho \defeq \varlimsup_{n\to\infty} \sqrt[n]{\abs{a_n}},
	\qquad
	R \defeq \frac1\rho,
\end{equation*}
那么\begin{itemize}
	\item 当\(R = 0\)时，级数\(\sum_{n=0}^\infty a_n x^n\)只在点\(x=0\)收敛；
	\item 当\(R = +\infty\)时，级数\(\sum_{n=0}^\infty a_n x^n\)在\((-\infty,+\infty)\)上绝对收敛；
	\item 当\(0 < R < +\infty\)时，级数\(\sum_{n=0}^\infty a_n x^n\)在\((-R,R)\)内绝对收敛，在\((-\infty,-R)\cup(R,+\infty)\)上发散.
\end{itemize}
%TODO proof
% \begin{proof}
% 当\(R=0\)时，

% 那么\begin{equation*}
% 	\varlimsup_{n\to\infty} \sqrt[n]{\abs{a_n x^n}}
% 	= \varlimsup_{n\to\infty} \sqrt[n]{\abs{a_n}} \cdot \abs{x}
% 	= \rho \abs{x}.
% 	\eqno(1)
% \end{equation*}

% 根据\hyperref[theorem:无穷级数.正项级数的根值审敛法]{正项级数的根值审敛法}，
% 当极限(1)取值小于\(1\)，
% 即\begin{equation*}
% 	\abs{x} < \frac1\rho
% \end{equation*}时，
% 级数\(\sum_{n=0}^\infty a_n x^n\)绝对收敛.

% 根据\cref{theorem:无穷级数.绝对发散的特殊情况}，
% 当极限(1)取值大于\(1\)，
% 即\begin{equation*}
% 	\abs{x} > \frac1\rho
% \end{equation*}时，
% 级数\(\sum_{n=0}^\infty a_n x^n\)发散.

% \begin{equation*}
% 	R = \left\{ \def\arraystretch{1.5} \begin{array}{cl}
% 		\frac1\rho, & 0<\rho<+\infty, \\
% 		+\infty, & \rho = 0, \\
% 		0, & \rho = +\infty \\
% 	\end{array} \right.
% \end{equation*}
% \end{proof}
\end{corollary}

对于\(\sum_{n=0}^\infty a_n (x-x_0)^n\)，我们有平行的结论：
如果幂级数\(\sum_{n=0}^\infty a_n (x-x_0)^n\)不是仅在\(x=x_0\)一点收敛，
也不是在整个数轴上都收敛，
则必定存在正数\(R\)，
使得幂级数\(\sum_{n=0}^\infty a_n (x-x_0)^n\)
在以\(x_0\)为中心、\(R\)为半径的对称区间\((x_0-R,x_0+R)\)内绝对收敛，
而在\((-\infty,x_0-R)\cup(x_0+R,+\infty)\)上发散.

我们把\cref{theorem:无穷级数.阿贝尔定理1推论} 中提到的正数\(R\)
称为“幂级数\(\sum_{n=0}^\infty a_n x^n\)的\DefineConcept{收敛半径}”.
把开区间\((-R,R)\)称为“幂级数\(\sum_{n=0}^\infty a_n x^n\)的\DefineConcept{收敛区间}”.

在已知幂级数的收敛半径或收敛区间的情况下，
我们可以根据幂级数在点\(x = \pm R\)处的收敛性，
就可以决定其收敛域是\((-R,R)\)、\([-R,R)\)、\((-R,R]\)或\([-R,R]\)四个区间之一.

如果幂级数只在\(x=0\)处收敛，这时收敛域为\(\{0\}\)，规定收敛半径\(R=0\).
如果幂级数对任意实数都收敛，则规定收敛半径\(R=+\infty\)，收敛域为\((-\infty,+\infty)\).

从\cref{theorem:无穷级数.阿贝尔定理1推论} 可以看出：
给定两个幂级数\(\sum_{n=0}^\infty a_n x^n\)和\(\sum_{n=0}^\infty b_n x^n\)，
假设它们的收敛半径分别是\(R_1\)和\(R_2\)，
如果\(\abs{a_n} \leq \abs{b_n}\ (n=1,2,\dotsc)\)，
那么必有\(\sqrt[n]{\abs{a_n}} \leq \sqrt[n]{\abs{b_n}}\)，
从而有\(R_1 \geq R_2\).
这体现了极限的保序性.

\begin{example}
%@see: 《数学分析（第二版 下册）》（陈纪修） P85 例10.3.2
考察幂级数\(\sum_{n=1}^\infty \frac{[2+(-1)^n]^n}{n} \left(x-\frac12\right)^n\)的敛散性.
\begin{solution}
因为\begin{equation*}
	\varlimsup_{n\to\infty} \sqrt[n]{\frac{[2+(-1)^n]^n}n} = 3,
\end{equation*}
所以收敛半径为\(R=\frac13\).
当\(x=\frac12+R=\frac56\)时，
级数\(\sum_{n=1}^\infty \frac{[2+(-1)^n]^n}{3^n n}\)是发散的.
当\(x=\frac12-R=\frac16\)时，
级数\(\sum_{n=1}^\infty \frac{[2+(-1)^n]^n}{6^n n}\)是发散的.
因此幂级数\(\sum_{n=1}^\infty \frac{[2+(-1)^n]^n}{n} \left(x-\frac12\right)^n\)的收敛域是
\(\left(\frac16,\frac56\right)\).
\end{solution}
\end{example}

\begin{theorem}\label{theorem:无穷级数.幂级数的收敛半径的求法2}
%@see: 《高等数学（第六版 下册）》 P272 定理2
%@see: 《数学分析（第二版 下册）》（陈纪修） P85 定理10.3.2（d'Alembert判别法）
如果\begin{equation*}
	\lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}} = \rho,
\end{equation*}
则幂级数\(\sum_{n=0}^\infty a_n x^n\)的收敛半径为\begin{equation*}
	R = \left\{ \def\arraystretch{1.5} \begin{array}{cl}
		\frac1\rho, & 0<\rho<+\infty, \\
		+\infty, & \rho = 0, \\
		0, & \rho = +\infty. \\
	\end{array} \right.
\end{equation*}
\begin{proof}
考察幂级数\(\sum_{n=0}^\infty a_n x^n\)的各项取绝对值所成的级数\begin{equation*}
	\sum_{n=1}^\infty \abs{a_n x^n}
	= \abs{a_0} + \abs{a_1 x} + \abs{a_2 x^2} + \dotsb + \abs{a_n x^n} + \dotsb.
\end{equation*}
这级数相邻两项之比为\begin{equation*}
	\frac{\abs{a_{n+1} x^{n+1}}}{\abs{a_n x^n}}
	= \abs{\frac{a_{n+1}}{a_n}} \abs{x}.
\end{equation*}

\begin{enumerate}
	\item 如果极限\(\lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}} = \rho\neq0\)存在，
	根据\hyperref[theorem:无穷级数.正项级数的比值审敛法]{比值审敛法}，
	则当\(\rho \abs{x} < 1\)即\(\abs{x} < \frac1\rho\)时，
	级数\(\sum_{n=1}^\infty \abs{a_n x^n}\)收敛，
	从而级数\(\sum_{n=0}^\infty a_n x^n\)绝对收敛；
	再根据\cref{theorem:无穷级数.绝对发散的特殊情况}，
	当\(\rho \abs{x} > 1\)即\(\abs{x} > \frac1\rho\)时，
	级数\(\sum_{n=1}^\infty \abs{a_n x^n}\)发散，
	并且\begin{equation*}
		(\exists N\in\mathbb{N})
		(\forall n\in\mathbb{N})
		[
			n > N
			\implies
			\abs{a_{n+1} x^{n+1}} > \abs{a_n x^n}
		].
	\end{equation*}

	\item 如果\(\rho=0\)，
	则对\(\forall x\neq0\)，
	有\(\lim_{n\to\infty} \abs{\frac{a_{n+1} x^{n+1}}{a_n x^n}} = 0\)，
	所以级数\(\sum_{n=1}^\infty \abs{a_n x^n}\)收敛，
	从而级数\(\sum_{n=0}^\infty a_n x^n\)绝对收敛.
	于是\(R=+\infty\).
		\item 如果\(\rho=+\infty\)，
	则对\(\forall x\neq0\)，
	级数\(\sum_{n=0}^\infty a_n x^n\)必发散，
	否则由\cref{theorem:无穷级数.阿贝尔定理1} 知道，
	\(\exists x\neq0\)使得\(\sum_{n=1}^\infty \abs{a_n x^n}\)收敛.
	于是\(R=0\).
	\qedhere
\end{enumerate}
\end{proof}
\end{theorem}
\begin{remark}
当级数缺项（即某些项取值为零）时，
不能直接运用\cref{theorem:无穷级数.幂级数的收敛半径的求法2} 求解幂级数的收敛半径，
可以把\(x\)看成常数，把\(\sum_{n=0}^\infty a_n x^n\)看成常数项级数，
使用合适的审敛法（例如\hyperref[theorem:无穷级数.正项级数的比值审敛法]{比值审敛法}，
或\hyperref[theorem:无穷级数.正项级数的根值审敛法]{根值审敛法}），
或者对幂级数使用换元法.
\end{remark}

\begin{example}
%@see: 《数学分析（第二版 下册）》（陈纪修） P86 例10.3.3
考察幂级数\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)的收敛情况.
\begin{solution}
因为\begin{equation*}
	\lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{(n+1)^{n+1} / (n+1)!}{n^n / n!}
	= e,
\end{equation*}
所以收敛半径为\(R=1/e\).

当\(x=1/e\)时，
\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)是正项级数，
由\hyperref[example:无穷乘积.斯特林公式]{斯特林公式}
\(n! \sim \sqrt{2\pi n} (n/e)^n\ (n\to\infty)\)有\begin{equation*}
	\frac{n^n}{n!} x^n
	\sim
	\frac{n^n}{\sqrt{2\pi} n^{n+1/2} e^{-n}} \cdot \frac1{e^n}
	= \frac1{\sqrt{2\pi n}}
	\quad(n\to\infty),
\end{equation*}
可知\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)在点\(x=1/e\)发散.

当\(x=-1/e\)时，
\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)是交错级数，
由于\begin{equation*}
	\abs{\frac{(n+1)^{n+1} x^{n+1} / (n+1)!}{n^n x^n / n!}}
	= \frac1e \left( 1 + \frac1n \right)^n
	< 1,
\end{equation*}
且\begin{equation*}
	\abs{\frac{n^n}{n!} x^n}
	\sim
	\frac1{\sqrt{2\pi n}}
	\to 0
	\quad(n\to\infty),
\end{equation*}
可知\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)
在点\(x=-1/e\)成为莱布尼茨级数，必定收敛.

综上所述，
\(\sum_{n=0}^\infty \frac{n^n}{n!} x^n\)的收敛域是\([-1/e,1/e)\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P273 例1
求幂级数\begin{equation*}
	x-\frac{x^2}{2}+\frac{x^3}{3}-\dotsb+(-1)^{n-1}\frac{x^n}{n}+\dotsb
\end{equation*}的收敛半径与收敛域.
\begin{solution}
因为\begin{equation*}
	\rho = \lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{n}{n+1} = 1,
\end{equation*}
所以收敛半径\begin{equation*}
	R = \frac1\rho = 1.
\end{equation*}

对于端点\(x=1\)，级数成为交错级数\begin{equation*}
	1-\frac{1}{2}+\frac{1}{3}-\dotsb+(-1)^{n-1}\frac{1}{n}+\dotsb,
\end{equation*}
由\cref{example:无穷级数.交错级数1} 可知，此级数收敛；
对于端点\(x=-1\)，级数成为\begin{equation*}
	-1-\frac{1}{2}-\frac{1}{3}-\dotsb-\frac{1}{n}-\dotsb,
\end{equation*}
此级数发散.
综上所述，收敛域是\((-1,1]\).
\end{solution}
\end{example}
利用上例的结果可以计算出交错级数\begin{equation*}
	1-\frac{1}{2}+\frac{1}{3}-\dotsb+(-1)^{n-1}\frac{1}{n}+\dotsb.
\end{equation*}
显然有\begin{align*}
	\sum_{n=1}^\infty (-1)^{n-1} \frac{1}{n}
	&= \eval{\sum_{n=1}^\infty (-1)^{n-1} \frac{x^n}{n}}_{x=1} \\
	&= \eval{\sum_{n=1}^\infty (-1)^{n-1} \int_0^x \left(\frac{x^n}{n}\right)' \dd{x}}_{x=1} \\
	&= \eval{\sum_{n=1}^\infty (-1)^{n-1} \int_0^x x^{n-1} \dd{x}}_{x=1} \\
	&= \eval{\int_0^x \sum_{n=1}^\infty (-1)^{n-1} x^{n-1} \dd{x}}_{x=1} \\
	&= \eval{\int_0^x \frac{1}{1+x} \dd{x}}_{x=1} \\
	&= \eval{\ln(1+x)}_{x=1} = \ln2.
\end{align*}
\begin{example}
%@see: 《2009年全国硕士研究生入学统一考试（数学一）》三解答题/第16题
设\(a_n\)是曲线\(y=x^n\)与\(y=x^{n+1}\)所围成区域的面积，
计算级数\(\sum_{n=1}^\infty a_{2n-1}\).
\begin{solution}
因为\(y = x^n\)与\(y = x^{n+1}\)只交于\((0,0)\)和\((1,1)\)两点，
且当\(0 < x < 1\)时总有\(x^n > x^{n+1}\)，
所以\begin{equation*}
	a_n = \int_0^1 (x^n - x^{n+1}) \dd{x}
	= \frac1{n+1} - \frac1{n+2},
\end{equation*}
于是\begin{equation*}
	\sum_{n=1}^\infty a_{2n-1}
	= \frac12 - \frac13 + \frac14 - \frac15 + \dotsb.
\end{equation*}
而\begin{equation*}
	1 - \left(\frac12 - \frac13 + \frac14 - \frac15 + \dotsb\right)
	= \ln2,
\end{equation*}
因此\(\sum_{n=1}^\infty a_{2n-1} = 1 - \ln2\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P273 例2
求幂级数\begin{equation*}
	1+x+\frac{1}{2!}x^2+\dotsb+\frac{1}{n!}x^n+\dotsb
\end{equation*}的收敛域.
\begin{solution}
因为\begin{equation*}
	\rho = \lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{n!}{(n+1)!}
	= \lim_{n\to\infty} \frac{1}{n+1}
	= 0,
\end{equation*}
所以收敛半径\(R = +\infty\)，从而收敛域是\((-\infty,+\infty)\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P273 例3
求幂级数\(\sum_{n=0}^\infty n! x^n\)的收敛半径.
\begin{solution}
因为\begin{equation*}
	\rho
	= \lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{(n+1)!}{n!}
	= \lim_{n\to\infty} (n+1)
	= +\infty,
\end{equation*}
所以收敛半径\(R = 0\)，
即级数仅在点\(x = 0\)处收敛.
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P274 例4
求幂级数\(\sum_{n=0}^\infty \frac{(2n)!}{(n!)^2} x^{2n}\)的收敛半径.
\begin{solution}
级数缺少奇次幂的项，\cref{theorem:无穷级数.幂级数的收敛半径的求法2} 不能直接应用，
我们根据\cref{theorem:无穷级数.正项级数的比值审敛法的上下极限形式} 来求收敛半径：
\begin{equation*}
	\lim_{n\to\infty} \abs{
		{\frac{[2(n+1)]!}{[(n+1)!]^2} x^{2(n+1)}}
		\Bigg/
		{\frac{(2n)!}{(n!)^2} x^{2n}}
	}
	= \lim_{n\to\infty} \abs{\frac{(2n+2)(2n+1)}{(n+1)^2} x^2}
	= 4 x^2.
\end{equation*}

当\(4 x^2 < 1\)即\(\abs{x} < 1/2\)时级数收敛；
当\(4 x^2 > 1\)即\(\abs{x} > 1/2\)时级数发散.
所以收敛半径\(R = 1/2\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P274 例4
求幂级数\(\sum_{n=1}^\infty \frac{(x-1)^n}{2^n \cdot n}\)的收敛域.
\begin{solution}
令\(t = x-1\)，上述级数变为\begin{equation*}
	\sum_{n=1}^\infty \frac{t^n}{2^n \cdot n}.
\end{equation*}
因为\begin{equation*}
	\rho
	= \lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{2^n \cdot n}{2^{n+1} \cdot (n+1)}
	= \frac{1}{2},
\end{equation*}
所以收敛半径\(R_t = 2\)，而原级数的收敛区间为\(-1<x<3\).

当\(x=3\)时，级数成为\(\sum_{n=1}^\infty \frac{1}{n}\)，这级数发散；
当\(x=-1\)时，级数成为\(\sum_{n=1}^\infty \frac{(-1)^n}{n}\)，这级数收敛.
因此原级数的收敛域为\([-1,3)\).
\end{solution}
\end{example}

\begin{example}
%@see: 《数学分析（第二版 下册）》（陈纪修） P94 习题 8.
设正项级数\(\sum_{n=1}^\infty a_n\)发散，
\(A_n = \sum_{k=1}^n a_k\)，
且\(\lim_{n\to\infty} \frac{a_n}{A_n} = 0\).
求幂级数\(\sum_{n=1}^\infty a_n x^n\)的收敛半径.
\begin{solution}
设\(\sum_{n=1}^\infty a_n x^n\)的收敛半径为\(R_1\)，
\(\sum_{n=1}^\infty A_n x^n\)的收敛半径为\(R_2\).

由于\(a_n\geq0\ (n=1,2,\dotsc)\)，
所以\(a_n \leq A_n\)，
从而有\(R_1 \geq R_2\).

又因为\(\sum_{n=1}^\infty a_n\)发散，
由\cref{theorem:无穷级数.正项级数的比值审敛法} 可知
\(\lim_{n\to\infty} \frac{a_{n+1}}{a_n} \geq 1\)，
所以\(R_1 \leq 1\).

由于\begin{equation*}
	\lim_{n\to\infty} \frac{A_n}{A_{n+1}}
	= \lim_{n\to\infty} \frac{A_{n+1} - a_{n+1}}{A_{n+1}}
	= 1,
\end{equation*}
所以\(R_2=1\).

综上所述，既然\(1 \leq R_1 \leq 1\)，则必有\(R_1=1\).
\end{solution}
\end{example}

\subsection{幂级数的性质}
\begin{theorem}[阿贝尔第二定理]\label{theorem:无穷级数.阿贝尔定理2}
%@see: 《数学分析（第二版 下册）》（陈纪修） P87 定理10.3.3（Abel第二定理）
设幂级数\(\sum_{n=0}^\infty a_n x^n\)的收敛半径为\(R\)，
则\begin{itemize}
	\item \(\sum_{n=0}^\infty a_n x^n\)在\((-R,R)\)上内闭一致收敛；
	\item \(\sum_{n=0}^\infty a_n x^n\)在包含于它的收敛域的任意闭区间上一致收敛，
	即\begin{itemize}
		\item 若\(\sum_{n=0}^\infty a_n x^n\)在点\(x=R\)收敛，
		则它在任意闭区间\([a,R]\subseteq(-R,R]\)上一致收敛；
		\item 若\(\sum_{n=0}^\infty a_n x^n\)在点\(x=-R\)收敛，
		则它在任意闭区间\([-R,b]\subseteq[-R,R)\)上一致收敛；
		\item 若\(\sum_{n=0}^\infty a_n x^n\)在点\(x=\pm R\)都收敛，
		则它在闭区间\([-R,R]\)上一致收敛.
	\end{itemize}
\end{itemize}
%TODO proof
\end{theorem}
\begin{remark}
我们可以把\hyperref{theorem:无穷级数.阿贝尔定理2}{阿贝尔第二定理}的结论推广为：
幂级数在它的收敛域上内闭一致收敛.
\end{remark}

根据\hyperref[theorem:无穷级数.阿贝尔定理2]{阿贝尔第二定理}，
我们可以得到幂级数的如下几个性质.
%\cref{theorem:无穷级数.幂级数的和函数的性质1}
%\cref{theorem:无穷级数.幂级数的和函数的性质2}
%\cref{theorem:无穷级数.幂级数的和函数的性质3}

\begin{property}\label{theorem:无穷级数.幂级数的和函数的性质1}
%@see: 《数学分析（第二版 下册）》（陈纪修） P87 定理10.3.4
%@see: 《高等数学（第六版 下册）》 P276 性质1
幂级数\(\sum_{n=0}^\infty a_n x^n\)的和函数在其收敛域上连续.
\begin{proof}
幂级数的一般项是幂函数，显然是连续函数.
由\hyperref[theorem:无穷级数.阿贝尔定理2]{阿贝尔第二定理}，
\(\sum_{n=0}^\infty a_n x^n\)在其收敛域上内闭一致收敛.
根据\hyperref[theorem:函数项级数.连续函数项级数的内闭一致收敛性保证和函数的连续性]{一致收敛函数项级数的和函数的连续性}，
\(\sum_{n=0}^\infty a_n x^n\)在包含于收敛域中的任意闭区间上连续，
因而在它的整个收敛域上连续.
\end{proof}
\end{property}

\begin{property}\label{theorem:无穷级数.幂级数的和函数的性质2}
%@see: 《数学分析（第二版 下册）》（陈纪修） P87 定理10.3.5
%@see: 《高等数学（第六版 下册）》 P276 性质2
幂级数\(\sum_{n=0}^\infty a_n x^n\)
在包含于其收敛域中的任意闭区间上
可以逐项求积分，
即对于其收敛域内的任意两点\(a,b\)，
有\begin{equation}
	\int_a^b \sum_{n=0}^\infty a_n x^n \dd{x}
	= \sum_{n=0}^\infty \int_a^b a_n x^n \dd{x};
\end{equation}
特别地，有\begin{equation}
	\int_0^x \sum_{n=0}^\infty a_n t^n \dd{t}
	= \sum_{n=0}^\infty \frac{a_n}{n+1} x^{n+1},
\end{equation}
且逐项积分所得到的幂级数\(\sum_{n=0}^\infty \frac{a_n}{n+1} x^{n+1}\)
和原幂级数\(\sum_{n=0}^\infty a_n x^n\)
具有相同的收敛半径.
\begin{proof}
由\hyperref[theorem:无穷级数.阿贝尔定理2]{阿贝尔第二定理}，
\(\sum_{n=0}^\infty a_n x^n\)在其收敛域上内闭一致收敛.
应用\hyperref[theorem:函数项级数.连续函数项级数的一致收敛性保证和函数的可积性]{一致收敛函数项级数的逐项积分定理}，
就得到幂级数的逐项可积性.

由于\begin{equation*}
	\varlimsup_{n\to\infty} \sqrt[n+1]{\frac{\abs{a_n}}{n+1}}
	= \varlimsup_{n\to\infty} \sqrt[n]{\abs{a_n}},
\end{equation*}
所以\(\sum_{n=0}^\infty \frac{a_n}{n+1} x^{n+1}\)
与\(\sum_{n=0}^\infty a_n x^n\)具有相同的收敛半径.
\end{proof}
\end{property}
\begin{remark}
虽然逐项积分所得的幂级数\(\sum_{n=0}^\infty \frac{a_n}{n+1} x^{n+1}\)
和原幂级数\(\sum_{n=0}^\infty a_n x^n\)收敛半径相同，
但是它的收敛域相比于原幂级数可能扩大.

%@see: 《数学分析（第二版 下册）》（陈纪修） P89 例10.3.4
例如，幂级数\begin{equation*}
	\sum_{n=1}^\infty (-1)^{n-1} x^{2n-2}
\end{equation*}的收敛域是\((-1,1)\)，
但逐项积分所得的幂级数\begin{equation*}
	\sum_{n=1}^\infty \frac{(-1)^{n-1}}{2n-1} x^{2n-1}
\end{equation*}的收敛域是\([-1,1]\).

%@see: 《数学分析（第二版 下册）》（陈纪修） P89 例10.3.5
又例如，幂级数\begin{equation*}
	\sum_{n=1}^\infty (-1)^{n-1} x^{n-1}
\end{equation*}的收敛域是\((-1,1)\)，
但逐项积分所得的幂级数\begin{equation*}
	\sum_{n=1}^\infty \frac{(-1)^{n-1}}{n} x^n
\end{equation*}的收敛域是\((-1,1]\).
\end{remark}

\begin{property}\label{theorem:无穷级数.幂级数的和函数的性质3}
%@see: 《数学分析（第二版 下册）》（陈纪修） P89 定理10.3.6
%@see: 《高等数学（第六版 下册）》 P276 性质3
幂级数\(\sum_{n=0}^\infty a_n x^n\)
在其收敛区间上可以逐项求导，
即\begin{equation}
	\dv{x} \sum_{n=0}^\infty a_n x^n
	= \sum_{n=0}^\infty \dv{x} a_n x^n
	= \sum_{n=1}^\infty n a_n x^{n-1}
	\quad(-R<x<R),
\end{equation}
其中\(R\)是\(\sum_{n=0}^\infty a_n x^n\)的收敛半径，
且逐项求导所得的幂级数\(\sum_{n=1}^\infty n a_n x^{n-1}\)的收敛半径也是\(R\).
\end{property}
\begin{remark}
虽然逐项积分所得的幂级数\(\sum_{n=1}^\infty n a_n x^{n-1}\)
和原幂级数\(\sum_{n=0}^\infty a_n x^n\)收敛半径相同，
但是它的收敛域相比于原幂级数可能缩小.

例如，幂级数\begin{equation*}
	\sum_{n=1}^\infty \frac{(-1)^{n-1}}{2n-1} x^{2n-1}
\end{equation*}的收敛域是\([-1,1]\)，
但逐项求导所得的幂级数\begin{equation*}
	\sum_{n=1}^\infty (-1)^{n-1} x^{2n-2}
\end{equation*}的收敛域是\((-1,1)\).
\end{remark}

反复利用\cref{theorem:无穷级数.幂级数的和函数的性质3} 可得以下结论.
\begin{proposition}
幂级数\(\sum_{n=0}^\infty a_n x^n\)的和函数
在其收敛区间\((-R,R)\)内具有任意阶导数.
\end{proposition}

\begin{example}
%@see: 《高等数学（第六版 下册）》 P276 例6
求幂级数\(\sum_{n=0}^\infty \frac{x^n}{n+1}\)的和函数.
\begin{solution}
先求收敛域.
由\begin{equation*}
	\lim_{n\to\infty} \abs{\frac{a_{n+1}}{a_n}}
	= \lim_{n\to\infty} \frac{n+1}{n+2}
	= 1,
\end{equation*}
得收敛半径\(R=1\).

当\(x = -1\)时，
幂级数成为\(\sum_{n=0}^\infty \frac{(-1)^n}{n+1}\)，
是莱布尼茨级数，收敛.
当\(x = 1\)时，
幂级数成为\(\sum_{n=0}^\infty \frac{1}{n+1}\)，
是发散的.
因此收敛域是\(I = [-1,1)\).

设和函数为\(s(x)\)，即\begin{equation*}
	s(x) = \sum_{n=0}^\infty \frac{x^n}{n+1},
	\quad x\in[-1,1).
\end{equation*}
于是\begin{equation*}
	x \cdot s(x) = \sum_{n=0}^\infty \frac{x^{n+1}}{n+1}.
\end{equation*}

利用\cref{theorem:无穷级数.幂级数的和函数的性质3}，逐项求导，并由\begin{equation*}
	\frac{1}{1-x} = 1+x+x^2+\dotsb+x^n+\dotsb
	\quad(-1<x<1),
\end{equation*}
得\begin{equation*}
	[x \cdot s(x)]'
	= \sum_{n=0}^\infty \left( \frac{x^{n+1}}{n+1} \right)'
	= \sum_{n=0}^\infty x^n
	= \frac{1}{1-x}
	\quad(\abs{x}<1).
\end{equation*}
对上式积分，
得\begin{equation*}
	x \cdot s(x) = \int_0^x \frac{1}{1-x} \dd{x} = -\ln(1-x)
	\quad(-1 \leq x < 1).
\end{equation*}
于是，当\(x\neq0\)时，有\(s(x) = -\frac{1}{x} \ln(1-x)\).

而\(s(0)\)可由\(s(0) = a_0 = 1\)得出，
或者由和函数的连续性得到，即\begin{equation*}
	s(0)
	= \lim_{x\to0} s(x)
	= \lim_{x\to0} \left[ -\frac{1}{x} \ln(1-x) \right]
	= 1.
\end{equation*}
故\begin{equation*}
	s(x) = \left\{ \begin{array}{cl}
		-\frac{1}{x} \ln(1-x), & x\in[-1,0)\cup(0,1), \\
		1, & x=0.
	\end{array} \right.
\end{equation*}
\end{solution}
%@Mathematica: Sum[x^n/(n + 1), {n, 0, Infinity}]
%@Mathematica: SumConvergence[x^n/(n + 1), n]
\end{example}

\begin{example}
%@see: 《2012年全国硕士研究生入学统一考试（数学一）》三解答题/第17题
求幂级数\(\sum_{n=0}^\infty \frac{4n^2+4n+3}{2n+1} x^{2n}\)的和函数.
%TODO
%@Mathematica: Sum[(4 n^2 + 4 n + 3)/(2 n + 1) x^(2 n), {n, 0, Infinity}] // FullSimplify
%@Mathematica: SumConvergence[(4 n^2 + 4 n + 3)/(2 n + 1) x^(2 n), n]
\end{example}
\begin{example}
%@see: 《2017年全国硕士研究生入学统一考试（数学一）》二填空题/第12题
求幂级数\(\sum_{n=1}^\infty (-1)^{n-1} n x^{n-1}\)的和函数.
%TODO
% 和函数为\(S(x) = \frac1{(1+x)^2}\ (-1<x<1)\).
%@Mathematica: Sum[(-1)^(n - 1) n x^(n - 1), {n, 0, Infinity}]
%@Mathematica: SumConvergence[(-1)^(n - 1) n x^(n - 1), n]
\end{example}

\begin{example}
%@see: 《2020年全国硕士研究生入学统一考试（数学一）》三解答题/第17题
设数列\(\{a_n\}\)满足\(a_1 = 1,
(n+1) a_{n+1} = \left( n + \frac12 \right) a_n\).
求幂级数\(\sum_{n=1}^\infty a_n x^n\)的收敛半径与和函数.
\begin{solution}
幂级数\(\sum_{n=1}^\infty a_n x^n\)的收敛半径为
\(\lim_{n\to\infty} \abs{\frac{a_n}{a_{n+1}}} = 1\).

假设它的和函数为\(S(x)\)，
那么\begin{align*}
	S'(x)
	&= \sum_{n=1}^\infty \dv{x} a_n x^n \\
	&= \sum_{n=1}^\infty n a_n x^{n-1}
	= \sum_{n=0}^\infty (n+1) a_{n+1} x^n \\
	&= 1 + \sum_{n=1}^\infty (n+1) a_{n+1} x^n \\
	% 代入\((n+1) a_{n+1} = \left( n + \frac12 \right) a_n\)
	&= 1 + \sum_{n=1}^\infty \left( n + \frac12 \right) a_n x^n \\
	&= 1 + \sum_{n=1}^\infty n a_n x^n + \frac12 \sum_{n=1}^\infty a_n x^n.
\end{align*}
于是得到一个一阶微分方程\begin{equation*}
	S'(x) = 1 + x S'(x) + \frac12 S(x),
\end{equation*}
整理得\begin{equation*}
	S'(x) - \frac1{2(1-x)} S(x) = \frac1{1-x},
\end{equation*}
其通解为\begin{equation*}
	S(x) = e^{\int \frac1{2(1-x)} \dd{x}}
	\left[ C + \int \frac1{1-x} e^{-\int \frac1{2(1-x)} \dd{x}} \dd{x} \right]
	% 由于收敛区间为\(-1<x<1\)，所以\(\ln\abs{1-x} = \ln(1-x)\).
	= \frac{C}{\sqrt{1-x}} - 2,
\end{equation*}
其中\(C\)是任意常数.
因为\(S(0) = \frac{C}{\sqrt{1-0}} - 2 = 0\)，
所以\(C = 2\)，
即\begin{equation*}
	S(x) = \frac2{\sqrt{1-x}} - 2
	\quad(-1<x<1).
\end{equation*}
\end{solution}
\end{example}
\begin{example}
%@see: 《2021年全国硕士研究生入学统一考试（数学一）》三解答题/第18题
设\(u_n(x) = e^{-nx} + \frac{x^{n+1}}{n(n+1)}\ (n=1,2,\dotsc)\).
求级数\(\sum_{n=1}^\infty u_n(x)\)的收敛域及和函数.
\begin{solution}
记\(S(x) = \sum_{n=1}^\infty u_n(x),
S_1(x) = \sum_{n=1}^\infty e^{-nx},
S_2(x) = \sum_{n=1}^\infty \frac{x^{n+1}}{n(n+1)}\).

我们知道，等比级数\(\sum_{n=1}^\infty e^{-nx}\)收敛当且仅当其公比的绝对值小于\(1\)，
即\(\abs{e^{-x}} < 1\)，
这就说明级数\(\sum_{n=1}^\infty e^{-nx}\)的收敛域为\((0,+\infty)\).
再由\cref{theorem:无穷级数.幂级数的收敛半径的求法2} 可知，
级数\(\sum_{n=1}^\infty \frac{x^{n+1}}{n(n+1)}\)的收敛半径为\begin{equation*}
	R = \lim_{n\to\infty} \abs{\frac{a_n}{a_{n+1}}}
	= \lim_{n\to\infty} \abs{\frac{(n+1)(n+2)}{n(n+1)}}
	= 1;
\end{equation*}
当\(x=1\)时，级数\(\sum_{n=1}^\infty \frac{x^{n+1}}{n(n+1)}\)成为
\(p\)级数\(\sum_{n=1}^\infty \frac1{n(n+1)}\)，
由\cref{example:无穷级数.p级数的收敛性} 可知该级数收敛.
于是级数\(\sum_{n=1}^\infty u_n(x)\)的收敛域为
\((0,+\infty) \cap (-1,1] = (0,1]\).

由\cref{example:无穷级数.等比级数的收敛性} 可知\begin{equation*}
	S_1(x) = \frac1{e^x-1}.
\end{equation*}
特别地，有\begin{equation*}
	S_1(1) = \frac1{e-1}.
\end{equation*}

当\(0<x<1\)时，
有\begin{align*}
	S_2(x) &= \sum_{n=1}^\infty \left( \frac{x^{n+1}}{n} - \frac{x^{n+1}}{n+1} \right) \\
	&= x \sum_{n=1}^\infty \frac{x^n}{n} - \sum_{n=2}^\infty \frac{x^n}{n} \\
	&= x + (x-1) \sum_{n=1}^\infty \frac{x^n}{n} \\
	&= x + (x-1) \int_0^x \sum_{n=1}^\infty \dv{t}(\frac{t^n}{n}) \dd{t} \\
	&= x + (1-x) \ln(1-x).
\end{align*}
注意到在上式中函数\(S_2\)在收敛域的端点\(x=1\)没有定义，需要另行计算.
由于\hyperref[theorem:无穷级数.幂级数的和函数的性质1]{幂级数的和函数在收敛域上连续}，
所以\begin{equation*}
	S_2(1) = \lim_{x\to1^-} S_2(x)
	= \lim_{x\to1^-} [x + (1-x) \ln(1-x)]
	%\cref{example:微分中值定理.洛必达法则.零乘无穷大型2}
	= 1.
\end{equation*}

综上所述，级数\(\sum_{n=1}^\infty u_n(x)\)的和函数为\begin{equation*}
	S(x)
	= S_1(x) + S_2(x) \\
	= \left\{ \begin{array}{cl}
		\frac1{e^x-1} + x + (1-x) \ln(1-x),
			& 0<x<1, \\
		\frac{e}{e-1},
			& x=1.
	\end{array} \right.
\end{equation*}
\end{solution}
\end{example}

\subsection{幂级数的运算}
\begin{definition}
设幂级数\(\sum_{n=0}^\infty a_n x^n\)
和\(\sum_{n=0}^\infty b_n x^n\)
分别在区间\((-R,R)\)和\((-R',R')\)内收敛.
定义：
\begin{gather}
	\left(\sum_{n=0}^\infty a_n x^n\right)
	+ \left(\sum_{n=0}^\infty b_n x^n\right)
	\defeq
	\sum_{n=0}^\infty (a_n+b_n) x^n, \\
	\left(\sum_{n=0}^\infty a_n x^n\right)
	- \left(\sum_{n=0}^\infty b_n x^n\right)
	\defeq
	\sum_{n=0}^\infty (a_n-b_n) x^n, \\
	\left(\sum_{n=0}^\infty a_n x^n\right)
	\cdot \left(\sum_{n=0}^\infty b_n x^n\right)
	\defeq
	\sum_{n=0}^\infty \left(
		\sum_{i=0}^n a_i b_{n-i}
	\right) x^n.
\end{gather}
\end{definition}

\begin{definition}
设幂级数\(\sum_{n=0}^\infty a_n x^n\)
和\(\sum_{n=0}^\infty b_n x^n\)
分别在区间\((-R,R)\)和\((-R',R')\)内收敛.

记\begin{equation*}
	\frac{
		\sum_{n=0}^\infty a_n x^n
	}{
		\sum_{n=0}^\infty b_n x^n
	}
	= \sum_{n=0}^\infty c_n x^n,
\end{equation*}
假设\(b_0 \neq 0\).
为了决定系数\(c_0,c_1,\dotsc,c_n,\dotsc\)，
可以将级数\(\sum_{n=0}^\infty b_n x^n\)
与\(\sum_{n=0}^\infty c_n x^n\)相乘，
并令乘积中各项的系数分别等于级数\(\sum_{n=0}^\infty a_n x^n\)中同次幂的系数，
即得\begin{equation*}
	\begin{cases}
		a_0 = b_0 c_0, \\
		a_1 = b_1 c_0 + b_0 c_1, \\
		a_2 = b_2 c_0 + b_1 c_1 + b_0 c_2, \\
		\hdotsfor{1} \\
	\end{cases}
\end{equation*}
由这些方程就可以顺序地求出\(c_0,c_1,\dotsc,c_n,\dotsc\).

相除后所得的幂级数\(\sum_{n=0}^\infty c_n x^n\)的收敛区间可能比原来的两级数的收敛区间小得多.
\end{definition}

例如，级数\begin{equation*}
	\sum_{n=0}^\infty a_n x^n
	= 1 + 0x + \dotsb + 0x^n + \dotsb
\end{equation*}与\begin{equation*}
	\sum_{n=0}^\infty b_n x^n
	= 1 - x + 0x^2 + \dotsb + 0x^n + \dotsb
\end{equation*}在整个数轴上收敛，
但是这两个级数的商\(\sum_{n=0}^\infty c_n x^n
= \sum_{n=0}^\infty x^n\)仅在区间\((-1,1)\)内收敛.
