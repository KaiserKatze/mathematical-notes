\section{泰勒公式}\label{section:微分中值定理.泰勒公式}
对于一些较复杂的函数，为了便于研究，往往希望用一些简单的函数来近似表达.
由于用多项式表示的函数，只要对自变量进行有限次加、减、乘三种算术运算，
便能求出它的函数值来，因此我们经常用多项式来近似表达函数.

在微分的应用中已经知道，当\(\abs{x}\)很小时，有如下的近似等式：\begin{equation*}
	e^x \approx 1+x, \qquad
	\ln(1+x) \approx x.
\end{equation*}
这些都是用一次多项式来近似表达函数的例子.
显然，在\(x=0\)处这些一次多项式及其一阶导数的值，
分别等于被近似表达的函数及其导数的相应值.

但是这种近似表达式还存在着不足之处：
首先是精确度不高，它所产生的误差仅是关于\(x\)的高阶无穷小；
其次是用它来作近似计算时，不能具体估算出误差大小.
因此，对于精确度要求较高且需要估计误差的时候，
就必须用高次多项式来近似表达函数，同时给出误差公式.

于是提出如下的问题：
设函数\(f\)在含有\(x_0\)的开区间内具有直到\((n+1)\)阶导数，
试找出一个关于\((x-x_0)\)的\(n\)次多项式\begin{equation*}
%@see: 《高等数学（第六版 上册）》 P140 (1)
	p_n(x)
	= a_0 + a_1 (x-x_0) + a_2 (x-x_0)^2 + \dotsb + a_n (x-x_0)^n
\end{equation*}来近似表达\(f\)，
要求\(p_n(x)\)与\(f(x)\)之差是比\((x-x_0)^n\)高阶的无穷小，
并给出误差\(\abs{f(x) - p_n(x)}\)的具体表达式.

下面我们来讨论这个问题.
假设\(p_n\)在\(x_0\)处的函数值及它的直到\(n\)阶导数在\(x_0\)处的值
依次与\(f(x_0),f'(x_0),\dotsc,f^{(n)}(x_0)\)相等，
即满足\begin{equation*}
	p_n(x) = f(x_0),
	p_n'(x) = f'(x_0),
	p_n''(x) = f''(x_0),
	\dotsc,
	p_n^{(n)}(x_0) = f^{(n)}(x_0),
\end{equation*}
按这些等式来确定多项式函数\(p_n\)的系数\(a_0,a_1,a_2,\dotsc,a_n\).
为此，对\(p_n\)求各阶导数，然后分别代入以上等式，得\begin{equation*}
	0! a_0 = f(x_0),
	1! a_1 = f'(x_0),
	2! a_2 = f''(x_0),
	\dotsc,
	n! a_n = f^{(n)}(x_0),
\end{equation*}
即得\begin{equation*}
	a_0 = \frac1{0!} f(x_0),
	a_1 = \frac1{1!} f'(x_0),
	a_2 = \frac1{2!} f''(x_0),
	\dotsc,
	a_n = \frac1{n!} f^{(n)}(x_0).
\end{equation*}

将求得的系数\(a_0,a_1,a_2,\dotsc,a_n\)代回多项式\(p_n\)，有\begin{equation*}
%@see: 《高等数学（第六版 上册）》 P140 (2)
	p_n(x) = f(x_0) + f'(x_0) (x-x_0)
	+ \frac{f''(x_0)}{2!} (x-x_0)^2
	+ \dotsb
	+ \frac{f^{(n)}(x_0)}{n!} (x-x_0)^n.
\end{equation*}
下面的定理表明，上述多项式的确是所要找的\(n\)次多项式.

\begin{theorem}[泰勒中值定理]\label{theorem:微分中值定理.泰勒中值定理}
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P184 定理2
%@see: 《高等数学（第六版 上册）》 P140 泰勒中值定理
%@see: 《数学分析教程（第3版 上册）》（史济怀） P199 定理4.3.1
\def\dyy{I}%定义域
\def\Xc{x_0,x}%
\def\Xa{\min\{\Xc\}}%
\def\Xb{\max\{\Xc\}}%
\def\X{\Xa,\Xb}%
设\([a,b] \subseteq \dyy \subseteq \mathbb{R}\)，
函数\(f\colon \dyy\to\mathbb{R}\)满足\begin{equation*}
	f \in C^n[a,b] \cap D^{n+1}(a,b).
\end{equation*}
那么对于\(\forall\Xc\in[a,b]\)，
记\begin{equation*}
	\alpha=\Xa, \qquad
	\beta=\Xb, \qquad
	X = (\alpha,\beta), \qquad
	\overline{X} = [\alpha,\beta],
\end{equation*}
对于\(\forall\phi \in C(\overline{X}) \cap D(X)
\cap \Set{u \given (\exists x \in X)[u'(x)\neq0]}\)，
\(\exists\xi \in X\)，
使得
\begin{equation}\label{equation:微分中值定理.泰勒公式1}
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P183 (7)
%@see: 《高等数学（第六版 上册）》 P140 (3)
	f(x) = p_n(x) + R_n(x),
\end{equation}
其中\begin{gather}
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P183 (5)
	p_n(x) = \sum_{k=0}^n \frac{f^{(k)}(x_0)}{k!} (x-x_0)^k,
		\label{equation:微分中值定理.泰勒公式.多项式1} \\
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P184 (8)
	R_n(x) = \frac{\phi(x)-\phi(x_0)}{\phi'(\xi) n!} f^{(n+1)}(\xi) (x-\xi)^n.
		\label{equation:微分中值定理.泰勒公式.余项0}
\end{gather}
\begin{proof}
考虑关于\(t\)的函数\begin{equation*}
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P184 (10)
	F(t) = f(x) - \left[
		\frac{f(t)}{0!} + \frac{f'(t)}{1!} (x-t) + \frac{f''(t)}{2!} (x-t)^2
		+ \dotsb + \frac{f^{(n)}(t)}{n!} (x-t)^n
	\right].
	\eqno(1)
\end{equation*}
可知\(F \in C(\overline{X}) \cap D(X)\)，
且\begin{align*}
	\dv{x}\kern-3pt\left[ \frac{f(t)}{0!} \right]
	&= \frac{f'(t)}{0!}, \\
	\dv{x}\kern-3pt\left[ \frac{f^{(k)}(t)}{k!} (x-t)^k \right]
	&= -\frac{f^{(k)}(t)}{(k-1)!} (x-t)^{k-1}
	+ \frac{f^{(k+1)}(t)}{k!} (x-t)^k,
	\quad k=2,3,\dotsc,n,
\end{align*}
从而有\begin{align*}
	F'(t)
	&= -\biggl[
	\frac{f'(t)}{0!} - \frac{f'(t)}{1!} + \frac{f''(t)}{1!} (x-t) - \frac{f''(t)}{1!} (x-t) \\
	&\hspace{25pt}+ \frac{f'''(t)}{2!} (x-t)^2 - \dotsb + \frac{f^{(n+1)}(t)}{n!} (x-t)^n
	\biggr] \\
	&= -\frac{f^{(n+1)}(t)}{n!} (x-t)^n.
\end{align*}
应用\hyperref[theorem:微分中值定理.柯西中值定理]{柯西中值定理}，
可知\(\exists\xi\in X\)，
使得\begin{equation*}
	\frac{F(\beta) - F(\alpha)}{\phi(\beta) - \phi(\alpha)}
	= \frac{F'(\xi)}{\phi'(\xi)}.
	\eqno(2)
\end{equation*}

把\(F'(\xi)\)的表达式\begin{equation*}
	F'(\xi) = -\frac{f^{(n+1)}(\xi)}{n!} (x-\xi)^n
	\eqno(3)
\end{equation*}代入(2)式，
得\begin{equation*}
	F(\beta) - F(\alpha)
	= -\frac{\phi(\beta) - \phi(\alpha)}{\phi'(\xi) n!} f^{(n+1)}(\xi) (x-\xi)^n.
\end{equation*}
于是\begin{equation*}
	F(x) - F(x_0)
	= -\frac{\phi(x) - \phi(x_0)}{\phi'(\xi) n!} f^{(n+1)}(\xi) (x-\xi)^n.
	\eqno(4)
\end{equation*}
最后，把\(F(x) = 0\)和\(F(x_0) = f(x) - p_n(x)\)代入(4)式，
就可得到\cref{equation:微分中值定理.泰勒公式.余项0}.
\end{proof}
\end{theorem}
多项式 \labelcref{equation:微分中值定理.泰勒公式.多项式1}
称为“函数\(f(x)\)按\((x-x_0)\)的幂展开的\(n\)次\DefineConcept{泰勒多项式}”.

在\cref{equation:微分中值定理.泰勒公式.余项0} 中取\(\phi(t) = (x-t)^{n+1}\)，就得到
\begin{equation}\label{equation:微分中值定理.泰勒公式.余项1}
%@see: 《数学分析教程（第3版 上册）》（史济怀） P200 (2)
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P184 (12)
%@see: 《高等数学（第六版 上册）》 P140 (4)
	R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!} (x-x_0)^{n+1}.
\end{equation}
像这样的\(R_n(x)\)的表达式 \labelcref{equation:微分中值定理.泰勒公式.余项1}
称为\DefineConcept{拉格朗日余项}（the Lagrange form of the remainder），
继而公式 \labelcref{equation:微分中值定理.泰勒公式1}
称为“\(f(x)\)按\((x-x_0)\)的幂展开的带有拉格朗日余项的\(n\)阶\DefineConcept{泰勒公式}
（Taylor's formula with the Lagrange form of the remainder）”.

在\cref{equation:微分中值定理.泰勒公式.余项0} 中取\(\phi(t) = x-t\)就得到
\begin{equation}\label{equation:微分中值定理.泰勒公式.余项4}
%@see: 《数学分析教程（第3版 上册）》（史济怀） P200 (3)
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P184 (11)
	R_n(x) = \frac{f^{(n+1)}(\xi)}{n!} (x-\xi)^n (x-x_0).
\end{equation}
像这样的\(R_n(x)\)的表达式 \labelcref{equation:微分中值定理.泰勒公式.余项4}
称为\DefineConcept{柯西余项}（the Cauchy form of the remainder）.

当\(n=0\)时，泰勒公式变成\hyperref[equation:微分中值定理.拉格朗日中值公式]{拉格朗日中值公式}：\begin{equation*}
	f(x) = f(x_0) + f'(\xi) (x-x_0), \quad x_0 < \xi < x.
\end{equation*}
因此，泰勒中值定理是拉格朗日中值定理的推广.

由泰勒中值定理可知，以多项式\(p_n(x)\)近似表达函数\(f(x)\)时，
其误差为\(\abs{R_n(x)}\).
如果对于某个固定的\(n\)，
当\(x\in(a,b)\)时，
\(\abs{f^{(n+1)}(x)} \leq M\)，
则有估计式\begin{equation}\label{equation:微分中值定理.泰勒公式.误差1}
	\abs{R_n(x)}
	= \abs{\frac{f^{(n+1)}(\xi)}{(n+1)!} (x-x_0)^{n+1}}
	\leq \frac{M}{(n+1)!} \abs{x-x_0}^{n+1}
\end{equation}
及\begin{equation*}
	\lim_{x \to x_0} \frac{R_n(x)}{(x-x_0)^n} = 0
\end{equation*}
由此可见，当\(x \to x_0\)时，
误差\(\abs{R_n(x)}\)是比\((x-x_0)^n\)高阶的无穷小，
即\begin{equation}\label{equation:微分中值定理.泰勒公式.余项2}
	R_n(x) = o[(x-x_0)^n].
\end{equation}

在不需要余项的精确表达式时，\(n\)阶泰勒公式也可以写成
\begin{equation}\label{equation:微分中值定理.泰勒公式2}
	f(x) = p_n(x) + o[(x - x_0)^n].
\end{equation}
\(R_n(x)\)的表达式 \labelcref{equation:微分中值定理.泰勒公式.余项2} 称为\DefineConcept{皮亚诺余项}.
\cref{equation:微分中值定理.泰勒公式2} 称为
“\(f(x)\)按\((x-x_0)\)的幂展开的带有皮亚诺余项的\(n\)阶泰勒公式
（Taylor's formula with the Peano form of the remainder）”.

在泰勒公式 \labelcref{equation:微分中值定理.泰勒公式1} 中，
如果取\(x_0 = 0\)，则\(\xi\)在\(0\)与\(x\)之间.
因此可以令\(\xi = \theta x\ (0 < \theta < 1)\)，从而泰勒公式变成较简单的形式，
即所谓“带有拉格朗日余项的\DefineConcept{麦克劳林公式}
（Maclaurin's formula with the Lagrange form of the remainder）”：
\begin{equation}\label{equation:微分中值定理.泰勒公式3}
	f(x)=\sum_{k=0}^n \frac{f^{(k)}(0)}{k!} x^k
		+ \frac{f^{(n+1)}(\theta x)}{(n+1)!} x^{n+1},
	\quad 0 < \theta < 1.
\end{equation}

在泰勒公式 \labelcref{equation:微分中值定理.泰勒公式2} 中，
如果取\(x_0 = 0\)，则有“带有皮亚诺余项的麦克劳林公式
（Maclaurin's formula with the Peano form of the remainder）”：
\begin{equation}\label{equation:微分中值定理.泰勒公式4}
	f(x)=\sum_{k=0}^n \frac{f^{(k)}(0)}{k!} x^k + o(x^n).
\end{equation}

误差估计式 \labelcref{equation:微分中值定理.泰勒公式.误差1} 相应地变成：
\begin{equation}\label{equation:微分中值定理.泰勒公式.误差2}
	\abs{R_n(x)} \leq \frac{M}{(n+1)!} \abs{x}^{n+1}.
\end{equation}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P142 例1
写出函数\(f(x) = e^x\)的带有拉格朗日余项的\(n\)阶麦克劳林公式.
\begin{solution}
因为\(f(x)=f'(x)=f''(x)=\dotsb=f^{(n)}(x)=f^{(n+1)}(x)=e^x\)，所以\begin{equation*}
	f(0)=f'(0)=f''(0)=\dotsb=f^{(n)}(0)=1.
\end{equation*}
将这些值代入带有拉格朗日余项的麦克劳林公式，
并注意到\(f^{(n+1)}(\theta x) = e^{\theta x}\)
便得\begin{equation*}%\(e^x\)的泰勒公式
	e^x = 1 + x + \frac{1}{2!} x^2 + \dotsb
	+ \frac{1}{n!} x^n + \frac{e^{\theta x}}{(n+1)!} x^{n+1},
	\quad 0 < \theta < 1.
\end{equation*}

由这个公式可知，若把\(e^x\)用它的\(n\)次泰勒多项式表达为\begin{equation*}
	e^x \approx 1 + x + \frac{x^2}{2!} + \dotsb + \frac{x^n}{n!},
\end{equation*}
这时所产生的误差为\begin{equation*}
	\abs{R_n(x)} = \abs{\frac{e^{\theta x}}{(n+1)!} x^{n+1}}
	< \frac{e^{\abs{x}}}{(n+1)!} \abs{x}^{n+1},
	\quad 0 < \theta < 1.
\end{equation*}

如果取\(x = 1\)，则得无理数\(e\)的近似式为\begin{equation*}
	e \approx 1 + 1 + \frac{1}{2!} + \dotsb + \frac{1}{n!},
\end{equation*}
其误差\(\abs{R_n} < \frac{e}{(n+1)!} < \frac{3}{(n+1)!}\).
当\(n=10\)时，可算出\(e \approx 2.718\ 282\)，其误差不超过\(10^{-6}\).
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P143 例2
求\(f(x)=\sin x\)的带有拉格朗日余项的\(n\)阶麦克劳林公式.
\begin{solution}
因为\begin{align*}
	f'(x)=\cos x,
	f''(x)=-\sin x,
	f'''(x)=-\cos x, \\
	f^{(4)}(x)=\sin x,
	\dotsc,
	f^{(n)}(x)=\sin\left(x+\frac{n\pi}{2}\right),
\end{align*}
所以\begin{equation*}
	f(0)=0,f'(0)=1,f''(0)=0,f'''(0)=-1,f^{(4)}(0)=0
\end{equation*}等等，
它们依次循环地取四个数\(0,1,0,-1\)，
于是按带有拉格朗日余项的麦克劳林公式（令\(n=2m\)）得\begin{equation*}
	\sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \dotsb + (-1)^{m-1} \frac{x^{2m-1}}{(2m-1)!} + R_{2m},
\end{equation*}
其中\begin{align*}
	R_{2m}
	&= \frac{1}{(2m+1)!} \sin\left[\theta x + (2m+1)\frac{\pi}{2}\right] x^{2m+1} \\
	&= (-1)^m \frac{\cos \theta x}{(2m+1)!} x^{2m+1},
	\quad 0<\theta<1.
\end{align*}

如果取\(m=1\)，则得近似公式\begin{equation*}
	\sin x \approx x,
\end{equation*}
这时误差为\begin{equation*}
	\abs{R_2} = \abs{-\frac{\cos \theta x}{3!} x^3}
	\leq \frac{\abs{x}^3}{6},
	\quad 0<\theta<1.
\end{equation*}
\end{solution}
\end{example}

类似地，还可以得到\begin{equation*}%\(\cos x\)的泰勒公式
	\cos x
	= 1 - \frac{1}{2!} x^2
		+ \frac{1}{4!} x^4 - \dotsb
		+ (-1)^m \frac{1}{(2m)!} x^{2m}
		+ R_{2m+1}(x),
\end{equation*}
其中\begin{align*}%\(\cos x\)的泰勒公式的拉格朗日余项
	R_{2m+1}(x)
	&= \frac{x^{2m+2}}{(2m+2)!} \cos\left[\theta x + (m+1)\pi\right] \\
	&= (-1)^{m+1} \frac{\cos \theta x}{(2m+2)!} x^{2m+2},
	\quad 0<\theta<1;
\end{align*}
以及\begin{equation*}%\(\ln(1+x)\)的泰勒公式
	\ln(1+x)
	= x - \frac{1}{2} x^2 + \frac{1}{3} x^3 - \dotsb
		+ (-1)^{n-1} \frac{1}{n} x^n + R_n(x),
\end{equation*}
其中\begin{equation*}%\(\ln(1+x)\)的泰勒公式的拉格朗日余项
	R_n(x) = \frac{\alpha(\alpha-1)\dotsm(\alpha-n+1)(\alpha-n)}{(n+1)!}
	(1+\theta x)^{\alpha-n-1} x^{n+1}
	\quad(0<\theta<1)
\end{equation*}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P144 例3
求极限\(\lim_{x\to0}\frac{\sin x - x \cos x}{\sin^3 x}\).
\begin{solution}
由于分式的分母\(\sin^3 x \sim x^3\ (x\to0)\)，
我们只需将分子中的\(\sin x\)和\(x \cos x\)分别用带有皮亚诺余项的三阶麦克劳林公式表示，
即\begin{equation*}
	\sin x = x - \frac{x^3}{3!} + o(x^3),
	\qquad
	x \cos x = x - \frac{x^3}{2!} + o(x^3).
\end{equation*}
于是\begin{equation*}
	\sin x - x \cos x = \frac{1}{3} x^3 + o(x^3),
\end{equation*}
故\begin{equation*}
	\lim_{x\to0}\frac{\sin x - x \cos x}{\sin^3 x}
	= \lim_{x\to0}\frac{\frac{1}{3} x^3 + o(x^3)}{x^3} = \frac{1}{3}.
\end{equation*}
\end{solution}
\end{example}

\begin{example}
设函数\(f\)具有二阶连续导数，\(\lim_{x\to0} \frac{f(x)}{x} = 0\)，\(f''(0)\neq0\)，
若\begin{equation*}
	\lim_{x\to0} \frac{e^{f(x)}-ax-b}{x^2} = c \neq 0,
\end{equation*}
求\(a,b,c\).
\begin{solution}
因为\(\lim_{x\to0} \frac{f(x)}{x} = 0\)，
所以\(f(x) = o(x)\)，
\(\lim_{x\to0} f(x) = 0\).
又因为\(f\)是连续的，
所以\(f(0) = \lim_{x\to0} f(x) = 0\)，
从而\begin{equation*}
	f'(0) = \lim_{x\to0} \frac{f(x) - f(0)}{x - 0} = \frac{f(x)}{x} = 0.
\end{equation*}
因此\begin{equation*}
	f(x) = \frac12 f''(0) x^2 + o(x^2),
	\qquad
	[f(x)]^2 = o(x^2).
\end{equation*}

因为\(e^x = 1 + x + \frac{1}{2!} x^2 + o(x^2)\)，
所以\begin{equation*}
	e^{f(x)} = 1 + f(x) + \frac{1}{2} [f(x)]^2 + o(x^2)
	= 1 + \frac{1}{2} f''(0) x^2 + o(x^2).
\end{equation*}

因为\begin{equation*}
	\lim_{x\to0} \frac{e^{f(x)} - ax - b}{c x^2} = 1,
\end{equation*}
所以\(e^{f(x)} - ax - b = c x^2 + o(x^2)\)，
即\begin{equation*}
	\left[ 1 + \frac{1}{2} f''(0) x^2 + o(x^2) \right] - ax - b = c x^2 + o(x^2).
\end{equation*}
对比得\(a = 0, b = 1, c = \frac{1}{2} f''(0)\).
\end{solution}
\end{example}

\begin{example}
计算极限\begin{equation*}
	\lim_{x\to1} \left(\frac{m}{1-x^m} - \frac{n}{1-x^n}\right).
\end{equation*}
\begin{solution}
直接计算得
\begin{align*}
	&\hspace{-10pt}
	\lim_{x\to1} \left(\frac{m}{1-x^m} - \frac{n}{1-x^n}\right) \\
	&\xlongequal{x-1=t}
	\lim_{t\to0} \left[\frac{m}{1-(1+t)^m}-\frac{n}{1-(1+t)^n}\right] \\
	&=
	\lim_{t\to0} \frac{m[1-(1+t)^n]-n[1-(1+t)^m]}{[1-(1+t)^m][1-(1+t)^n]} \\
	&=
	\lim_{t\to0} \frac{m\left[-nt-\frac{1}{2}n(n-1)t^2+o(t^2)\right]
		-n\left[-mt-\frac{1}{2}m(m-1)t^2+o(t^2)\right]}{[-mt+o(t)][-nt+o(t)]} \\
	&=
	\lim_{t\to0} \frac{\frac{1}{2}mn(m-n)t^2+o(t^2)}{mnt^2+o(t^2)}
	= \frac{m-n}{2}.
\end{align*}
\end{solution}
\end{example}

\begin{example}
计算极限\begin{equation*}
	\lim_{n\to\infty} \frac{1}{e^n} \left(1+\frac{1}{n}\right)^{n^2}.
\end{equation*}
\begin{solution}
注意到当\(n\to\infty\)时，
\(1+\frac1n\to1\)而\(n^2\to\infty\)，
可见\(\left(1+\frac{1}{n}\right)^{n^2}\)是\(1^\infty\)型未定式.
于是利用\hyperref[equation:函数.对数恒等式]{对数恒等式}变形得到\begin{equation*}
	\frac{1}{e^n} \left(1+\frac{1}{n}\right)^{n^2}
	= \exp\ln\frac{1}{e^n} \left(1+\frac{1}{n}\right)^{n^2}
	= \exp[ n^2 \ln(1+\frac{1}{n}) - n ].
\end{equation*}
利用\(\ln(1+x)\)的泰勒公式\begin{equation*}
	\ln(1+x)
	= x - \frac{1}{2} x^2 + \frac{1}{3} x^3 - \dotsb
		+ (-1)^{n-1} \frac{1}{n} x^n + o(x^n)
\end{equation*}得到\begin{equation*}
	\ln(1+\frac1n)
	= \frac1n - \frac12\cdot\frac1{n^2} + \frac13\cdot\frac1{n^3}
	+ o\left( \frac1{n^3} \right),
\end{equation*}
那么\begin{equation*}
	\exp[ n^2 \ln(1+\frac{1}{n}) - n ]
	= \exp[
		n - \frac12 + \frac13\cdot\frac1n + o\left( \frac1n \right)
		- n
	]
	\to e^{-\frac12}
	\quad(n\to\infty).
\end{equation*}
\end{solution}
\end{example}
\begin{example}
求\(f(x) = (1+x)^{\frac1x}\)的带有皮亚诺余项的\(n\)阶麦克劳林公式.
\begin{solution}
%@see: https://math.stackexchange.com/a/1975754/591741
利用\hyperref[equation:函数.对数恒等式]{对数恒等式}变形得到\begin{equation*}
	f(x) = (1+x)^{\frac1x}
	= \exp\frac{\ln(1+x)}x.
\end{equation*}
由\(\ln(1+x)\)的泰勒公式\begin{equation*}
	\ln(1+x)
	= x - \frac12 x^2 + \frac13 x^3 - \dotsb
		+ (-1)^{n-1} \frac1n x^n + o(x^n)
\end{equation*}得\begin{align*}
	f(x) &= \exp\left(
		1 - \frac12 x + \frac13 x^2 - \dotsb
		+ (-1)^{n-1} \frac1n x^{n-1} + o(x^n)
	\right) \\
	&= e \cdot \exp(-\frac12 x + \frac13 x^2 - \dotsb + (-1)^{n-1} \frac1n x^{n-1} + o(x^n)).
\end{align*}
记\(g(x) = -\frac12 x + \frac13 x^2 - \dotsb + (-1)^{n-1} \frac1n x^{n-1}\)，
则\(f(x) = e \cdot \exp(g(x) + o(x^n))\).
再由\(e^x\)的泰勒公式\begin{equation*}
	e^x = 1 + x + \frac1{2!} x^2 + \dotsb
	+ \frac1{n!} x^n + o(x^n)
\end{equation*}得\begin{equation*}
	f(x)
	= e \left[ 1 + g(x) + \frac1{2!} g^2(x) + \dotsb + \frac1{n!} g^n(x) + o(x^n) \right].
\end{equation*}
特别地，当\(n=4\)时，有\begin{equation*}
	f(x) = e \left( 1 - \frac12 x + \frac{11}{24} x^2 - \frac7{16} x^3 \right) + o(x^4).
\end{equation*}
\end{solution}
%@Mathematica: Series[(1 + x)^(1/x), {x, 0, 3}]
\end{example}

\begin{example}
%@see: 《2023年全国硕士研究生入学统一考试（数学一）》三解答题/第20题
设函数\(f(x)\)在\([-a,a]\)上具有二阶连续导数，证明：
\begin{enumerate}
	\item 若\(f(0)=0\)，则存在\(\xi\in(-a,a)\)，
	使得\(f''(\xi) = \frac{1}{a^2} [f(a) + f(-a)]\)；

	\item 若\(f(x)\)在\((-a,a)\)内取得极值，则存在\(\eta\in(-a,a)\)，
	使得\begin{equation*}
		\abs{f''(\eta)}
		\geq
		\frac{1}{2a^2} \abs{f(a) - f(-a)}.
	\end{equation*}
\end{enumerate}
\begin{proof}
假设\(f(0) = 0\).
因为函数\(f\)在\([-a,a]\)上具有二阶连续导数，
由泰勒中值定理可知，
对\(\forall x\in(-a,a)\)，有
\begin{align*}
	f(x) &= f(0) + f'(0) x + \frac{1}{2} f''(\xi) x^2 \\
	&= f'(0) x + \frac{1}{2} f''(\xi) x^2,
\end{align*}
其中\(\xi\)是\(0\)与\(x\)之间的某个值.
因此\begin{equation*}
	f(a) = f'(0) a + \frac{1}{2} f''(\xi_1) a^2,
	\quad \xi_1\in(0,a),
	\eqno(1)
\end{equation*}\begin{equation*}
	f(-a) = f'(0) (-a) + \frac{1}{2} f''(\xi_2) (-a)^2,
	\quad \xi_2\in(-a,0).
	\eqno(2)
\end{equation*}
(1)、(2)两式相加得\begin{equation*}
	f(a) + f(-a) = \frac{a^2}{2} [f''(\xi_1) + f''(\xi_2)].
	\eqno(3)
\end{equation*}
又因为\(f''(x)\)在闭区间\([\xi_2,\xi_1]\)上连续，
必有最大值\(M\)和最小值\(m\)，即\begin{equation*}
	m \leq f''(\xi_1) \leq M,
	\qquad
	m \leq f''(\xi_2) \leq M,
\end{equation*}
从而\begin{equation*}
	m \leq \frac{f''(\xi_1) + f''(\xi_2)}{2} \leq M.
\end{equation*}
由介值定理得，\(\exists\xi\in[\xi_2,\xi_1]\subseteq(-a,a)\)，使得\begin{equation*}
	\frac{f''(\xi_1) + f''(\xi_2)}{2} = f''(\xi).
	\eqno(4)
\end{equation*}
将(4)式代入(3)式，命题1得证.

假设\(f(x)\)在\((-a,a)\)内取得极值.
设\(f\)在点\(x=x_0\in(-a,a)\)处取得极值，由费马引理可知\(f'(x_0)=0\).
于是有函数\(f\)按\(x-x_0\)的幂展开的带有拉格朗日余项的1阶泰勒公式：
\begin{align*}
	f(x) &= f(x_0) + f'(x_0) (x-x_0) + \frac{f''(\gamma)}{2!} (x-x_0)^2 \\
	&= f(x_0) + \frac{f''(\gamma)}{2!} (x-x_0)^2
	\quad(\text{\(\gamma\)介于\(x_0\)与\(x\)之间}),
\end{align*}
则\begin{equation*}
	f(-a) = f(x_0) + \frac{f''(\gamma_1)}{2!}(-a-x_0)^2,
	\quad\gamma_1\in(-a,x_0),
\end{equation*}\begin{equation*}
	f(a) = f(x_0) + \frac{f''(\gamma_2)}{2!} (a-x_0)^2,
	\quad\gamma_2\in(x_0,a),
\end{equation*}
从而
\begin{align*}
	\abs{f(a)-f(-a)}
	&= \abs{\frac{1}{2} (a-x_0)^2 f''(\gamma_2) - \frac{1}{2} (a+x_0)^2 f''(\gamma_1)} \\
	&\leq \frac{1}{2} \abs{(a-x_0)^2 f''(\gamma_2)} + \frac{1}{2} \abs{(a+x_0)^2 f''(\gamma_1)}.
\end{align*}
因为\(\abs{f''(x)}\)连续，
设\(M = \max\{ \abs{f''(\gamma_1)}, \abs{f''(\gamma_2)} \}\)，
则\begin{equation*}
	\abs{f(a) - f(-a)}
	\leq \frac{1}{2} M(a+x_0)^2 + \frac{1}{2} M(a-x_0)^2
	= M(a^2 + x_0^2).
\end{equation*}
因为\(x_0\in(-a,a)\)，
则\begin{equation*}
	\abs{f(a) - f(-a)} \leq M(a^2+x_0^2) \leq 2 M a^2,
\end{equation*}
则\(M \geq \frac{1}{2 a^2} \abs{f(a) - f(-a)}\)，
即存在\(\eta\in\{\gamma_1,\gamma_2\}\subseteq(-a,a)\)，
使得\(\abs{f''(\eta)} \geq \frac{1}{2 a^2} \abs{f(a) - f(-a)}\).
命题2得证.
\end{proof}
\end{example}

%积分余项的表达式为\begin{equation}\label{equation:微分中值定理.泰勒公式.余项3}
%R_n = \int_{x_0}^x f^{(n+1)}(t) \frac{(x-t)^n}{n!} \dd{t}.
%\end{equation}
%积分余项的应用条件是：\(f \in C^n\)，即\(n\)阶可导且导函数均连续.

\begin{example}
%@see: https://math.stackexchange.com/questions/4829692/what-is-the-limit-of-x-n-x-n1n
%@credit: {8b6edada-f2fd-4ae5-9020-eb533149a54c},{5a781423-ba4e-4629-ac1a-eac743a4d445}
设数列\(\{x_n\}\)满足\(0<x_1<\pi\)，且有递推公式\(x_{n+1}=\sin x_n\ (n=1,2,\dotsc)\).
证明以下极限收敛，并进行计算：\begin{equation*}
	\lim_{n\to\infty} x_n,
	\qquad
	\lim_{n\to\infty} \left(\frac{x_{n+1}}{x_n}\right)^{1/x_n^2},
	\qquad
	\lim_{n\to\infty} \left(\frac{x_n}{x_{n+1}}\right)^n.
\end{equation*}
\begin{solution}
令\(f(x) = x - \sin x\ (0<x<\pi)\)，
求导得\(f'(x) = 1 - \cos x\).
因为\(-1 < \cos x < 1\ (0<x<\pi)\)，
所以\begin{equation*}
	0 < f'(x) < 2
	\quad(0<x<\pi)
\end{equation*}
恒成立，
这就说明函数\(f\)在\((0,\pi)\)严格单调增加.
又因为\(f(0) = 0\)，
所以恒成立\begin{equation*}
	f(x) = x - \sin x > 0
	\quad(0<x<\pi).
\end{equation*}
因为\(0<x_1<\pi\)，
所以\begin{equation*}
	0<x_2=\sin x_1\leq1<\frac\pi2.
\end{equation*}
利用数学归纳法易证：当\(n\geq2\)时，成立\(0<x_n\leq1\)，数列\(\{x_n\}\)有界.
进一步有\begin{equation*}
	0<x_3=\sin x_2<x_2<1.
\end{equation*}
利用数学归纳法易证：当\(n\geq3\)时，成立\(0<x_{n+1}<x_n<1\)，数列\(\{x_n\}\)严格单调减少.
根据\hyperref[theorem:极限.数列的单调有界定理]{单调有界定理}可知，数列\(\{x_n\}\)收敛.

假设\(\lim_{n\to\infty} x_n = x\).
对递推公式\(x_{n+1}=\sin x_n\)令\(n\to\infty\)得\(x=\sin x\).
由上可知，方程\(x=\sin x\ (0 \leq x \leq 1)\)有唯一解\(x=0\)，
因此\(\lim_{n\to\infty} x_n = 0\).

直接计算\begin{align*}
	\lim_{n\to\infty} \left(\frac{x_{n+1}}{x_n}\right)^{1/x_n^2}
	&= \lim_{x\to0^+} \left(\frac{\sin x}{x}\right)^{1/x^2}
	= \lim_{x\to0^+} \exp\left(\frac1{x^2}\ln\frac{\sin x}{x}\right) \\
	&= \exp\lim_{x\to0^+} \frac1{x^2} \ln\left(1+\frac{\sin x-x}{x}\right) \\
	&= \exp\lim_{x\to0^+} \frac{\sin x-x}{x^3} \\
	&= \exp\lim_{x\to0^+} \frac{-x^3/6}{x^3}
	= e^{-\frac16}.
\end{align*}

令\begin{equation*}
	f(x) = \left\{ \begin{array}{cl}
		\frac{x}{\sin x}, & x\neq0, \\
		1, & x=0.
	\end{array} \right.
\end{equation*}
当\(x\neq0\)时，求导得\begin{equation*}
	f'(x) = \frac{\sin x - x \cos x}{\sin^2 x},
	\qquad
	f''(x) = \frac{x \sin^3 x - 2 \sin^2 x \cos x + 2 x \sin x \cos^2 x}{\sin^4 x}.
\end{equation*}
于是\(f(0) = 1,
f'(0) = 0,% 这里用到了\hyperref[theorem:微分中值定理.导数极限定理]{导数极限定理}
f''(0) = 1/3\)，
从而有\begin{equation*}
	f(x) = 1 + \frac16 x^2 + o(x^2).
\end{equation*}
因此\begin{align*}
	\lim_{n\to\infty} \left(\frac{x_n}{x_{n+1}}\right)^n
	&= \lim_{n\to\infty} \left(\frac{x_n}{\sin x_n}\right)^n
	= \lim_{n\to\infty} \left(1+\frac16 x_n^2+o(x_n^2)\right)^n \\
	&= \exp\lim_{n\to\infty} n\ln\left(1+\frac16 x_n^2+o(x_n^2)\right)
	= \exp\lim_{n\to\infty} \frac{n x_n^2}6,
\end{align*}
这里\begin{align*}
	\lim_{n\to\infty} n x_n^2
	&= \lim_{n\to\infty} \frac{n}{x_n^{-2}}
	= \lim_{n\to\infty} \frac1{x_{n+1}^{-2}-x_n^{-2}}
		\tag{\hyperref[theorem:极限.施托尔茨定理1]{施托尔茨定理}} \\
	&= \lim_{n\to\infty} \frac{x_n^2 x_{n+1}^2}{x_n^2-x_{n+1}^2}
	= \lim_{n\to\infty} \frac{x_n^2 \sin^2 x_n}{(x_n-\sin x_n)(x_n+\sin x_n)} \\
	&= \lim_{n\to\infty} \frac{x_n^4}{\frac16 x_n^3 \cdot 2 x_n}
	= 3,
\end{align*}
可知\begin{equation*}
	\lim_{n\to\infty} \left(\frac{x_n}{x_{n+1}}\right)^n
	= e^{\frac12}.
\end{equation*}
\end{solution}
% 利用递推公式定义数列
%@Mathematica: f[1] := 1
%@Mathematica: f[n_] := Sin[f[n - 1]]
% 在指定区间上绘制数列的散点图
%@Mathematica: DiscretePlot[f[n], {n, 1, 20}]
% 定义数列
%@Mathematica: g[n_] := (f[n]/f[n + 1])^n
% 在指定区间上绘制数列的散点图
%@Mathematica: DiscretePlot[g[n], {n, 1, 20}]
\end{example}

\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》二填空题/第12题
设函数\(f(x) = \arctan x - \frac{x}{1 + a x^2}\)，
且\(f'''(0) = 1\)，
求\(a\)的取值.
\begin{solution}
由于\begin{equation*}
	\arctan x = x - \frac13 x^3 + o(x^3),
	\qquad
	\frac1{1+x} = 1 - x + o(x),
\end{equation*}
而\begin{equation*}
	\frac1{1 + a x^2}
	= 1 - a x^2 + o(x^2),
	\qquad
	\frac{x}{1 + a x^2}
	= x - a x^3 + o(x^3),
\end{equation*}
所以\begin{equation*}
	f(x) = \left( x - \frac13 x^3 + o(x^3) \right)
	- \left( x - a x^3 + o(x^3) \right)
	= \left( a - \frac13 \right) x^3 + o(x^3).
\end{equation*}
又因为\begin{equation*}
	f(x) = f(0) + f'(0) x + \frac{f''(0)}{2!} x^2 + \frac{f'''(0)}{3!} x^3 + o(x^3),
\end{equation*}
所以由泰勒公式的唯一性可知\(\frac{f'''(0)}{3!} = a - \frac13\)，
因此\(a = \frac13 + \frac1{3!}
= \frac12\).
\end{solution}
\end{example}
