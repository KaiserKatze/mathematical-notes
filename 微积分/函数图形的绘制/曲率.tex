\section{曲率}\label{section:微分中值定理.曲率}
\subsection{弧微分}
作为曲率的预备知识，先介绍弧微分的概念.

设函数\(f(x)\)在区间\((a,b)\)内具有连续导数.
在曲线\(y=f(x)\)上取固定点\(M_0(x_0,y_0)\)作为度量弧长的基点，
并规定依\(x\)增大的方向作为曲线的正向.
对曲线上任一点\(M(x,y)\)，
规定有向弧段\(\Arc{M_0 M}\)的值\(s\)（简称为弧\(s\)）如下：
\(s\)的绝对值等于这弧段的长度，
当有向弧段\(\Arc{M_0 M}\)的方向与曲线的正向一致时\(s>0\)，相反时\(s<0\).
显然，弧\(s\)与\(x\)存在函数关系：
\(s = s(x)\)，而且\(s(x)\)是\(x\)的单调增加函数.
下面来求\(s(x)\)的导数及微分.

设\(x\)、\(x+\increment x\)为\((a,b)\)内两个邻近的点，
它们在曲线\(y=f(x)\)上的对应点为\(M\)、\(M'\)，
并设对应于\(x\)的增量\(\increment x\)，
弧\(s\)的增量为\(\increment s\)，
那么\begin{equation*}
	\increment s = \Arc{M_0 M'} - \Arc{M_0 M} = \Arc{M M'}.
\end{equation*}
于是\begin{align*}
	\left(\frac{\increment s}{\increment x}\right)^2
	&= \left(\frac{\Arc{M M'}}{\increment x}\right)^2
	= \left(\frac{\Arc{M M'}}{\abs{M M'}}\right)^2
		\cdot \frac{\abs{M M'}^2}{(\increment x)^2} \\
	&= \left(\frac{\Arc{M M'}}{\abs{M M'}}\right)^2
		\cdot \frac{(\increment x)^2 + (\increment y)^2}{(\increment x)^2} \\
	&= \left(\frac{\Arc{M M'}}{\abs{M M'}}\right)^2
		\cdot \left[ 1 + \left(\frac{\increment y}{\increment x}\right)^2 \right],
\end{align*}\begin{equation*}
	\frac{\increment s}{\increment x}
	= \pm \sqrt{\left(\frac{\Arc{M M'}}{\abs{M M'}}\right)^2
	\cdot \left[ 1 + \left(\frac{\increment y}{\increment x}\right)^2 \right]}.
\end{equation*}
令\(\increment x\to0\)取极限，
由于\(\increment x\to0\)时，
\(M' \to M\)，
这时弧的长度与弦的长度之比的极限等于1，
即\begin{equation*}
	\lim_{M' \to M} \frac{\abs{\Arc{M M'}}}{\abs{M M'}} = 1,
\end{equation*}
又\begin{equation*}
	\lim_{\increment x\to0} \frac{\increment y}{\increment x} = y',
\end{equation*}
因此得\begin{equation*}
	\dv{s}{x} = \pm \sqrt{1 + (y')^2}.
\end{equation*}
由于\(s = s(x)\)是单调增加函数，从而上式根号前应取正号，
于是有\begin{equation}
	\dd{s} = \sqrt{1 + (y')^2} \dd{x},
\end{equation}
这就是\DefineConcept{弧微分公式}.

弧微分公式也可写作\begin{equation}
	\dd{s} = \sqrt{(\dd{x})^2 + (\dd{y})^2}.
\end{equation}

\subsection{曲率及其计算公式}
设曲线\(C\)是光滑的（即曲线上每一点处都具有切线，且切线随切点的移动而连续转动），
在曲线\(C\)上选定一点\(M_0\)作为度量弧\(s\)的基点.
设曲线上点\(M\)对应于弧\(s\)，
在点\(M\)处切线的倾角为\(\alpha\)
（这里假定曲线\(C\)所在的平面上已设立了\(xOy\)坐标系），
曲线上另外一点\(M'\)对应于弧\(s+\increment s\)，
在点\(M'\)处切线的倾角为\(\alpha + \increment \alpha\).
那么，弧段\(\Arc{MM'}\)的长度为\(\abs{\increment s}\).
当动点从\(M\)移动到\(M'\)时切线转过的角度为\(\abs{\increment \alpha}\).

我们用比值\(\frac{\abs{\increment\alpha}}{\abs{\increment s}}\)，
即单位弧段上切线转过的角度的大小来表达弧段\(\Arc{MM'}\)的平均弯曲程度，
把这比值叫做弧段\(\Arc{MM'}\)的\DefineConcept{平均曲率}，
并记作\(\overline{K}\)，即\begin{equation*}
	\overline{K} = \abs{\frac{\increment\alpha}{\increment s}}.
\end{equation*}

类似于从平均速度引进瞬时速度的方法，
当\(\increment s\to0\)（即\(M' \to M\)）时，
上述平均曲率的极限叫做曲线\(C\)在点\(M\)处的\DefineConcept{曲率}（curvature），
%@see: https://mathworld.wolfram.com/Curvature.html
记作\(K\)，
即\begin{equation*}
	K \defeq \lim_{\increment s\to0} \abs{\frac{\increment\alpha}{\increment s}}.
\end{equation*}
在\(\displaystyle \lim_{\increment s\to0} \frac{\increment\alpha}{\increment s}
= \dv{\alpha}{s}\)存在的条件下，
\(K\)也可以表示为\begin{equation*}
	K = \abs{\dv{\alpha}{s}}.
\end{equation*}

对于直线来说，切线与直线本身重合，
当点沿直线移动时，切线的倾角不变，
\(\increment\alpha = 0\)，
\(\frac{\increment\alpha}{\increment s} = 0\)，
从而\(K = \abs{\displaystyle\dv{\alpha}{s}} = 0\).
这就是说，直线上任意点\(M\)处的曲率都等于零，这与我们直觉认识到的“直线不弯曲”一致.

\begin{figure}%曲率圆
	\centering
	\begin{tikzpicture}
		\draw[thick,->] (0,0) -> (9,0)node[above]{\(x\)};
		\draw[thick,->] (0,0) -> (0,8)node[right]{\(y\)};
		\pgfmathsetmacro{\cx}{4}
		\pgfmathsetmacro{\cy}{4}
		\pgfmathsetmacro{\cr}{3}
		\coordinate(M)at(\cx,\cy);
		\draw (M)circle(\cr);
		\pgfmathsetmacro{\ta}{30}
		\pgfmathsetmacro{\tb}{80}
		\pgfmathsetmacro{\pax}{\cx+\cr*sin(\ta)}
		\pgfmathsetmacro{\pay}{\cy-\cr*cos(\ta)}
		\pgfmathsetmacro{\pbx}{\cx+\cr*sin(\tb)}
		\pgfmathsetmacro{\pby}{\cy-\cr*cos(\tb)}
		\coordinate(P1)at(\pax,\pay);
		\coordinate(P2)at(\pbx,\pby);
		\draw (M)node[left]{\(D\)}--(P1)node[below]{\(M\)}
			(M)--(P2)node[right]{\(M'\)}node[midway,above]{\(a\)};
		\pgfmathsetmacro{\paz}{\pax+\pay*(\cy-\pay)/(\cx-\pax)}
		\pgfmathsetmacro{\pbz}{\pbx+\pby*(\cy-\pby)/(\cx-\pbx)}
		\coordinate(Q1)at(\paz,0);
		\coordinate(Q2)at(\pbz,0);
		\coordinate(X)at(100,0);
		\draw (Q1)--(P1) (Q2)--(P2);

		\draw pic["\(\increment\alpha\)",draw=orange,-,below right]{angle=P1--M--P2};
		\draw pic["\(\alpha\)",draw=orange,-,angle eccentricity=1.5,angle radius=5mm]{angle=X--Q1--P1};
		\draw pic["\(\alpha+\increment\alpha\)",draw=orange,-,angle eccentricity=1,angle radius=3mm,above right]{angle=X--Q2--P2};
		\draw pic[draw=gray,-,angle radius=0.3cm]{right angle=M--P1--Q1};
		\draw pic[draw=gray,-,angle radius=0.3cm]{right angle=M--P2--Q2};
	\end{tikzpicture}
	\caption{曲率圆}
	\label{figure:微分中值定理.曲率圆}
\end{figure}

设圆的半径为\(a\)，由\cref{figure:微分中值定理.曲率圆} 可见，
圆在点\(M\)、\(M'\)处的切线所夹的角\(\increment\alpha\)等于中心角，
即\begin{equation*}
	\angle{M D M'} = \increment\alpha.
\end{equation*}
但是\begin{equation*}
	\angle{M D M'} = \frac{\increment s}{a},
\end{equation*}
于是\begin{equation*}
	\frac{\increment\alpha}{\increment s}
	= \frac{\increment s / a}{\increment s}
	= \frac{1}{a},
\end{equation*}
从而\begin{equation*}
	K = \abs{\dv{\alpha}{s}} = \frac{1}{a}.
\end{equation*}
因为点\(M\)是圆上任意取定的一点，
上述结论表示，
圆上各点处的曲率都等于半径\(a\)的倒数\(\frac{1}{a}\)，
这就是说，圆的弯曲程度到处一样；
且半径越小的圆，曲率越大，即圆弯曲得越厉害.

设曲线的直角坐标方程为\(y=f(x)\)，
且\(f(x)\)具有二阶导数（这时\(f'(x)\)连续，从而曲线是光滑的）.
因为\(\tan\alpha = y'\)，
所以再在等号两边同时对\(x\)求导便得\begin{equation*}
	\sec^2\alpha \dv{\alpha}{x} = y'',
\end{equation*}
即\begin{equation*}
	\dv{\alpha}{x}
	= \frac{y''}{\sec^2\alpha}
	= \frac{y''}{1 + \tan^2\alpha}
	= \frac{y''}{1 + (y')^2},
\end{equation*}
于是\begin{equation*}
	\dd{\alpha}
	= \frac{y''}{1 + (y')^2} \dd{x}.
\end{equation*}
又因为\(\dd{s} = \sqrt{1+(y')^2} \dd{x}\)，
从而有\begin{equation}
	K
	= \abs{\dv{\alpha}{s}}
	= \frac{1}{\sqrt{1+(y')^2}}
	\abs{\frac{y''}{1 + (y')^2}}
	= \frac{\abs{y''}}{(1+(y')^2)^{\frac32}}.
\end{equation}

设曲线由参数方程\(\left\{ \begin{array}{c}
	x = \phi(t) \\
	y = \psi(t)
\end{array} \right.\)给出，
由\cref{equation:导数.参数方程确定的函数的一阶导数,equation:导数.参数方程确定的函数的二阶导数}
可知\begin{equation*}
	y' = \frac{\psi'(t)}{\phi'(t)}, \qquad
	y'' = \frac{\psi''(t) \phi'(t) - \psi'(t) \phi''(t)}{(\phi'(t))^3},
\end{equation*}
那么有\begin{equation}
	K = \frac{
		\abs{\phi'(t)\psi''(t)-\phi''(t)\psi'(t)}
	}{
		[(\phi'(t))^2+(\psi'(t))^2]^{\frac32}
	}.
\end{equation}

在某些实际问题中，
\(\abs{y'}\)同\(1\)比较起来是很小的（即\(\abs{y'} \ll 1\)），可以忽略不计，
这时，由\(1 + (y')^2 \approx 1\)，而有曲率的近似计算公式为\begin{equation*}
	K \approx \abs{y''}.
\end{equation*}
这就是说，当\(\abs{y'} \ll 1\)时，
曲率\(K\)近似于\(\abs{y''}\).
经过这样的简化之后，对一些复杂问题的计算和讨论就方便多了.

\subsection{曲率圆与曲率半径}
设曲线\(y=f(x)\)在点\(M(x,y)\)处的曲率为\(K\ (K\neq0)\).
在点\(M\)处的曲线的发现上，在凹的一侧取一点\(D\)，使\(\abs{DM} = \frac{1}{K} = \rho\).
以\(D\)为圆心，\(\rho\)为半径作圆，这个圆叫做曲线在点\(M\)处的\DefineConcept{曲率圆}，
曲率圆的圆心\(D\)叫做曲线在点\(M\)处的\DefineConcept{曲率中心}，
曲率圆的半径\(\rho\)叫做曲线在点\(M\)处的\DefineConcept{曲率半径}.

按上述规定可知，曲率圆与曲线在点\(M\)有相同的切线和曲率，且在点\(M\)邻近有相同的凹向.
因此，在实际问题中，常常用曲率圆在点\(M\)邻近的一段圆弧来近似代替曲线弧，以使问题简化.

按上述规定，曲线在点\(M\)处的曲率\(K\ (K\neq0)\)
与曲线在点\(M\)处的曲率半径\(\rho\)有如下的关系：\begin{equation*}
	\rho = \frac{1}{K}, \qquad
	K = \frac{1}{\rho}.
\end{equation*}
这就是说：曲线上一点处的曲率半径与曲线在该点处的曲率互为倒数.

\begin{example}
求出对数曲线\(y = \ln x\)上曲率半径最小的点.
\begin{solution}
显然有\(y' = \frac{1}{x}\)，\(y'' = -\frac{1}{x^2}\)，那么曲率为\begin{equation*}
	K = \frac{\abs{y''}}{(1+(y')^2)^{\frac32}}
	= \frac{1/x^2}{(1+1/x^2)^{\frac32}}
	= \frac{x}{(1+x^2)^{\frac32}}.
\end{equation*}
曲率\(K\)对\(x\)求导得\begin{equation*}
	K' = \frac{(1+x^2)^{\frac32} - x \frac32 (1+x^2)^{\frac12} 2x}{(1+x^2)^3}
	= \frac{1 - 2x^2}{(1+x^2)^{\frac52}}.
\end{equation*}
令\(K' = 0\)，考虑\(x>0\)，
解得\(x_0 = \frac{1}{\sqrt{2}}\).
当\(0<x<x_0\)时，\(K'>0\)；
当\(x>x_0\)时，\(K'<0\)；
说明\(K'\)在\(x=x_0\)时取得极大值.
而曲率半径最小的点就是曲率最大的点，
即\(x = \frac{1}{\sqrt{2}}\)时，
曲率半径最小值为\(\frac{3\sqrt{3}}{2}\).
\end{solution}
\end{example}

\subsection{曲率中心的计算公式以及渐屈线、渐伸线}
设已知曲线的方程是\(y=f(x)\)，
且其二阶导数\(y''\)在点\(x\)不为零.
又设曲线\(y=f(x)\)在点\(M(x,y)\)的曲率为\(K\)，
曲率中心为\(D(\alpha,\beta)\)，
曲率半径为\(\rho=K^{-1}\)，
那么曲率圆的方程为\begin{equation*}
	(\xi-\alpha)^2+(\eta-\beta)^2=\rho^2,
	\quad(\xi,\eta)\in\mathbb{R}^2.
\end{equation*}

因为\(M(x,y)\)在这个曲率圆上，所以满足曲率圆的方程，
有\begin{equation}\label{equation:曲率圆.曲率中心的推导1}
	(x-\alpha)^2+(y-\beta)^2=\rho^2.
\end{equation}
又因为曲线在点\(M\)的切线与曲率圆的半径\(DM\)垂直，
两者的斜率分别为\begin{equation*}
	y'
	\quad\text{和}\quad
	\frac{y-\beta}{x-\alpha},
\end{equation*}
所以\begin{equation*}
	y' \cdot \frac{y-\beta}{x-\alpha} = -1,
\end{equation*}
即\begin{equation}\label{equation:曲率圆.曲率中心的推导2}
	y' = -\frac{x-\alpha}{y-\beta}.
\end{equation}
由\cref{equation:曲率圆.曲率中心的推导1,equation:曲率圆.曲率中心的推导2}
消去\(x-\alpha\)，解出\begin{equation*}
	(y-\beta)^2
	=\frac{\rho^2}{1+(y')^2}
	=\frac{(1+(y')^2)^2}{(y'')^2}.
\end{equation*}

由于当\(y''>0\)时，曲线\(y=f(x)\)是凹弧，\(y-\beta<0\)；
当\(y''<0\)时，曲线是凸弧，\(y-\beta>0\).
总之，\(y''\)与\(y-\beta\)异号.
因此取上式两边的平方根，得\begin{equation*}
	y-\beta
	=-\frac{1+(y')^2}{y''};
\end{equation*}
于是\begin{equation*}
	x-\alpha
	=-y'(y-\beta)
	=\frac{y'(1+(y')^2)}{y''}.
\end{equation*}

因此，曲线在对应点\(M(x,y)\)的曲率中心\(D(\alpha,\beta)\)的坐标为
\begin{equation}
	\left\{ \def\arraystretch{1.5} \begin{array}{l}
		\alpha = x - y' \frac{1 + (y')^2}{y''}, \\
		\beta = y + \frac{1 + (y')^2}{y''}.
	\end{array} \right.
\end{equation}

当点\((x,f(x))\)沿曲线\(C\)移动时，
相应的曲率中心\(D\)的轨迹曲线\(G\)称为曲线\(C\)的\DefineConcept{渐屈线}（evolute）.
%@see: https://mathworld.wolfram.com/Evolute.html
相对地，曲线\(C\)称为曲线\(G\)的\DefineConcept{渐伸线}（involute）.
%@see: https://mathworld.wolfram.com/Involute.html
