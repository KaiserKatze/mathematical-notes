\section{平面曲线的渐近线}
%@see: https://mathworld.wolfram.com/Asymptote.html
\subsection{水平渐近线、铅直渐近线}
%@see: 《高等数学（第六版 上册）》 P35
如果当\(x\to\infty\)、\(x\to+\infty\)或\(x\to-\infty\)时，有\(f(x) \to A\)，
则称“直线\(y = A\)是
函数\(f\)的图形的\DefineConcept{水平渐近线}（horizontal asymptote line）”.

%@see: 《高等数学（第六版 上册）》 P41
如果当\(x \to x_0\)、\(x \to x_0^+\)或\(x \to x_0^-\)时，有\(f(x) \to \infty\)，
则称“直线\(x = x_0\)是
函数\(f\)的图形的\DefineConcept{铅直渐近线}（vertical asymptote line）”.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P42 习题1-4 8.
求函数\(f(x)=\frac4{2-x^2}\)的图形的渐近线.
\begin{solution}
因为当\(x\to\sqrt2\)时，\(2-x^2\to0\)，\(f(x)\to\infty\)，
所以\(x=\sqrt2\)是函数\(f(x)=\frac4{2-x^2}\)的图形的铅直渐近线.
\end{solution}
\end{example}

\subsection{斜渐近线}
如果直线\(L: y = kx+b\ (k \neq 0)\)满足：
当\(x\to\infty\)、\(x\to+\infty\)或\(x\to-\infty\)时，
曲线\(y = f(x)\)上的动点\(M(x,f(x))\)到直线\(L\)的欧氏距离\(d(M,L)\to0\)，
则称“直线\(L\)是
曲线\(y = f(x)\)的\DefineConcept{斜渐近线}”.

显然，\(\vb{\nu}=(1,k,0)\)是直线\(L: y=kx+b\)的一个方向向量.
取直线\(L\)上一点\(M_0(0,b,0)\).
根据\cref{equation:解析几何.点到直线的距离}，
点\(M(x,f(x),0)\)到直线\(L\)的距离为\begin{equation*}
	d(M,L)=\frac{\abs{\VectorOuterProduct{\vec{M_0M}}{\vb{\nu}}}}{\abs{\vb{\nu}}}
	=\frac{
		\abs{kx-f(x)+b}
	}{
		\sqrt{1+k^2}
	}.
\end{equation*}
为了使得\begin{equation*}
	\lim_{x\to\infty} \frac{\abs{kx-f(x)+b}}{\sqrt{1+k^2}} = 0
\end{equation*}成立，
考虑到\(k\)是常数，必有\(\abs{kx-f(x)+b}\)是\(x\to\infty\)时的无穷小，
从而有\begin{equation*}
	\lim_{x\to\infty} (f(x)-kx-b) = 0,
\end{equation*}
即\begin{equation*}
	\lim_{x\to\infty} (f(x)-kx) = b.
\end{equation*}
因为\hyperref[theorem:函数极限.无穷小.有界函数与无穷小的乘积是无穷小]{有界函数与无穷小的乘积是无穷小}，
所以\begin{equation*}
	\lim_{x\to\infty} \frac{f(x)-kx}{x}
	= \lim_{x\to\infty} \left( \frac{f(x)}x-k \right)
	= 0,
\end{equation*}
于是\begin{equation*}
	\lim_{x\to\infty} \frac{f(x)}{x} = k.
\end{equation*}

于是我们得到以下命题.
\begin{proposition}
直线\(L: y = kx+b\)为曲线\(y = f(x)\)的渐近线的充分必要条件是：\begin{equation*}
	k = \lim_{x\to\infty} \frac{f(x)}{x},
	\quad\text{且}\quad
	b = \lim_{x\to\infty} \left( f(x) - kx \right),
\end{equation*}
或\begin{equation*}
	k = \lim_{x\to+\infty} \frac{f(x)}{x},
	\quad\text{且}\quad
	b = \lim_{x\to+\infty} \left( f(x) - kx \right),
\end{equation*}
或\begin{equation*}
	k = \lim_{x\to-\infty} \frac{f(x)}{x},
	\quad\text{且}\quad
	b = \lim_{x\to-\infty} \left( f(x) - kx \right).
\end{equation*}
\end{proposition}

\begin{remark}
在计算函数\(f\)的图形的渐近线方程时，应该注意函数\(f\)的定义域.
例如，当计算定义在\((0,+\infty)\)上的函数\(f\)的水平渐近线时，
极限过程就不可以是\(x\to\infty\)和\(x\to-\infty\)；
当计算定义在\((a,b)\)上的函数\(f\)的铅直渐近线时，
极限过程就不可以是\(x \to a\)和\(x \to a^-\)！
\end{remark}

% \begin{example}
% 求出曲线\(C: y = x \ln\left(e+\frac{1}{x-1}\right)\)的渐近线方程.
% \begin{solution}
% 设直线\(L: y = kx+b\)为曲线\(C\)的渐近线，则\begin{align*}
% 	k &= \lim_{x\to\infty} \frac{x \ln\left(e+\frac{1}{x-1}\right)}{x}
% 	= \lim_{x\to\infty} \ln\left(e+\frac{1}{x-1}\right)
% 	= 1, \\
% 	b &= \lim_{x\to\infty} \left[ x \ln\left(e+\frac{1}{x-1}\right) - kx \right]
% 	= \lim_{x\to\infty} x \left[ \ln\left(e+\frac{1}{x-1}\right) - 1 \right] \\
% 	&= \lim_{x\to\infty} x \ln\left[1+\frac{1}{e(x-1)}\right]
% 	= \lim_{x\to\infty} \frac{x}{e(x-1)}
% 	= \frac1e.
% \end{align*}
% 因此，曲线\(C\)的渐近线方程为\(y = x + \frac1e\).
% \end{solution}
% \end{example}

\begin{example}
%@see: 《1998年全国硕士研究生入学统一考试（数学二）》一填空题/第5题
求曲线\(C: y = x \ln(e+\frac1x)\ (x>0)\)的渐近线方程.
\begin{solution}
因为\begin{align*}
	k &= \lim_{x\to\infty} \frac{y}{x}
	= \lim_{x\to\infty} \ln(e+\frac1x)
	= 1, \\
	b &= \lim_{x\to\infty} (y-x)
	= \lim_{x\to\infty} x\left[ \ln(e+\frac1x) - 1 \right] \\
	&= \lim_{t\to0} \frac{\ln(e+t)-1}{t}
	= \lim_{t\to0} \frac1{e+t}
	= \frac1e,
\end{align*}
所以曲线\(C\)的渐近线方程为\(y = x + \frac1e\).
\end{solution}
\end{example}

我们可以观察到，
求解一条曲线\(y = f(x)\)的斜渐近线的本质，
就是将\(f\)展开成\begin{equation*}
	f(x) = x \left( k + \frac{b}{x} + o\left(\frac1x\right) \right)
\end{equation*}或\begin{equation*}
	f(x) = k x + b + o(1),
\end{equation*}
其中\(o(1)\)是当\(x\to\infty\)时的无穷小.
于是，我们可以利用泰勒展式求解斜渐近线.

\begin{example}
%@see: https://www.bilibili.com/video/BV1sV4y1h7Q8/
求曲线\(y = e^{\frac1x} \sqrt{1+x^2}\)的斜渐近线.
\begin{solution}
因为当\(x\to\infty\)时\begin{align*}
	y &= e^{\frac1x} \sqrt{1+x^2} \\
	&= \abs{x} \cdot e^{\frac1x} \sqrt{1+\frac1{x^2}} \\
	&= \abs{x} \cdot \left( 1 + \frac1x + o\left(\frac1x\right) \right)
	\left( 1 + \frac12 \frac1{x^2} + o\left(\frac1{x^2}\right) \right) \\
	&= \abs{x} \cdot \left( 1 + \frac1x + o\left(\frac1x\right) \right),
\end{align*}
所以\(y = \pm(x + 1)\)是\(y = e^{\frac1x} \sqrt{1+x^2}\)的斜渐近线.
\end{solution}
\end{example}
\begin{example}
求曲线\(y = \sqrt{4x^2+x} \ln(2+\frac1x)\)的斜渐近线.
\begin{solution}
因为当\(x\to\infty\)时\begin{align*}
	y &= 2 \abs{x} \cdot \sqrt{1 + \frac1{4x}} \left[ \ln2 + \ln(1+\frac1{2x}) \right] \\
	&= 2 \abs{x} \cdot \left( 1 + \frac12 \frac1{4x} + o\left(\frac1x\right) \right)
	\left( \ln 2 + \frac1{2x} + o\left(\frac1x\right) \right) \\
	&= 2 \abs{x} \cdot \left[ \ln2 + \left( \frac{\ln2}8 + \frac12 \right) \frac1x + o\left(\frac1x\right) \right],
\end{align*}
所以\(y = \pm\left( 2x\ln2 + \frac14 \ln2 + 1 \right)\)
是\(y = \sqrt{4x^2+x} \ln(2+\frac1x)\)的斜渐近线.
\end{solution}
\end{example}
\begin{example}
%@see: 《2020年全国硕士研究生入学统一考试（数学二）》三解答题/第15题
求曲线\(y = \frac{x^{1+x}}{(1+x)^x}\ (x>0)\)的斜渐近线.
\begin{solution}
因为当\(x\to+\infty\)时\begin{align*}
	y &= \frac{x^{1+x}}{(1+x)^x}
	= x \cdot \left( 1 + \frac1x \right)^{-x} \\
	&= x \cdot \exp[-x \ln(1 + \frac1x)] \\
	&= x \cdot \exp[-x \left( \frac1x - \frac12 \frac1{x^2} + o\left(\frac1{x^2}\right) \right)] \\
	&= x \cdot \exp\left( -1 + \frac12 \frac1x + o\left(\frac1x\right) \right) \\
	&= x \cdot \frac1e \cdot \exp\left( \frac12 \frac1x + o\left( \frac1x \right) \right) \\
	&= x \cdot e^{-1} \cdot \left( 1 + \frac12 \frac1x + o\left(\frac1x\right) \right),
\end{align*}
所以\(y = \frac{x}{e} + \frac1{2e}\)是\(y = \frac{x^{1+x}}{(1+x)^x}\ (x>0)\)的斜渐近线.
\end{solution}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1hQ4y1z7TT
求笛卡尔叶形线\(C: x^3+y^3-3axy=0\)的斜渐近线方程.
\begin{solution}
令\(t \defeq \frac{y}{x}\)，
则\(y = tx\)，
代入笛卡尔叶形线的方程得\begin{equation*}
	x^3+(tx)^3-3ax \cdot tx = 0,
\end{equation*}
整理得\begin{equation*}
	x^3(1+t^3)-3atx^2=0,
\end{equation*}
化简得\begin{equation*}
	x = \frac{3at}{1+t^3},
	\qquad
	y = \frac{3at^2}{1+t^3}.
\end{equation*}
因为当\(t\to-1\)时\(x\to\infty\)，
所以笛卡尔叶形线的斜渐近线的斜率\(k\)和截距\(b\)分别为\begin{gather*}
	k = \lim_{x\to\infty} \frac{y}{x}
	= \lim_{t\to-1} t
	= -1, \\
	b = \lim_{x\to\infty} (y-kx)
	= 3a \lim_{t\to-1} \frac{t}{1-t+t^2}
	= -a.
\end{gather*}
因此笛卡尔叶形线的斜渐近线方程为\(x+y+a=0\).
\end{solution}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1VF411D7Td
求参数方程\begin{equation*}
	\left\{ \begin{array}{l}
		x = t \ln t, \\
		y = \frac{\ln t}t
	\end{array} \right.
\end{equation*}确定的曲线\(C\)的渐近线.
%@Mathematica: ParametricPlot[{t Log[t], Log[t]/t}, {t, .1, 2}]
\begin{solution}
首先注意到参数\(t\)的取值范围是\(t>0\).
对参数\(t\)求导得\begin{equation*}
	\left\{ \begin{array}{l}
		x'(t) = \ln t + 1, \\
		y'(t) = \frac{1-\ln t}{t^2}.
	\end{array} \right.
\end{equation*}
令\(x'(t) \geq 0\)得\(t \geq e^{-1}\)，
可知\(x(t)\)在\((0,e^{-1})\)内单调减少，
在\((e^{-1},+\infty)\)内单调增加.
当\(t = e^{-1}\)时，有\(x(t) = -e^{-1}\)，
于是\begin{equation*}
	\lim_{t\to0^+} t \ln t
	= \lim_{t\to0^+} \frac{1/t}{-1/t^2}
	= 0,
	\qquad
	\lim_{t\to+\infty} t \ln t
	= +\infty.
\end{equation*}
令\(y'(t) \geq 0\)得\(t \leq e\)，
可知\(y(t)\)在\((0,e)\)内单调增加，
在\((e,+\infty)\)内单调减少.
当\(t = e\)时，有\(y(t) = e^{-1}\)，
于是\begin{equation*}
	\lim_{t\to0^+} \frac{\ln t}{t}
	= -\infty,
	\qquad
	\lim_{t\to+\infty} \frac{\ln t}{t}
	= \lim_{t\to+\infty} \frac1t
	= 0.
\end{equation*}
综上所述，由该参数方程确定的隐函数\(y(x)\)的
定义域是\((-e^{-1},+\infty)\)，
值域是\((-\infty,e^{-1})\).

由于\begin{equation*}
	\lim_{x\to+\infty} \frac{y(x)}{x}
	= \lim_{t\to+\infty} \frac{y(t)}{x(t)}
	= \lim_{t\to+\infty} \frac1{t^2}
	= 0,
	\qquad
	\lim_{x\to+\infty} y(x)
	= \lim_{t\to+\infty} y(t)
	= 0,
\end{equation*}
所以\(y=0\)是曲线\(C\)的一条水平渐近线.

由于\begin{equation*}
	\lim_{y\to-\infty} \frac{x(y)}{y}
	= \lim_{t\to0^+} \frac{x(t)}{y(t)}
	= \lim_{t\to0^+} t^2
	= 0,
	\qquad
	\lim_{y\to-\infty} x(y)
	= \lim_{t\to0^+} x(t)
	= 0,
\end{equation*}
所以\(x=0\)是曲线\(C\)的一条铅直渐近线.
\end{solution}
\end{example}

\begin{example}
%@see: https://www.bilibili.com/video/BV1mF411f7Zo
求曲线\(C: x^5+x^2y^3=y^4\)的斜渐近线方程.
\end{example}
\begin{example}
%@see: https://www.bilibili.com/video/BV1mF411f7Zo
求曲线\(C: x^5+y^5=y^4\)的斜渐近线方程.
\end{example}

\begin{example}
%@credit: {4dc9721f-7c76-4700-adc0-75d458e212ba}
求曲线\(C: x^3+y^3=y^2\)的斜渐近线方程.
%TODO
% \begin{solution}
% 移项得\(x^3=y^2-y^3\)，
% 开方得\(x=\sqrt[3]{y^2-y^3}\)，
% 对\(y\)求导得\begin{equation*}
% 	\dv{x}{y} = \frac13 (y^2-y^3)^{-\frac23} (2y-3y^2).
% \end{equation*}
% 那么\begin{equation*}
% 	\lim_{y\to\infty} \dv{x}{y}
% 	= \lim_{y\to\infty} \frac{2y-3y^2}{3(y^2-y^3)^{\frac23}}
% 	= \lim_{y\to\infty} \frac{(2-3y)y}{3y^2(1/y-1)^{\frac23}}
% 	= \lim_{y\to\infty} \frac{2-3y}{3y(1/y-1)^{\frac23}}
% \end{equation*}
% \end{solution}
\end{example}
