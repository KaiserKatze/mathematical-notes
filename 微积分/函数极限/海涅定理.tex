\section{函数极限与数列极限的关系，海涅定理}
\subsection{海涅定理}
\begin{theorem}[海涅定理]\label{theorem:极限.海涅定理}
%@see: 《数学分析（上册）》（陈纪修） P78 定理3.1.5
%@see: 《数学分析教程》（史济怀） P70 定理2.4.1
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P92 命题1
设函数\(f\colon D\to\mathbb{R}\).
\(\lim_{x \to x_0} f(x) = A\)的充分必要条件是：
任何一个值域为\(D-\{x_0\}\)且收敛于\(x_0\)的数列\(\{x_n\}\)
总满足\(\lim_{n\to\infty} f(x_n) = A\).
\begin{proof}
必要性.
由\(\lim_{x \to x_0} f(x) = A\)可知\[
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in D)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{f(x)-A}<\epsilon
	].
\]
因为\(\lim_{n\to\infty} x_n = x_0\)，
且\(x_n \neq x_0\ (n=1,2,\dotsc)\)，
所以\[
	(\forall\delta>0)
	(\exists N\in\mathbb{N})
	(\forall n\in\mathbb{N})
	[
		n>N
		\implies
		0<\abs{x_n-x_0}<\delta
		\implies
		\abs{f(x_n)-A}<\epsilon
	],
\]
即\(\lim_{n\to\infty} f(x_n) = A\).

充分性.
用反证法.
我们知道，命题“函数\(f\)在点\(x_0\)的极限是\(A\)”可以表述为\[
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in D)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{f(x)-A}<\epsilon
	],
\]
那么它的否命题“函数\(f\)在点\(x_0\)的极限不是\(A\)”可以表述为\[
	(\exists\epsilon_0>0)
	(\forall\delta>0)
	(\exists x\in D)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{f(x)-A}\geq\epsilon_0
	].
\]
于是\[
	(\forall n\in\mathbb{N}^+)
	(\exists x_n\in D)
	\left[
		0<\abs{x_n-x_0}<\frac1n
		\implies
		\abs{f(x_n)-A}\geq\epsilon_0
	\right],
\]
如此，我们就找到了一个数列\(\{x_n\}\)
满足\(x_n\neq x_0\ (n=1,2,\dotsc)\)且\(\lim_{n\to\infty} x_n = x_0\)，
但是\(\{f(x_n)\}\)不可能满足\(\lim_{n\to\infty} f(x_n) = A\).
由此推翻假设，得到\(\lim_{x\to x_0} f(x) = A\).
\end{proof}
\end{theorem}
海涅定理也称作\DefineConcept{归结原则}.

这里要注意定理的条件\(x_n \neq x_0\)，
因为只要没有这个条件就不能保证海涅定理的结果成立，下面我们举例说明.
设\[
	f(x) = \left\{ \begin{array}{cl}
		2, & x\neq0, \\
		1, & x=0.
	\end{array} \right.
\]
又设点\(x_0\)与数列\(\{x_n\}\)满足\(x_0=x_n=0\ (n=1,2,\dotsc)\).
那么有\[
	\lim_{n\to\infty} x_n = 0,
	\quad\text{和}\quad
	\lim_{x\to0} f(x) = 2,
\]
但是\[
	\lim_{n\to\infty} f(x_n) = \lim_{n\to\infty} f(0) = 1.
\]这就说明不总有\[
	\lim_{n\to\infty} f(x_n)
	= \lim_{x \to x_0} f(x)
\]成立.

\begin{example}
函数\(f\)在\((-\infty,+\infty)\)内单调有界，
数列\(\{x_n\}\)收敛，
但函数列\(\{f(x_n)\}\)不一定收敛.
例如，取函数\[
	f(x) = \left\{ \begin{array}{rl}
		1 & x\geq0, \\
		-1, & x<0,
	\end{array} \right.
\]
和数列\(x_n = \frac{(-1)^n}{n}\)，
容易看出\(\varlimsup_{n\to\infty} f(x_n) = 1\)
和\(\varliminf_{n\to\infty} f(x_n) = -1\)，
于是\(\lim_{n\to\infty} f(x_n)\)发散.
\end{example}

\begin{example}
函数\(f\)在\((-\infty,+\infty)\)内单调有界，
函数列\(\{f(x_n)\}\)单调或收敛，
但数列\(\{x_n\}\)不一定收敛.
例如，取\[
	f(x) = \arctan x,
\]
和数列\(x_n = n\)，
容易看出\(\{f(x_n)\}\)单调且收敛，
但是\(\{x_n\}\)不收敛.
\end{example}

\begin{example}
证明：函数\(\sin\frac1x\)在点\(x=0\)没有极限.
\begin{proof}
取\(x_n = \frac1{n\pi}\ (n=1,2,\dotsc)\).
显然有\(x_n\neq0\)且\(\lim_{n\to\infty} x_n = 0\).

再取\(y_n = \frac1{2n\pi+\pi/2}\ (n=1,2,\dotsc)\).
显然有\(y_n\neq0\)且\(\lim_{n\to\infty} y_n = 0\).

但是由于\[
	\lim_{n\to\infty} \sin\frac1{x_n} = 0
	\neq 1 = \lim_{n\to\infty} \sin\frac1{y_n},
\]
所以根据\cref{theorem:极限.海涅定理} 可知，
函数\(\sin\frac1x\)在点\(x=0\)没有极限.
\end{proof}
\end{example}

\subsection{上极限与下极限}
\begin{definition}
设函数\(f\colon D\to\mathbb{R}\)在点\(x_0\)的某个去心邻域中有定义.
\begin{itemize}
	\item 	把\[
		\lim_{\delta\to0^+} \sup_{0<\abs{x-x_0}<\delta} f(x)
	\]称为“函数\(f\)在点\(x_0\)的\DefineConcept{上极限}”，
	记为\(\varlimsup_{x \to x_0} f(x)\).

	\item 把\[
		\lim_{\delta\to0^+} \inf_{0<\abs{x-x_0}<\delta} f(x)
	\]称为“函数\(f\)在点\(x_0\)的\DefineConcept{下极限}”，
	记为\(\varliminf_{x \to x_0} f(x)\).
\end{itemize}
\end{definition}

\begin{property}
设函数\(f\colon D\to\mathbb{R}\)在点\(x_0\)的某个去心邻域中有定义，
则\[
	\varliminf_{x \to x_0} f(x) \leq \varlimsup_{x \to x_0} f(x).
\]
\end{property}

\begin{theorem}
设函数\(f\colon D\to\mathbb{R}\)在点\(x_0\)的某个去心邻域中有定义，
则函数\(f\)在点\(x_0\)时极限存在的充分必要条件是：
\(f\)在点\(x_0\)的上、下极限相等，
即\[
	\varlimsup_{x \to x_0} f(x)
	= \varliminf_{x \to x_0} f(x)
	= A
	\iff
	\lim_{x \to x_0} f(x) = A.
\]
\end{theorem}
