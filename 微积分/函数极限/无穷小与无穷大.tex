\section{无穷小与无穷大}
\subsection{无穷小的概念}
\begin{definition}
%@see: 《高等数学（第六版 上册）》 P39 定义1
%@see: 《数学分析（第二版 上册）》（陈纪修） P100 定义3.3.1
若\(\lim_{x \to x_0} f(x) = 0\)，
则称“函数\(f\)是当\(x \to x_0\)时的\DefineConcept{无穷小}（infinitesimal）”.
\end{definition}
这里的极限过程\(x \to x_0\)可以扩充到\(x \to x_0^+\)、\(x \to x_0^-\)、\(x \to \infty\)、\(x \to +\infty\)、\(x \to -\infty\)等情况.

\begin{definition}
设\(f\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基.
若\(\lim_\mathcal{B} f(x) = 0\)，
则称“函数\(f\)是在基\(\mathcal{B}\)上的\DefineConcept{无穷小}”.
\end{definition}

\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P39 定理1
设\(f\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基.
\(\lim_\mathcal{B} f(x) = A \in \mathbb{R}\)的充分必要条件是：\[
	(\exists\alpha\in\mathbb{R}^X)
	\left[
		\lim_\mathcal{B} \alpha(x) = 0
		\land
		f(x) = A + \alpha(x)
	\right].
\]
\begin{proof}
这里假设\(f\)在点\(x_0\)的某个去心邻域内有定义，
即\((\exists\rho>0)[\mathring{U}(x_0,\rho) \subseteq X]\)，
在此前提下证明\[
	\lim_{x \to x_0} f(x) = A
	\iff
	(\exists\alpha\in\mathbb{R}^X)
	\left[
		\lim_{x \to x_0} \alpha(x) = 0
		\land
		f(x) = A + \alpha(x)
	\right].
\]

必要性.
设\(\lim_{x \to x_0} f(x) = A\)，
由定义有\[
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in X)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{f(x)-A}<\epsilon
	].
\]
令\(\alpha(x)=f(x)-A\)，
则\[
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in X)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{\alpha(x)-0}<\epsilon
	],
\]
也就是说函数\(\alpha\)是当\(x \to x_0\)时的无穷小.

充分性.
设\(f(x)=A+\alpha(x)\)，其中\(A\)是常数，\(\alpha\)是当\(x \to x_0\)时的无穷小.
由定义有\[
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in X)
	[
		0<\abs{x-x_0}<\delta
		\implies
		\abs{\alpha(x)-0}<\epsilon
		\implies
		\abs{f(x)-A}<\epsilon
	],
\]
这就说明\(A\)是函数\(f\)当\(x \to x_0\)时的极限.
\end{proof}
\end{theorem}

\subsection{无穷大的概念}
\begin{definition}
%@see: 《数学分析（第二版 上册）》（陈纪修） P103 定义3.3.2
设\(f\in\mathbb{R}^X\).
\begin{itemize}
	\item 若\(\lim_{x\to\infty} f(x) = \infty\)，
	则称“函数\(f\)是当\(x\to\infty\)时的\DefineConcept{无穷大}”.

	\item 若\(\lim_{x\to\infty} f(x) = +\infty\)，
	则称“函数\(f\)是当\(x\to\infty\)时的\DefineConcept{正无穷大}”.

	\item 若\(\lim_{x\to\infty} f(x) = -\infty\)，
	则称“函数\(f\)是当\(x\to\infty\)时的\DefineConcept{负无穷大}”.
\end{itemize}
我们把正无穷大和负无穷大统称为\DefineConcept{定号无穷大}，
把既非正无穷大又非负无穷大的无穷大称为\DefineConcept{不定号无穷大}.
\end{definition}
这里的极限过程\(x \to \infty\)可以扩充到\(x \to x_0\)、\(x \to x_0^+\)、\(x \to x_0^-\)、\(x \to +\infty\)、\(x \to -\infty\)等情况.

\begin{definition}
设\(f\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基.
\begin{itemize}
	\item 若\(\lim_\mathcal{B} f(x) = \infty\)，
	则称“函数\(f\)是在基\(\mathcal{B}\)上的\DefineConcept{无穷大}”.

	\item 若\(\lim_\mathcal{B} f(x) = +\infty\)，
	则称“函数\(f\)是在基\(\mathcal{B}\)上的\DefineConcept{正无穷大}”.

	\item 若\(\lim_\mathcal{B} f(x) = -\infty\)，
	则称“函数\(f\)是在基\(\mathcal{B}\)上的\DefineConcept{负无穷大}”.
\end{itemize}
\end{definition}

\subsection{无穷小的比较}
现在我们已经知道，
两个无穷小的和、差、积仍旧是无穷小.
但是，两个无穷小的商，却会出现不同的情况.
例如，当\(x\to0\)时，
\(3x\)、\(x^2\)、\(\sin x\)都是无穷小，
而\[
	\lim_{x\to0}\frac{x^2}{3x}=0, \qquad
	\lim_{x\to0}\frac{3x}{x^2}=\infty, \qquad
	\lim_{x\to0}\frac{\sin x}{3x}=\frac{1}{3}.
\]
两个无穷小之比的极限的各种不同情况，
反映了不同的无穷小趋于零的“快慢”程度.
就上面几个例子来说，
在\(x\to0\)的过程中，
\(x^2\to0\)比\(3x\to0\)要“快些”，
反过来说\(3x\to0\)比\(x^2\to0\)要“慢些”，
而\(\sin x\to0\)与\(x\to0\)“快慢相仿”.

\begin{definition}\label{definition:无穷小和无穷大.无穷小的比较}
%@see: 《高等数学（第六版 上册）》 P57 定义
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷小，
且\(\alpha(x)\neq0\).
\newcommand{\lf}[1][]{\lim_\mathcal{B} \frac{\beta(x)}{\alpha^{#1}(x)}}
\begin{itemize}
	\item 如果\(\lf=0\)，
	就说“\(\beta\)是比\(\alpha\)~\DefineConcept{高阶}的无穷小”，
	记作\(\beta=o(\alpha)\).

	\item 如果\(\lf=\infty\)，
	就说“\(\beta\)是比\(\alpha\)~\DefineConcept{低阶}的无穷小”.

	%@see: 《数学分析（第二版 上册）》（陈纪修） P101 (2)
	\item 如果\[
		(\exists A>0)
		(\exists B\in\mathcal{B})
		(\forall x\in B)
		\left[
			\abs{\frac{\beta(x)}{\alpha(x)}} \leq A
		\right],
	\]
	就说“\(\frac\beta\alpha\)是在基\(\mathcal{B}\)上的\DefineConcept{有界量}”，
	记为\(\beta = O(\alpha)\).

	\item 如果\[
		(\exists A>0)
		(\exists a>0)
		(\exists B\in\mathcal{B})
		(\forall x\in B)
		\left[
			a \leq \abs{\frac{\beta(x)}{\alpha(x)}} \leq A
		\right],
	\]
	就说“\(\alpha\)与\(\beta\)是\DefineConcept{同阶}无穷小”，
	记作\(\beta = \Theta(\alpha)\).

	\item 如果\(\lf[k]=c\ (\text{$c$是非零常数},\text{$k$是正常数})\)，
	就说“\(\beta\)是关于\(\alpha\)的\(k\)~\DefineConcept{阶}无穷小”.

	\item 如果\(\lf=1\)，
	就说“\(\beta\)与\(\alpha\)是\DefineConcept{等价无穷小}”，
	记作\(\alpha\sim\beta\).
\end{itemize}
\end{definition}
\begin{remark}
只要我们把无穷小和高阶无穷小两者的定义联系起来，
再结合\[
	\lim_{x\to0} \frac{x}{1} = 0,
	\qquad
	\lim_{n\to\infty} \frac{1/n}{1} = 0
\]这两个例子，可以看出：
任意一个无穷小都是常数\(1\)的高阶无穷小.
因此，在不需要强调具体的阶数时，我们常用\(o(1)\)表示某个函数是无穷小.
同理，在不需要强调具体的阶数时，用\(O(1)\)表示某个函数是有界量.
最后，我们用\(\Theta(1)\)表示某个函数是常数函数.
\end{remark}

\begin{proposition}
%@see: 《数学分析（第二版 上册）》（陈纪修） P101 (2)
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷小，
且\(\alpha(x)\neq0\).
若\[
	\lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)} = c\ (\text{$c$是非零常数}),
\]
则\(\beta\)与\(\alpha\)是同阶无穷小.
\end{proposition}

%@see: 《高等数学（第六版 上册）》 P57
\begin{example}
因为\(\lim_{x\to0} \frac{3x^2}{x} = 0\)，
所以当\(x\to0\)时，
\(3x^2\)是比\(x\)高阶的无穷小，
即\(3x^2 = o(x)\ (x\to0)\).
\end{example}

%@see: 《高等数学（第六版 上册）》 P58
\begin{example}
因为\(\lim_{n\to\infty} \frac{1/n}{1/n^2} = \infty\)，
所以当\(n\to\infty\)时，
\(\frac{1}{n}\)是比\(\frac{1}{n^2}\)低阶的无穷小.
\end{example}

\begin{example}
因为\(\lim_{x\to3} \frac{x^2-9}{x-3} = 6\)，
所以当\(x\to3\)时，
\(x^2-9\)与\(x-3\)是同阶无穷小.
\end{example}

\begin{example}
由\cref{equation:函数极限.重要极限8} 可知
\(\lim_{x\to0} \frac{1-\cos x}{x^2} = \frac12\)，
所以当\(x\to0\)时，
\(1-\cos x\)是关于\(x\)的二阶无穷小，
也是关于\(x^2\)的同阶无穷小，
还是关于\(\frac12 x^2\)的等价无穷小.
\end{example}

\begin{example}
因为\(\lim_{x\to0} \frac{\sin x}{x} = 1\)，
所以当\(x\to0\)时，
\(\sin x\)与\(x\)是等价无穷小，
即\(\sin x \sim x\ (x\to0)\).
\end{example}

\begin{remark}
记号“\(o\)”、“\(O\)”和“\(\sim\)”都是相对于一定的极限过程的，
一般来说，在使用这些记号时，我们应该附上表示极限过程的记号，例如“\((x \to x_0)\)”.
只有在意义明确，不会发生误解的前提下，才可以省略.
\end{remark}
\begin{remark}
应该注意到，
记号\(o(\alpha)\)实际上是满足\(\lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)} = 0\)的全体函数，
即\[
	o(\alpha) = \Set*{ \beta\in\mathbb{R}^X \given \lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)} = 0 }.
\]
当我们说\(\beta = o(\alpha)\)时，
意思其实是“函数\(\beta\)是函数族\(o(\alpha)\)的一个元素”.
当我们说\(\gamma = \beta + o(\alpha)\)时，
意思其实是“存在\(\phi\in o(\alpha)\)，使得\(\gamma = \beta + \phi\)”.
由此可知：当\(x\to0\)时，有\[
	o(1)
	\supseteq o(x)
	\supseteq o(x^2)
	\supseteq \dotsb
	\supseteq o(x^n)
	\supseteq \dotsb.
\]
换句话说，高阶无穷小是低阶无穷小的子集.

另一方面，我们可以注意到：“\(\beta = \Theta(\alpha)\)”蕴含了“\(\beta = O(\alpha)\)”，
即\(\Theta(\alpha) \subseteq O(\alpha)\).
\end{remark}

\begin{proposition}
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷小，
且\(\alpha(x)\neq0\)，
则\[
	\text{\(\beta\)是比\(\alpha\)高阶的无穷小}
	\iff
	\text{\(\alpha\)是比\(\beta\)低阶的无穷小}.
\]
\end{proposition}

\begin{remark}
显然，等价无穷小是同阶无穷小的特殊情形.
\end{remark}

\begin{definition}
%@see: 《数学分析（第二版 上册）》（陈纪修） P102
设\(f\colon\mathbb{R}\to\mathbb{R}\)是无穷小.
定义\DefineConcept{无穷小的阶}：\begin{gather*}
	\ord_{x \to x_0} f(x) = k
	\defiff
	\lim_{x \to x_0} \frac{f(x)}{(x-x_0)^k} = c < \infty, \\
	\ord_{x \to x_0^+} f(x) = k
	\defiff
	\lim_{x \to x_0^+} \frac{f(x)}{(x-x_0)^k} = c < \infty, \\
	\ord_{x \to x_0^-} f(x) = k
	\defiff
	\lim_{x \to x_0^-} \frac{f(x)}{(x-x_0)^k} = c < \infty, \\
	\ord_{x \to \infty} f(x) = k
	\defiff
	\lim_{x \to \infty} x^k f(x) = c < \infty, \\
	\ord_{x \to +\infty} f(x) = k
	\defiff
	\lim_{x \to +\infty} x^k f(x) = c < \infty, \\
	\ord_{x \to -\infty} f(x) = k
	\defiff
	\lim_{x \to -\infty} x^k f(x) = c < \infty.
\end{gather*}
\end{definition}
\begin{remark}
可以我们可以利用同阶无穷小记号把上述定义简化为：\begin{gather*}
	\ord_{x \to x_0} f(x) = k
	\defiff
	f(x) = \Theta((x-x_0)^k)\ (x \to x_0), \\
	\ord_{x \to x_0^+} f(x) = k
	\defiff
	f(x) = \Theta((x-x_0)^k)\ (x \to x_0^+), \\
	\ord_{x \to x_0^-} f(x) = k
	\defiff
	f(x) = \Theta((x-x_0)^k)\ (x \to x_0^-), \\
	\ord_{x \to \infty} f(x) = k
	\defiff
	f(x) = \Theta(1/x^k)\ (x \to \infty), \\
	\ord_{x \to +\infty} f(x) = k
	\defiff
	f(x) = \Theta(1/x^k)\ (x \to +\infty), \\
	\ord_{x \to -\infty} f(x) = k
	\defiff
	f(x) = \Theta(1/x^k)\ (x \to -\infty).
\end{gather*}
\end{remark}
\begin{example}
幂函数\(f(x) = a x^\mu\ (a\neq0)\)是当\(x\to0\)时的无穷小，
它的阶为\[
	\ord_{x\to0} f(x) = \mu.
\]
\end{example}

\subsection{无穷大的比较}
\begin{definition}\label{definition:无穷小和无穷大.无穷大的比较}
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷大.
\newcommand{\lf}[1][]{\lim_\mathcal{B} \frac{\beta(x)}{\alpha^{#1}(x)}}
\begin{itemize}
	%@see: 《数学分析（第二版 上册）》（陈纪修） P103 (1)
	\item 如果\(\lf=\infty\)，
	就说“\(\beta\)是比\(\alpha\)~\DefineConcept{高阶}的无穷大”.

	\item 如果\(\lf=0\)，
	就说“\(\beta\)是比\(\alpha\)~\DefineConcept{低阶}的无穷大”，
	记作\(\beta = o(\alpha)\).

	%@see: 《数学分析（第二版 上册）》（陈纪修） P103 (2)
	\item 如果\[
		(\exists A>0)
		(\exists B\in\mathcal{B})
		(\forall x\in B)
		\left[
			\abs{\frac{\beta(x)}{\alpha(x)}} \leq A
		\right],
	\]
	就说“\(\frac\beta\alpha\)是在基\(\mathcal{B}\)上的\DefineConcept{有界量}”，
	记为\(\beta = O(\alpha)\).

	\item 如果\[
		(\exists A>0)
		(\exists a>0)
		(\exists B\in\mathcal{B})
		(\forall x\in B)
		\left[
			a \leq \abs{\frac{\beta(x)}{\alpha(x)}} \leq A
		\right],
	\]
	就说“\(\alpha\)与\(\beta\)是\DefineConcept{同阶}无穷大\footnote{在研究算法时，
	我们会说“\(\alpha\)是\(\beta\)的一个\DefineConcept{渐进紧确界}%
	（asymptotically tight bound）”.}”，
	记作\(\beta = \Theta(\alpha)\).

	\item 如果\(\lf=1\)，
	就说“\(\beta\)与\(\alpha\)是\DefineConcept{等价无穷大}”，
	记作\(\alpha\sim\beta\).
\end{itemize}
\end{definition}
\begin{remark}
根据\cref{definition:无穷小和无穷大.无穷小的比较,definition:无穷小和无穷大.无穷大的比较}，
只要\(\alpha\)是无穷小或无穷大，
就成立\(\lim_\mathcal{B} \frac{o(\alpha)}{\alpha} = 0\).
\end{remark}

\begin{proposition}
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷大，
则\[
	\text{\(\beta\)是比\(\alpha\)高阶的无穷大}
	\iff
	\text{\(\alpha\)是比\(\beta\)低阶的无穷大}.
\]
\end{proposition}

\begin{proposition}
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷大.
若\[
	\lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)} = c\ (\text{$c$是非零常数}),
\]
则\(\beta\)与\(\alpha\)是同阶无穷大.
\end{proposition}

\subsection{无穷小与无穷大的关系}
无穷大与无穷小之间有一种简单的关系，即：
\begin{theorem}\label{theorem:极限.无穷大与无穷小的关系}
%@see: 《高等数学（第六版 上册）》 P41 定理2
设\(f\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基.
令\(g(x) = \frac1{f(x)}\).
\begin{itemize}
	\item 若\(f\)是在基\(\mathcal{B}\)上的无穷大，
	则\(g\)为无穷小.

	\item 若\(f\)是在基\(\mathcal{B}\)上的无穷小，
	且\((\exists B\in\mathcal{B})(\forall x\in B)[f(x) \neq 0]\)，
	则\(g\)为无穷大.
\end{itemize}
\end{theorem}

\begin{proposition}%渐进比较
%@see: 《算法导论（原书第3版）》 P29
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则2
设\(\alpha,\beta,\gamma\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha,\beta,\gamma\)都是在基\(\mathcal{B}\)上的无穷小，
则\begin{itemize}
	\item {\rm\bf 传递性}\begin{gather*}
		\alpha = \Theta(\beta)
		\land
		\beta = \Theta(\gamma)
		\implies
		\alpha = \Theta(\gamma). \\
		\alpha = O(\beta)
		\land
		\beta = O(\gamma)
		\implies
		\alpha = O(\gamma). \\
		\alpha = o(\beta)
		\land
		\beta = o(\gamma)
		\implies
		\alpha = o(\gamma).
	\end{gather*}

	\item {\rm\bf 自反性}\begin{gather*}
		\alpha = \Theta(\alpha). \\
		\alpha = O(\alpha).
	\end{gather*}

	\item {\rm\bf 对称性}\begin{gather*}
		\alpha = \Theta(\beta)
		\iff
		\beta = \Theta(\alpha).
	\end{gather*}
\end{itemize}
\end{proposition}

显然，当一个函数是无穷大时，它必定无界；
但当一个函数无界时，它却不一定是无穷大.
\begin{example}
证明：函数\(f(x) = \frac1x \sin\frac1x\)在区间\((0,1]\)上无界，
但该函数不是\(x\to0^+\)时的无穷大.
\begin{proof}
取数列\(u_n = \frac{\pi}{2} + n\pi\ (n=0,1,2,\dotsc)\)，
那么恒有\(\abs{\sin u_n} = 1\)和\[
	0 < \dotsb < \frac1{u_n} < \dotsb < \frac1{u_1} < \frac1{u_0} < 1
\]成立.
易见\((\forall M > 0)(\forall n\in\mathbb{N})[n > M/\pi \implies u_n > M]\)，
数列\(\{u_n\}\)无界.
由于\[
	\abs{f(x)} = \abs{\frac1x \sin\frac1x}
	= \abs{\frac1x} \abs{\sin\frac1x}
	= \frac1x \abs{\sin\frac1x},
\]\[
	\abs{f(1/u_n)}
	= u_n \abs{\sin u_n}
	= u_n,
\]
所以函数列\(\{\abs{f(1/u_n)}\}\)也无界，
自然地，函数\(f\)也无界.

用反证法.
假设\(f\)是当\(x\to0^+\)时的无穷大，
即\[
	(\forall M>0)
	(\exists\delta>0)
	(\forall x)
	[
		0<x<\delta
		\implies
		\abs{f(x)}>M
	].
\]
取数列\(v_n = n\pi\ (n=1,2,\dotsc)\)，
那么\(\sin v_n = 0\)和\(v_n>0\)恒成立，
且\[
	(\forall\delta>0)
	(\forall n\in\mathbb{N})
	\left[n>\ceil*{\frac1{\pi\delta}} \implies 0<\frac1{v_n}<\delta\right].
\]
由于\[
	\abs{f\left(\frac1{v_n}\right)}
	= v_n \sin v_n
	= 0,
\]
所以函数列\(\{\abs{f(1/v_n)}\}\)恒为零，
与假设矛盾，说明\(f(x)\)不是\(x\to0^+\)时的无穷大.
\end{proof}
\end{example}

\subsection{无穷小与无穷大的运算}
我们不难看出：当\(x\to0\)时，有\begin{gather*}
	x \cdot o(1) = o(x), \qquad
	x \cdot o(x) = o(x^2), \\
	x^{-1} \cdot o(x) = o(1), \qquad
	x^{-1} \cdot o(x^2) = o(x), \qquad
	x^{-2} \cdot o(x^2) = o(1),
\end{gather*}
利用数学归纳法可得以下结论.
\begin{proposition}
当\(x\to0\)时，对于任意整数\(k\)，有\begin{gather}
	x^k \cdot o(x^n) = o(x^{n+k})
	\quad(k \geq 0), \\
	x^{-k} \cdot o(x^n) = o(x^{n-k})
	\quad(n \geq k > 0).
\end{gather}
\end{proposition}

\begin{proposition}\label{theorem:函数的无穷小与无穷大.和差取大规则}
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷小.
如果\(\beta = o(\alpha)\)，
则\[
	\alpha \pm \beta \sim \alpha.
\]
%TODO proof
\end{proposition}
\begin{remark}
\cref{theorem:函数的无穷小与无穷大.和差取大规则} 说明，
当高阶无穷小\(\beta\)和低阶无穷小\(\alpha\)相加或相减时，
它们的等价无穷小就是低阶无穷小\(\alpha\).
如\cref{figure:无穷小与无穷大.次数越大的幂函数越贴近横轴} 所示，
因为当自变量变化时，高阶无穷小比低阶无穷小更快地趋于零，
相对而言，低阶无穷小就显得更“大”一些，
因此我们常常把\cref{theorem:函数的无穷小与无穷大.和差取大规则} 称为“和差取大规则”.
\end{remark}
\begin{figure}[htb]
	\centering
	\begin{tikzpicture}[scale=.6]
		\begin{axis}[
			name=Infinitesimal,
			xmin=0,xmax=.8,
			ymin=0,ymax=.8,
			grid=both,width=\textwidth,height=\textwidth,
			axis lines=middle,
			xlabel=$x$,
			ylabel=$y$,
			x label style={at={(ticklabel* cs:1.00)}, inner sep=5pt, anchor=west},
			y label style={at={(ticklabel* cs:1.00)}, inner sep=2pt, anchor=south},
			xtick={.1,.2,...,.8},
			ytick={.1,.2,...,.8},
		]
			\addplot[color=blue,samples=50,smooth,domain=0:.8]
				{x};\label{pgfplots:无穷小与无穷大.幂函数1}
			\addplot[color=orange,samples=50,smooth,domain=0:.8]
				{x^2};\label{pgfplots:无穷小与无穷大.幂函数2}
			\addplot[color=green,samples=50,smooth,domain=0:.8]
				{x^4};\label{pgfplots:无穷小与无穷大.幂函数4}
			\addplot[color=red,samples=50,smooth,domain=0:.8]
				{x^8};\label{pgfplots:无穷小与无穷大.幂函数8}
		\end{axis}
		\node[draw,fill=white,inner sep=0pt,right=1em]at(Infinitesimal.east){\small\begin{tblr}{cl}
			\ref{pgfplots:无穷小与无穷大.幂函数1} & \(x\) \\
			\ref{pgfplots:无穷小与无穷大.幂函数2} & \(x^2\) \\
			\ref{pgfplots:无穷小与无穷大.幂函数4} & \(x^4\) \\
			\ref{pgfplots:无穷小与无穷大.幂函数8} & \(x^8\) \\
		\end{tblr}};
	\end{tikzpicture}
	\caption{}
	\label{figure:无穷小与无穷大.次数越大的幂函数越贴近横轴}
\end{figure}

特别地，我们可得如下结论.
\begin{corollary}
当\(x\to0\)时，对于非负整数\(m,n\)，如果\(m>n\)，则\[
	o(x^m) + o(x^n) = o(x^n).
\]
\end{corollary}
\begin{remark}
对于上述命题，我们还可以从集合包含关系的角度进行理解：
前面我们提到，高阶无穷小是低阶无穷小的子集，
而当\(x\to0\)时，如果\(m>n\)，则\(o(x^n) \supseteq o(x^m)\)，
于是\[
	o(x^m) \cup o(x^n) = o(x^n).
\]
\end{remark}

\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则9
设\(\alpha,\beta\in\mathbb{R}^X\)，
则\[
	o(\alpha) + o(\beta) = o(\abs{\alpha} + \abs{\beta}).
\]
%TODO proof
\end{proposition}
\begin{theorem}
%@see: 《高等数学（第六版 上册）》 P43 定理1
有限个无穷小的和也是无穷小.
\begin{proof}
对\cref{theorem:函数的无穷小与无穷大.和差取大规则} 运用数学归纳法可得.
\end{proof}
\end{theorem}

\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则1
设\(\alpha,\beta\in\mathbb{R}^X\)，
\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)是基\(\mathcal{B}\)上的无穷大，
\(\beta=O(1)\)，
则\[
	\beta = o(\alpha).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则6
设\(\alpha\in\mathbb{R}^X\)，
则\[
	o(1)~O(\alpha) = o(\alpha).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则7
设\(\alpha\in\mathbb{R}^X\)，
则\[
	O(1)~o(\alpha) = o(\alpha).
\]
%TODO proof
\end{proposition}
\begin{theorem}\label{theorem:函数极限.无穷小.有界函数与无穷小的乘积是无穷小}
%@see: 《高等数学（第六版 上册）》 P43 定理2
有界量与无穷小的乘积是无穷小.
\end{theorem}
%\cref{example:数列极限.有界函数与无穷小的乘积是无穷小}

\begin{corollary}
%@see: 《高等数学（第六版 上册）》 P44 推论1
常数与无穷小的乘积是无穷小.
%TODO proof
\end{corollary}

\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则10
设\(\alpha,\beta\in\mathbb{R}^X\)，
则\[
	o(\alpha)~o(\beta) = o(\alpha \beta).
\]
%TODO proof
\end{proposition}
\begin{corollary}
%@see: 《高等数学（第六版 上册）》 P44 推论2
有限个无穷小的乘积也是无穷小.
%TODO proof
\end{corollary}

\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则3
设\(\alpha,\beta,\gamma\in\mathbb{R}^X\).
如果\(\alpha = O(\beta),
\beta = o(\gamma)\)
则\[
	\alpha = o(\alpha).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则4
设\(\alpha,\beta\in\mathbb{R}^X\)，
则\[
	O(\alpha) + O(\beta) = O(\alpha + \beta).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则5
设\(\alpha,\beta\in\mathbb{R}^X\)，
则\[
	O(\alpha)~O(\beta) = O(\alpha \beta).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则8
设\(\alpha\in\mathbb{R}^X\)，
则\[
	O(\alpha) + o(\alpha) = O(\alpha).
\]
%TODO proof
\end{proposition}
\begin{proposition}
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则12
设\(\alpha\in\mathbb{R}^X\)，
则\[
	(o(\alpha))^k = o(\alpha^k).
\]
%TODO proof
\end{proposition}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P48 例8
求\(\lim_{x\to\infty} \frac{\sin x}{x}\).
\begin{solution}
当\(x\to\infty\)时，分子的极限\(\lim_{x\to\infty} \sin x\)不存在，分母\(x\to\infty\)，
故\hyperref[theorem:极限.极限的四则运算法则]{关于商的极限的运算法则}不能应用.
但是我们可以把\(\frac{\sin x}{x}\)看作\(\sin x\)与\(\frac1x\)的乘积.
由于\(\frac1x\)是当\(x\to\infty\)时的无穷小，
而\(\sin x\)是有界函数，
那么根据\cref{theorem:函数极限.无穷小.有界函数与无穷小的乘积是无穷小}
有\begin{equation}
	\lim_{x\to\infty} \frac{\sin x}{x} = 0.
\end{equation}
\end{solution}
\end{example}

\begin{example}
求\(\lim_{x\to0} x \sin\frac1x\).
\begin{solution}
当\(x\to0\)时，\(\sin\frac1x\)是有界函数，而\(x\)是无穷小，
那么根据\cref{theorem:函数极限.无穷小.有界函数与无穷小的乘积是无穷小}
有\begin{equation}
	\lim_{x\to0} x \sin\frac1x = 0.
\end{equation}
\end{solution}
\end{example}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P49 习题1-5 3. (2)
计算极限\(\lim_{x\to\infty} \frac{\arctan x}{x}\).
\begin{solution}
令\(t = \arctan x\)，
则\(x = \tan t\)，
于是根据\cref{theorem:函数极限.无穷小.有界函数与无穷小的乘积是无穷小} 可得\[
	\lim_{x\to+\infty} \frac{\arctan x}{x}
	= \lim_{t\to\frac\pi2^-} \frac{t}{\tan t}
	= 0,
\]\[
	\lim_{x\to-\infty} \frac{\arctan x}{x}
	= \lim_{t\to-\frac\pi2^+} \frac{t}{\tan t}
	= 0.
\]
因此，根据\cref{theorem:函数极限.极限与单侧极限的关系2} 有\begin{equation}
	\lim_{x\to\infty} \frac{\arctan x}{x} = 0.
\end{equation}
\end{solution}
\end{example}

\subsection{等价替换}
必须指出的是，等价无穷小、等价无穷大都是等价关系.
\begin{property}
%@see: 《高等数学（第六版 上册）》 P60 习题1-7 5.
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则13
设\(\mathcal{B}\)是\(X\)中的基，
\(\alpha,\beta,\gamma\in\mathbb{R}^X\)都是在基\(\mathcal{B}\)上的无穷小（或无穷大），
那么\begin{itemize}
	\item {\rm\bf 自反性}：
	\(\alpha \sim \alpha\)；

	\item {\rm\bf 对称性}：
	\(\alpha \sim \beta \implies \beta \sim \alpha\)；

	\item {\rm\bf 传递性}：
	\(\alpha \sim \beta \land \beta \sim \gamma \implies \alpha \sim \gamma\).
\end{itemize}
\end{property}

与其他等价关系类似，在计算极限时，
我们也可以用一个等价无穷小（或无穷大）去替换另一个无穷小（或无穷大）.

\begin{theorem}\label{theorem:极限.无穷小的比较1}
%@see: 《高等数学（第六版 上册）》 P58 定理1
%@see: 《阶的估计基础》（潘承洞、于秀源） P7 法则14
设\(\alpha,\beta\in\mathbb{R}^X\)，\(\mathcal{B}\)是\(X\)中的基，
\(\alpha\)和\(\beta\)都是在基\(\mathcal{B}\)上的无穷小，
则\(\beta\)与\(\alpha\)是等价无穷小的充分必要条件是
\(\beta = \alpha + o(\alpha)\).
\begin{proof}
必要性.
设\(\alpha\sim\beta\)，
由定义有\(\lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)} = 1\)，
则\[
	\lim_\mathcal{B} \frac{\beta(x)-\alpha(x)}{\alpha(x)}
	= \lim_\mathcal{B} \left(\frac{\beta(x)}{\alpha(x)}-1\right)
	= \lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)}-1 = 0,
\]
因此\(\beta-\alpha=o(\alpha)\)，
即\(\beta=\alpha+o(\alpha)\).

充分性.
设\(\beta=\alpha+o(\alpha)\)，
则\[
	\lim_\mathcal{B} \frac{\beta(x)}{\alpha(x)}
	= \lim_\mathcal{B} \frac{\alpha(x)+o(\alpha)}{\alpha(x)}
	= \lim_\mathcal{B} \left(1+\frac{o(\alpha)}{\alpha(x)}\right)
	= 1 + \lim_\mathcal{B} \frac{o(\alpha)}{\alpha(x)}
	= 1,
\]
因此\(\alpha\sim\beta\).
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:极限.无穷小的比较2}
%@see: 《数学分析（第二版 上册）》（陈纪修） P106 定理3.3.1
%@see: 《高等数学（第六版 上册）》 P59 定理2
设\(\mathcal{B}\)是\(X\)中的基，
\(u,v,w\in\mathbb{R}^X\)在\(x_0 \in X\)的某个去心邻域上有定义，
且\[
	\lim_\mathcal{B} \frac{v(x)}{w(x)} = 1.
\]
\begin{itemize}
	\item 当\(\lim_\mathcal{B} u(x) \cdot w(x) = A\)时，
	有\(\lim_\mathcal{B} u(x) \cdot v(x) = A\).

	\item 当\(\lim_\mathcal{B} \frac{u(x)}{w(x)} = A\)时，
	有\(\lim_\mathcal{B} \frac{u(x)}{v(x)} = A\).
\end{itemize}
\begin{proof}
由\hyperref[theorem:极限.极限的四则运算法则]{极限的四则运算法则}直接可得.
\end{proof}
\end{theorem}

\cref{theorem:极限.无穷小的比较2} 表明，
求两个无穷小之比的极限时，
分子及分母都可用等价无穷小来代替.
因此，如果用来代替的无穷小选得适当的话，
可以使计算简化.

\begin{example}
%@see: 《高等数学（第六版 上册）》 P58 例1
证明：当\(x\to0\)时，\begin{equation}
	\sqrt[n]{1+x} - 1 \sim \frac1n x.
\end{equation}
\begin{proof}
因为\begin{align*}
	\frac{\sqrt[n]{1+x} - 1}{\frac1n x}
	&= \frac{(\sqrt[n]{1+x})^n - 1}{\frac1n x \left[ \sqrt[n]{(1+x)^{n-1}} + \sqrt[n]{(1+x)^{n-2}} + \dotsb + 1 \right]} \\
	&= \frac{n}{\sqrt[n]{(1+x)^{n-1}} + \sqrt[n]{(1+x)^{n-2}} + \dotsb + 1},
\end{align*}
而\[
	\lim_{x\to0} \sqrt[n]{(1+x)^m} = 1,
\]
所以\[
	\lim_{x\to0} \frac{\sqrt[n]{1+x} - 1}{\frac1n x} = \lim_{x\to0} \frac{n}{1 \cdot n} = 1,
\]
也就是说\(\sqrt[n]{1+x} - 1 \sim \frac1n x \quad(x\to0)\).
\end{proof}
\end{example}

\begin{example}
设\(a\neq0\).
计算极限\(\lim_{x\to0} \frac{(1+x)^a-1}x\).
\begin{solution}
%@see: https://www.bilibili.com/video/BV1mG411Z7mV/?t=622
令\(t = (1+x)^a-1\)，
则\[
	a \ln(1+x) = \ln(1+t),
	\qquad
	1+x=\exp[\frac1a \ln(1+t)],
	\qquad
	x=\exp[\frac1a \ln(1+t)]-1,
\]
且\(t\to0\ (x\to0)\)，
于是\[
	\lim_{x\to0} \frac{(1+x)^a-1}x
	= \lim_{t\to0} \frac{t}{\exp[\frac1a \ln(1+t)]-1}.
\]
因为\(\ln(1+t)\to0\ (t\to0)\)和\(e^x-1 \sim x\ (x\to0)\)，
所以\[
	\lim_{x\to0} \frac{(1+x)^a-1}x
	= \lim_{t\to0} \frac{t}{\frac1a \ln(1+t)}
	= a \lim_{t\to0} \frac{t}{\ln(1+t)}.
\]
由\cref{equation:函数极限.重要极限12} 可知
\(\lim_{t\to0} \frac{\ln(1+t)}{t} = 1\)，
因此\begin{equation}\label{equation:函数极限.重要极限16}
	\lim_{x\to0} \frac{(1+x)^a-1}x
	= a.
\end{equation}
\end{solution}
\end{example}
\begin{remark}
从\cref{equation:函数极限.重要极限16} 可以看出：
只要\(a\neq0\)，就有\((1+x)^a-1 \sim ax\ (x\to0)\).
\end{remark}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P106 例3.3.9
计算极限\(\lim_{x\to0} \frac{\ln(1+x^2)}{(e^{2x}-1) \tan x}\).
\begin{solution}
由于当\(x\to0\)时，
\(\tan x \sim x,
e^{2x}-1 \sim 2x,
\ln(1+x^2) \sim x^2\)，
所以\[
	\lim_{x\to0} \frac{\ln(1+x^2)}{(e^{2x}-1) \tan x}
	= \lim_{x\to0} \frac{x^2}{2x \cdot x}
	= \frac12.
\]
\end{solution}
\end{example}

\begin{proposition}[等价无穷小的换元法]\label{theorem:无穷小与无穷大.等价无穷小的换元法}
设\(\alpha,\beta,\gamma\)都是当\(x\to0\)时的无穷小，
其中\(\alpha \sim \beta\)，
并且有\[
	(\exists\delta>0)
	(\forall x)
	[
		x\in\mathring{U}(0,\delta)
		\implies
		\gamma(x) \neq 0
	],
\]
则\[
	\alpha\circ\gamma \sim \beta\circ\gamma.
\]
\begin{proof}
记\(f(x) = \frac{\alpha(x)}{\beta(x)}\)，
利用\hyperref[theorem:极限.复合函数的极限运算法则1]{复合函数的极限运算法则}立即可得\[
	\lim_{x\to0} f(\gamma(x))
	= \lim_{x\to0} f(x)
	= 1.
	\qedhere
\]
\end{proof}
\end{proposition}

\begin{proposition}[和差代替规则]\label{theorem:极限.无穷小的比较4}
设\(\alpha\sim\alpha'\)，\(\beta\sim\beta'\)，\(\beta\)与\(\alpha\)不是等价无穷小，则\[
	\alpha\pm\beta\sim\alpha'\pm\beta'.
\]
\end{proposition}

\begin{proposition}[因式代替规则]\label{theorem:极限.无穷小的比较5}
设\(\alpha\sim\beta\)，且函数\(\phi\)有界或\(\lim\phi\)存在，则\[
	\alpha \phi \sim \beta \phi.
\]
\end{proposition}

\begin{example}
%@see: https://www.bilibili.com/video/BV1E4iPetEzN/
计算极限\(\lim_{n\to\infty} \left(1+\frac1{n^2}\right)\left(1+\frac2{n^2}\right)\dotsm\left(1+\frac{n}{n^2}\vphantom{\frac1{n^2}}\right)\).
\begin{solution}
%@see: {47583c12-05b9-4815-9975-7962eeb50ede}
因为\[
	\ln\left(1+\frac{k}{n^2}\right)
	\sim \frac{k}{n^2}
	\quad(n\to\infty),
\]
所以\begin{align*}
	&\hspace{-20pt}
	\left(1+\frac1{n^2}\right)\left(1+\frac2{n^2}\right)\dotsm\left(1+\frac{n}{n^2}\vphantom{\frac1{n^2}}\right) \\
	&= \exp\sum_{k=1}^n \ln\left(1+\frac{k}{n^2}\right)
	= \exp\left[ \sum_{k=1}^n \left(\frac{k}{n^2} + o\left(\frac1{n^2}\right)\right) \right] \\
	&= \exp\left( \frac{n+1}{2n} + o\left(\frac1n\right) \right)
	\to e^{\frac12}
	\quad(n\to\infty).
\end{align*}
\end{solution}
\end{example}
