\section{反常积分的审敛法}
反常积分的收敛性，可以通过求被积函数的原函数，然后按定义取极限，根据极限的存在与否来判定.
但在本节中，我们可以建立不通过被积函数的原函数判定反常积分收敛性的判定法.

\subsection{柯西极限存在准则}
由于反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛
即为极限\(\lim_{t\to+\infty} \int_a^t f(x) \dd{x}\)存在，
因此对反常积分收敛性的最本质的刻画，
就是极限论中的\hyperref[theorem:极限.函数的柯西极限存在准则]{柯西极限存在准则}，
它可以表述为如下形式：
\begin{theorem}\label{theorem:反常积分.柯西极限存在准则}
%@see: 《数学分析（第二版 上册）》（陈纪修） P370 定理8.2.1（Cauchy收敛原理）
设函数\(f\colon[a,+\infty)\to\mathbb{R}\)，
则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛的充分必要条件是：
对任意给定\(\epsilon>0\)，存在\(X \geq a\)，
使得对任意\(x_1,x_2 \geq X\)，
有\begin{equation*}
	\abs{\int_{x_1}^{x_2} f(t) \dd{t}} < \epsilon.
\end{equation*}
\end{theorem}

同样地，由于反常积分\(\int_a^b f(x) \dd{x}\ (\text{$x=a$是瑕点})\)收敛
即为极限\(\lim_{\epsilon\to0^+} \int_{a+\epsilon}^b f(x) \dd{x}\)存在，
因此我们可以把\hyperref[theorem:极限.函数的柯西极限存在准则]{柯西极限存在准则}表述为如下形式：
\begin{theorem}
%@see: 《数学分析（第二版 上册）》（陈纪修） P376 定理8.2.1'（Cauchy收敛原理）
设函数\(f\colon[a,b)\to\mathbb{R}\)，
点\(x=b\)是瑕点，
则反常积分\(\int_a^b f(x) \dd{x}\)收敛的充分必要条件是：
对任意给定\(\epsilon>0\)，存在\(\delta>0\)，
使得对任意\(d_1,d_2\in(0,\delta)\)，
有\begin{equation*}
	\abs{\int_{b-d_1}^{b-d_2} f(x) \dd{x}} < \epsilon.
\end{equation*}
\end{theorem}

\subsection{绝对收敛，条件收敛}
\begin{definition}
%@see: 《数学分析（第二版 上册）》（陈纪修） P370 定义8.2.1
设函数\(f\colon[a,+\infty)\to\mathbb{R}\)在任意有限闭区间上黎曼可积.
\begin{itemize}
	\item 如果反常积分\begin{equation*}
		\int_a^{+\infty} \abs{f(x)} \dd{x}
	\end{equation*}收敛，
	则称“反常积分\(\int_a^{+\infty} f(x) \dd{x}\)~\DefineConcept{绝对收敛}”.

	\item 如果反常积分\begin{equation*}
		\int_a^{+\infty} f(x) \dd{x}
	\end{equation*}收敛，
	而\begin{equation*}
		\int_a^{+\infty} \abs{f(x)} \dd{x}
	\end{equation*}不收敛，
	则“反常积分\(\int_a^{+\infty} f(x) \dd{x}\)~\DefineConcept{条件收敛}”.
\end{itemize}
\end{definition}

\begin{theorem}\label{theorem:定积分.绝对收敛的无穷限反常积分必收敛}
%@see: 《高等数学（第六版 上册）》 P264 定理5
%@see: 《数学分析（第二版 上册）》（陈纪修） P370 推论
绝对收敛的反常积分必定收敛.
\begin{proof}
对于任意给定\(\epsilon>0\)，
由于\(\int_a^{+\infty} \abs{f(x)} \dd{x}\)收敛，
所以存在\(X \geq a\)，
使得对任意\(x_1,x_2 \geq X\)，
成立\begin{equation*}
	\int_{x_1}^{x_2} \abs{f(x)} \dd{x} < \epsilon.
\end{equation*}
利用\cref{theorem:定积分.定积分性质5推论2} 可得\begin{equation*}
	\abs{\int_{x_1}^{x_2} f(x) \dd{x}}
	\leq \int_{x_1}^{x_2} f(x) \dd{x}
	< \epsilon,
\end{equation*}
再次运用\hyperref[theorem:反常积分.柯西极限存在准则]{柯西极限存在准则}便知
\(\int_a^{+\infty} f(x) \dd{x}\)收敛.
\end{proof}
\end{theorem}

\begin{example}
%@see: 《高等数学（第六版 上册）》 P268 习题5-5 2.
设反常积分\(\int_1^{+\infty} f^2(x) \dd{x}\)收敛.
证明：反常积分\(\int_1^{+\infty} \frac{f(x)}{x} \dd{x}\)绝对收敛.
\begin{proof}
由\hyperref[theorem:不等式.基本不等式2]{基本不等式}
\(a^2 + b^2 \geq 2ab\ (a,b\in\mathbb{R})\)可得，
在区间\([1,+\infty)\)上有\begin{equation*}
	\abs{\frac{f(x)}{x}}
	= \frac{\abs{f(x)}}{x}
	\leq \frac{1}{2} \left[
		\abs{f(x)}^2 + \frac{1}{x^2}
	\right]
	= \frac{1}{2} f^2(x) + \frac{1}{2x^2}
\end{equation*}成立，
且\(\int_1^{+\infty} f^2(x) \dd{x}\)和\(\int_1^{+\infty} \frac{1}{x^2} \dd{x}\)都收敛，
故\(\int_1^{+\infty} \abs{\frac{f(x)}{x}} \dd{x}\)收敛.
\end{proof}
\end{example}

\subsection{非负函数的反常积分的审敛法}
\begin{theorem}\label{theorem:定积分.无穷限反常积分的审敛法引理}
%@see: 《高等数学（第六版 上册）》 P261 定理1
%@see: 《数学分析教程 （第3版 下册）》（史济怀） P274 定理16.1.1
设函数\(f\colon[a,+\infty)\to\mathbb{R}\)非负，
则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛的充分必要条件是：
函数\begin{equation*}
	F\colon[a,+\infty)\to\mathbb{R},
	x \mapsto \int_a^x f(t) \dd{t}
\end{equation*}在\([a,+\infty)\)上有上界.
\begin{proof}
根据\hyperref[definition:定积分.无穷限的反常积分的定义1]{定义}，
反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛，
当且仅当极限\(F(+\infty) = \lim_{x\to+\infty} F(x)\)存在且有限.
由于\(f(x)\geq0\)，
所以\(F(x) = \int_a^x f(t) \dd{t}\)是单调增加的，
于是由\hyperref[theorem:极限.函数的单调有界定理]{单调有界定理}%
和\hyperref[theorem:极限.函数极限的局部有界性]{局部有界性}可知，
极限\(F(+\infty)\)存在且有限的充分必要条件是\(F\)有界.
\end{proof}
\end{theorem}

根据\cref{theorem:定积分.无穷限反常积分的审敛法引理}，
对于非负函数的无穷限的反常积分，有以下的比较审敛原理.
\begin{theorem}[比较审敛原理]\label{theorem:定积分.无穷限反常积分的比较审敛原理}
%@see: 《高等数学（第六版 上册）》 P261 定理2（比较审敛原理）
%@see: 《数学分析（第二版 上册）》（陈纪修） P371 定理8.2.2（比较判别法）
设函数\(f,g\)在区间\([a,+\infty)\)上连续.
\begin{itemize}
	\item 如果\begin{equation*}
		0 \leq f(x) \leq g(x)
		\quad(a \leq x < +\infty),
	\end{equation*}
	并且\(\int_a^{+\infty} g(x) \dd{x}\)收敛，
	则\(\int_a^{+\infty} f(x) \dd{x}\)也收敛.

	\item 如果\begin{equation*}
		0 \leq g(x) \leq f(x)
		\quad(a \leq x < +\infty),
	\end{equation*}
	并且\(\int_a^{+\infty} g(x) \dd{x}\)发散，
	则\(\int_a^{+\infty} f(x) \dd{x}\)也发散.
\end{itemize}
\begin{proof}
任意取定\(t \in (a,+\infty)\).

当有\(0 \leq f(x) \leq g(x)\)且\(\int_a^{+\infty} g(x) \dd{x}\)收敛时，
根据\cref{theorem:定积分.定积分性质5推论1}
得\begin{equation*}
	\int_a^t f(x) \dd{x}
	\leq
	\int_a^t g(x) \dd{x}
	\leq
	\int_a^{+\infty} g(x) \dd{x}.
\end{equation*}
这表明作为积分上限\(t\)的函数\begin{equation*}
	F(t) = \int_a^t f(x) \dd{x}
\end{equation*}
在区间\([a,+\infty)\)上有上界.
由\cref{theorem:定积分.无穷限反常积分的审敛法引理} 可知，
反常积分\(\int_a^{+\infty} f(x) \dd{x}\)也收敛.
\end{proof}
\end{theorem}

\begin{example}
%@credit: {3ba7e116-f533-4966-b9ee-3e553864ebec}
设函数\(f\)在\([0,+\infty)\)上可导，
且\(f'(x)>0,f(0)=1\).
证明：\(\int_0^{+\infty} \frac1{f(x)+f'(x)} \dd{x}\)收敛
是\(\int_0^{+\infty} \frac1{f(x)} \dd{x}\)收敛的充分必要条件.
\begin{proof}
因为\(f'(x)>0\)且\(f(0)=1\)，
所以\(f\)在\([0,+\infty)\)上严格单调增加且恒大于或等于\(1\)，
从而函数\(x \mapsto \frac1{f(x)}\)在\([0,+\infty)\)上严格单调减少且\(0 < \frac1{f(x)} \leq 1\)，
那么由\hyperref[theorem:极限.函数的单调有界定理]{单调有界定理}可知\begin{equation*}
	\lim_{x\to+\infty} \frac1{f(x)} = A < \infty.
\end{equation*}
当\(x\geq0\)时，有\begin{equation*}
	0 < \frac1{f(x)} - \frac1{f(x)+f'(x)}
	= \frac{f'(x)}{f^2(x)+f(x) f'(x)}
	< \frac{f'(x)}{f^2(x)}.
\end{equation*}
又因为\begin{equation*}
	\int_0^{+\infty} \frac{f'(x)}{f^2(x)} \dd{x}
	= \eval{-\frac1{f(x)}}_0^{+\infty}
	= 1 - A,
\end{equation*}
所以由\hyperref[theorem:定积分.无穷限反常积分的比较审敛原理]{比较审敛原理}可知
反常积分\(\int_0^{+\infty} \left( \frac1{f(x)} - \frac1{f(x)+f'(x)} \right) \dd{x}\)收敛.

因此\(\int_0^{+\infty} \frac1{f(x)+f'(x)} \dd{x}\)收敛
是\(\int_0^{+\infty} \frac1{f(x)} \dd{x}\)收敛的充分必要条件.
\end{proof}
\end{example}

\begin{corollary}[比较审敛原理的极限形式]
%@see: 《数学分析（第二版 上册）》（陈纪修） P371 推论（比较判别法的极限形式）
设函数\(f,g\)在\([a,+\infty)\)上非负，
记\begin{equation*}
	\rho \defeq \lim_{x\to+\infty} \frac{f(x)}{g(x)}.
\end{equation*}
\begin{itemize}
	\item 若\(0 \leq \rho < +\infty\)，
	则\begin{equation*}
		\text{\(\int_a^{+\infty} g(x) \dd{x}\)收敛}
		\implies
		\text{\(\int_a^{+\infty} f(x) \dd{x}\)收敛}.
	\end{equation*}
	\item 若\(0 < \rho \leq +\infty\)，
	则\begin{equation*}
		\text{\(\int_a^{+\infty} g(x) \dd{x}\)发散}
		\implies
		\text{\(\int_a^{+\infty} f(x) \dd{x}\)发散}.
	\end{equation*}
\end{itemize}
\end{corollary}

\begin{theorem}[比较审敛法1]\label{theorem:定积分.无穷限反常积分的比较审敛法}
%@see: 《高等数学（第六版 上册）》 P262 定理3（比较审敛法1）
%@see: 《数学分析（第二版 上册）》（陈纪修） P372 定理8.2.3（Cauchy判别法）
设函数\(f\)在区间\([a,+\infty)\)上非负.
\begin{itemize}
	\item 如果存在常数\(M>0\)及\(p>1\)，使得\begin{equation*}
		f(x) \leq \frac{M}{x^p}
		\quad(a \leq x < +\infty),
	\end{equation*}
	则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛.
	\item 如果存在常数\(N>0\)，使得\begin{equation*}
		f(x) \geq \frac{N}{x}
		\quad(a \leq x < +\infty),
	\end{equation*}
	则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)发散.
\end{itemize}
\end{theorem}

\begin{theorem}[比较审敛法2]\label{theorem:定积分.无界函数的反常积分的比较审敛法}
%@see: 《高等数学（第六版 上册）》 P265 定理6（比较审敛法2）
%@see: 《数学分析（第二版 上册）》（陈纪修） P376 定理8.2.3'（Cauchy判别法）
设函数\(f\)在区间\((a,b]\)上非负，
点\(x=a\)是瑕点.
\begin{itemize}
	\item 如果存在常数\(M > 0\)及\(q < 1\)，使得\begin{equation*}
		f(x) \leq \frac{M}{(x-a)^q}
		\quad(a < x \leq b),
	\end{equation*}
	则反常积分\(\int_a^b f(x) \dd{x}\)收敛.
	\item 如果存在常数\(N > 0\)及\(q \geq 1\)，使得\begin{equation*}
		f(x) \geq \frac{N}{(x-a)^q}
		\quad(a < x \leq b),
	\end{equation*}
	则反常积分\(\int_a^b f(x) \dd{x}\)发散.
\end{itemize}
\end{theorem}

\begin{theorem}[极限审敛法1]\label{theorem:定积分.无穷限反常积分的极限审敛法}
%@see: 《高等数学（第六版 上册）》 P262 定理4（极限审敛法1）
%@see: 《数学分析（第二版 上册）》（陈纪修） P373 推论（Cauchy判别法的极限形式）
设函数\(f\)在区间\([a,+\infty)\)上非负，
记\begin{equation*}
	\rho(k) \defeq \lim_{x\to+\infty} x^k f(x).
\end{equation*}
\begin{itemize}
	\item 如果存在常数\(k > 1\)，
	使得\(0 \leq \rho(k) < +\infty\)，
	则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛.
	\item 如果存在常数\(k \leq 1\)，
	使得\(0 < \rho(k) \leq +\infty\)，
	则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)发散.
\end{itemize}
\end{theorem}
\begin{remark}
\cref{theorem:定积分.无穷限反常积分的极限审敛法} 说明：
如果\(f\)是当\(x\to+\infty\)时比\(1/x\)高阶的无穷小，
则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛.
如果\(f\)是当\(x\to+\infty\)时与\(1/x\)同阶的无穷小，
或\(f\)是当\(x\to+\infty\)时比\(1/x\)低阶的无穷小，
则反常积分\(\int_a^{+\infty} f(x) \dd{x}\)发散.
\end{remark}

\begin{theorem}[极限审敛法2]\label{theorem:定积分.无界函数的反常积分的极限审敛法}
%@see: 《高等数学（第六版 上册）》 P265 定理7（极限审敛法2）
%@see: 《数学分析（第二版 上册）》（陈纪修） P372 推论'（Cauchy判别法的极限形式）
设函数\(f\)在区间\((a,b]\)上非负，
点\(x=a\)是瑕点，
记\begin{equation*}
	\rho(k) \defeq \lim_{x\to a^+} (x-a)^k f(x).
\end{equation*}
\begin{itemize}
	\item 如果存在常数\(k < 1\)，
	使得\(0 \leq \rho(k) < +\infty\)，
	则反常积分\(\int_a^b f(x) \dd{x}\)收敛.

	\item 如果存在常数\(k \geq 1\)，
	使得\(0 < \rho(k) \leq +\infty\)，
	则反常积分\(\int_a^b f(x) \dd{x}\)发散.
\end{itemize}
\end{theorem}
\begin{remark}
\cref{theorem:定积分.无界函数的反常积分的极限审敛法} 说明：
如果\(f\)是当\(x \to a^+\)时比\(1/(x-a)\)低阶的无穷大，
则反常积分\(\int_a^b f(x) \dd{x}\)收敛.
如果\(f\)是当\(x \to a^+\)时与\(1/(x-a)\)同阶的无穷大，
或\(f\)是当\(x \to a^+\)时比\(1/(x-a)\)高阶的无穷大，
则反常积分\(\int_a^b f(x) \dd{x}\)发散.
\end{remark}

\begin{example}\label{example:定积分.高斯积分的收敛性}
证明：高斯积分\begin{equation*}
	\int_0^{+\infty} e^{-x^2} \dd{x}
\end{equation*}收敛.
\begin{proof}
因为在区间\([0,+\infty)\)上被积函数\(f(x) = e^{-x^2} > 0\)，
且由\cref{example:微分中值定理.洛必达法则.无穷大比无穷大型2} 可知极限\begin{equation*}
	\lim_{x\to+\infty} x^2 e^{-x^2}
	= \lim_{x\to+\infty} \frac{x^2}{e^{x^2}}
	\xlongequal{u=x^2} \lim_{u\to+\infty} \frac{u}{e^u}
	= 0,
\end{equation*}
那么根据\cref{theorem:定积分.无穷限反常积分的极限审敛法}，
高斯积分\(\int_0^{+\infty} e^{-x^2} \dd{x}\)收敛.
\end{proof}
\end{example}
\begin{remark}
同理可知\(\int_{-\infty}^0 e^{-x^2} \dd{x}\)也收敛，
于是高斯积分\begin{equation*}
	\int_{-\infty}^{+\infty} e^{-x^2} \dd{x}
\end{equation*}收敛.
%\cref{example:反常积分.利用伽马函数计算高斯积分}
%\cref{example:二重积分.利用二重积分计算高斯积分}
\end{remark}

\begin{example}
%@see: 《2010年全国硕士研究生入学统一考试（数学一）》一选择题/第3题
设\(m,n\)是正整数，
讨论反常积分\(\int_0^1 \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)的敛散性.
\begin{proof}
点\(x=0\)和\(x=1\)都可能是被积函数\(\frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}}\)的瑕点.

先考虑\(\int_0^{\frac12} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)的敛散性.

因为当\(x\to0^+\)时\(\ln(1-x) \sim -x\)，
所以\begin{equation*}
	\lim_{x\to0^+} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}}
	= \lim_{x\to0^+} x^{\frac2m-\frac1n}
	= \left\{ \def\arraystretch{1.5} \begin{array}{cl}
		0, & \frac2m-\frac1n>0, \\
		1, & \frac2m-\frac1n=0, \\
		\infty, & \frac2m-\frac1n<0.
	\end{array} \right.
\end{equation*}
由于\(m,n\)都是正整数，所以\(-1<\frac2m-\frac1n<2\).
于是当\(\frac2m-\frac1n\geq0\)时，
点\(x=0\)不是被积函数\(\frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}}\)的瑕点，
定积分\(\int_0^{\frac12} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)收敛.
当\(-1<\frac2m-\frac1n<0\)时，
点\(x=0\)是被积函数\(\frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}}\)的瑕点，
只要取\(q=\frac1n-\frac2m\in(0,1)\)，
就有\begin{equation*}
	\lim_{x\to0^+} x^q \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} = 1.
\end{equation*}
由\cref{theorem:定积分.无界函数的反常积分的极限审敛法} 可知
反常积分\(\int_0^{\frac12} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)收敛.
因此，不论\(m,n\)取什么正整数，
积分\(\int_0^{\frac12} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)总是收敛.

再考虑\(\int_{\frac12}^1 \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)的敛散性.
因为\begin{align*}
	\lim_{x\to1^-} \sqrt{1-x} \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}}
	&= \lim_{x\to1^-} \sqrt{1-x} \ln^{\frac2m}(1-x) \\
	&\xlongequal{u=1-x}
	\lim_{u\to0^+} u^{\frac12} \ln^{\frac2m} u
	= 0, \tag{\cref{example:微分中值定理.洛必达法则.零乘无穷大型2}}
\end{align*}
所以由\cref{theorem:定积分.无界函数的反常积分的极限审敛法} 可知
不论\(m,n\)取什么正整数，
反常积分\(\int_{\frac12}^1 \frac{\sqrt[m]{\ln^2(1-x)}}{\sqrt[n]{x}} \dd{x}\)总是收敛.
\end{proof}
\end{example}
\begin{example}
%@see: 《2016年全国硕士研究生入学统一考试（数学一）》一选择题/第1题
设反常积分\(\int_0^{+\infty} \frac{\dd{x}}{x^a (1+x)^b}\)收敛，
判断\(a,b\)的取值范围.
\begin{solution}
令\(f(x) = \frac1{x^a (1+x)^b}\).
由\cref{theorem:定积分.定积分性质3} 可得\begin{equation*}
	\int_0^{+\infty} \frac{\dd{x}}{x^a (1+x)^b}
	= \int_0^1 \frac{\dd{x}}{x^a (1+x)^b}
	+ \int_1^{+\infty} \frac{\dd{x}}{x^a (1+x)^b}
	= I_1 + I_2.
\end{equation*}

先考虑积分\(I_1\).
\begin{itemize}
	\item 当\(a\leq0\)时，
	\(I_1\)是常义积分.
	\item 当\(a>0\)时，\(x=0\)是瑕点，有\begin{equation*}
		\lim_{x\to0^+} x^a f(x)
		= \lim_{x\to0^+} \frac1{(1+x)^b}
		= 1 > 0,
	\end{equation*}
	由\cref{theorem:定积分.无界函数的反常积分的极限审敛法} 可知，
	当\(0<a<1\)时，积分\(I_1\)收敛；
	当\(a\geq1\)时，积分\(I_1\)发散.
\end{itemize}
因此，要使\(I_1\)收敛，必有\(a < 1\).

再考虑积分\(I_2\).
注意到\begin{equation*}
	\lim_{x\to+\infty} x^{a+b} f(x)
	= \lim_{x\to+\infty} \frac{x^b}{(1+x)^b}
	= 1 > 0,
\end{equation*}
由\cref{theorem:定积分.无穷限反常积分的极限审敛法} 可知，
当\(a+b>1\)时，积分\(I_2\)收敛；
当\(a+b\leq1\)时，积分\(I_2\)发散.

综上所述，反常积分\(\int_0^{+\infty} \frac{\dd{x}}{x^a (1+x)^b}\)收敛，
当且仅当\(a<1\)且\(a+b>1\).
\end{solution}
\end{example}

\subsection{一般函数的反常积分的审敛法}
\begin{theorem}\label{theorem:反常积分.无穷限的反常积分的阿贝尔--狄利克雷审敛法}
%@see: 《数学分析（第二版 上册）》（陈纪修） P374 定理8.2.5
设函数\(f,g\colon[a,+\infty)\to\mathbb{R}\).

若下列两个条件之一满足，
则反常积分\(\int_a^{+\infty} f(x) ~ g(x) \dd{x}\)收敛：\begin{itemize}
	\item {\rm\bf 阿贝尔条件}
	反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛，
	函数\(g\)在\([a,+\infty)\)上单调有界；

	\item {\rm\bf 狄利克雷条件}
	函数\(x \mapsto \int_a^x f(t) \dd{t}\)在\([a,+\infty)\)上有界，
	函数\(g\)在\([a,+\infty)\)上单调且\(\lim_{x\to+\infty} g(x) = 0\).
\end{itemize}
%TODO proof
%\cref{theorem:定积分.积分中值定理2}
%\cref{theorem:无穷级数.无穷级数的阿贝尔--狄利克雷审敛法}
\end{theorem}

\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P375 例8.2.4
证明：反常积分\(\int_1^{+\infty} \frac{\sin x}{x} \dd{x}\)条件收敛.
% 与狄利克雷积分\(\int_0^{+\infty} \frac{\sin x}{x} \dd{x}\)的积分下限不同！
\begin{proof}
显然函数\(x \mapsto \int_1^x \sin t \dd{t}\)有界，
函数\(x \mapsto \frac1x\)在\([1,+\infty)\)上单调减少且\(\lim_{x\to+\infty} \frac1x = 0\)，
满足\hyperref[theorem:反常积分.无穷限的反常积分的阿贝尔--狄利克雷审敛法]{狄利克雷条件}，
因此反常积分\(\int_1^{+\infty} \frac{\sin x}{x} \dd{x}\)收敛.

但是在\([1,+\infty)\)上，有\begin{equation*}
	\abs{\frac{\sin x}{x}}
	\geq \frac{\sin^2x}{x}
	= \frac1{2x} - \frac{\cos2x}{2x},
\end{equation*}
因反常积分\(\int_1^{+\infty} \frac{\cos2x}{2x} \dd{x}\)收敛
（仿照上面对反常积分\(\int_1^{+\infty} \frac{\sin x}{x} \dd{x}\)的讨论），
而反常积分\(\int_1^{+\infty} \frac{\dd{x}}{2x}\)发散，
所以反常积分\(\int_1^{+\infty} \frac{\sin^2x}{x} \dd{x}\)发散.
再由\hyperref[theorem:定积分.无穷限反常积分的比较审敛原理]{比较审敛原理}可知，
\(\int_1^{+\infty} \abs{\frac{\sin x}{x}} \dd{x}\)发散.

综上所述，\(\int_1^{+\infty} \frac{\sin x}{x} \dd{x}\)条件收敛.
\end{proof}
\end{example}
\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P375 例8.2.5
证明：反常积分\(\int_1^{+\infty} \frac{\sin x \arctan x}{x} \dd{x}\)条件收敛.
\begin{proof}
由上例可知\(\int_1^{+\infty} \frac{\sin x}{x} \dd{x}\)收敛，
而函数\(x \mapsto \arctan x\)在\([1,+\infty)\)上单调有界，
满足\hyperref[theorem:反常积分.无穷限的反常积分的阿贝尔--狄利克雷审敛法]{阿贝尔条件}，
因此\(\int_1^{+\infty} \frac{\sin x \arctan x}{x} \dd{x}\)收敛.

当\(\sqrt3 \leq x < +\infty\)时，有\begin{equation*}
	\abs{\frac{\sin x \arctan x}{x}}
	\geq \abs{\frac{\sin x}{x}}.
\end{equation*}
因为\(\int_1^{+\infty} \abs{\frac{\sin x}{x}} \dd{x}\)发散，
所以由\hyperref[theorem:定积分.无穷限反常积分的比较审敛原理]{比较审敛原理}可知，
\(\int_1^{+\infty} \abs{\frac{\sin x \arctan x}{x}} \dd{x}\)发散.

综上所述，\(\int_1^{+\infty} \frac{\sin x \arctan x}{x} \dd{x}\)条件收敛.
\end{proof}
\end{example}

\begin{theorem}\label{theorem:反常积分.无界函数的反常积分的阿贝尔--狄利克雷审敛法}
%@see: 《数学分析（第二版 上册）》（陈纪修） P376 定理8.2.5'
设函数\(f,g\colon(a,b]\to\mathbb{R}\)，
点\(x=a\)是瑕点.

若下列两个条件之一满足，
则反常积分\(\int_a^b f(x) ~ g(x) \dd{x}\)收敛：\begin{itemize}
	\item {\rm\bf 阿贝尔条件}
	反常积分\(\int_a^b f(x) \dd{x}\)收敛，
	函数\(g\)在\((a,b]\)上单调有界.

	\item {\rm\bf 狄利克雷条件}
	函数\(x \mapsto \int_{a+x}^b f(t) \dd{t}\)在\((0,b-a]\)上有界，
	函数\(g\)在\((a,b]\)上单调且\(\lim_{x \to a^+} g(x) = 0\).
\end{itemize}
%TODO proof
\end{theorem}

\subsection{反常积分的重要特性}
%@see: 《数学分析（第二版 上册）》（陈纪修） P362
设函数\(f\colon[a,+\infty)\to\mathbb{R}\).
由\cref{example:定积分.p积分} 可知，
\(\lim_{x\to+\infty} f(x) = 0\)
并不能保证\(\int_a^{+\infty} f(x) \dd{x}\)收敛.
% 反常积分\(\int_0^{+\infty} \sin x^2 \dd{x}\)收敛于\(\sqrt{\frac\pi8}\)，但是函数\(x \mapsto \sin x^2\)不是当\(x\to+\infty\)时的无穷小
反过来，若\(\int_a^{+\infty} f(x) \dd{x}\)收敛，
能否保证\(\lim_{x\to+\infty} f(x) = 0\)，
或者退一步，至少保证\(f\)在定义域上有界呢？
下面我们用一个例子说明：同样不能！
\begin{example}
%@see: 《数学分析（第二版 上册）》（陈纪修） P362 例8.1.7
设函数\(f\colon[1,+\infty)\to\mathbb{R}\)
满足\begin{equation*}
	f(x) = \left\{ \begin{array}{cl}
		n+1, & n \leq x \leq n+\frac1{n(n+1)^2}, \\
		0, & n+\frac1{n(n+1)^2} < x < n+1,
	\end{array} \right.
	\quad n=1,2,\dotsc.
\end{equation*}
那么对于任意\(t>1\)，
总可以取自然数\(n\)，
使得\(n \leq t < n+1\).
由于\(f(x)\geq0\)，
所以\begin{equation*}
	\int_1^n f(x) \dd{x}
	\leq \int_1^t f(x) \dd{x}
	\leq \int_1^{n+1} f(x) \dd{x}.
\end{equation*}
考虑到\begin{equation*}
	\int_k^{k+1} f(x) \dd{x}
	= \int_k^{k+\frac1{k(k+1)^2}} (k+1) \dd{x}
	= (k+1) \cdot \frac1{k(k+1)^2}
	= \frac1{k(k+1)},
	\quad k=1,2,\dotsc,
\end{equation*}
令\(n\to\infty\)，
得\begin{align*}
	\lim_{n\to\infty} \int_1^n f(x) \dd{x}
	&= \lim_{n\to\infty} \left[
		\int_1^2 f(x) \dd{x}
		+ \int_2^3 f(x) \dd{x}
		+ \dotsb
		+ \int_{n-1}^n f(x) \dd{x}
	\right] \\
	&= \lim_{n\to\infty} \left[
		\frac1{1\cdot2}
		+ \frac1{2\cdot3}
		+ \dotsb
		+ \frac1{(n-1)n}
	\right] \\
	&= \lim_{n\to\infty} \left[
		\left(1-\frac12\right)
		+ \left(\frac12-\frac13\right)
		+ \dotsb
		+ \left(\frac1{n-1}-\frac1n\right)
	\right] \\
	&= \lim_{n\to\infty} \left(1-\frac1n\right)
	= 1.
\end{align*}
同理可得\begin{equation*}
	\lim_{n\to\infty} \int_1^{n+1} f(x) \dd{x} = 1.
\end{equation*}
利用\hyperref[theorem:数列极限.夹逼准则]{夹逼准则}便知\begin{equation*}
	\int_1^{+\infty} f(x) \dd{x}
	= \lim_{t\to+\infty} \int_1^t f(x) \dd{x}
	= 1,
\end{equation*}
但是\(f\)显然是无界的.
\end{example}
我们还可以断言，即使\(f\)在\([a,+\infty)\)上连续（甚至\(n\)次可微），
也可仿照上例，构造出使\(\int_a^{+\infty} f(x) \dd{x}\)收敛，
而\(f\)在\([a,+\infty)\)无界的例子.

下面证明，只要把“\(f\)在\([a,+\infty)\)上连续”
或“\(f\)在\([a,+\infty)\)上\(n\)次可微”
改为“\(f\)在\([a,+\infty)\)上一致连续”，
就能得到\(\lim_{x\to+\infty} f(x) = 0\).

\begin{proposition}
%@see: 《数学分析（第二版 上册）》（陈纪修） P379 例8.2.9
设函数\(f\colon[a,+\infty)\to\mathbb{R}\)在\([a,+\infty)\)一致连续，
且反常积分\(\int_a^{+\infty} f(x) \dd{x}\)收敛，
则\(\lim_{x\to+\infty} f(x) = 0\).
%TODO proof
\end{proposition}
