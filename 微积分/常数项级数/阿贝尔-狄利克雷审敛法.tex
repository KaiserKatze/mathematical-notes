\section{阿贝尔--狄利克雷审敛法}
\begin{lemma}[阿贝尔变换]
%@see: 《数学分析（第二版 下册）》（陈纪修） P31 引理9.4.1（Abel变换）
%@see: 《数学分析教程（第3版 下册）》（史济怀） P182 引理14.4.1（Abel分部求和公式）
设\(\{a_n\},\{b_n\}\)是两个数列，
记\(B_n \defeq \sum_{k=1}^n b_k\ (n=1,2,\dotsc)\)，
则\begin{equation}\label{equation:无穷级数.阿贝尔的分部求和公式}
	\sum_{k=1}^p a_k b_k
	= a_p B_p - \sum_{k=1}^{p-1} (a_{k+1} - a_k) B_k.
\end{equation}
\begin{proof}
直接计算得\begin{align*}
	\sum_{k=1}^p a_k b_k
	&= a_1 B_1 + \sum_{k=2}^p a_k (B_k - B_{k-1}) \\
	&= a_1 B_1 + \sum_{k=2}^p a_k B_k - \sum_{k=2}^p a_k B_{k-1} \\
	&= \sum_{k=1}^{p-1} a_k B_k - \sum_{k=1}^{p-1} a_{k+1} B_k + a_p B_p \\
	&= a_p B_p - \sum_{k=1}^{p-1} (a_{k+1} - a_k) B_k.
	\qedhere
\end{align*}
\end{proof}
\end{lemma}
我们把\cref{equation:无穷级数.阿贝尔的分部求和公式} 称为\DefineConcept{分部求和公式}.
事实上，阿贝尔变换就是离散形式的分部积分公式.
我们只要把数列的通项类比于被积函数
（\(a_n\)对应于\(u(x)\)，\(b_n\)对应于\(v(x)\)），
求和类比于求积分，
求差类比于求微分
（\(a_{k+1} - a_k\)对应于函数的微分\(\dd{[u(x)]}\)），
那么两条公式就是一致的.

\begin{example}
%@see: https://www.bilibili.com/video/BV1JW4y1U7NF/
利用阿贝尔变换证明\cref{example:无穷级数.与调和数列有关的级数1} 中的级数收敛并求和.
\begin{solution}
记\(a_n = \frac1{n+1},
b_n = \frac1n,
B_n = \sum_{k=1}^n \frac1k\)，
那么由\cref{equation:无穷级数.阿贝尔的分部求和公式} 有\begin{align*}
	&\sum_{n=1}^m \frac1{(n+1)(n+2)} \sum_{k=1}^n \frac1k
	= \sum_{n=1}^m \left( a_n - a_{n+1} \right) B_n
	= \sum_{n=1}^{m+1} a_n b_n - a_{m+1} B_{m+1} \\
	&= \sum_{n=1}^{m+1} \frac1{n+1} \cdot \frac1n - \frac1{m+2} \sum_{k=1}^{m+1} \frac1k
	= 1 - \frac1{m+2} - \frac1{m+2} \sum_{k=1}^{m+1} \frac1k.
\end{align*}
令\(m\to\infty\)，
由\(\frac1{m+2} \to 0,
\frac1{m+2} \sum_{k=1}^{m+1} \frac1k \to 0\)可知
\(\sum_{n=1}^m \frac1{(n+1)(n+2)} \sum_{k=1}^n \frac1k \to 1\).
\end{solution}
\end{example}

\begin{lemma}[阿贝尔引理]\label{theorem:无穷级数.阿贝尔引理}
%@see: 《数学分析（第二版 下册）》（陈纪修） P32 引理9.4.2（Abel引理）
%@see: 《数学分析教程（第3版 下册）》（史济怀） P182 引理14.4.2（Abel引理）
设\begin{itemize}
	\item \(\{a_n\}\)是单调数列，
	\item 数列\(\{b_n\}\)的部分和数列\(\{B_n\}\)
	（其中\(B_n = \sum_{k=1}^n b_k\ (n=1,2,\dotsc)\)）有界，
	即存在\(M>0\)，成立\(\abs{B_n} \leq M\ (n=1,2,\dotsc)\)，
\end{itemize}
则\begin{equation*}
	\abs{\sum_{k=1}^p a_k b_k}
	\leq M(\abs{a_1} + 2 \abs{a_p}).
\end{equation*}
\begin{proof}
由\hyperref[equation:无穷级数.阿贝尔的分部求和公式]{阿贝尔变换}得\begin{align*}
	\abs{\sum_{k=1}^p a_k b_k}
	&\leq \abs{a_p} \abs{B_p} + \sum_{k=1}^{p-1} \abs{a_{k+1} - a_k} \abs{B_k} \\
	&\leq M \left(
		\abs{a_p}
		+ \sum_{k=1}^{p-1} \abs{a_{k+1} - a_k}
	\right).
\end{align*}
由于\(\{a_n\}\)单调，
所以\begin{equation*}
	\sum_{k=1}^{p-1} \abs{a_{k+1} - a_k}
	= \abs{\sum_{k=1}^{p-1} (a_{k+1} - a_k)}
	= \abs{a_p - a_1}
	\leq \abs{a_p} + \abs{a_1},
\end{equation*}
于是\begin{equation*}
	\abs{\sum_{k=1}^p a_k b_k}
	\leq M(\abs{a_1} + 2 \abs{a_p}).
	\qedhere
\end{equation*}
\end{proof}
\end{lemma}

\begin{theorem}\label{theorem:无穷级数.无穷级数的阿贝尔--狄利克雷审敛法}
%@see: 《数学分析（第二版 下册）》（陈纪修） P33 定理9.4.3（级数的A-D判别法）
%@see: 《数学分析教程（第3版 下册）》（史济怀） P183 定理14.4.3（Dirichlet判别法）
%@see: 《数学分析教程（第3版 下册）》（史济怀） P184 定理14.4.4（Abel判别法）
设\(\{a_n\},\{b_n\}\)是两个数列.

若下列两个条件之一满足，
则级数\(\sum_{n=1}^\infty a_n b_n\)收敛：\begin{itemize}
	\item {\rm\bf 阿贝尔条件}
	数列\(\{a_n\}\)单调有界，
	级数\(\sum_{n=1}^\infty b_n\)收敛；

	\item {\rm\bf 狄利克雷条件}
	数列\(\{a_n\}\)单调趋于\(0\)，
	级数\(\sum_{n=1}^\infty b_n\)的部分和数列有界.
	%@see: https://mathworld.wolfram.com/DirichletsTest.html
\end{itemize}
\begin{proof}
假设满足阿贝尔条件，
设\(\abs{a_n} \leq M\)，
由于\(\sum_{n=1}^\infty b_n\)收敛，
则对于任意给定\(\epsilon>0\)，
存在正整数\(N\)，
使得对于一切\(n>N\)和一切正整数\(p\)，
成立\begin{equation*}
	\abs{\sum_{k=n+1}^{n+p} b_k} < \epsilon.
\end{equation*}
对\(\sum_{k=n+1}^{n+p} a_k b_k\)应用\hyperref[theorem:无穷级数.阿贝尔引理]{阿贝尔引理}，即得\begin{equation*}
	\abs{\sum_{k=n+1}^{n+p} a_k b_k}
	< \epsilon (\abs{a_{n+1} + 2 \abs{a_{n+p}}})
	\leq 3 M \epsilon.
\end{equation*}
根据\hyperref[theorem:无穷级数.级数的柯西审敛原理]{柯西审敛原理}便知
级数\(\sum_{n=1}^\infty a_n b_n\)收敛.

假设满足狄利克雷条件.
由于\(\lim_{n\to\infty} a_n = 0\)，
因此对于任意给定\(\epsilon>0\)，
存在正整数\(N\)，
使得对于一切\(n>N\)，
成立\begin{equation*}
	\abs{a_n} < \epsilon.
\end{equation*}
又设\(\abs{\sum_{k=1}^n b_k} \leq M\)，
令\(B_p = \sum_{k=n+1}^{n+p} b_k\ (p=1,2,\dotsc)\)，
则\begin{equation*}
	\abs{B_p}
	= \abs{\sum_{k=1}^{n+p} b_k - \sum_{k=1}^n b_k}
	\leq \abs{\sum_{k=1}^{n+p} b_k} + \abs{\sum_{k=1}^n b_k}
	= 2 M.
\end{equation*}
应用\hyperref[theorem:无穷级数.阿贝尔引理]{阿贝尔引理}，同样可得\begin{equation*}
	\abs{\sum_{k=n+1}^{n+p} a_k b_k}
	\leq 2 M (\abs{a_{n+1}} + 2 \abs{a_{n+p}})
	< 6 M \epsilon
\end{equation*}对一切\(n>N\)与一切正整数\(p\)成立.
根据\hyperref[theorem:无穷级数.级数的柯西审敛原理]{柯西审敛原理}便知
级数\(\sum_{n=1}^\infty a_n b_n\)收敛.
\end{proof}
%\cref{theorem:反常积分.无穷限的反常积分的阿贝尔--狄利克雷审敛法}
\end{theorem}
\begin{remark}
在狄利克雷条件中，取\(b_n = (-1)^{n-1}\)，
则级数\(\sum_{n=1}^\infty b_n\)的部分和数列有界，
那么当数列\(\{a_n\}\)单调趋于\(0\)时，
级数\(\sum_{n=1}^\infty (-1)^{n-1} a_n\)收敛.
这就是前面已经证明过的\hyperref[theorem:无穷级数.莱布尼茨定理]{莱布尼茨审敛法}.
可见莱布尼茨审敛法只是狄利克雷审敛法的特殊情形.

在阿贝尔条件中，由于数列\(\{a_n\}\)单调有界，不妨设\(\lim_{n\to\infty} a_n = a\)，
则数列\(\{a_n - a\}\)单调趋于\(0\).
又因为级数\(\sum_{n=1}^\infty b_n\)收敛，
所以它的部分和数列必定有界，根据狄利克雷审敛法，
级数\(\sum_{n=1}^\infty (a_n - a) b_n\)收敛，
从而级数\(\sum_{n=1}^\infty a_n b_n\)收敛.
这就说明：阿贝尔审敛法是狄利克雷审敛法的特殊情形.
\end{remark}

\begin{example}\label{example:无穷级数.单调收敛数列与正弦函数列的乘积的级数收敛}
%@see: 《数学分析（第二版 下册）》（陈纪修） P34 例9.4.3
设数列\(\{a_n\}\)单调趋于\(0\)，
则对一切实数\(x\)，级数\(\sum_{n=1}^\infty a_n \sin n x\)收敛.
\begin{proof}
当\(x=2k\pi\)时，
有\(\sum_{n=1}^\infty a_n \sin n x = 0\)，
于是对于一切实数\(x\)，
级数\(\sum_{n=1}^\infty a_n \sin n x\)收敛.

当\(x\neq2k\pi\)时，有\begin{equation*}
	2\sin\frac{x}{2} \cdot \sum_{k=1}^n \sin kx
	= \cos\frac{x}{2} - \cos\frac{2n+1}{2}x,
\end{equation*}
于是对一切正整数\(n\)有\begin{equation*}
	\abs{\sum_{k=1}^n \sin k x}
	\leq \frac1{\abs{\sin(x/2)}},
\end{equation*}
由\hyperref[theorem:无穷级数.无穷级数的阿贝尔--狄利克雷审敛法]{狄利克雷审敛法}可知
级数\(\sum_{n=1}^\infty a_n \sin n x\)收敛.
\end{proof}
\end{example}
