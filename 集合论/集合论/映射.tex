\section{映射}
\subsection{映射的概念}
\begin{definition}
%@see: 《Elements of Set Theory》 P42 Definition
设\(F\)是关系，如果\[
	(\forall x \in \dom F)(\exists! y)[\opair{x,y} \in F],
\]
则称“关系\(F\)是一个\DefineConcept{映射}（function）”.
\end{definition}
可以从映射的定义中看出，虽然映射也是关系，
但映射有一般的关系所没有的特殊性质：
映射是\DefineConcept{单值的}（single-valued）.
换句话说，对于关系\(F\)，每个\(x\)可能对应若干个\(y\)；
但是，对于映射\(F\)，每个\(x\)就只对应一个\(y\).
我们可以把\(x\)与\(y\)这两个元素之间的对应关系记为\(x \mapsto y\).

我们把使得\(xFy\)成立的\(y\)称为“\(x\)（在映射\(F\)下）的\DefineConcept{像}%
（the \emph{value} of \(F\) at \(x\)）”，
记为\(F(x)\)，即\[
	y = f(x);
\]
称\(x\)为“\(y\)（在映射\(F\)下）的一个\DefineConcept{原像}”.
这里用的\(F(x)\)符号是欧拉提出的，
我们仅当\(F\)是一个映射且\(x\in\dom F\)时使用这个记号.
不过，我们也可以定义：\[
	F(x) \defeq \bigcup\Set{ y \given \opair{x,y} \in F }.
\]
它对于任意\(F\)和\(x\)都有意义.

映射是如此重要，以至于各家对用于描述映射的术语没有达成统一.
以下是两种最常采用的术语.

设\(X,Y\)都是集合，
如果\(f\)是一个映射，且\(\dom f = X\)，\(\ran f \subseteq Y\)，
则称“\(f\)是从\(X\)到\(Y\)的\DefineConcept{映射}%
（\(f\) is a function \emph{from} \(X\) \emph{into} \(Y\)）”，
或称“\(f\)将\(X\)映射到\(Y\)里%
（\(f\) \emph{maps} \(X\) \emph{into} \(Y\)）”，
记作\[
	f\colon X \to Y.
\]
如果还有\(\ran f = Y\)，
那么称“\(f\)是从\(X\)到\(Y\)上的映射%
（\(f\) is a function from \(X\) \emph{onto} \(Y\)）”，
或称“\(f\)将\(X\)映射到\(Y\)上%
（\(f\) \emph{maps} \(X\) \emph{onto} \(Y\)）”，
或称“\(f\)是\DefineConcept{满射}（surjective）”.
我们把集合\(Y\)称为“映射\(f\)的\DefineConcept{陪域}（codomain）”.
我们可以说“任意映射总将它的定义域映射到它的值域上”，
还可以说“任意映射总把它的定义域映射到以它的值域为子集的任意集合\(Y\)里”.
注意到两种说法的区别，“上”字和“里”字的选用，
不光取决于映射\(f\)本身，还取决于我们讨论的陪域\(Y\).

如果\[
	(\forall y \in \ran f)
	(\exists! x)
	[\opair{x,y} \in f],
\]
那么称“映射\(f\)是\DefineConcept{一对一的}（one-to-one）”.

有时候我们希望把“一对一的”这个概念套用到一般的关系上，
它们往往不是映射，因此我们类比于“单值的”，创造出“单根的”这个概念.
\begin{definition}
%@see: 《Elements of Set Theory》 P43 Definition
如果集合\(R\)满足\[
	(\forall y \in \ran R)
	(\exists! x)
	[\opair{x,y} \in R],
\]
则称“\(R\)是\DefineConcept{单根的}（single-rooted）”.
\end{definition}

因此，我们可以说，“一个映射是单根的”当且仅当“这个映射是一对一的”.

如果\[
	(\forall x_1, x_2 \in \dom f)
	[x_1 \neq x_2 \implies f(x_1) \neq f(x_2)],
\]
那么称“\(f\)是\DefineConcept{单射}（injective）”.

由于映射本就是单值的，若它还是单根的，那么这个映射就是单射.
换句话说，“一对一的映射”和“单射”是相同的概念.

如果\(f\)既是单射，又是满射，
那么称“\(f\)是\DefineConcept{双射}（bijective）
或\DefineConcept{一一映射}”.

我们可以给出一个最平凡的一一映射.
\begin{definition}
设\(X\)是集合.
我们把\[
	\Set{ \opair{x,x} \given x \in X }
\]称为“（\(X\)上的）\DefineConcept{恒等映射}或\DefineConcept{恒同映射}”，
常记为\(i_X\).
\end{definition}

\begin{definition}
设\(F\)是映射，
集合\(D \subseteq \dom F\)，
\(C \in \ran F\).
\begin{itemize}
	\item 如果\[
		(\forall x \in D)[F(x) = C],
	\]
	则称“\(F\)在\(D\)上\DefineConcept{恒等于}~\(C\)”，
	记作\(F(x) \equiv C\ (x \in D)\)；
	当\(D=\dom F\)时，
	称“\(F\)~\DefineConcept{恒等于}~\(C\)”，
	记为\(F(x) \equiv C\).
	\item 如果\[
		(\exists x \in D)[F(x) \neq C],
	\]
	则称“\(F\)在\(D\)上\DefineConcept{不恒等于}~\(C\)”，
	记作\(F(x) \not\equiv C\ (x \in D)\)；
	当\(D=\dom F\)时，
	称“\(F\)~\DefineConcept{不恒等于}~\(C\)”，
	记为\(F(x) \not\equiv C\).
	\item 如果\[
		(\forall x \in D)[F(x) \neq C],
	\]
	则称“\(F\)在\(D\)上\DefineConcept{恒不等于}~\(C\)”，
	记作\(F(x) \neq C\ (x \in D)\)；
	当\(D=\dom F\)时，
	称“\(F\)~\DefineConcept{恒不等于}~\(C\)”，
	记为\(F(x) \neq C\).
\end{itemize}
\end{definition}

\begin{example}
%@see: 《Elements of Set Theory》 P52 Exercise 11
设\(F,G\)都是映射，
\(\dom F = \dom G = X\)，且\[
	(\forall x \in X)[F(x) = G(x)].
\]
证明：\(F=G\).
\begin{proof}
显然有
\begin{align*}
	F=G
	&\iff (\forall x \in X)(\exists!y)[
		\opair{x,y} \in F
		\iff
		\opair{x,y} \in G
	] \\
	&\iff (\forall x \in X)(\exists!y)[
		y = F(x) = G(x)
	] \\
	&\iff (\forall x \in X)[F(x) = G(x)].
	\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P52 Exercise 12
设\(f,g\)都是映射.
证明：\[
	f \subseteq g
	\iff
	\dom f \subseteq \dom g
	\land
	(\forall x \in \dom f)
	[f(x) = g(x)].
\]
\begin{proof}
直接有
\begin{align*}
	f \subseteq g
	&\iff (\forall x)(\exists!y)[\opair{x,y} \in f \implies \opair{x,y} \in g] \\
	&\iff (\forall x \in \dom f)[x \in \dom g]\land(\forall x \in \dom f)(\exists!y)[y=f(x)=g(x)] \\
	&\iff [\dom f \subseteq \dom g]\land(\forall x \in \dom f)[f(x)=g(x)].
	\qedhere
\end{align*}
\end{proof}
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 13
设\(f,g\)都是映射，\(f \subseteq g\)且\(\dom g \subseteq \dom f\).
证明：\(f=g\).
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 14
设\(f,g\)都是映射.
证明：
\begin{enumerate}
	\item \(f \cap g\)是映射.
	\item \(f \cup g\)是映射的充分必要条件是\[
		(\forall x \in (\dom f)\cap(\dom g))[f(x)=g(x)].
	\]
\end{enumerate}
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 15
\def\A{\mathscr{A}}%
设\(\A\)是一组映射，且\[
	(\forall f,g\in\A)[f \subseteq g \lor g \subseteq f].
\]
证明：\(\bigcup\A\)也是映射.
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 16
证明：不存在一个集合，使得每个映射都属于它.
%TODO
\end{example}

\begin{example}
%@see: 《实变函数论（第三版）》（周民强） P14 思考题5.
设\(f\colon X \to Y,
g\colon Y \to X\).
证明：若\[
	(\forall x \in X)[g(f(x)) = x],
\]
则\(f\)是单射，\(g\)是满射.
%TODO
\end{example}

\subsection{逆，复合，限制，像，原像}
以下定义的操作通常用在映射上，有时候也用于关系，但也可以用于任意集合.
\begin{definition}\label{definition:映射.逆-复合-限制-像}
设\(A,F,G\)都是集合.
\begin{itemize}
	\item 称集合\[
		\Set*{ \opair{u,v} \given \opair{v,u} \in F }
	\]为“\(F\)的\DefineConcept{逆}%
	（the \emph{inverse} of \(F\)）”，
	记作\(F^{-1}\).

	特别地，如果\(F^{-1}\)是映射，
	则称“\(F^{-1}\)是\(F\)的\DefineConcept{逆映射}”.

	\item 称集合\[
		\Set*{ \opair{u,v} \given (\exists t)[\opair{u,t} \in G \land \opair{t,v} \in F] }
	\]为“\(F\)和\(G\)的\DefineConcept{复合}%
	（the \emph{composition} of \(F\) and \(G\)）”，
	记作\(F \circ G\).

	\item 称集合\[
		\Set*{ \opair{u,v} \given \opair{u,v} \in F \land u \in A }
	\]为“\(F\)在\(A\)上的\DefineConcept{限制}%
	（the \emph{restriction} of \(F\) to \(A\)）”，
	记作\(F \upharpoonright A\).
	%\cref{definition:子空间.拓扑子空间中的集族的限制}

	\item 称集合\[
		\Set*{ v \given (\exists u \in A)[\opair{u,v} \in F] }
	\]为“\(A\)在\(F\)下的\DefineConcept{像}%
	（the \emph{image} of \(A\) \emph{under} \(F\)）”，
	记作\(F\ImageOfSetUnderRelation{A}\).
\end{itemize}
\end{definition}

当\(F\)是一个映射，且\(A \subseteq \dom F\)时，
\(F\ImageOfSetUnderRelation{A}\)这个概念可能更容易理解，
因为这时候\[
	F\ImageOfSetUnderRelation{A}
	= \Set{ F(u) \given u \in A }.
\]

我们可以利用子集公理构造出上述定义下的所需集合的存在性.
特别地，\[
	F^{-1} \subseteq \ran F \times \dom F, \qquad
	F \circ G \subseteq \dom G \times \ran F,
\]\[
	F \upharpoonright A \subseteq F, \qquad
	F\ImageOfSetUnderRelation{A} \subseteq \ran F.
\]

例如，我们可以按如下方法正当化“关系\(F\)的逆”的定义：
根据子集公理，存在集合\(B\)，使得对于任意\(x\)，总有\begin{align*}
	x \in B
	&\iff
	[x \in \ran F \times \dom F]
	\land
	(\exists u)(\exists v)[x = \opair{u,v} \land \opair{v,u} \in F], \\
	&\iff
	(\exists u)(\exists v)[x = \opair{u,v} \land \opair{v,u} \in F].
\end{align*}
再根据外延公理，可以保证集合\(B\)的唯一性.
因此我们可以将集合\(B\)记为\(F^{-1}\).

\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P22 定义1.5.4
设\(A,B,X\)都是集合，\(A \subset B\).
若映射\(F\colon A \to X\)和\(G\colon B \to X\)满足\(F \subset G\)，
则称“\(G\)是\(F\)在\(B\)上的\DefineConcept{扩张}”.
\end{definition}

\begin{theorem}
\(F \upharpoonright \emptyset = \emptyset\).
\end{theorem}

\begin{theorem}
\(F\ImageOfSetUnderRelation{A} = \ran(F \upharpoonright A)\).
\begin{proof}
根据值域的定义有\begin{align*}
	v \in \ran(F \upharpoonright A)
	&\iff
	(\exists u)[\opair{u,v} \in F \upharpoonright A] \\
	&\iff
	(\exists u)[\opair{u,v} \in F \land u \in A] \\
	&\iff
	v \in F\ImageOfSetUnderRelation{A}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

\begin{definition}
设\(F\)是关系，\(A\)是集合，那么称集合\[
	\Set*{ x \in \dom F \given F(x) \in A }
\]为“集合\(A\)在关系\(F\)下的\DefineConcept{原像}%
（the \emph{inverse image} of \(A\) under \(F\)）”，
记作\(F^{-1}\ImageOfSetUnderRelation{A}\).
\end{definition}

一般来说，一个映射的逆不一定是映射.
例如，\(F=\Set{ \opair{1,1},\opair{2,1} }\)是一个映射，
但它的逆\(F^{-1}=\Set{ \opair{1,1},\opair{1,2} }\)不是映射.

\begin{theorem}\label{theorem:集合论.关系的逆的定义域值域以及关系的二重逆}
%@see: 《Elements of Set Theory》 P46 Theorem 3E
设\(F\)是集合，则有\begin{gather}
	\dom F^{-1} = \ran F, \\
	\ran F^{-1} = \dom F.
\end{gather}

如果\(F\)是关系，则有\begin{equation}
	(F^{-1})^{-1} = F.
\end{equation}
\begin{proof}
因为\[
	y \in \dom F^{-1}
	\iff
	(\exists x)[yF^{-1}x]
	\iff
	(\exists x)[xFy]
	\iff
	y \in \ran F,
\]
所以\(\dom F^{-1} = \ran F\).

因为\[
	x \in \ran F^{-1}
	\iff
	(\exists y)[yF^{-1}x]
	\iff
	(\exists y)[xFy]
	\iff
	x \in \dom F,
\]
所以\(\ran F^{-1} = \dom F\).

因为\[
	\opair{x,y} \in (F^{-1})^{-1}
	\iff
	\opair{y,x} \in F^{-1}
	\iff
	\opair{x,y} \in F,
\]
所以\((F^{-1})^{-1} = F\).
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:集合论.关系及其逆是映射的充分必要条件}
%@see: 《Elements of Set Theory》 P46 Theorem 3F
设\(F\)是集合，则“\(F^{-1}\)是映射”的充分必要条件是：\(F\)是单根的.

设\(F\)是关系，则“\(F\)是映射”的充分必要条件是：\(F^{-1}\)是单根的.
\begin{proof}
容易看出\begin{align*}
	\text{\(F^{-1}\)是映射}
	&\iff
	\text{\(F^{-1}\)是单值的} \\
	&\iff
	(\forall x \in \dom F^{-1})(\exists! y)[xF^{-1}y] \\
	&\iff
	(\forall x \in \ran F)(\exists! y)[yFx] \\
	&\iff
	\text{\(F\)是单根的}, \\
	\text{\(F\)是映射}
	&\iff
	\text{\(F\)是单值的} \\
	&\iff
	(\forall x \in \dom F)(\exists! y)[xFy] \\
	&\iff
	(\forall x \in \ran F^{-1})(\exists! y)[yF^{-1}x] \\
	&\iff
	\text{\(F^{-1}\)是单根的}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:集合论.逆映射的计算}
%@see: 《Elements of Set Theory》 P46 Theorem 3G
设\(F\)是单射.
\begin{enumerate}
	\item 如果\(x \in \dom F\)，那么\[
		F^{-1}(F(x)) = x.
	\]

	\item 如果\(y \in \ran F\)，那么\[
		F(F^{-1}(y)) = y.
	\]
\end{enumerate}
\begin{proof}
假设\(x \in \dom F\)，
那么\(\opair{x,F(x)} \in F\)，且\(\opair{F(x),x} \in F^{-1}\)，
于是\(F(x) \in \dom F^{-1}\).
因为\(F\)是单射，是单根的，
所以由\cref{theorem:集合论.关系及其逆是映射的充分必要条件}
可知\(F^{-1}\)是映射，
从而\(x = F^{-1}(F(x))\).

如果\(y \in \ran F\)，
那么根据本定理第1条，以及\((F^{-1})^{-1} = F\)，可知\[
	F(F^{-1}(y)) = (F^{-1})^{-1}(F^{-1}(y)) = y.
	\qedhere
\]
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:集合论.映射的复合也是映射}
%@see: 《Elements of Set Theory》 P47 Theorem 3H
设\(F,G\)都是映射，则\(F \circ G\)是映射，且\[
	\dom(F \circ G)
	= \Set*{ x \in \dom G \given G(x) \in \dom F },
\]\[
	(\forall x \in \dom(F \circ G))
	[(F \circ G)(x) = F(G(x))].
\]
\begin{proof}
要证\(F \circ G\)是一个映射，
假设有\(\opair{x,y} \in F \circ G\)和\(\opair{x,z} \in F \circ G\)同时成立.
那么，\[
	(\exists p)[\opair{x,p} \in G \land \opair{p,y} \in F]
	\quad\text{和}\quad
	(\exists q)[\opair{x,q} \in G \land \opair{q,z} \in F]
\]同时成立.
既然\(G\)是映射，必有\(p = q\).
同理，\(F\)是映射，必有\(y = z\).
因此\(F \circ G\)是映射.

现在再假设\(x \in \dom G\)且\(G(x) \in \dom F\).
我们必须证明\[
	x \in \dom(F \circ G)
	\quad\text{和}\quad
	(F \circ G)(x) = F(G(x)).
\]
我们知道\[
	\opair{x,G(x)} \in G,
	\qquad
	\opair{G(x),F(G(x))} \in F.
\]
因此\(\opair{x,F(G(x))} \in F \circ G\).

反过来说，如果\(x \in \dom(F \circ G)\)，
那么就有\[
	(\exists y)(\exists t)
	[\opair{x,t} \in G \land \opair{t,y} \in F].
\]
于是就有\(x \in \dom G\)和\(t = G(x) \in \dom F\).
\end{proof}
\end{theorem}

容易看出，映射的复合是有顺序的，
\(f \circ g\)有意义并不代表\(g \circ f\)也有意义.
即便两者都有意义，它们也未必相同.

\begin{example}
%@see: 《Elements of Set Theory》 P47 Example
假设\(G\)是单射，
那么，根据\cref{theorem:集合论.映射的复合也是映射}，
\(G^{-1} \circ G\)也是一个映射，
它的定义域为\[
	\Set{ x \in \dom G \given G(x) \in \dom G^{-1} }
	= \dom G,
\]
并且，对于\(\forall x \in \dom(G^{-1} \circ G)\)，
有\begin{align*}
	(G^{-1} \circ G)(x) &= G^{-1}(G(x)) \\
	&= x. \tag{\cref{theorem:集合论.逆映射的计算}}
\end{align*}
因此，\(G^{-1} \circ G\)就是\(I_{\dom G}\)，
\(\dom G\)上的恒等映射.
同理，\(G \circ G^{-1}\)是\(I_{\ran G}\)，
\(\ran G\)上的恒等映射.
\end{example}

\begin{theorem}
%@see: 《Elements of Set Theory》 P65 Exercise 53.
设\(R,S\)是集合，那么\begin{gather}
	(R \cup S)^{-1} = R^{-1} \cup S^{-1},
	\label{equation:集合论.并的逆等于逆的并} \\
	(R \cap S)^{-1} = R^{-1} \cap S^{-1},
	\label{equation:集合论.交的逆等于逆的交} \\
	(R - S)^{-1} = R^{-1} - S^{-1}.
	\label{equation:集合论.差的逆等于逆的差}
\end{gather}
\begin{proof}
对\cref{equation:集合论.并的逆等于逆的并} 证明如下：
\begin{align*}
	\opair{x,y} \in (R \cup S)^{-1}
	&\iff \opair{y,x} \in R \cup S \\
	&\iff \opair{y,x} \in R \lor \opair{y,x} \in S \\
	&\iff \opair{x,y} \in R^{-1} \lor \opair{x,y} \in S^{-1} \\
	&\iff \opair{x,y} \in R^{-1} \cup S^{-1}.
\end{align*}

对\cref{equation:集合论.交的逆等于逆的交} 证明如下：
\begin{align*}
	\opair{x,y} \in (R \cap S)^{-1}
	&\iff \opair{y,x} \in R \cap S \\
	&\iff \opair{y,x} \in R \land \opair{y,x} \in S \\
	&\iff \opair{x,y} \in R^{-1} \land \opair{x,y} \in S^{-1} \\
	&\iff \opair{x,y} \in R^{-1} \cap S^{-1}.
\end{align*}

对\cref{equation:集合论.差的逆等于逆的差} 证明如下：
\begin{align*}
	\opair{x,y} \in (R - S)^{-1}
	&\iff \opair{y,x} \in R - S \\
	&\iff \opair{y,x} \in R \land \opair{y,x} \notin S \\
	&\iff \opair{x,y} \in R^{-1} \land \opair{x,y} \notin S^{-1} \\
	&\iff \opair{x,y} \in R^{-1} - S^{-1}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

\begin{theorem}\label{theorem:集合论.复合的逆}
%@see: 《Elements of Set Theory》 P47 Theorem 3I
设\(F,G\)都是集合，那么\[
	(F \circ G)^{-1} = G^{-1} \circ F^{-1}.
\]
\begin{proof}
易知\((F \circ G)^{-1}\)和\(G^{-1} \circ F^{-1}\)都是关系，且\begin{align*}
	\opair{x,y} \in (F \circ G)^{-1}
	&\iff
	\opair{y,x} \in F \circ G \\
	&\iff
	(\exists t)[\opair{y,t} \in G \land \opair{t,x} \in F] \\
	&\iff
	(\exists t)[\opair{x,t} \in F^{-1} \land \opair{t,y} \in G^{-1}] \\
	&\iff
	\opair{x,y} \in G^{-1} \circ F^{-1}.
	\qedhere
\end{align*}
\end{proof}
\end{theorem}

由\cref{theorem:集合论.复合的逆} 立即可得如下推论.
\begin{proposition}\label{theorem:集合论.复合的逆.推论1}
设\(F\)是集合，那么\[
	(F^{-1} \circ F)^{-1} = F^{-1} \circ F.
\]
\end{proposition}

\begin{axiom}[选择公理(第一种形式)]
%@see: 《Elements of Set Theory》 P49 Axiom of Choice (first form)
对于任意关系\(R\)，存在映射\(H\)，满足\[
	H \subseteq R,
	\quad\text{且}\quad
	\dom H = \dom R.
\]
\end{axiom}

\begin{theorem}
%@see: 《Elements of Set Theory》 P48 Theorem 3J
设映射\(F\colon A \to B\)，其中\(A\)是非空集合.
\begin{enumerate}
	\item “存在映射\(G\colon B \to A\)（称其为\DefineConcept{左逆}），
	使得\(G \circ F\)是\(A\)上的恒等映射\(I_A\)”是“\(F\)是单射”的充分必要条件.

	\item “存在映射\(H\colon B \to A\)（称其为\DefineConcept{右逆}），
	使得\(F \circ H\)是\(B\)上的恒等映射\(I_B\)”是“\(F\)是满射”的充分必要条件.
\end{enumerate}
\begin{proof}
\begin{enumerate}
	\item
	先证充分性.
	我们假设存在映射\(G\)使得\(G \circ F = I_A\).
	如果\(F(x) = F(y)\)，那么\[
		x = G(F(x)) = G(F(y)) = y,
	\]
	于是\(F\)是单射.

	再证必要性.
	假设\(F\)是单射，
	那么根据\cref{theorem:集合论.关系的逆的定义域值域以及关系的二重逆,theorem:集合论.关系及其逆是映射的充分必要条件}，
	\(F^{-1}\)是一个从\(\ran F\)到\(A\)上的映射.
	现在我们需要将\(F^{-1}\)延拓为以\(B\)为定义域的映射\(G\).
	因为\(A\)是非空集合，
	于是我们可以取定\(a \in A\)，
	然后令\[
		G(x) = \left\{ \begin{array}{ll}
			F^{-1}(x), & x \in \ran F, \\
			a, & x \in B - \ran F,
		\end{array} \right.
	\]或者令\[
		G = F^{-1} \cup (B - \ran F) \times \Set{a}.
	\]
	这个构造出来的映射\(G\)是一个从\(B\)到\(A\)里的映射，
	且满足\[
		\dom(G \circ F) = A,
	\]
	以及\[
		(\forall x \in A)[G(F(x)) = F^{-1}(F(x)) = x],
	\]
	于是\(G \circ F = I_A\)成立.

	\item
	我们还是先证充分性.
	假设存在映射\(H\)使得\(F \circ H = I_B\).
	那么\[
		(\forall y \in B)[y = F(H(y))],
	\]
	从而\(y \in \ran F\)，
	于是\(\ran F = B\).

	必要性的证明稍显困难.
	我们不能直接取\(H = F^{-1}\)，
	因为一般而言\(F\)不会是单射，
	\(F^{-1}\)也不会是一个映射.
	假设\(F\)将\(A\)映射到\(B\)上，\(\ran F = B\).
	现在我们需要为每个\(y \in B\)选择某个\(x\)，使得\(F(x) = y\)，然后令\(H(y) = x\)；
	考虑到\(y \in \ran F\)，这样的\(x\)必定存在.
	虽然我们知道对于每个\(y\)，存在一个合适的\(x\)，
	但是我们无法据此构造所求映射\(H\).
	因此，我们需要引入选择公理.
	借助选择公理，我们可以令映射\(H\)满足\(H \subseteq F^{-1}\)且\(\dom H = \dom F^{-1} = B\).
	于是\(H\)满足\[
		(\forall y \in B)
		[
			\opair{y,H(y)} \in F^{-1}
			\iff
			\opair{H(y),y} \in F
			\iff
			F(H(y)) = y
		].
		\qedhere
	\]
\end{enumerate}
\end{proof}
\end{theorem}

\begin{theorem}
%@see: 《Elements of Set Theory》 P48 Theorem 3K
设\(A,B,F\)都是集合.
\def\F#1{F\ImageOfSetUnderRelation{#1}}
\begin{enumerate}
	\item 并的像是像的并：\begin{gather}
		\F{A \cup B}
		= \F{A} \cup \F{B},
		\label{equation:集合论.并的像与像的并的关系1} \\
		\F{\bigcup A}
		= \bigcup\Set{ \F{a} \given a \in A }.
		\label{equation:集合论.并的像与像的并的关系2}
	\end{gather}

	\item 交的像包含于像的交：\begin{gather}
		\F{A \cap B}
		\subseteq \F{A} \cap \F{B},
		\label{equation:集合论.交的像与像的交的关系1} \\
		\F{\bigcap A}
		\subseteq \bigcap\Set{ \F{a} \given a \in A }.
		\label{equation:集合论.交的像与像的交的关系2}
		\quad(A \neq \emptyset)
	\end{gather}
	若\(F\)是单根的，则以上两式取“=”号.

	\item 差的像包含像的差：\begin{equation}
		\F{A} - \F{B}
		\subseteq \F{A-B}.
		\label{equation:集合论.差的像与像的差的关系}
	\end{equation}
	若\(F\)是单根的，则上式取“=”号.
\end{enumerate}
\begin{proof}
\cref{equation:集合论.并的像与像的并的关系1} 证明如下：
\begin{align*}
	y \in \F{A \cup B}
	&\iff (\exists x \in A \cup B)[\opair{x,y} \in F] \\
	&\iff (\exists x \in A)[\opair{x,y} \in F]
			\lor (\exists x \in B)[\opair{x,y} \in F] \\
	&\iff y \in \F{A} \lor y \in \F{B}.
\end{align*}

\cref{equation:集合论.交的像与像的交的关系1} 证明如下：
\begin{align*}
	y \in \F{A \cap B}
	&\iff (\exists x \in A \cap B)[\opair{x,y} \in F] \\
	&\implies (\exists x \in A)[\opair{x,y} \in F]
		\land (\exists x \in B)[\opair{x,y} \in F] \\
	&\iff y \in \F{A} \land y \in \F{B}.
\end{align*}
注意到中间步骤的\(\implies\)不总是可逆的，
这时因为虽然有\[
	(\exists x_1 \in A)[\opair{x_1,y} \in F], \qquad
	(\exists x_2 \in B)[\opair{x_2,y} \in F],
\]
但是可能\[
	(\forall x \in A \cap B)[\opair{x,y} \notin F].
\]
不过，如果\(F\)是单根的，那么必有\(x_1 = x_2 \in A \cap B\)，
这时候中间步骤的\(\implies\)是可逆的，可以改为\(\iff\).

\cref{equation:集合论.并的像与像的并的关系2,equation:集合论.交的像与像的交的关系2} 分别是%
\cref{equation:集合论.并的像与像的并的关系1,equation:集合论.交的像与像的交的关系1} 的简单推广，
故略去证明.

\cref{equation:集合论.差的像与像的差的关系} 证明如下：
\begin{align*}
	y \in \F{A} - \F{B}
	&\iff (\exists x \in A)[\opair{x,y} \in F]
		\land \neg[(\exists t \in B)[\opair{t,y} \in F]] \\
	&\implies (\exists x \in A - B)[\opair{x,y} \in F] \\
	&\iff y \in \F{A - B}.
\end{align*}
若\(F\)是单根的，则\[
	(\exists! x)[\opair{x,y} \in F].
\]
这种情况下，中间步骤的\(\implies\)可以改为\(\iff\).
\end{proof}
\end{theorem}

\begin{corollary}
%@see: 《Elements of Set Theory》 P48 Corollary 3L
设\(G\)是映射，\(A,B\)都是集合.
\def\G#1{G^{-1}\ImageOfSetUnderRelation{#1}}
\begin{gather}
	\G{\bigcup A} = \bigcup\Set*{ \G{a} \given a \in A },
	\label{equation:集合论.并的原像与原像的并的关系} \\
	\G{\bigcap A} = \bigcap\Set*{ \G{a} \given a \in A }, \quad A \neq \emptyset,
	\label{equation:集合论.交的原像与原像的交的关系} \\
	\G{A - B} = \G{A} - \G{B}.
	\label{equation:集合论.差的原像与原像的差的关系}
\end{gather}
\end{corollary}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 22.(a)
\def\F#1{F\ImageOfSetUnderRelation{#1}}
证明：\begin{equation}
	A \subseteq B \implies \F{A} \subseteq \F{B}.
\end{equation}
\begin{proof}
因为\(A \subseteq B\)，所以\(A \cap B = A\)，
那么由\cref{equation:集合论.交的像与像的交的关系1} 可知，\[
	\F{A} = \F{A \cap B} \subseteq \F{A} \cap \F{B} \subseteq \F{B}.
	\qedhere
\]
\end{proof}
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 22.(b)
证明：\begin{equation}
	(F \circ G)\ImageOfSetUnderRelation{A}
	= F\ImageOfSetUnderRelation{G\ImageOfSetUnderRelation{A}}.
\end{equation}
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P53 Exercise 22.(c)
证明：\begin{equation}
	Q \upharpoonright (A \cup B)
	= (Q \upharpoonright A)\cup(Q \upharpoonright B).
\end{equation}
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P65 Exercise 59.
设\(A,B,Q\)是集合.
证明：\begin{gather}
	Q \upharpoonright (A \cap B)
	= (Q \upharpoonright A) \cap (Q \upharpoonright B), \\
	Q \upharpoonright (A - B)
	= (Q \upharpoonright A)
	- (Q \upharpoonright B).
\end{gather}
%TODO
\end{example}

\begin{example}
%@see: 《Elements of Set Theory》 P65 Exercise 60.
设\(A,R,S\)是集合.
证明：\begin{equation}
	(R \circ S) \upharpoonright A = R \circ (S \upharpoonright A).
\end{equation}
%TODO
\end{example}

\begin{proposition}\label{theorem:集合论.与逆相等的充分必要条件}
设\(R\)是集合，
则\(R^{-1} \subseteq R
\iff R^{-1} = R
\iff R \subseteq R^{-1}\).
\begin{proof}
容易看出\begin{align*}
	R^{-1} \subseteq R
	&\iff
	(\forall x)(\forall y)[xR^{-1}y \implies xRy] \\
	&\iff
	(\forall x)(\forall y)[yRx \implies xRy] \\
	&\iff
	(\forall u)(\forall v)[uRv \implies vRu] \\
	&\iff
	(\forall u)(\forall v)[uRv \implies uR^{-1}v] \\
	&\iff
	R \subseteq R^{-1},
\end{align*}
再由\(R^{-1} \subseteq R \land R \subseteq R^{-1}\)
便得\(R = R^{-1}\).
\end{proof}
\end{proposition}

\subsection{有标集族，指标集，子集族}\label{section:集合论.指标集}
%@see: https://math.libretexts.org/Bookshelves/Mathematical_Logic_and_Proof/Book%3A_Mathematical_Reasoning__Writing_and_Proof_(Sundstrom)/05%3A_Set_Theory/5.05%3A_Indexed_Families_of_Sets
\begin{definition}
%@see: 《Elements of Set Theory》 P51
设\(F\)是映射，\(I\)是集合，\(\dom F \supseteq I\).

对于\(\forall i \in I\)，
把\(i\)在映射\(F\)下的像\(F(i)\)记作\(F_i\)，
即\[
	F_i \defeq F(i).
\]

把\(F\)在\(I\)上的限制\(F \upharpoonright I\)
称为“一个以\(I\)为指标集的\DefineConcept{有标集族}（an \emph{indexed family of sets} indexed by \(I\)）”，
记作\(\{F_i\}_{i \in I}\)，
即\[
	\{F_i\}_{i\in I}
	\defeq
	F \upharpoonright I.
\]
把\(I\)的每一个元素称为一个\DefineConcept{指标}（index）.
把\(I\)称为“\(\{F_i\}_{i \in I}\)的\DefineConcept{指标集}（indexing set）”.
\end{definition}

\begin{example}
当我们谈到有标集族\(\{R\}_{i \in I}\)时，
我们指的就是映射\(F = I \times \{R\}\)，
即对于每一个\(i \in I\)都指定同一个集合\(F(i) = R\).
\end{example}

\begin{example}
设\(\mathscr{A}\)是一个集族，
那么恒同映射\(\{A\}_{A \in \mathscr{A}} = \Set{ \opair{A,A} \given A \in \mathscr{A} }\)
就是一个以\(\mathscr{A}\)为指标集的有标集族.
有时候我们会把\(\{A\}_{A \in \mathscr{A}}\)简记为“有标集族\(\mathscr{A}\)”.
\end{example}

\begin{definition}
%@see: 《Elements of Set Theory》 P51
%@see: 《点集拓扑讲义（第四版）》（熊金城） P26 定义1.6.1
设有标集族\(\{F_i\}_{i \in I}\).

定义：\begin{equation}
	\bigcup_{i \in I} F_i
	\defeq
	\bigcup\Set{ F_i \given i \in I },
\end{equation}
把它称为“有标集族\(\{F_i\}_{i \in I}\)的并”.

当指标集\(I\)非空时，定义：
\begin{equation}
	\bigcap_{i \in I} F_i
	\defeq
	\bigcap\Set{ F_i \given i \in I },
\end{equation}
把它称为“有标集族\(\{F_i\}_{i \in I}\)的交”.
\end{definition}
应该注意到：
\(\bigcup_{i \in \emptyset} F_i = \emptyset\)，
而\(\bigcap_{i \in \emptyset} F_i\)没有定义.

\begin{theorem}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P26 定理1.6.1
设\(\{A_i\}_{i \in I}\)和\(\{B_j\}_{j \in J}\)是两个非空有标集族.
如果\[
	\Set{ A_i \given i \in I }
	= \Set{ B_j \given j \in J },
\]
则有\begin{gather}
	\bigcup_{i \in I} A_i = \bigcup_{j \in J} B_j, \\
	\bigcap_{i \in I} A_i = \bigcap_{j \in J} B_j.
\end{gather}
%TODO
\end{theorem}

\begin{theorem}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P27 定理1.6.2
设\(\{A_i\}_{i \in I}\)是一个非空有标集族，
\(B\)是一个集合，
则\begin{itemize}
	\item 对于任意\(i_0 \in I\)，有\[
		\bigcap_{i \in I} A_i \subseteq A_{i_0} \subseteq \bigcup_{i \in I} A_i;
	\]

	\item {\rm\bf 分配律}\begin{gather*}
		B \cap \left( \bigcup_{i \in I} A_i \right)
		= \bigcup_{i \in I} \left( B \cap A_i \right), \\
		B \cup \left( \bigcap_{i \in I} A_i \right)
		= \bigcap_{i \in I} \left( B \cup A_i \right);
	\end{gather*}

	\item {\rm\bf 对偶律}\begin{gather*}
		B - \left( \bigcup_{i \in I} A_i \right)
		= \bigcap_{i \in I} \left( B - A_i \right), \\
		B - \left( \bigcap_{i \in I} A_i \right)
		= \bigcup_{i \in I} \left( B - A_i \right).
	\end{gather*}
\end{itemize}
%TODO
\end{theorem}

\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P28
设\(X\)是一个集合，
\(\{A_i\}_{i \in I}\)是一个有标集族，
且满足\[
	(\forall i \in I)
	[A_i \subseteq X],
\]
则称“\(\{A_i\}_{i \in I}\)是集合\(X\)的一个\DefineConcept{子集族}”.
\end{definition}

\begin{theorem}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P28 定理1.6.3
设\(R\)是集合\(X\)与集合\(Y\)之间的一个关系，
则对于集合\(X\)的任何一个非空子集族\(\{A_i\}_{i \in I}\)，
有\begin{gather*}
	R\left( \bigcup_{i \in I} A_i \right)
	= \bigcup_{i \in I} R(A_i), \\
	R\left( \bigcap_{i \in I} A_i \right)
	\subseteq \bigcap_{i \in I} R(A_i).
\end{gather*}
%TODO
\end{theorem}

\begin{theorem}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P28 定理1.6.4
设\(X\)和\(Y\)是两个集合，映射\(f\colon X \to Y\)，
则对于集合\(Y\)的任何一个非空子集族\(\{B_j\}_{j \in J}\)，
有\begin{gather*}
	f^{-1}\left( \bigcup_{j \in J} B_j \right)
	= \bigcup_{j \in J} f^{-1}(B_j), \\
	f^{-1}\left( \bigcap_{j \in J} B_j \right)
	= \bigcap_{j \in J} f^{-1}(B_j).
\end{gather*}
%TODO
\end{theorem}

\subsection{映射空间}
对于任意给定的集合\(A,X\)，定义：\[
	X^A \defeq \Set{ F \given F\ \text{是从\(A\)到\(X\)的映射} }.
\]
我们把\(X^A\)称为“从\(A\)到\(X\)的\DefineConcept{映射空间}”.

因为\(F\colon A \to X\)必有\(F \subseteq A \times X\)，\(F \in \Powerset(A \times X)\)，
所以我们可以对集合\(\Powerset(A \times X)\)利用子集公理，构造包括全部从\(A\)到\(X\)的映射的集合.

%之所以采取这种表记方式，
%是因为当\(A\)和\(X\)是有限集，且\(\abs{A}=a,\abs{X}=x\)时，
%\(\abs{X^A}=x^a\).

容易看出，对于非空集合\(A\)，总有\(\emptyset^A = \emptyset\)；
这是因为没有哪个映射会同时有非空的定义域和空的值域.
另一方面，对于任意集合\(A\)，总有\(A^\emptyset = \Set{\emptyset}\)；
这是因为“空映射”\(\emptyset\colon \emptyset \to A\)的存在，
空映射是唯一的以空集为定义域的映射.
作为特例，我们还有\(\emptyset^\emptyset=\Set{\emptyset}\).

\subsection{映射的四则运算}
\begin{definition}
设\(F,G\)都是同一个映射空间中的映射，\(k \in \ran F\).
\begin{itemize}
	\item 把\[
		\Set{ \opair{u,kv} \given \opair{u,v} \in F }
	\]称为“\(F\)的\(k\)~\DefineConcept{倍}”，
	记作\(k F\).
	\item 把\[
		\Set{ \opair{u,v+w} \given \opair{u,v} \in F, \opair{u,w} \in G }
	\]称为“\(F\)和\(G\)的\DefineConcept{和}”，
	记作\(F + G\).
	\item 把\[
		\Set{ \opair{u,vw} \given \opair{u,v} \in F, \opair{u,w} \in G }
	\]称为“\(F\)和\(G\)的\DefineConcept{积}”，
	记作\(F G\).
	\item 把\[
		\Set{ \opair{u,v/w} \given \opair{u,v} \in F, \opair{u,w} \in G }
	\]为“\(F\)和\(G\)的\DefineConcept{商}”，
	记作\(F/G\)或\(\frac{F}{G}\).
\end{itemize}
\end{definition}
