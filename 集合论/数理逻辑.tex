\chapter{命题逻辑}
逻辑，是英文单词 logic 的音译.
逻辑学是研究思维形式、思维方法及思维规律尤其是推理的学科.
早在两千多年前，古希腊逻辑学家亚里士多德创立了形式逻辑（formal logic），
详细讨论概念（词项）、判断（命题）和各种形式的推理，
研究逻辑基本规律等内容.

德国数学家、哲学家莱布尼茨首先提出用数学方法研究逻辑，
即建立一套表意符号体系，在符号之间进行形式推理，
由此创立了数理逻辑（mathematical logic）.

现在，除了传统的数理逻辑（内容包括逻辑演算、公理化集合论、模型论、递归论和证明论）以外，
还出现了各种各样的应用逻辑，诸如
多值逻辑、模态逻辑、归纳逻辑、时序逻辑、动态逻辑、模糊逻辑、
非单调逻辑、默认逻辑、数字逻辑、电路逻辑、算法逻辑及程序逻辑等，
这些都与计算机科学密切相关.

%@see: https://www.tutorialspoint.com/discrete_mathematics/rules_of_inference.htm

\section{命题，形式语言}
\subsection{命题的概念}
\DefineConcept{命题}（proposition），
是指对确定的对象进行判断的陈述句.
这可以从两个方面去理解：\begin{enumerate}
	\item 命题必须是一个完整的句子，具有必需的语法结构（起码要有主语、谓语、宾语）；
	\item 命题必须具有真假意义，研究者应该能够判断命题是否符合客观实际或是否合理，
	这就要求命题不能是除了陈述句以外的其他句式（例如疑问句、感叹句）.
\end{enumerate}

下面几句话都是命题：\begin{itemize}
	\item 太阳总从东方升起.
	\item 只有在冬天才下雪.
	\item 水是液体.
	\item 冰是固体.
	\item 辽宁舰是中国的第一艘航空母舰.
	\item 我喜欢智能手机盒平板电脑.
	\item 小李和小王是同学.
	\item 你只有刻苦学习，才能取得好成绩.
	\item 火星上有生物\footnote{
		虽然我们至今尚不知道火星上是否存在生物，
		但我们相信在将来某个时刻一定会知道的，
		因此“火星上有生物.”是一个命题.
	}.
\end{itemize}

“\(x>3\).”不是命题，因为我们无从得知变量\(x\)的取值，进而无法确定其真假.

“立正！”是命令句，它本身没有对错之分，但命令发出后会有终结反应.

“这朵花真漂亮！”是感叹句，
“你要我的手机号码是想给我充话费？”是疑问句，
都没有真假意义.

命题的\DefineConcept{真值}（truth）就是命题的逻辑取值.
经典逻辑值只有两个：\begin{itemize}
	\item 如果命题\(p\)的判断正确，
	那么我们称“命题\(p\)是\DefineConcept{真的}（true）”，
	或称“命题\(p\)是\DefineConcept{真命题}”，
	或称“命题\(p\)的真值为\(1\)”；
	\item 如果命题\(p\)的判断错误，
	那么我们称“命题\(p\)是\DefineConcept{假的}（false）”，
	或称“命题\(p\)是\DefineConcept{假命题}”，
	或称“命题\(p\)的真值为\(0\)\footnote{
		有的书会把真命题的真值记为T，
		把假命题的真值记为F.
		还有的会把真命题的真值记为\(\top\)，
		把假命题的真值记为\(\bot\).
	}”.
\end{itemize}

\subsection{命题逻辑的形式语言}
对于用汉语（或其他人类语言）表述的命题，
我们可能会因为它含糊不清的语义而无法作出真伪判断.
因此，数学家创造了一种独立于人类语言的、专门用于逻辑演绎的语言，
这就是\DefineConcept{形式语言}（formal language）.

形式语言有三个方面可供我们讨论：\begin{enumerate}
	\item 指定形式语言使用的符号集、字母表（即下面即将介绍的命题常量、命题变元）；
	\item 制定一些规则，用以构造语法正确的有限符号串（即命题公式）；
	\item 指明形式语言与自然语言之间所允许的翻译.
\end{enumerate}

我们把用来表示命题真值的符号\(0\)和\(1\)
称为\DefineConcept{逻辑常量}或\DefineConcept{命题常量}.
相对地，把用来表示命题的小写拉丁字母（例如\(p,q,r,\dotsc\)）
称为\DefineConcept{逻辑变量}或\DefineConcept{命题变元}.
命题变元可以代表任意命题.
从取值的角度看，命题变元既可以取\(1\)也可以取\(0\).

\section{逻辑联结词，命题公式，真值表}
对于复杂的命题，我们可以将其看作是由若干个小命题组合而成的.
就像汉语中有“而且”“但是”等连接句子的虚词一样，
命题逻辑也有扮演相同角色的符号，
这就是\DefineConcept{逻辑联结词}（logical connective）.

\DefineConcept{命题公式}（proposition formula）是
由命题常量、命题变元、逻辑联结词、左圆括号、右圆括号构成的有意义的符号串，
本质上是逻辑函数或逻辑表达式，其取值只可能为\(1\)或\(0\)，
其严格定义可以借助递归定义方式给出.
\begin{definition}
%@see: 《离散数学》（邓辉文） P85 定义3-1
命题公式按下列规则生成：\begin{enumerate}[label={(\arabic*)}]
	\item 命题常量、命题变元是命题公式；
	\item 若\(A\)是命题公式，则\((\neg A)\)是命题公式；
	\item 若\(A\)和\(B\)是命题公式，则\((A \circ B)\)是命题公式，
	其中符号\(\circ\)代表某个逻辑联结词；
	\item 有限次应用(1)(2)(3)这三条规则所得到的符号串是命题公式.
\end{enumerate}
\end{definition}

我们可以按命题公式中是否含有逻辑联结词，将命题公式分为两类：\begin{itemize}
	\item \DefineConcept{简单命题}（simple proposition），
	或称\DefineConcept{原子命题}（atom proposition），
	即不含有逻辑联结词的命题公式；
	\item \DefineConcept{复合命题}（compound proposition），
	即由简单命题和逻辑联结词构成的命题公式.
\end{itemize}

\subsection{命题公式的真值表}
给定命题公式\(A\)，对\(A\)中出现的每个命题变元都指定一个真值\(1\)或\(0\)，
就说“对命题公式\(A\)进行了一种\DefineConcept{真值指派}（assignment）”
或者说“对命题公式\(A\)进行了一个\DefineConcept{解释}（interpretation）”，
而在该指派下可以求出命题公式\(A\)的一个真值.
将\(A\)的所有可能的真值指派以及它在每一个真值指派下的取值列成一张表，
就得到命题公式\(A\)的\DefineConcept{真值表}（truth table）.

\subsection{否定联结词}
设\(p\)表示一个命题，
\(\neg p\)是对命题\(p\)的\DefineConcept{否定}（negation），
读作“非\(p\)”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|c|p{1.5cm}|}
		\hline
		\(p\) & \(\neg p\) \\
		\hline
		0 & 1 \\
		1 & 0 \\
		\hline
	\end{tabular}
	\caption{否定联结词的真值表}
\end{table}

\(\neg\)是仅有的一个一元逻辑运算符，
下面讨论的都是二元逻辑运算符.

\subsection{合取联结词}
设\(p,q\)各表示一个命题，
\(p \land q\)是对命题\(p\)与\(q\)的\DefineConcept{合取}（conjunction）.

合取联结词\(\land\)相当于汉语中的
“并且”“与”“和”“以及”“不但……而且……”
“虽然……但是……”“尽管……仍然……”等.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \land q\) \\
		\hline
		0 & 0 & 0 \\
		0 & 1 & 0 \\
		1 & 0 & 0 \\
		1 & 1 & 1 \\
		\hline
	\end{tabular}
	\caption{合取联结词的真值表}
\end{table}

\subsection{析取联结词}
设\(p,q\)各表示一个命题，
\(p \lor q\)是对命题\(p\)与\(q\)的\DefineConcept{析取}（disjunction）.

析取联结词\(\lor\)相当于汉语中的“或”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \lor q\) \\
		\hline
		0 & 0 & 0 \\
		0 & 1 & 1 \\
		1 & 0 & 1 \\
		1 & 1 & 1 \\
		\hline
	\end{tabular}
	\caption{析取联结词的真值表}
\end{table}

\subsection{异或联结词}
设\(p,q\)各表示一个命题，
\(p \lxor q\)是对命题\(p\)与\(q\)的\DefineConcept{异或}（exclusive or）.

为了凸出析取联结词与异或联结词的联系与区别，
我们常把对命题\(p\)与\(q\)的析取\(p \lor q\)
称为对\(p\)与\(q\)的\DefineConcept{可兼或}（inclusive or），
把对\(p\)与\(q\)的异或\(p \lxor q\)
称为对\(p\)与\(q\)的\DefineConcept{不可兼或}.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \lxor q\) \\
		\hline
		0 & 0 & 0 \\
		0 & 1 & 1 \\
		1 & 0 & 1 \\
		1 & 1 & 0 \\
		\hline
	\end{tabular}
	\caption{异或联结词的真值表}
\end{table}

\subsection{条件联结词}
设\(p,q\)各表示一个命题，
\(p \limp q\)读作“\(p\)蕴涵\(q\)”或“\(p\)条件\(q\)”.

我们把\(p\)称为“\(p \limp q\)的\DefineConcept{前件}（antecedent）”
或“\(p \limp q\)的\DefineConcept{条件}（premise）”，
把\(q\)称为“\(p \limp q\)的\DefineConcept{后件}（consequent）”
或“\(p \limp q\)的\DefineConcept{结论}（conclusion）”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \limp q\) \\
		\hline
		0 & 0 & 1 \\
		0 & 1 & 1 \\
		1 & 0 & 0 \\
		1 & 1 & 1 \\
		\hline
	\end{tabular}
	\caption{条件联结词的真值表}
\end{table}

如果已知命题\(p \limp q\)是真命题，
则称“\(p\)是\(q\)的\DefineConcept{充分条件}”，
或称“\(q\)是\(p\)的\DefineConcept{必要条件}”.

如果已知\((p \limp q) \land (q \limp p)\)是真命题，
则称“\(p\)是\(q\)的\DefineConcept{充分必要条件}”，
或称“\(q\)是\(p\)的\DefineConcept{充分必要条件}”.

如果已知\((p \limp q) \land (q \lnimp p)\)是真命题，
则称“\(p\)是\(q\)的\DefineConcept{充分不必要条件}”，
或称“\(q\)是\(p\)的\DefineConcept{必要不充分条件}”.

把\(q \limp p\)称为“\(p \limp q\)的\DefineConcept{逆命题}”.
称“\(q \limp p\)和\(p \limp q\)是\DefineConcept{互逆命题}”.

把\(\neg p \limp \neg q\)称为“\(p \limp q\)的\DefineConcept{否命题}”.
称“\(\neg p \limp \neg q\)和\(p \limp q\)是\DefineConcept{互否命题}”.

把\(\neg q \limp \neg p\)称为“\(p \limp q\)的\DefineConcept{逆否命题}”.
称“\(\neg q \limp \neg p\)和\(p \limp q\) \DefineConcept{互为逆否命题}”.

\begin{figure}[htb]
	\centering
	\tikzstyle{prop} = [rectangle, minimum width=3cm, minimum height=2cm, text centered, draw=black, fill=orange!30]
	\tikzstyle{arrow} = [thick,<->,>=stealth]
	\begin{tikzpicture}[node distance=4cm]
		\node (p11) [prop] {\begin{tblr}{c}
			原命题 \\ \(p \limp q\)
		\end{tblr}};
		\node (p12) [prop, right=6cm of p11] {\begin{tblr}{c}
			逆命题 \\ \(q \limp p\)
		\end{tblr}};
		\node (p21) [prop, below of=p11] {\begin{tblr}{c}
			否命题 \\ \(\neg p \limp \neg q\)
		\end{tblr}};
		\node (p22) [prop, below of=p12] {\begin{tblr}{c}
			逆否命题 \\ \(\neg q \limp \neg p\)
		\end{tblr}};

		\begin{scope}[arrow]
			\draw (p11) -- node[anchor=south]{互逆} (p12);
			\draw (p11) -- node[anchor=east]{互否} (p21);
			\draw (p22) -- node[anchor=north]{互逆} (p21);
			\draw (p22) -- node[anchor=west]{互否} (p12);
			\draw (p11) -- node[sloped,near end,below]{互为逆否} (p22);
			\draw (p12) -- node[sloped,near end,above]{互为逆否} (p21);
		\end{scope}
	\end{tikzpicture}
	\caption{}
\end{figure}

\subsection{等价联结词}
设\(p,q\)各表示一个命题，
\(p \liff q\)读作“\(p\)等价\(q\)”或“\(p\)双条件\(q\)”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \liff q\) \\
		\hline
		0 & 0 & 1 \\
		0 & 1 & 0 \\
		1 & 0 & 0 \\
		1 & 1 & 1 \\
		\hline
	\end{tabular}
	\caption{等价联结词的真值表}
\end{table}

\subsection{与非联结词}
设\(p,q\)各表示一个命题，
\(p \lnand q\)读作“\(p\)与非\(q\)”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \lnand q\) \\
		\hline
		0 & 0 & 1 \\
		0 & 1 & 1 \\
		1 & 0 & 1 \\
		1 & 1 & 0 \\
		\hline
	\end{tabular}
	\caption{与非联结词的真值表}
\end{table}

\subsection{或非联结词}
设\(p,q\)各表示一个命题，
\(p \lnor q\)读作“\(p\)或非\(q\)”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \lnor q\) \\
		\hline
		0 & 0 & 1 \\
		0 & 1 & 0 \\
		1 & 0 & 0 \\
		1 & 1 & 0 \\
		\hline
	\end{tabular}
	\caption{或非联结词的真值表}
\end{table}

\subsection{条件否定联结词}
设\(p,q\)各表示一个命题，
\(p \lnimp q\)读作“\(p\)条件否定\(q\)”.

\begin{table}[ht]
	\centering
	\begin{tabular}{|*{2}{c|}p{2cm}|}
		\hline
		\(p\) & \(q\) & \(p \lnimp q\) \\
		\hline
		0 & 0 & 0 \\
		0 & 1 & 0 \\
		1 & 0 & 1 \\
		1 & 1 & 0 \\
		\hline
	\end{tabular}
	\caption{条件否定联结词的真值表}
\end{table}

\subsection{括号的省略}
我们解读形式语言的顺序和汉语、英语等常见人类语言一致.
除非命题公式有括号，否则我们总是按照从左到右的顺序，分析理解形式语言的含义.

严格按照命题公式的定义，就会出现很多的括号.
一方面，这些括号使得命题公式的结构清晰、含义清除；
而另一方面，括号太多给命题公式的阅读和书写带来不便.
因此，为了简化书写，减少命题公式中括号的数目，特作如下一些可以省略括号的约定：\begin{itemize}
	\item 最外层的括号可以省略；
	\item 9个逻辑联结词运算的优先顺序依次为\footnote{
		有的书上只规定了\(\neg,\land,\lor,\limp,\liff\)这5个逻辑联结词的优先顺序.
	}\[
		\neg, \quad
		\land, \quad
		\lor, \quad
		\lxor, \quad
		\limp, \quad
		\liff, \quad
		\lnand, \quad
		\lnor, \quad
		\lnimp,
	\]
	符合本约定的有些括号可以不写（详见\cref{definition:命题逻辑.逻辑联结词的优先顺序}）；
	\item 同级运算从左至右依次进行.
\end{itemize}

\begin{definition}\label{definition:命题逻辑.逻辑联结词的优先顺序}
设\(\phi,\psi,\eta\)都是命题公式.
定义：\begin{gather}
	\phi
	\defiff
	(\phi), \\
	(\neg\phi\land\psi)
	\defiff
	((\neg\phi)\land\psi), \\
	(\phi\land\neg\psi)
	\defiff
	(\phi\land(\neg\psi)), \\
	(\neg\phi\lor\psi)
	\defiff
	((\neg\phi)\lor\psi), \\
	(\phi\lor\neg\psi)
	\defiff
	(\phi\lor(\neg\psi)), \\
	(\neg\phi\limp\psi)
	\defiff
	((\neg\phi)\limp\psi), \\
	(\phi\limp\neg\psi)
	\defiff
	(\phi\limp(\neg\psi)), \\
	(\neg\phi\liff\psi)
	\defiff
	((\neg\phi)\liff\psi), \\
	(\phi\liff\neg\psi)
	\defiff
	(\phi\liff(\neg\psi)), \\
	(\phi\land\psi\land\eta)
	\defiff
	((\phi\land\psi)\land\eta), \\
	(\phi\land\psi\lor\eta)
	\defiff
	((\phi\land\psi)\lor\eta), \\
	(\phi\lor\psi\lor\eta)
	\defiff
	((\phi\lor\psi)\lor\eta), \\
	(\phi\lor\psi\land\eta)
	\defiff
	(\phi\lor(\psi\land\eta)), \\
	(\phi\land\psi\limp\eta)
	\defiff
	((\phi\land\psi)\limp\eta), \\
	(\phi\limp\psi\limp\eta)
	\defiff
	((\phi\limp\psi)\limp\eta), \\
	(\phi\limp\psi\land\eta)
	\defiff
	(\phi\limp(\psi\land\eta)), \\
	(\phi\land\psi\liff\eta)
	\defiff
	((\phi\land\psi)\liff\eta), \\
	(\phi\liff\psi\liff\eta)
	\defiff
	((\phi\liff\psi)\liff\eta), \\
	(\phi\liff\psi\land\eta)
	\defiff
	(\phi\liff(\psi\land\eta)), \\
	(\phi\lor\psi\limp\eta)
	\defiff
	((\phi\lor\psi)\limp\eta), \\
	(\phi\limp\psi\lor\eta)
	\defiff
	(\phi\limp(\psi\lor\eta)), \\
	(\phi\lor\psi\liff\eta)
	\defiff
	((\phi\lor\psi)\liff\eta), \\
	(\phi\liff\psi\lor\eta)
	\defiff
	(\phi\liff(\psi\lor\eta)), \\
	(\phi\limp\psi\liff\eta)
	\defiff
	((\phi\limp\psi)\liff\eta), \\
	(\phi\liff\psi\limp\eta)
	\defiff
	(\phi\liff(\psi\limp\eta)).
\end{gather}
\end{definition}

% \begin{definition}
% 设\(\phi,\psi\)都是合式公式.
% 定义：
% \((\neg(\phi\limp\psi))
% \defiff
% (\phi\lnimp\psi)\).
% \end{definition}

\begin{example}
\([(\neg p) \lor (q)]\)等同于\([\neg p \lor q]\).
\end{example}

\begin{example}
\([p \limp q \land r \limp s]\)等同于\([(p \limp (q \land r)) \limp s]\).
\end{example}

\subsection{命题公式的类型}
\begin{definition}
%@see: 《离散数学》（邓辉文） P88 定义3-2
在任何指派下均取真的命题公式，
称为\DefineConcept{永真式}或\DefineConcept{重言式}（tautology）.
\end{definition}

\begin{definition}
%@see: 《离散数学》（邓辉文） P88 定义3-2
在任何指派下均取假的命题公式，
称为\DefineConcept{永假式}或\DefineConcept{矛盾式}（contradiction）.
\end{definition}

\begin{definition}
%@see: 《离散数学》（邓辉文） P88 定义3-2
至少有一种指派使其为真的命题公式，
称为\DefineConcept{可满足式}（satisfactable formula）.
\end{definition}

\begin{definition}
%@see: 《离散数学》（邓辉文） P88 定义3-2
至少有一种指派使其为真，同时至少有一种指派使其为假的命题公式，
称为\DefineConcept{中性式}或\DefineConcept{偶然式}（contingency）.
\end{definition}

\begin{example}
命题公式\(\neg p \lor q \limp r\)是中性式.
\end{example}

\begin{example}
命题公式\(p \lor \neg p\)是永真式.
\end{example}

\begin{example}
命题公式\(p \land \neg p\)是永假式.
\end{example}

\begin{example}
%@see: 《离散数学》（邓辉文） P89 例3-9
证明：命题公式\((p \limp q) \liff (\neg p \lor q)\)是永真式.
\begin{proof}
列出\((p \limp q) \liff (\neg p \lor q)\)的真值表：\begin{center}
	\begin{tblr}{*2c|*3c|c}
		\hline
		\(p\) & \(q\) & \(p \limp q\) & \(\neg p\) & \(\neg p \lor q\) & \((p \limp q) \liff (\neg p \lor q)\) \\
		\hline
		1 & 1 & 1 & 0 & 1 & 1 \\
		1 & 0 & 0 & 0 & 0 & 1 \\
		0 & 1 & 1 & 1 & 1 & 1 \\
		0 & 0 & 1 & 1 & 1 & 1 \\
		\hline
	\end{tblr}
\end{center}
由真值表可知，命题公式\((p \limp q) \liff (\neg p \lor q)\)是永真式.
\end{proof}
\end{example}
\begin{remark}
像这样，通过绘制真值表，得出一个命题公式的类型的方法，称为\emph{真值表法}.
真值表法是最常用的判断命题公式类型的方法，
但是话说回来，当命题变元较多时，真值表法是极为不方便的.
\end{remark}

\begin{example}
%@see: 《离散数学》（邓辉文） P89 例3-10
证明：命题公式\((p \land (p \limp q)) \limp q\)是永真式.
\begin{proof}
假设\(p \land (p \limp q)\)取真，
则\(p\)及\(p \limp q\)均取真，
进而\(q\)为真，
因此\((p \land (p \limp q)) \limp q\)永真.
\end{proof}
\end{example}
\begin{remark}
像这样，利用对取值进行分析，得出一个命题公式的类型的方法，称为\emph{取值法}.
\end{remark}

\begin{example}
证明：命题公式\(p \limp p\)是永真式.
% 同一律
\begin{proof}
列出\(p \limp p\)的真值表：\begin{center}
	\begin{tblr}{c|c}
		\hline
		\(p\) & \(p \limp p\) \\
		\hline
		1 & 1 \\
		0 & 1 \\
		\hline
	\end{tblr}
\end{center}
由真值表可知，命题公式\(p \limp p\)是永真式.
\end{proof}
\end{example}

\begin{example}
证明：命题公式\(p \limp (q \limp p)\)是永真式.
% 肯定后件律
\begin{proof}
列出\(p \limp (q \limp p)\)的真值表：\begin{center}
	\begin{tblr}{*2c|c|c}
		\hline
		\(p\) & \(q\) & \(q \limp p\) & \(p \limp (q \limp p)\) \\
		\hline
		1 & 1 & 1 & 1 \\
		1 & 0 & 1 & 1 \\
		0 & 1 & 0 & 1 \\
		0 & 0 & 1 & 1 \\
		\hline
	\end{tblr}
\end{center}
由真值表可知，命题公式\(p \limp (q \limp p)\)是永真式.
\end{proof}
\end{example}

下面介绍\DefineConcept{永真式代入定理}（Rule of Substitution，简称RS）.
\begin{theorem}
%@see: 《离散数学》（邓辉文） P89 定理3-1
设命题公式\(A(\AutoTuple{p}{n})\)是永真式，
则分别用命题公式\(\AutoTuple{B}{n}\)代换命题变元\(\AutoTuple{p}{n}\)，
所得到的命题公式\(A(\AutoTuple{B}{n})\)也是永真式.
%TODO proof
\end{theorem}
% \DefineConcept{代入实例}（substitution instance）

\section{逻辑等值的命题公式}
\subsection{逻辑等值的定义}
\begin{definition}
%@see: 《离散数学》（邓辉文） P90 定义3-3
给定两个命题公式\(A\)和\(B\)，
如果在任何真值指派下，\(A\)和\(B\)的真值都相同，
则称“命题公式\(A\)和\(B\) \DefineConcept{逻辑等值}（logically equal）”
或“命题公式\(A\)和\(B\) \DefineConcept{逻辑等价}（logically equivalent）”，
记为\(A = B\).
\end{definition}
\begin{remark}
注意不要混淆“逻辑等价”与“等价联结词”这两个概念.
\end{remark}
\begin{theorem}
设\(A\)和\(B\)是命题公式，
则\(A = B\)的充分必要条件是\(A \liff B\)是永真式.
%TODO proof
\end{theorem}

\begin{example}
证明：对于任意命题公式\(A,B\)，
有\begin{equation}\label{equation:数理逻辑.蕴含式化为析取式}
	A \limp B = \neg A \lor B.
\end{equation}
\begin{proof}
列出真值表：\begin{center}
	\begin{tblr}{*5{|c}|}
		\hline
		\(p\) & \(q\) & \(p \limp q\) & \(\neg p\) & \(\neg p \lor q\) \\
		\hline
		0 & 0 & 1 & 1 & 1 \\
		0 & 1 & 1 & 1 & 1 \\
		1 & 0 & 0 & 0 & 0 \\
		1 & 1 & 1 & 0 & 1 \\
		\hline
	\end{tblr}
\end{center}
显然有\(A \limp B = \neg A \lor B\).
\end{proof}
\end{example}

\begin{theorem}
对于任意命题公式\(A,B,C\)，有\begin{itemize}
	\item {\rm\bf 自反性}：\(A = A\).
	\item {\rm\bf 对称性}：若\(A = B\)，则\(B = A\).
	\item {\rm\bf 传递性}：若\(A = B\)且\(B = C\)，则\(A = C\).
\end{itemize}
%TODO proof
\end{theorem}

\begin{theorem}[基本等值式]
对于任意命题公式\(A,B,C\)，有\begin{itemize}
	\item {\rm\bf 对合律}：\(\neg\neg A = A\).
	\item {\rm\bf 幂等律}（或称{\rm\bf 重叠律}）：\begin{itemize}
		\item \(A \lor A = A\)
		\item \(A \land A = A\)
	\end{itemize}
	\item {\rm\bf 交换律}：\begin{itemize}
		\item \(A \lor B = B \lor A\)
		\item \(A \land B = B \land A\)
	\end{itemize}
	\item {\rm\bf 结合律}：\begin{itemize}
		\item \((A \lor B) \lor C = A \lor (B \lor C)\)
		\item \((A \land B) \land C = A \land (B \land C)\)
	\end{itemize}
	\item {\rm\bf 吸收律}：\begin{itemize}
		\item \(A \lor (A \land B) = A\)
		\item \(A \land (A \lor B) = A\)
	\end{itemize}
	\item {\rm\bf 分配律}：\begin{itemize}
		\item \(A \lor (B \land C) = (A \lor B) \land (A \lor C)\)
		\item \(A \land (B \lor C) = (A \land B) \lor (A \land C)\)
	\end{itemize}
	\item {\rm\bf 互补律}：\begin{itemize}
		\item \(A \lor \neg A = 1\)
		\item \(A \land \neg A = 0\)
	\end{itemize}
	\item {\rm\bf De Morgan 律}：\begin{itemize}
		\item \(\neg(A \lor B) = \neg A \land \neg B\).
		\item \(\neg(A \land B) = \neg A \lor \neg B\).
	\end{itemize}
	\item {\rm\bf 同一律}：\begin{itemize}
		\item \(A \lor 0 = 0 \lor A = A\)
		\item \(A \land 1 = 1 \land A = A\)
	\end{itemize}
	\item {\rm\bf 0-1 律}：\begin{itemize}
		\item \(A \lor 1 = 1 \lor A = 1\)
		\item \(A \land 0 = 0 \land A = 0\)
	\end{itemize}
\end{itemize}
\end{theorem}
\begin{remark}
基本等值式可以用于：\begin{itemize}
	\item 化简命题公式；
	\item 判断命题公式的类型；
	\item 证明等值式；
	\item 计算命题公式的范式；
	\item 命题逻辑推理.
\end{itemize}
\end{remark}

对于任意命题公式\(A,B\)，有\begin{itemize}
	\item \(A \lxor B
	= \neg(A \liff B)
	= (A \land \neg B) \lor (\neg A \land B)\).
	\item \(A \limp B
	= \neg A \lor B\).
	\item \(A \liff B
	= (A \limp B) \land (B \limp A)\).
	\item \(A \lnand B
	= \neg(A \land B)\).
	\item \(A \lnor B
	= \neg(A \lor B)\).
	\item \(A \notimplies B
	= \neg(A \limp B)\).
\end{itemize}

\begin{theorem}[等值置换定理]
设\(C\)是命题公式\(A\)的子公式，且\(C = D\)，
则将\(A\)中的\(C\)部分或全部替换成\(D\)所得到的命题公式与\(A\)等值.
%TODO proof
\end{theorem}

\subsection{对偶原理}
\begin{definition}
设命题公式\(A\)中至多含有3个逻辑联结词\(\neg,\land,\lor\).
将\(A\)中\(\land\)换成\(\lor\)，\(\lor\)换成\(\land\)，\(1\)换成\(0\)，\(0\)换成\(1\)，
所得到的命题公式称为“\(A\)的\DefineConcept{对偶式}（dual formula）”，记为\(A^*\).
\end{definition}

\begin{theorem}[对偶原理]
设\(A\)和\(B\)是命题公式.
若\(A = B\)，则\(A^* = B^*\).
\end{theorem}

\section{命题公式的范式}
%@see: https://www.geeksforgeeks.org/normal-and-principle-forms/
%@see: https://library.fiveable.me/key-terms/formal-logic-ii/conjunctive-normal-form
给定一个命题公式，根据它的真值表，显然可以方便地得出它在每一种指派下的真值.
但是随着命题变元个数\(N\)的增加，命题公式的真值指派就有\(2^N\)种，在实际计算中就变成不可行的了.

\begin{definition}
设\(A\)是命题公式.
若\[
	A = A_1 \lor A_2 \lor \dotsb \lor A_n
	\quad(n\geq1),
\]
其中\(A_i\ (i=1,2,\dotsc,n)\)是由命题变元或其否定组成的合取式，
则称“\(A_1 \lor A_2 \lor \dotsb \lor A_n\)是
\(A\)的\DefineConcept{析取范式}（disjunctive normal form）”.
\end{definition}

\begin{definition}
设\(A\)是命题公式.
若\[
	A = A_1 \land A_2 \land \dotsb \land A_n
	\quad(n\geq1),
\]
其中\(A_i\ (i=1,2,\dotsc,n)\)是由命题变元或其否定组成的析取式，
则称“\(A_1 \land A_2 \land \dotsb \land A_n\)是
\(A\)的\DefineConcept{合取范式}（conjunctive normal form）”.
\end{definition}

可以证明：任意一个命题公式都存在析取范式与合取范式.

计算析取范式、合取范式的步骤：\begin{enumerate}
	\item 使用等值式，将命题公式中的联结词归约为\(\neg,\land,\lor\)；
	\item 利用 De Morgan 律，将\(\neg\)移到命题变元的前面；
	\item 根据分配律，得到命题公式的析取范式、合取范式.
\end{enumerate}

\begin{example}
设\(p,q,r\)都是命题变元.
求命题公式\(A = p \limp q \liff r\)的析取范式、合取范式.
\begin{solution}
由等值式得\begin{align*}
	A &= p \limp q \liff r \\
	&= (\neg p \lor q \limp r) \land (r \limp \neg p \lor q) \\
	&= (\neg(\neg p \lor q) \lor r) \land (\neg r \lor (\neg p \lor q)) \\
	&= (p \land \neg q \lor r) \land (\neg p \lor q \lor \neg r).
\end{align*}
于是\(A\)的析取范式为\begin{align*}
	A &= (p \land \neg q \lor r) \land (\neg p \lor q \lor \neg r) \\
	% 分配律
	&= (p \land \neg q) \land (\neg p \lor q \lor \neg r)
		\lor r \land (\neg p \lor q \lor \neg r) \\
	% 分配律
	&= (p \land \neg q) \land \neg p
		\lor (p \land \neg q) \land q
		\lor (p \land \neg q) \land \neg r
		\lor r \land \neg p
		\lor r \land q
		\lor r \land \neg r \\
	% 吸收律，消去\(p \land \neg p\)、\(q \land \neg q\)和\(r \land \neg r\)
	&= p \land \neg q \land \neg r
		\lor \neg p \land r
		\lor q \land r,
\end{align*}
\(A\)的合取范式为\begin{align*}
	A &= (p \land \neg q \lor r) \land (\neg p \lor q \lor \neg r) \\
	% 分配律
	&= (p \lor r) \land (\neg q \lor r) \land (\neg p \lor q \lor \neg r).
\end{align*}
\end{solution}
\end{example}

根据命题公式的析取范式、合取范式，可以分别得出该命题公式的成真指派、成假指派.
例如，已知\(A\)的析取范式是
\(A = p \land \neg q \land \neg r
\lor \neg p \land r
\lor q \land r\)，
若要\(A\)取\(1\)，
则\[
	p \land \neg q \land \neg r,
	\qquad
	\neg p \land r
	\qquad
	q \land r
\]至少一个为\(1\)，
由\(p \land \neg q \land \neg r = 1\)得\((p,q,r) = (1,0,0)\)，
由\(\neg p \land r = 1\)得\((p,q,r) = (0,1,1),(0,0,1)\)，
由\(q \land r = 1\)得\((p,q,r) = (1,1,1),(0,1,1)\)，
于是，\(A\)的成真指派有\[
	(1,0,0),
	(0,1,1),
	(0,0,1),
	(1,1,1).
\]
同样地，由\(A\)的合取范式
\(A = (p \lor r) \land (\neg q \lor r) \land (\neg p \lor q \lor \neg r)\)可知，
\(A\)的成假指派有\[
	(1,0,1),
	(1,1,0),
	(0,1,0),
	(0,0,0).
\]

一般来说，一个命题公式的析取范式、合取范式都不是唯一的.
例如，假设\(A = p\)，
那么\((p \land q) \lor (p \land \neg q)\)和\(p\)都是\(A\)的析取范式.
这种不唯一性给有些问题的讨论带来不便.
下面根据命题公式的所有命题变元，讨论给定命题公式的唯一的标准形式：
\DefineConcept{主析取范式}和\DefineConcept{主合取范式}.

\begin{definition}
对于给定的命题变元，若由命题变元或其否定组成的合取式满足\begin{itemize}
	\item 每个命题变元或其否定两者之一只出现一次，
	\item 按字典顺序或按下标从小到大顺序出现，
\end{itemize}
则称该合取式为“由所给命题变元产生的\DefineConcept{极小项}（minimal term）”.
\end{definition}

可以证明：对于每一个极小项，只有一种指派使其取\(1\).

根据这个结论，我们可以对极小项编码：
极小项用\(m_i\)表示，
其中下标\(i\)是由成真指派得到的二进制数或对应的十进制数.

\begin{table}[ht]
	\centering
	\begin{tblr}{c|c|c}
		\hline
		极小项 & 成真指派 & 极小项的符号表示\(m_i\) \\
		\hline
		\(p \land q\) & 11 & \(m_{11} = m_3\) \\
		\(p \land \neg q\) & 10 & \(m_{10} = m_2\) \\
		\(\neg p \land q\) & 01 & \(m_{01} = m_1\) \\
		\(\neg p \land \neg q\) & 00 & \(m_{00} = m_0\) \\
		\hline
	\end{tblr}
	\caption{由2个命题变元\(p,q\)产生的极小项及其成真指派、符号表示}
\end{table}

\begin{table}[ht]
	\centering
	\begin{tblr}{c|c|c}
		\hline
		极小项 & 成真指派 & 极小项的符号表示\(m_i\) \\
		\hline
		\(p \land q \land r\) & 111 & \(m_{111} = m_7\) \\
		\(p \land q \land \neg r\) & 110 & \(m_{110} = m_6\) \\
		\(p \land \neg q \land r\) & 101 & \(m_{101} = m_5\) \\
		\(p \land \neg q \land \neg r\) & 100 & \(m_{100} = m_4\) \\
		\(\neg p \land q \land r\) & 011 & \(m_{011} = m_3\) \\
		\(\neg p \land q \land \neg r\) & 010 & \(m_{010} = m_2\) \\
		\(\neg p \land \neg q \land r\) & 001 & \(m_{001} = m_1\) \\
		\(\neg p \land \neg q \land \neg r\) & 000 & \(m_{000} = m_0\) \\
		\hline
	\end{tblr}
	\caption{由3个命题变元\(p,q,r\)产生的极小项及其成真指派、符号表示}
\end{table}

\begin{definition}
对于命题公式\(A\)，
若由\(A\)中所有命题变元产生的若干个极小项的析取等值于\(A\)，
则把该析取式称为“\(A\)的\DefineConcept{主析取范式}（major disjunctive form）”.
\end{definition}
\begin{remark}
对于命题公式\(A = A(p_1,p_2,\dotsc,p_n)\)，
它的所有极小项的析取是永真式\(1\)，
它的0个极小项的析取是永假式\(0\)，
在这两种极端情况下\(A\)的主析取范式均不存在.
除了上述两种情况外，\(A\)均为中性式.
\end{remark}

%@see: 《离散数学》（邓辉文） P99
利用\emph{等值演算法}，求命题公式\(A\)的主析取范式的计算步骤：\begin{enumerate}
	\item 求出\(A\)的析取范式；
	\item 利用分配律，补充析取范式缺少的命题变元.
\end{enumerate}

%@see: 《离散数学》（邓辉文） P100
利用\emph{真值表法}，求命题公式\(A\)的主析取范式的计算步骤：\begin{enumerate}
	\item 写出命题公式\(A\)的真值表；
	\item 写出\(A\)的成真指派对应的极小项，使得该极小项在该指派下也为\(1\)；
	\item \(A\)等值于所有这样写出的极小项的析取.
\end{enumerate}

\begin{definition}
对于给定的命题变元，若由命题变元或其否定组成的析取式满足\begin{itemize}
	\item 每个命题变元或其否定两者之一只出现一次，
	\item 按字典顺序或按下标从小到大顺序出现，
\end{itemize}
则称该析取式为“由所给命题变元产生的\DefineConcept{极大项}（maximal term）”.
\end{definition}

可以证明：对于每一个极大项，只有一种指派使其取\(0\).

根据这个结论，我们可以对极大项编码：
极大项用\(M_i\)表示，
其中下标\(i\)是由成假指派得到的二进制数或对应的十进制数.

\begin{table}[ht]
	\centering
	\begin{tblr}{c|c|c}
		\hline
		极大项 & 成假指派 & 极大项的符号表示\(M_i\) \\
		\hline
		\(p \lor q\) & 00 & \(M_{00} = M_0\) \\
		\(p \lor \neg q\) & 01 & \(M_{01} = M_1\) \\
		\(\neg p \lor q\) & 10 & \(M_{10} = M_2\) \\
		\(\neg p \lor \neg q\) & 11 & \(M_{11} = M_3\) \\
		\hline
	\end{tblr}
	\caption{由2个命题变元\(p,q\)产生的极大项及其成假指派、符号表示}
\end{table}

\begin{table}[ht]
	\centering
	\begin{tblr}{c|c|c}
		\hline
		极大项 & 成假指派 & 极大项的符号表示\(M_i\) \\
		\hline
		\(p \lor q \lor r\) & 000 & \(M_{000} = M_0\) \\
		\(p \lor q \lor \neg r\) & 001 & \(M_{001} = M_1\) \\
		\(p \lor \neg q \lor r\) & 010 & \(M_{010} = M_2\) \\
		\(p \lor \neg q \lor \neg r\) & 011 & \(M_{011} = M_3\) \\
		\(\neg p \lor q \lor r\) & 100 & \(M_{100} = M_4\) \\
		\(\neg p \lor q \lor \neg r\) & 101 & \(M_{101} = M_5\) \\
		\(\neg p \lor \neg q \lor r\) & 110 & \(M_{110} = M_6\) \\
		\(\neg p \lor \neg q \lor \neg r\) & 111 & \(M_{111} = M_7\) \\
		\hline
	\end{tblr}
	\caption{由3个命题变元\(p,q,r\)产生的极大项及其成假指派、符号表示}
\end{table}

\begin{definition}
对于命题公式\(A\)，
若由\(A\)中所有命题变元产生的若干个极大项的合取等值于\(A\)，
则把该合取式称为“\(A\)的\DefineConcept{主合取范式}（major conjunctive form）”.
\end{definition}

%@see: 《离散数学》（邓辉文） P102
利用\emph{等值演算法}，求命题公式\(A\)的主合取范式的计算步骤：\begin{enumerate}
	\item 求出\(A\)的合取范式；
	\item 利用分配律，补充合取范式缺少的命题变元.
\end{enumerate}

%@see: 《离散数学》（邓辉文） P102
利用\emph{真值表法}，求命题公式\(A\)的主合取范式的计算步骤：\begin{enumerate}
	\item 写出命题公式\(A\)的真值表；
	\item 写出\(A\)的成假指派对应的极大项，使得该极大项在该指派下也为\(0\)；
	\item \(A\)等值于所有这样写出的极大项的合取.
\end{enumerate}

\begin{example}
设命题公式\(A\)的真值表如下所示，求\(A\)的主析取范式与主合取范式.
\begin{center}
	\begin{tblr}{*4c|*4c}
		\hline
		\(p\) & \(q\) & \(r\) & \(A\) & \(p\) & \(q\) & \(r\) & \(A\) \\
		\hline
		1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 \\
		1 & 1 & 0 & 0 & 0 & 1 & 0 & 0 \\
		1 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
		1 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\
		\hline
	\end{tblr}
\end{center}
\begin{solution}
\(A\)等值于\(A\)的成真指派对应的极小项的析取：\[
	A = (p \land q \land r)
		\lor (p \land \neg q \land \neg r)
		\lor (\neg p \land \neg q \land \neg r).
\]

\(A\)等值于\(A\)的成假指派对应的极大项的合取：\[
	A = (\neg p \lor \neg q \lor r)
		\land (\neg p \lor q \lor \neg r)
		\land (p \lor \neg q \lor \neg r)
		\land (p \lor \neg q \lor r)
		\land (p \lor q \lor \neg r).
\]
\end{solution}
\end{example}
\begin{remark}
在电路实现逻辑运算时，通常选用项数较少的分解式.
在上例中，主析取范式的极小项个数为3，主合取范式的极大项个数为5，
因此最好选用主析取范式.
\end{remark}

\begin{theorem}
%@see: 《离散数学》（邓辉文） P102 定理3-9
任意非永假命题公式都存在唯一的主析取范式.
任意非永真命题公式都存在唯一的主合取范式.
%TODO proof
\end{theorem}

\section{联结词汇集的功能完备性}
\begin{definition}
%@see: 《离散数学》（邓辉文） P106 定义3-11
设\(S\)是由联结词组成的汇集.
若任意命题公式都可由\(S\)中的联结词等值地表示出来，
则称“\(S\)是一个\DefineConcept{功能完备联结词集}（complete group of connectives）”.
\end{definition}

\begin{theorem}\label{theorem:数理逻辑.功能完备联结词集1}
%@see: 《离散数学》（邓辉文） P106 定理3-10
\(\{\neg,\land,\lor\}\)是功能完备联结词集.
\end{theorem}
\begin{corollary}
\(\{\lnor\}\)是功能完备联结词集.
\end{corollary}
\begin{corollary}
\(\{\lnand\}\)是功能完备联结词集.
\begin{proof}
因为\begin{align*}
	\neg p
	&= \neg(p \land p)
	= p \lnand p, \\
	p \land q
	&= \neg(\neg(p \land q))
	= \neg(p \lnand q)
	= (p \lnand q) \lnand (p \lnand q), \\
	p \lor q
	&= \neg(\neg p \land \neg q)
	= (\neg p) \lnand (\neg q)
	= (p \lnand p) \lnand (q \lnand q),
\end{align*}
也就是说\(\neg p\)、\(p \land q\)、\(p \lor q\)
可以由仅含\(\lnand\)的命题公式等值表示，
那么根据\cref{theorem:数理逻辑.功能完备联结词集1} 可知，
\(\{\lnand\}\)是功能完备联结词集.
\end{proof}
\end{corollary}
\begin{corollary}
\(\{\neg,\land\}\)是功能完备联结词集.
\end{corollary}
\begin{corollary}\label{theorem:数理逻辑.功能完备联结词集5}
\(\{\neg,\lor\}\)是功能完备联结词集.
\begin{proof}
因为\begin{align*}
	p \land q
	&= \neg(\neg p \lor \neg q),
\end{align*}
也就是说\(p \land q\)可由仅含\(\{\neg,\lor\}\)的命题公式等值表示，
那么根据\cref{theorem:数理逻辑.功能完备联结词集1} 可知，
\(\{\neg,\lor\}\)是功能完备联结词集.
\end{proof}
\end{corollary}
\begin{corollary}
\(\{\neg,\limp\}\)是功能完备联结词集.
\end{corollary}

\begin{example}
%@see: 《离散数学》（邓辉文） P106 例3-26
定义3元联结词\(f\)：\begin{center}
	\begin{tblr}{*4c|*4c}
		\hline
		\(p\) & \(q\) & \(r\) & \(f(p,q,r)\) & \(p\) & \(q\) & \(r\) & \(f(p,q,r)\) \\
		\hline
		1 & 1 & 1 & 0 & 0 & 1 & 1 & 0 \\
		1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 \\
		1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 \\
		1 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\
		\hline
	\end{tblr}
\end{center}
证明：\(\{f\}\)是功能完备联结词集.
\begin{proof}
由\(f\)的真值表可知\(f(p,q,r)\)的主合取范式为\[
	f(p,q,r)
	= (\neg p \lor \neg q \lor \neg r)
	\land (p \lor \neg q \lor \neg r)
	\land (p \lor \neg q \lor r).
\]
于是有\[
	f(p,p,p) = \neg p,
	\qquad
	f(\neg p,\neg p,\neg q) = p \lor q.
\]
因此由\cref{theorem:数理逻辑.功能完备联结词集5} 可知，
\(\{f\}\)是功能完备联结词集.
\end{proof}
\end{example}

\begin{example}
%@see: 《离散数学》（邓辉文） P107 例3-28
证明：\(\{\land,\limp\}\)不是功能完备联结词集.
\begin{proof}
对于只含有联结词\(\{\land,\limp\}\)的任意命题公式\(A\)，
在所有命题变元均取\(1\)时，\(A\)的真值为\(1\).

对\(A\)中所含的联结词个数\(n\)使用第二数学归纳法.
当\(n=0\)时，显然成立.
假设\(n = k\)时成立，当\(A\)含\(k+1\)个联结词时，
\(A = B \land C\)或\(A = B \limp C\)，
由归纳假设可知，在所有命题变元均取\(1\)时，\(B\)和\(C\)的真值为\(1\)，进而\(A\)的真值为\(1\).

对于命题变元\(p\)，
由上述讨论可知\(p \land \neg p\)不能用仅含联结词\(\{\land,\limp\}\)的命题公式等值表示，
故\(\{\land,\limp\}\)不是功能完备联结词集.
\end{proof}
\end{example}

\begin{definition}
%@see: 《离散数学》（邓辉文） P107 定义3-12
设\(S\)是功能完备联结词集，
如果\(S\)的任意非空真子集都不是功能完备联结词集，
则称“\(S\)是\DefineConcept{极小功能完备联结词集}”.
\end{definition}

\begin{theorem}
%@see: 《离散数学》（邓辉文） P107 定理3-11
下列联结词集是极小功能完备的：\begin{itemize}
	\item \(\{\lnor\}\)；
	\item \(\{\lnand\}\)；
	\item \(\{\neg,\land\}\)；
	\item \(\{\neg,\lor\}\)；
	\item \(\{\neg,\limp\}\).
\end{itemize}
\end{theorem}
