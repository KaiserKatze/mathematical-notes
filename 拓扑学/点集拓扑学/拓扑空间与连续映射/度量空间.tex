\section{度量空间}
根据\cref{definition:极限.函数在一点的连续性} 我们知道，
“函数\(f\colon\mathbb{R}\to\mathbb{R}\)在点\(x_0\in\mathbb{R}\)连续”
当且仅当\begin{equation*}
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x\in\mathbb{R})
	[
		\abs{x - x_0}<\delta
		\implies
		\abs{f(x) - f(x_0)} < \epsilon
	].
\end{equation*}
在这个定义中只涉及两个实数之间的距离（即两个实数之差的绝对值）这个概念.
为了验证一个函数在某点处的连续性往往只要用到关于上述距离的最基本的性质，而与实数的其他性质无关.
关于多元函数的连续性情形也完全类似.
在此之前，我们一直是依靠几何直觉理解“距离”的概念，从现在开始，我们要抽象出度量和度量空间的概念.

\subsection{度量与度量空间的概念}
\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\(X\)是一个集合，映射\(\rho\colon X \times X \to \mathbb{R}\).
如果对于\(\forall x,y \in X\)，
有\(\rho(x,y) \geq 0\)和\(\rho(x,y) = 0 \iff x = y\)，
则称“映射\(\rho\)具有\DefineConcept{正定性}”.
\end{definition}
\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\(X\)是一个集合，映射\(\rho\colon X \times X \to \mathbb{R}\).
如果对于\(\forall x,y \in X\)，
有\(\rho(x,y) = \rho(y,x)\)，
则称“映射\(\rho\)具有\DefineConcept{对称性}”.
\end{definition}
\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\(X\)是一个集合，映射\(\rho\colon X \times X \to \mathbb{R}\).
如果对于\(\forall x,y,z \in X\)，
有\(\rho(x,z) \leq \rho(x,y) + \rho(y,z)\)，
则称“映射\(\rho\)满足\DefineConcept{三角不等式}”.
\end{definition}
\begin{definition}
%@see: 《数学分析（第7版 第二卷）》（卓里奇） P1 定义1
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\(X\)是一个集合.
如果映射\(\rho\colon X \times X\to\mathbb{R}\)具有正定性、对称性，满足三角不等式，
那么称“映射\(\rho\)是集合\(X\)的一个\DefineConcept{度量}（metric）”.
\end{definition}
\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\(\rho\)是集合\(X\)的一个度量，
则称“\((X,\rho)\)是一个\DefineConcept{度量空间}（metric space）”
或“集合\(X\)是一个{对于度量\(\rho\)而言的度量空间}”.
如果前文已经说明了度量\(\rho\)，省略它不至于引起混淆，那么可以简称“\(X\)是一个度量空间”.
%@see: https://mathworld.wolfram.com/MetricSpace.html
\end{definition}
\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P45 定义2.1.1
设\((X,\rho)\)是一个度量空间，
那么把实数\(\rho(x,y)\)
称为“在度量空间\((X,\rho)\)中，从点\(x\)到点\(y\)的\DefineConcept{距离}（distance）”
或“对于度量\(\rho\)而言，从点\(x\)到点\(y\)的距离”，
在不致混淆的情况下简称为“从点\(x\)到点\(y\)的距离”.
\end{definition}
%TODO 注意将“度量”与“测度（measure）”作区别
%@see: https://math.stackexchange.com/questions/1402847/
%@see: https://mathworld.wolfram.com/Measure.html
%@see: https://math.hws.edu/eck/metric-spaces/

\begin{remark}
假设一个映射\(f\)既具有对称性，又满足三角不等式，
并且对于\(\forall x,y \in X\)有\(\rho(x,y) = 0 \allowbreak\iff x = y\)，
那就不必明说对于\(\forall x,y \in X\)有\(\rho(x,y) \geq 0\)，
这是因为只要在三角不等式中，取\(x=z\)，
便可得到\(
	0
	= \rho(x,x)
	\leq \rho(x,y) + \rho(y,x)
	= 2 \rho(x,y)
\)，
即\(\rho(x,y)\geq0\).
\end{remark}

\begin{remark}
任意给定一个集合，我们总可以给出无穷多个度量.
例如，给定集合\(X\)，对于\(x,y \in X\)，
只要任意取定\(c\in\mathbb{R}^+\)，
然后令\begin{equation*}
	d(x,y) = \left\{ \begin{array}{cl}
		c, & x \neq y, \\
		0, & x=y,
	\end{array} \right.
\end{equation*}
那么映射\(d\)就是集合\(X\)的一个度量.
\end{remark}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 1.
证明：映射\(
	\rho\colon \mathbb{R}\times\mathbb{R} \to \mathbb{R},
	(x,y) \mapsto (x-y)^2
\)不是\(\mathbb{R}\)的度量.
\begin{proof}
显然\(\rho(x,y) = (x-y)^2\)具有对称性和半正定性，
这是因为\begin{gather*}
	\rho(y,x)
	= (y-x)^2
	= (x-y)^2
	= \rho(x,y)
	\geq 0, \\
	\rho(x,y) = (x-y)^2 = 0 \iff x-y = 0 \iff x=y.
\end{gather*}
不过，只要取\(x=-1,y=0,z=1\)，
就有\(
	\rho(x,z)
	% = (x-z)^2 = (-1-1)^2 = (-2)^2
	= 4,
	\rho(x,y)
	% = (x-y)^2 = (-1-0)^2 = (-1)^2
	= 1,
	\rho(y,z)
	% = (y-z)^2 = (0-1)^2 = (-1)^2
	= 1
\)，
从而\(\rho(x,z) >\allowbreak \rho(x,y) +\allowbreak \rho(y,z)\)，
所以\(\rho\)不满足三角不等式，
因此\(\rho\)不是\(\mathbb{R}\)的度量.
\end{proof}
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 1.
证明：映射\(
	\rho\colon \mathbb{R}\times\mathbb{R} \to \mathbb{R},
	(x,y) \mapsto \abs{x^2-y^2}
\)不是\(\mathbb{R}\)的度量.
\begin{proof}
显然\(\rho(x,y) = \abs{x^2-y^2}\)满足对称性和三角不等式，
这是因为\begin{gather*}
	\rho(y,x)
	= \abs{y^2-x^2}
	= \abs{x^2-y^2}
	= \rho(x,y), \\
	\rho(x,z)
	= \abs{x^2-z^2}
	= \abs{(x^2-y^2)-(z^2-y^2)}
	\leq \abs{x^2-y^2} + \abs{y^2-z^2}
	= \rho(x,y) + \rho(y,z).
\end{gather*}
不过，只要取\(x=1,y=-1\)，
就有\(x \neq y\)
和\(
	\rho(x,y)
	% = \abs{x^2-y^2} = \abs{1^2-(-1)^2} = \abs{1-1}
	= 0
\)，
所以\(\rho\)不满足半正定性，
因此\(\rho\)不是\(\mathbb{R}\)的度量.
\end{proof}
\end{example}

\subsection{常见的度量空间}
\begin{example}[实数空间\(\mathbb{R}\)]
%@see: 《点集拓扑讲义（第四版）》（熊金城） P46 例2.1.1
对于实数集\(\mathbb{R}\)，
定义映射\(\rho\colon\mathbb{R}\times\mathbb{R}\to\mathbb{R}\)如下：\begin{equation*}
	\rho(x,y) = \abs{x-y},
	\quad x,y\in\mathbb{R}.
\end{equation*}
显然\(\rho\)是\(\mathbb{R}\)的一个度量，
因此\((\mathbb{R},\rho)\)是一个度量空间.
特别地，这个度量空间被称为\DefineConcept{实数空间}或\DefineConcept{直线}，
称度量\(\rho\)为“\(\mathbb{R}\)的\DefineConcept{通常度量}（usual metric）”.
\end{example}

我们可以假设一个定义在\([0,+\infty)\)上的非负函数\(f(x)\)，
当且仅当\(x=0\)时\(f(x)=0\).
如果函数\(f(x)\)严格上凸，
则对于\(\forall x,y\in\mathbb{R}\)，只要取\begin{equation*}
	d(x,y)=f(\abs{x-y}),
\end{equation*}
就得到\(\mathbb{R}\)的一个度量.

特别地，可以取\(d(x,y)=\sqrt{\abs{x-y}}\)
或\(d(x,y)=\frac{\abs{x-y}}{1+\abs{x-y}}\).

可以验证，在度量\(d(x,y)=\frac{\abs{x-y}}{1+\abs{x-y}}\)下，
数轴上任意两点之间的距离都小于\(1\).

\begin{example}[欧氏空间\(\mathbb{R}^n\)]\label{example:度量空间.欧氏空间}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P46 例2.1.2
对于实数集\(\mathbb{R}\)的\(n\)重笛卡尔积\(\mathbb{R}^n\)，
定义映射\(\rho\colon\mathbb{R}^n\times\mathbb{R}^n\to\mathbb{R}\)如下：\begin{equation*}
	\rho(\vb{x},\vb{y})
	= \sqrt{\sum_{i=1}^n (x_i-y_i)^2},
	\quad \vb{x}=(\AutoTuple{x}{n}),\vb{y}=(\AutoTuple{y}{n})\in\mathbb{R}^n.
\end{equation*}
显然\(\rho\)是\(\mathbb{R}^n\)的一个度量，
因此\((\mathbb{R}^n,\rho)\)是一个度量空间.
特别地，这个度量空间被称为（\(n\)维）\DefineConcept{欧氏空间}，
称度量\(\rho\)为\(\mathbb{R}^n\)的\DefineConcept{通常度量}.
2维欧氏空间通常称为欧氏平面.
%@see: https://mathworld.wolfram.com/EuclideanSpace.html
\end{example}

\begin{example}
对于\(\mathbb{R}^n\)，除了通常度量以外，我们还可以定义\begin{equation*}
	d_p(\vb{x},\vb{y})
	= \left(\sum_{i=1}^n \abs{x_i-y_i}^p\right)^{\frac{1}{p}},
	\quad \vb{x}=(\AutoTuple{x}{n}),\vb{y}=(\AutoTuple{y}{n})\in\mathbb{R}^n,
\end{equation*}
其中\(p\geq1\).
利用\hyperref[example:不等式.闵可夫斯基不等式]{闵可夫斯基不等式}%
可以证明\(d_p\)是\(\mathbb{R}^n\)的一个度量，
因此\((\mathbb{R}^n,d_p)\)也是一个度量空间，
把\(d_p\)称为\(\mathbb{R}^n\)的\DefineConcept{闵氏度量}.
\end{example}

\begin{example}
对于闭区间上的连续函数族\(C[a,b]\)，任给其中两个函数\(f,g\)，
定义：\begin{equation*}
	d(f,g)=\max_{a \leq x \leq b} \abs{f(x)-g(x)}.
\end{equation*}
我们把\(d\)称为\(C[a,b]\)的\DefineConcept{一致度量}%
或\DefineConcept{一致收敛性度量}%
或\DefineConcept{切比雪夫度量}.
在利用多项式代替任意给定函数以所需精度进行近似计算时，
可以用度量\(d\)刻画近似计算得精度.

我们还可以定义\begin{equation*}
	d_p(f,g)=\left[\int_a^b\abs{f-g}^p(x)\dd{x}\right]^{\frac{1}{p}}.
\end{equation*}
当\(p=1\)时，我们把\(d_p\)称为\DefineConcept{积分度量}；
当\(p=2\)时，我们把它称为\DefineConcept{均方差度量}；
当\(p=+\infty\)时，我们把它称为\DefineConcept{一致度量}.

我们常把度量空间\((C[a,b],d_p)\)简记为\(C_p[a,b]\)，
把度量空间\((C[a,b],d)\)简记为\(C_\infty[a,b]\).
\end{example}

\begin{example}[希尔伯特空间\(\mathbb{H}\)]
%@see: 《点集拓扑讲义（第四版）》（熊金城） P47 例2.1.3
构造由所有的平方收敛的实数序列构成的集合，并记为\begin{equation*}
	\mathbb{H}
	= \Set*{
		\vb{x}=(\AutoTuple{x}{0})
		\given
		x_i\in\mathbb{R},
		i\in\mathbb{N}^+;
		\sum_{i=1}^\infty x_i^2<\infty
	}.
\end{equation*}
定义映射\(\rho\colon\mathbb{H}\times\mathbb{H}\to\mathbb{R}\)如下：\begin{equation*}
	\rho(\vb{x},\vb{y}) = \sqrt{\sum_{i=1}^\infty (x_i-y_i)^2},
	\quad \vb{x}=(\AutoTuple{x}{0}),\vb{y}=(\AutoTuple{y}{0})\in\mathbb{H}.
\end{equation*}
可以证明\(\rho\)是\(\mathbb{H}\)的一个度量，
因此\((\mathbb{H},\rho)\)是一个度量空间.
特别地，这个度量空间被称为\DefineConcept{希尔伯特空间}，
称度量\(\rho\)为\(\mathbb{H}\)的\DefineConcept{通常度量}.
%@see: https://mathworld.wolfram.com/HilbertSpace.html
\end{example}

\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P47 例2.1.4
设\((X,\rho)\)是一个度量空间.
如果总有\begin{equation*}
	(\forall x \in X)
	(\exists \delta_x > 0)
	(\forall y \in X - \{x\})
	[\rho(x,y) > \delta_x]
\end{equation*}成立，
则称“度量空间\((X,\rho)\)是\DefineConcept{离散的}”.
\end{definition}
\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P47 例2.1.4
设\(X\)是任意一个集合，映射\(\rho\colon X \times X\to\mathbb{R}\)满足\begin{equation*}
	\rho(x,y) = \left\{ \begin{array}{ll}
		0, & x=y, \\
		1, & x\neq y.
	\end{array} \right.
\end{equation*}
容易验证：\(\rho\)是\(X\)的一个离散的度量，度量空间\((X,\rho)\)是离散的.
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 2.
证明：只含有限个点的度量空间一定是离散的.
\begin{proof}
设集合\(X\)含有\(n\)个点，
那么\(X\)中一定存在距离最短的两个点，
记\begin{equation*}
	\delta \defeq \min\Set{
		\rho(x_i,x_j)
		\given
		x_i,x_j \in X,
		x_i \neq x_j
	},
\end{equation*}
显然\begin{equation*}
	(\forall x \in X)
	(\exists \epsilon > 0)
	(\forall y \in X - \{x\})
	[
		\rho(x,y) > \delta - \epsilon > 0
	].
\end{equation*}
由此可见，只含有限个点的度量空间一定是离散的.
\end{proof}
\end{example}

\subsection{球形邻域的概念与性质}
\begin{definition}\label{definition:度量空间.球形邻域的概念}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P47 定义2.1.2
设\((X,\rho)\)是一个度量空间，\(x \in X\)，\(\epsilon > 0\)，
那么把集合\begin{equation*}
	\Set{ y \in X \given \rho(x,y) < \epsilon }
\end{equation*}
称为“在度量空间\((X,\rho)\)中，一个以\(x\)为\DefineConcept{中心}、
以\(\epsilon\)为\DefineConcept{半径}的\DefineConcept{球形邻域}%
（a \emph{ball} of \emph{radius} \(\epsilon\) about \(x\)）”
或“点\(x\)对于度量\(\rho\)而言的一个\(\epsilon\)-邻域”，
记作\(B(x,\epsilon)\)
或\(B_{\epsilon}(x)\)；
不特别强调度量\(\rho\)时，
可以简称为“一个以\(x\)为中心、以\(\epsilon\)为半径的球形邻域”
或“点\(x\)的一个\(\epsilon\)-邻域”；
进一步，不特别强调球形邻域的半径\(\epsilon\)时，
可以简称为“点\(x\)的一个球形邻域”，并简记为\(B(x)\).
\end{definition}

\begin{theorem}\label{theorem:度量空间.球形邻域的性质}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P48 定理2.1.1
设\((X,\rho)\)是一个度量空间，
则\(x\)的球形邻域具有以下基本性质：
\begin{enumerate}
	\item 每一点\(x \in X\)至少有一个球形邻域，
	并且点\(x\)属于它的每一个球形邻域；

	\item 对于点\(x \in X\)的任意两个球形邻域，
	存在\(x\)的球形邻域同时包含于两者；

	\item 如果\(y \in X\)属于\(x \in X\)的某一个球形邻域，
	则\(y\)有一个球形邻域包含于\(x\)的这个球形邻域.
\end{enumerate}
\begin{proof}
\begin{enumerate}
	\item 设\(x \in X\).
	对于每一个实数\(\epsilon>0\)，
	\(B(x,\epsilon)\)是\(x\)的一个球形邻域，
	所以\(x\)至少有一个球形邻域.
	由于\(\rho(x,x)=0\)，
	所以\(x\)属于它的每一个球形邻域.

	\item 如果\(B(x,\epsilon_1)\)和\(B(x,\epsilon_2)\)是\(x \in X\)的两个球形邻域，
	任意选取实数\(\epsilon>0\)，使得\(\epsilon<\min\{\epsilon_1,\epsilon_2\}\)，
	则\begin{equation*}
		B(x,\epsilon)
		\subseteq
		B(x,\epsilon_1) \cap B(x,\epsilon_2).
	\end{equation*}

	\item 设\(y \in B(x,\epsilon)\).
	令\(\epsilon_1 = \epsilon - \rho(x,y)\).
	显然\(\epsilon_1>0\).
	如果\(z \in B(y,\epsilon_1)\)，
	则\begin{equation*}
		\rho(z,x)
		\leq \rho(z,y) + \rho(y,x)
		< \epsilon_1 + \rho(y,x)
		= \epsilon,
	\end{equation*}
	所以\(z \in B(x,\epsilon)\).
	这证明\(B(y,\epsilon_1) \subseteq B(x,\epsilon)\).
	\qedhere
\end{enumerate}
\end{proof}
\end{theorem}

\begin{theorem}
%@see: 《基础拓扑学讲义》（尤承业） P14 引理
度量空间\((X,\rho)\)的任意两个球形邻域的交集是若干个球形邻域的并集.
\begin{proof}
只要任意取定\(X\)中两点\(x_1\)和\(x_2\)，
并任意取定两个正数\(\epsilon_1\)和\(\epsilon_2\)，
就可得到两个球形邻域\(B(x_1,\epsilon_1)\)和\(B(x_2,\epsilon_2)\)，
再令\(U \defeq B(x_1,\epsilon_1) \cap B(x_2,\epsilon_2)\)，
那么对于任意\(x \in U\)，
根据\hyperref[definition:度量空间.球形邻域的概念]{球形邻域的定义}有\(
	\epsilon_1 > \rho(x,x_1),
	\epsilon_2 > \rho(x,x_2)
\)，
若记\(
	\epsilon_x \defeq \min\{
		\epsilon_1 - \rho(x,x_1),
		\epsilon_2 - \rho(x,x_2)
	\}
\)，
则有\(B(x,\epsilon_x) \subseteq U\).
于是\begin{equation*}
	U = \bigcup_{x \in U} B(x,\epsilon_x).
	\qedhere
\end{equation*}
\end{proof}
\end{theorem}

\subsection{度量空间与极限的联系}
\begin{definition}
%@see: 《Real Analysis Modern Techniques and Their Applications Second Edition》（Folland） P14
设\(\{x_n\}\)是度量空间\((X,\rho)\)中的一个序列.
若\begin{equation*}
	\lim_{n\to\infty} \rho(x_n,x) = 0,
\end{equation*}
则称“在度量空间\((X,\rho)\)中，序列\(\{x_n\}\) \DefineConcept{收敛于} 点\(x\)%
（\(\{x_n\}\) \emph{converges} to \(x\)）”，
记作\(\lim_{n\to\infty} x_n = x\)；
不特别强调度量\(\rho\)时，可以简称为“\(\{x_n\}\)收敛于\(x\)”.
\end{definition}

\subsection{开集的概念与性质}
\begin{definition}\label{definition:度量空间.开集的概念}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P48 定义2.1.3
设\(A\)是度量空间\(X\)的一个子集.
如果\(A\)中的每一个点都有一个球形邻域包含于\(A\)，
即\begin{equation*}
	(\forall a \in A)
	(\exists\epsilon>0)
	[B(a,\epsilon) \subseteq A],
\end{equation*}
则称“\(A\)是度量空间\(X\)中的一个\DefineConcept{开集}（open set）”.
\end{definition}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P48 例2.1.5
实数空间\(\mathbb{R}\)中，所有的开区间，不论是有限的还是无限的，都是开集；
闭区间或半开半闭区间都不是\(\mathbb{R}\)中的开集.
\end{example}

\begin{theorem}\label{theorem:度量空间.开集的性质}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P49 定理2.1.2
度量空间\(X\)中的开集具有以下性质：
\begin{enumerate}
	\item 集合\(X\)本身和空集\(\emptyset\)都是开集；
	\item 任意两个开集的交也是一个开集；
	\item 任意一个开集族的并是一个开集；
	\item 任意一个球形邻域都是开集.
\end{enumerate}
\begin{proof}
\begin{enumerate}
	\item 根据\cref{theorem:度量空间.球形邻域的性质}，
	\(X\)中的每一个元素\(x\)都有一个球形邻域，
	这个球形邻域当然包含在\(X\)中，
	所以\(X\)满足开集的条件.
	空集\(\emptyset\)中不含任何点，
	也自然地可以认为它满足开集的条件.

	\item 设\(U,V\)都是\(X\)中的开集.
	如果\(x \in U \cap V\)，
	则存在\(x\)的一个球形邻域\(B(x,\epsilon_1)\)包含于\(U\)，
	也存在\(x\)的一个球形邻域\(B(x,\epsilon_2)\)包含于\(V\).
	根据\cref{theorem:度量空间.球形邻域的性质}，
	\(x\)有一个球形邻域\(B(x,\epsilon)\)
	同时包含于\(B(x,\epsilon_1)\)和\(B(x,\epsilon_2)\)，
	因此\begin{equation*}
		B(x,\epsilon)
		\subseteq
		B(x,\epsilon_1) \cap B(x,\epsilon_2)
		\subseteq
		U \cap V.
	\end{equation*}
	由于\(U \cap V\)中的每一点都是一个球形邻域包含于\(U \cap V\)，
	所以\(U \cap V\)是一个开集.

	\item 设\(\sfA\)是一个由\(X\)中的开集构成的子集族.
	如果\(x \in \bigcup \sfA\)，
	则存在\(A \in \sfA\)使得\(x \in A\).
	由于\(A\)是一个开集，
	所以\(x\)有一个球形邻域包含于\(A\)，
	显然这个球形邻域也包含于\(\bigcup \sfA\).
	这证明\(\bigcup \sfA\)是\(X\)中的一个开集.
	\qedhere
\end{enumerate}
\end{proof}
\end{theorem}

根据\cref{theorem:度量空间.球形邻域的性质} 可以得知，
每一个球形邻域都是开集.

有时候为了方便讨论问题，我们将球形邻域的概念稍稍作一点推广.
\begin{definition}\label{definition:度量空间.邻域的概念}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P50 定义2.1.4
设\(x\)是度量空间\(X\)中的一个点，集合\(U \subseteq X\).
如果存在一个开集\(V\)满足条件\(x \in V \subseteq U\)，
就称“\(U\)是点\(x\)（在度量空间\(X\)中）的一个\DefineConcept{邻域}”.
\end{definition}

下面这个定理为邻域的定义提供了一个等价的说法，并且表明从球形邻域推广到邻域是自然的事情.
\begin{theorem}\label{theorem:度量空间.邻域的判定}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P50 定理2.1.3
设\(x\)是度量空间\(X\)中的一个点，
则“\(X\)的子集\(U\)是\(x\)的一个邻域”的充分必要条件是：
\(x\)有某一个球形邻域包含于\(U\).
\begin{proof}
如果\(U\)是点\(x\)的一个邻域，
根据邻域的定义，存在开集\(V\)，使得\(x \in V \subseteq U\).
又根据开集的定义，\(x\)有一个球形邻域包含于\(V\)，
从而这个球形邻域也就包含于\(U\).
这证明\(U\)满足定理的条件.

反之，如果\(U\)满足定理中的条件，
由于球形邻域都是开集，
因此\(U\)是\(x\)的邻域.
\end{proof}
\end{theorem}

\subsection{集合的直径，集合的有界性}
\begin{definition}
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P343 定义9
%@see: 《数学分析（第7版 第一卷）》（卓里奇） P343 定义10
%@see: 《点集拓扑讲义（第四版）》（熊金城） P219 定义7.5.1
设\((X,\rho)\)是一个度量空间，\(A \subseteq X\).
定义：\begin{equation*}
	\diam A = \sup_{x,y \in A} \rho(x,y),
\end{equation*}
称其为“集合\(A\)（在度量空间\((X,\rho)\)中）的\DefineConcept{直径}（diameter）”.
\end{definition}
\begin{definition}
设\((X,\rho)\)是一个度量空间，\(A \subseteq X\).
若\begin{equation*}
	(\exists M>0)
	(\forall x,y \in A)
	[\rho(x,y) < M],
\end{equation*}
则称“集合\(A\)（在度量空间\((X,\rho)\)中）是\DefineConcept{有界的}（bounded）”，
记作\(\diam A < \infty\).
\end{definition}
\begin{definition}
设\((X,\rho)\)是一个度量空间，\(A \subseteq X\).
若\begin{equation*}
	(\forall M>0)
	(\exists x,y \in A)
	[\rho(x,y) > M],
\end{equation*}
则称“集合\(A\)（在度量空间\((X,\rho)\)中）是\DefineConcept{无界的}（unbounded）”，
记作\(\diam A = \infty\).
\end{definition}

\subsection{度量空间之间的连续映射}
现在我们把分析学中的连续函数的概念推广为度量空间之间的连续映射.

\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P50 定义2.1.5
设\(X,Y\)都是度量空间，
映射\(f\colon X \to Y\)，
点\(x_0 \in X\).
如果对于\(f(x_0)\)的任何一个球形邻域\(B(f(x_0),\epsilon)\)，
存在\(x_0\)的某一个球形邻域\(B(x_0,\delta)\)，
使得\begin{equation*}
	f(B(x_0,\delta))
	\subseteq
	B(f(x_0),\epsilon),
\end{equation*}
则称“映射\(f\)在点\(x_0\) \DefineConcept{连续}”.
\end{definition}

\begin{definition}\label{definition:度量空间.连续映射的概念}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P50 定义2.1.5
设\(X,Y\)都是度量空间，
映射\(f\colon X \to Y\).
如果\begin{equation*}
	(\forall x \in X)
	[\text{$f$在点$x$连续}],
\end{equation*}
则称“\(f\)是一个\DefineConcept{连续映射}”.
\end{definition}

\begin{remark}
\cref{definition:度量空间.连续映射的概念} 是分析学中函数连续性定义的纯粹形式推广.
之所以这样说，是因为如果\(\rho\)和\(\sigma\)分别是\(X\)和\(Y\)的度量，
则“映射\(f\)在点\(x_0\)连续”可以说成是\begin{equation*}
	(\forall\epsilon>0)
	(\exists\delta>0)
	(\forall x \in X)
	[
		\rho(x,x_0)<\delta
		\implies
		\sigma(f(x),f(x_0))<\epsilon
	].
\end{equation*}
\end{remark}

下面这个定理是把度量空间和度量空间之间的连续映射的概念
推广为拓扑空间和拓扑空间之间的连续映射的出发点.
\begin{theorem}\label{theorem:度量空间.度量空间下的连续映射与邻域的联系}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P50 定理2.1.4
设\(X\)、\(Y\)是两个度量空间.
映射\(f\colon X \to Y\).
取\(x_0 \in X\).
那么\begin{equation*}
	\text{\(f\)在点\(x_0\)连续}
	\iff
	\text{\(f(x_0)\)的每一个邻域的原像是\(x_0\)的一个邻域},
\end{equation*}\begin{equation*}
	\text{\(f\)是连续映射}
	\iff
	\text{\(Y\)中的每一个开集的原像是\(X\)中的一个开集}.
\end{equation*}
\begin{proof}
先证“\(\text{\(f\)在点\(x_0\)连续}
\implies
\text{\(f(x_0)\)的每一个邻域的原像是\(x_0\)的一个邻域}\)”.
假设\(f\)在点\(x_0\)连续.
令\(U\)为\(f(x_0)\)的一个邻域.
根据\cref{theorem:度量空间.邻域的判定}，
\(f(x_0)\)有一个球形邻域\(B(f(x_0),\epsilon)\)包含于\(U\).
由于\(f\)在点\(x_0\)连续，
所以\(x_0\)有一个球形邻域\(B(x_0,\delta)\)
使得\(f(B(x_0,\delta)) \subseteq B(f(x_0),\epsilon)\).
然而，\(f^{-1}(B(f(x_0),\epsilon)) \subseteq f^{-1}(U)\)，
所以\(B(x_0,\delta) \subseteq f^{-1}(U)\).
这证明\(f^{-1}(U)\)是\(x_0\)的一个邻域.

再证“\(\text{\(f(x_0)\)的每一个邻域的原像是\(x_0\)的一个邻域}
\implies
\text{\(f\)在点\(x_0\)连续}\)”.
假设\(f(x_0)\)的每一个邻域的原像是\(x_0\)的一个邻域.
任意给定\(f(x_0)\)的一个邻域\(B(f(x_0),\epsilon)\)，
则\(f^{-1}(B(f(x_0),\epsilon))\)是\(x_0\)的一个邻域.
根据\cref{theorem:度量空间.邻域的判定}，
\(x_0\)有一个球形邻域\(B(x_0,\delta)\)
包含于\(f^{-1}(B(f(x_0),\epsilon))\).
因此\(f(B(x_0,\delta)) \subseteq B(f(x_0),\epsilon)\).
这就证明\(f\)在点\(x_0\)连续.

接下来证“\(\text{\(f\)是连续映射}
\implies
\text{\(Y\)中的每一个开集的原像是\(X\)中的一个开集}\)”.
假设\(f\)是连续映射.
令\(V\)是\(Y\)中的一个开集，
又令\(U = f^{-1}(V)\).
对于每一个\(x \in U\)，我们有\(f(x) \in V\).
由于\(V\)是一个开集，
所以\(V\)是\(f(x)\)的一个邻域.
由于\(f\)在每一点处都连续，
故根据本定理第一个结论，
\(U\)是\(x\)的一个邻域.
于是有包含\(x\)的某一个开集\(U_x\)使得\(U_x \subseteq U\).
易见\(U = \bigcup_{x \in U} U_x\).
由于每一个\(U_x\)都是开集，
根据\cref{theorem:度量空间.开集的性质}，
\(U\)是一个开集.

最后证“\(\text{\(Y\)中的每一个开集的原像是\(X\)中的一个开集}
\implies
\text{\(f\)是连续映射}\)”.
假设\(Y\)中的每一个开集的原像是\(X\)中的一个开集.
对于任意\(x \in X\)，
设\(U\)是\(f(x)\)的一个邻域，
即存在包含\(f(x)\)的一个开集\(V \subseteq U\).
从而\(x \in f^{-1}(V) \subseteq f^{-1}(U)\).
根据假设，\(f^{-1}(V)\)是一个开集，
所以\(f^{-1}(U)\)是\(x\)的一个邻域，
因此对于\(x\)而言，
\(f(x)\)的每一个邻域的原像是\(x\)的一个邻域，
因此根据本定理第一个结论可知，
\(f\)在点\(x\)连续.
由于点\(x\)是任意选取的，所以\(f\)是一个连续映射.
\end{proof}
\end{theorem}

%现在我们就明白了，对于积分的每一种定义都基于一种度量：
%黎曼积分基于若尔当度量，
%勒贝格积分基于勒贝格度量.

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 3.
设\((X,\rho)\)是一个离散的度量空间.
证明：\begin{itemize}
	\item \(X\)的每一个子集都是开集；
	\item 如果\(Y\)也是一个度量空间，则任意一个从\(X\)到\(Y\)的映射都是连续的.
\end{itemize}
\begin{proof}
因为\((X,\rho)\)是一个离散的度量空间，
那么由定义有\begin{equation*}
	(\forall x \in X)
	(\exists \delta_x > 0)
	(\forall y \in X - \{x\})
	[\rho(x,y) > \delta_x].
\end{equation*}

任取\(X\)的一个子集\(A\)，
便有\begin{equation*}
	(\forall x \in A)
	[B(x,\epsilon_x) = \{x\} \subseteq A],
\end{equation*}
这就说明\(X\)的每一个子集都是开集.

设映射\(f\colon X \to Y\)，
\(\sigma\)是\(Y\)的度量.
在\(X\)中任取一点\(x_0\)，
对于任意正数\(\epsilon\)，
只要取\(\delta = \delta_{x_0}\)，
就会使得\begin{align*}
	f(B(x_0,\delta))
	&= f(\{x_0\})
	= \{f(x_0)\}
	= \Set{ y \in Y \given \sigma(y,f(x_0)) = 0 } \\
	&\subseteq
	B(f(x_0),\epsilon)
	= \Set{ y \in Y \given \sigma(y,f(x_0)) < \epsilon },
\end{align*}
这就说明映射\(f\)在点\(x_0\)连续.
\end{proof}
\end{example}

\begin{definition}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 4.
设\(\rho_1,\rho_2\)都是集合\(X\)的度量，\(A \subseteq X\).
若\begin{equation*}
	\text{\(A\)是度量空间\((X,\rho_1)\)中的开集}
	\iff
	\text{\(A\)是度量空间\((X,\rho_2)\)中的开集},
\end{equation*}
则称“度量\(\rho_1\)与\(\rho_2\)是\DefineConcept{等价的}”.
\end{definition}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 4.
设\(X\)是一个非空集合，\(Y\)是一个度量空间，
\(f\)是从\(X\)到\(Y\)的一个映射，
映射\(\rho_1,\rho_2\)都是\(X\)的度量，
且\(\rho_1\)与\(\rho_2\)是等价的.
证明：\(f\)对于度量\(\rho_1\)而言是连续的，
当且仅当\(f\)对于度量\(\rho_2\)而言是连续的.
%TODO
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 5.
定义映射\(\rho_1\colon \mathbb{R}^2 \times \mathbb{R}^2 \to \mathbb{R}\)，
使之满足\begin{equation*}
	\rho_1(x,y) = \max\{ \abs{x_1-y_1}, \abs{x_2-y_2} \},
	\quad x=(x_1,x_2),y=(y_1,y_2).
\end{equation*}
定义映射\(\rho_2\colon \mathbb{R}^2 \times \mathbb{R}^2 \to \mathbb{R}\)，
使之满足\begin{equation*}
	\rho_2(x,y) = \abs{x_1-y_1} + \abs{x_2-y_2},
	\quad x=(x_1,x_2),y=(y_1,y_2).
\end{equation*}
证明：\(\rho_1\)、\(\rho_2\)和\(\mathbb{R}^2\)的通常度量\(\rho\)是等价的.
%TODO proof
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 6.
定义映射\(f\colon \mathbb{R}^2 \to \mathbb{R}\)，使之满足\begin{equation*}
	f(x) = \max\{ x_1, x_2 \},
	\quad x=(x_1,x_2).
\end{equation*}
证明：\(f\)是连续映射.
\begin{proof}
要证\(f\)是连续映射，
只需证对于\(\mathbb{R}^2\)中任意一点\(x\)和任意\(\epsilon > 0\)，存在\(\delta > 0\)，
当\(\mathbb{R}^2\)中任意一点\(y = (y_1,y_2)\)
满足\(\sqrt{(x_1-y_1)^2+(x_2-y_2)^2} < \delta\)时，
就有\(\abs{f(x) - f(y)} < \epsilon\)成立.
%@credit: {ce603838-a24d-4616-9395-d7b223e8cb72} 提起\(\max\)与\(\abs\)的关系
由\cref{equation:绝对值函数.两个数的最大值} \begin{equation*}
	\max\{a,b\} = \frac{a+b}{2} + \frac{\abs{a-b}}{2}
\end{equation*}
\def\ExpandMax#1#2{\frac{#1+#2}{2} + \frac{\abs{#1-#2}}{2}}
可知\begin{align*}
	\abs{f(x) - f(y)}
	&= \abs{
		\left( \ExpandMax{x_1}{x_2} \right)
		-
		\left( \ExpandMax{y_1}{y_2} \right)
	} \\
	&= \abs{
		\frac{
			(x_1-y_1) + (x_2-y_2)
			+ \abs{x_1-x_2} - \abs{y_1-y_2}
		}{2}
	} \\
	%\cref{theorem:不等式.三角不等式1}
	&\leq \abs{\frac{x_1-y_1}{2}} + \abs{\frac{x_2-y_2}{2}} + \frac{\abs{\abs{x_1-x_2} - \abs{y_1-y_2}}}{2} \\
	%\cref{theorem:不等式.三角不等式2}
	&\leq \abs{\frac{x_1-y_1}{2}} + \abs{\frac{x_2-y_2}{2}} + \frac{\abs{(x_1-x_2)-(y_1-y_2)}}{2} \\
	&= \frac{\abs{x_1-y_1}}{2} + \frac{\abs{x_2-y_2}}{2} + \frac{\abs{(x_1-y_1)-(x_2-y_2)}}{2} \\
	%\cref{theorem:不等式.三角不等式1}
	&\leq \frac{\abs{x_1-y_1}}{2} + \frac{\abs{x_2-y_2}}{2} + \frac{\abs{x_1-y_1}}{2} + \frac{\abs{x_2-y_2}}{2} \\
	&= \abs{x_1-y_1} + \abs{x_2-y_2}
	%\cref{theorem:不等式.基本不等式n算术平均数与平方平均数}
	\leq 2\sqrt{\frac{(x_1-y_1)^2+(x_2-y_2)^2}{2}}
	< \frac{2\delta}{\sqrt2},
\end{align*}
所以只要让\(\delta\)满足\(\epsilon = \sqrt2 \delta\)，
或者说令\(\delta = \frac{\epsilon}{\sqrt2}\)，
那么当\(\sqrt{(x_1-y_1)^2+(x_2-y_2)^2} < \delta\)时，
就有\(\abs{f(x) - f(y)} < \epsilon\)成立.
\end{proof}
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 6.
定义映射\(f\colon \mathbb{R}^2 \to \mathbb{R}\)，使之满足\begin{equation*}
	f(x) = x_1 + x_2,
	\quad x=(x_1,x_2).
\end{equation*}
证明：\(f\)是连续映射.
%TODO proof
\end{example}

\begin{example}
%@see: 《点集拓扑讲义（第四版）》（熊金城） P54 习题 7.
设\((X,\rho)\)是一个度量空间.
定义映射\(\rho_1\colon X \times X \to \mathbb{R}\)，使之满足\begin{equation*}
	\rho_1(x,y) = \frac{\rho(x,y)}{1+\rho(x,y)}.
\end{equation*}
定义映射\(\rho_2\colon X \times X \to \mathbb{R}\)，使之满足\begin{equation*}
	\rho_2(x,y) = \left\{ \begin{array}{cl}
		\rho(x,y), & \rho(x,y) \leq 1, \\
		1, & \rho(x,y) > 1.
	\end{array} \right.
\end{equation*}
证明：\(\rho_1,\rho_2,\rho\)是等价的.
%TODO proof
\end{example}
