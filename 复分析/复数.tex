\chapter{复数}
\section{复数的形式与运算}
\subsection{复数的三角形式}
\begin{definition}[复数的三角形式]
由于平面直角坐标系上的点\((x,y)\)也可以用极坐标\(\opair{r,\theta}\)表示，
因此根据极坐标和直角坐标间的关系，
复数\(z=x+\iu y\)也可以表示成\[
	z = r(\cos\theta+\iu\sin\theta).
\]
这就是复数\(z\)的\DefineConcept{三角形式}，
其中\[
	r = \sqrt{x^2+y^2} = \abs{z},
\]\[
	\tan\theta = \frac{y}{x}.
\]
我们把\(r\)称为复数\(z\)的\DefineConcept{模长}（complex modulus），
%@see: https://mathworld.wolfram.com/ComplexModulus.html
把\(\theta\)称作复数\(z\)的\DefineConcept{辐角}（complex argument）.
%@see: https://mathworld.wolfram.com/ComplexArgument.html
\end{definition}

对于复数\(z=x+\iu y=r(\cos\theta+\iu\sin\theta)\)，
使得\(\tan\theta=\frac{y}{x}\)成立的\(\theta=\Arg z\)值有无穷多个.
规定落在区间\((-\pi,\pi]\)内的辐角值为\(\Arg z\)的\DefineConcept{主值}，
或称之为\DefineConcept{主辐角}，
记作\(\arg{z}\)，
即\[
	\Arg z \defeq \arg{z} + 2k\pi, \quad k\in\mathbb{Z},
\]
则主辐角\(\arg{z}\)是唯一确定的.
有时候主辐角\(\arg{z}\)被规定落在区间\([0,2\pi)\)内.

注意：\begin{enumerate}
	\item 对复数\(z = x + \iu y\)，若\(z \neq 0\)且\(z \neq \infty\)，
	则满足\(\tan \theta = \frac{y}{x}\)的\(\theta\)的取值有无穷多个，
	因此辐角\(\Arg z\)有无穷多个值，
	但主辐角\(\arg z\)只有一个值；
	\item 当复数\(z = 0\)或\(z = \infty\)时，
	辐角\(\Arg z\)、主辐角\(\arg{z}\)均无意义.
\end{enumerate}

\begin{theorem}
设非零复数\(z=r(\cos\theta+\iu\sin\theta)\)的主辐角为\(\arg{z} \in (-\pi,\pi]\)，则有\[
\def\arraystretch{1.5}
\arg{z} = \left\{ \begin{array}{lc}
\arctan{\frac{y}{x}}, &\quad x > 0, \\
\frac{\pi}{2}, &\quad x = 0 \land y > 0, \\
\arctan{\frac{y}{x}} + \pi, &\quad x < 0 \land y \geq 0, \\
\arctan{\frac{y}{x}} - \pi, &\quad x < 0 \land y < 0, \\
-\frac{\pi}{2}, &\quad x = 0 \land y < 0,
\end{array} \right.
\]
\end{theorem}

\begin{theorem}
设非零复数\(z=x+\iu y=r(\cos\theta+\iu\sin\theta)\)的主辐角为\(\arg{z} = \alpha\)，则\[
\tan{\frac{\alpha}{2}}
= \frac{\sin\alpha}{1+\cos\alpha}
= \frac{r\sin\alpha}{r+r\cos\alpha}
= \frac{y}{r+x}
= \frac{y}{x+\sqrt{x^2+y^2}}
\]所以\[
\arg{z} = \alpha
= 2 \arctan{ \frac{y}{x+\sqrt{x^2+y^2}} }
\]
\end{theorem}

\begin{lemma}
设非零复数\(z_1=\cos\theta_1+\iu\sin\theta_1\)、\(z_2=\cos\theta_2+\iu\sin\theta_2\)，则\[
z_1z_2 = (\cos\theta_1+\iu\sin\theta_1)(\cos\theta_2+\iu\sin\theta_2)
= \cos(\theta_1+\theta_2) + \iu\sin(\theta_1+\theta_2),
\]\[
\frac{z_1}{z_2} = \frac{\cos\theta_1+\iu\sin\theta_1}{\cos\theta_2+\iu\sin\theta_2}
= \cos(\theta_1-\theta_2) + \iu\sin(\theta_1-\theta_2),
\]
\end{lemma}

\subsection{复数的指数形式}
根据以上引理，只要定义
\begin{equation}\label{equation:复数.欧拉公式}
	e^{\iu\theta}
	\defeq
	\cos\theta+\iu\sin\theta,
\end{equation}
就有\[
	e^{\iu\theta_1} e^{\iu\theta_2} = e^{\iu(\theta_1+\theta_2)}
	\quad \text{和} \quad
	\frac{e^{\iu\theta_1}}{e^{\iu\theta_2}} = e^{\iu(\theta_1-\theta_2)}
\]成立，
继而可以将任意非零复数\(z=x+\iu y\)写成指数形式，即\[
	z = r e^{\iu\theta}.
\]

复数0的辐角无意义，不能写成指数形式.

\begin{theorem}[指数形式下的复数的乘除法]
设非零复数\(z_1 = r_1 e^{\iu\theta_1}\)、\(z_2 = r_2 e^{\iu\theta_2}\)，则\[
z_1 z_2 = r_1 e^{\iu\theta_1} \cdot r_2 e^{\iu\theta_2} = r_1 r_2 e^{\iu(\theta_1+\theta_2)}
\]\[
\frac{z_1}{z_2} = \frac{r_1 e^{\iu\theta_1}}{r_2 e^{\iu\theta_2}} = \frac{r_1}{r_2} e^{\iu(\theta_1-\theta_2)}
\]
\end{theorem}

\begin{property}
设复数\(z_1\)、\(z_2\)，则有\begin{align*}
\Arg{z_1 z_2} &= \Arg{z_1} + \Arg{z_2} \\
\Arg{\frac{z_1}{z_2}} &= \Arg{z_1} - \Arg{z_2} \\
\Arg{\ComplexConjugate{z}} &= -\Arg z
\end{align*}
注意以上等式两边各是无穷多个角度值的集合.

同样地，存在\(k_1,k_2 \in \mathbb{Z}\)，使得\begin{align*}
\arg{z_1 z_2} &= \arg{z_1} + \arg{z_2} + 2 k_1 \pi \\
\arg{\frac{z_1}{z_2}} &= \arg{z_1} - \arg{z_2} + 2 k_2 \pi
\end{align*}
成立.
\end{property}

\begin{theorem}[指数形式下复数相等条件]
非零复数\(z_1=r_1 e^{\iu\theta_1}\)、\(z_2=r_2 e^{\iu\theta_2}\)相等的充分必要条件是：\[
\left\{ \begin{array}{l}
r_1 = r_2 \\
\theta_1 = \theta_2 + 2k\pi
\end{array} \right. \quad (k \in \mathbb{Z})
\]
\end{theorem}

我们可以利用指数形式的复数作出对三角函数和积互化公式的证明.
由于\[
e^{\iu(\alpha+\beta)}
= e^{\iu\alpha} e^{\iu\beta}
\]
可以写为代数形式
\[\begin{aligned}
\cos(\alpha+\beta)+\iu\sin(\alpha+\beta)
&= (\cos\alpha+\iu\sin\alpha)(\cos\beta+\iu\sin\beta) \\
&= (\cos\alpha \cos\beta - \sin\alpha \sin\beta)
    + \iu(\cos\alpha \sin\beta + \sin\alpha \cos\beta),
\end{aligned}\]
那么，稍加比较便知\[
\cos(\alpha+\beta) = \cos\alpha \cos\beta - \sin\alpha \sin\beta,
\]\[
\sin(\alpha+\beta) = \cos\alpha \sin\beta + \sin\alpha \cos\beta.
\]

\begin{example}
证明：\begin{gather}
\sum_{k=1}^n \cos kx
    = \cos(\frac{n+1}{2}x)
    \csc(\frac{1}{2}x)
    \sin(\frac{n}{2}x). \\
\sum_{k=1}^n \sin kx
    = \sin(\frac{n+1}{2}x)
    \csc(\frac{1}{2}x)
    \sin(\frac{n}{2}x).
\end{gather}
\end{example}

\subsection{复数的乘幂与方根}
\begin{definition}
设\(n\)是正整数，则\(z^n\)表示\(n\)个\(z\)的乘积.
规定：\(0^n=0\)，\(z^0=1\)，\(z^{-n}=\frac{1}{z^n}\).
当\(z=re^{\iu\theta} \neq 0\)时，\[
z^n = r^n e^{in\theta} = r^n(\cos n\theta+\iu\sin n\theta),
\quad n \in \mathbb{Z}.
\]
\end{definition}

\begin{theorem}[棣莫弗公式]
\begin{equation}\label{equation:复数.棣莫弗公式}
	(\cos\theta+i\sin\theta)^n = \cos{n\theta}+\iu\sin{n\theta}
\end{equation}
\end{theorem}
我们称\cref{equation:复数.棣莫弗公式} 为\DefineConcept{棣莫弗公式}.

\begin{definition}[复数的方根]
已知\(z\in\mathbb{C}\)，
关于复数\(w\)的方程\[
	w^n = z \quad (n \geq 2, n \in \mathbb{Z})
\]的根
称为\(z\)的~\DefineConcept{\(n\)次方根}.
记所有根的总体为\(\sqrt[n]{z}\).

当\(z=0\)时，以上方程只有唯一解\(w = 0\).

当\(z \neq 0\)时，设\(z=re^{\iu\theta}\)，\(w=\rho e^{\iu\phi}\)（其中\(r,\theta,\rho,\phi\in\mathbb{R}^+\)）代入原方程，得\[
\rho^n e^{\iu n \phi} = r e^{\iu\theta}
\]根据复数相等的充分必要条件，得\[
\left\{ \begin{array}{l}
\rho^n = r \\
n\phi = \theta + 2k\pi
\end{array} \right. \quad (k \in \mathbb{Z})
\]由于\(\rho\)和\(r\)都是正实数，故可由\(\rho^n=r\)得出唯一确定的算术根\(\rho=\sqrt[n]{r}\)；
又可由\(n\phi=\theta+2k\pi\)得出\(\phi=\frac{\theta+2k\pi}{n}\).
也就是说，\(z\)的\(n\)次方根为\[
w_k = (\sqrt[n]{z})_k = \sqrt[n]{r} e^{\iu \frac{\theta + 2k\pi}{n}} \quad (k=0,1,\dotsc,n-1)
\]
\end{definition}

在复平面上，\(\sqrt[n]{z}\)的不同值\(w_k\)表示为\[
w_k = w_0 e^{\iu\frac{2k\pi}{n}} \quad (k \in \mathbb{Z}),
\]对给定的复数\(z\)，由\(z\)的模\(r\)和辐角\(\theta\)先在复平面上确定\(w_0 = \sqrt[n]{r} e^{\iu\frac{\theta}{n}}\)，然后将\(w_0\)依次绕原点旋转\[
\def\f{\frac{2\pi}{n}}
\f,\,2\cdot\f,\,3\cdot\f,\,\dots,\,(n-1)\cdot\f,
\]包括\(w_0\)在内，就在复平面上得到\(\sqrt[n]{z}\)的总共\(n\)个值的几何表示.它们均匀地分布在中心在原点、半径为\(\sqrt[n]{r}\)的圆周上，即它们是内接于此圆周的正\(n\)角形的\(n\)个顶点.

\section{复平面上的几何图形}
复数乘除法的几何意义可由指数形式下的乘除法运算公式得到.

复数\(z=z_1 z_2\)对应的向量是把复数\(z_1\)对应的向量先伸缩\(r_2 = \abs{z_2}\)倍，
再旋转一个角度\(\theta_2 = \arg z_2\)得到的.

直角坐标平面上任意一条用隐函数方程\(F(x,y)=0\)表示的曲线，经过变量代换即可得到其复方程为\[
F\left(\frac{z+\ComplexConjugate{z}}{2},\frac{z-\ComplexConjugate{z}}{2\iu}\right)=0.
\]

\begin{example}[射线]
从点\(z_0\)出发，与正实轴夹角为\(\theta_0\)的射线的复变数方程为\[
\arg(z-z_0) = \theta_0.
\]
\end{example}

\begin{example}[线段]
连接\(z_1\)、\(z_2\)两点的线段的参数方程为\[
z = z_1 + t(z_2 - z_1), \qquad t \in [0,1].
\]
\end{example}

\begin{example}[直线]
过\(z_1\)、\(z_2\)两点的直线的参数方程为\[
z = z_1 + t(z_2 - z_1), \qquad t \in (-\infty,+\infty).
\]

实轴的方程为\(\Im z = 0\)；
虚轴的方程为\(\Re z = 0\).
\end{example}

\begin{example}[三点共线的充分必要条件]
三点\(z_1\)、\(z_2\)、\(z_3\)共线的充分必要条件为\[
\frac{z_3 - z_1}{z_2 - z_1} = t \neq 0, \qquad t \in \mathbb{R}.
\]
\end{example}

\begin{example}[圆]
以\(z_0\)为圆心，\(R\)为半径的圆周的方程为\[
\abs{z - z_0} = R.
\]而\(\abs{z-z_0}<R\)表示圆的内部，\(\abs{z-z_0}>R\)表示圆的外部.

复平面上圆周的一般方程为\[
A z \ComplexConjugate{z} + \beta \ComplexConjugate{z} + \ComplexConjugate{\beta} z + C = 0
\]其中\(A,C\in\mathbb{R}\)，\(A \neq 0\)，\(\beta\in\mathbb{C}\)，且\[
\abs{\beta}^2 > AC
\]

以\(z_0\)为圆心，\(R\)为半径的圆周的方程还可表示为\[
z - z_0 = R e^{\iu \theta}.
\]
\end{example}

\begin{definition}
设圆\(C: \abs{z - a} = R\).
如果点\(z_1,z_2\)都在从圆心\(a\)出发的同一条射线上，且满足\[
\abs{z_1 - a} \abs{z_2 - a} = R^2,
\]则称点\(z_1,z_2\)关于圆周\(C\)对称.

特别地，规定圆心\(a\)与无穷远点\(\infty\)关于圆周\(C\)对称.
\end{definition}

\begin{theorem}
点\(z_1,z_2\)关于圆周\(C: \abs{z - a} = R\)对称的充分必要条件是：\[
\ComplexConjugate{z_a - a} (z_2 - a) = R^2.
\]
\end{theorem}

\begin{theorem}
点\(z_1,z_2\)关于圆周\(C: \abs{z - a} = R\)对称的充分必要条件是：通过\(z_1,z_2\)的任意圆周都与\(C\)正交.
\end{theorem}
