\chapter{初等代数}
\section{排列组合}
\subsection{排列、组合的基本概念}
从若干个元素中取出几个或全部的一种排法，
称作是一个\DefineConcept{排列}（permutation）.
例如，从\(a,b,c,d\)四个字母里一次取出两个的排列数有12个，即\[
	\begin{gathered}
	ab, \quad
	ac, \quad
	ad, \quad
	bc, \quad
	bd, \quad
	cd, \\
	ba, \quad
	ca, \quad
	da, \quad
	cb, \quad
	db, \quad
	dc;
	\end{gathered}
\]
其中每一个都代表两个字母的不同的排法.

从若干个元素中取出几个或全部的一种选法，
称作是一个\DefineConcept{组合}（combination）.
例如，从\(a,b,c,d\)四个字母里一次取出两个的组合数有6个，即\[
	ab, \quad
	ac, \quad
	ad, \quad
	bc, \quad
	bd, \quad
	cd;
\]
其中每一个都代表两个字母的不同的选法.

从这些例子中我们看到，组合仅与每个选法所含元素的个数有关，
而排列还要考虑元素在每一个排法中的次序.
例如，从四个字母\(a,b,c,d\)中选三个字母可以得到\(abc\)这样一种组合，
可以作以下六种不同的排列：\[
	abc, \quad
	acd, \quad
	bca, \quad
	bac, \quad
	cab, \quad
	cba.
\]

\subsection{排列组合的基本原理}
在讨论排列与组合的一般性命题之前，我们先通过几个例子来说明两个重要的原则.
\begin{enumerate}
	\item {\rm\bf 加法原理}：
	如果做一件事，完成它可以有\(n\)类办法，
	在第一类办法中有\(m_1\)种不同的方法，
	在第二类办法中有\(m_2\)种不同的方法，……，
	在第\(n\)类办法中有\(m_n\)种不同的方法，那么完成这件事共有\[
	N = m_1 + m_2 + \dotsb + m_n
	\]种不同的方法.

	\item {\rm\bf 乘法原理}：
	如果做一件事，完成它需要分成\(n\)个步骤，
	做第一步有\(m_1\)种不同的方法，
	做第二步有\(m_2\)种不同的方法，……，
	做第\(n\)步有\(m_n\)种不同的方法，那么完成这件事共有\[
	N = m_1 \times m_2 \times \dotsm \times m_n
	\]种不同的方法.
\end{enumerate}

\begin{example}
有10艘汽艇往返于利物浦与都柏林之间，问某人来回乘坐不同汽艇的方式有多少种？
\begin{solution}
去时有10种方式；对于其中每一种，因为不能乘坐同一条船，回来时有9种方式可选；
因此，一共有\(10 \times 9 = 90\)种方法来完成这两段路程.
\end{solution}
\end{example}

\begin{example}
3个旅行者来到一个小镇，镇上有4家旅店，若他们分别住不同的旅店，问投宿的方式有多少种？
\begin{solution}
第一个人可以有4种选择；
在他选定后，第二个人有3种选择；
从而这两个人共有\(4 \times 3\)种选择，
对于其中每一种选择，第三个人有2家旅店供选择；
所以，投宿的方式共有\(4 \times 3 \times 2 = 24\)种.
\end{solution}
\end{example}

我们现在来求从\(n\)个不同元素中一次取出\(k\)个的排列数.
这可以看成是用我们手上的\(n\)个不同元素去填满\(k\)个空位的不同方式的种数.

填第一个位置有\(n\)种方式，
因为可以取\(n\)个元素中的任意一个.
在这个位置用任意一种方式填好后，
填第二个位置有\(n-1\)种方式.
由于填第一个位置的每一种方式，都可与填第二个位置的每一种方式组合，
所以填前两个位置的方式有\(n(n-1)\)种.
前两个位置以任意一种方式填好后，
填第三个位置有\(n-2\)种方式.
同理，填前三个位置的方式共有\(n(n-1)(n-2)\)种.
继续这样的方法，我们注意到每填一个新的位置，就产生一个新的因子.
而且在每一步上，因子的个数总与剩余位置的个数相同；
于是，我们得出填满\(k\)个位置的方式种数等于\[
	\underbrace{n(n-1)(n-2)\dotsm[n-(k-1)]}_{k\ \text{个因子}}.
\]
这就是所求从\(n\)个元素一次取出\(k\)个元素的排列数，
我们可以利用阶乘记号将它表示为\[
	\frac{n!}{(n-k)!}.
\]

我们还可以推断出如下结论：
从\(n\)个元素一次取出全部\(n\)个元素的排列数为\(n!\).

以后我们用符号\(A_n^k\)表示从\(n\)个元素一次取出\(k\)个的排列数，即\begin{equation}
	A_n^k \defeq \frac{n!}{(n-k)!}.
\end{equation}
特别地，\(A_n^n \equiv n!\).

从\(n\)个元素一次取出\(k\)个元素的排列数也可用下面的思路求得.
按规定，我们用\(A_n^k\)代表从\(n\)个元素一次取出\(k\)个元素的排列数.
假设我们首先组成\(n\)个元素一次取出\(k-1\)个元素的所有排列，
那么这些排列一共有\(A_n^{k-1}\)种.
在这些排列的每一个的后面，我们放上剩下的\(n-(k-1)\)个元素中的任意一个；
每进行一次这样的操作，我们便得到\(n\)个元素一次取\(k\)个的一种排列，
因此，\(n\)个元素一次取\(k\)个的排列数为\(A_n^{k-1} \times (n-k+1)\)种，即\[
	A_n^k = A_n^{k-1} \times (n-k+1).
\]
在上式中用\(k-1\)代替\(k\)，我们得\[
	A_n^{k-1} = A_n^{k-2} \times (n-k+2);
\]
依次递推，直到\[
	A_n^2 = A_n^1 \times (n-1),
\]\[
	A_n^1 = n.
\]
将上述各式的等号左右两边分别相乘，且约去两边相同的因子，便得\[
	A_n^k = n(n-1)\dotsm(n-k+2)(n-k+1).
\]

接下来我们想求从\(n\)个不同的元素中一次取出\(k\)的组合数.
我们用符号\(C_n^k\)表示所求组合数.
每一个这样的组合都由一组\(k\)个不同的元素组成，
而这组元素本身又可以组成\(k!\)个不同的排列.
因此\(C_n^k \times k!\)便等于\(n\)个元素一次取\(k\)个的排列数，即\[
	C_n^k \times k! \equiv A_n^k
	= n(n-1)(n-2)\dotsm(n-k+2)(n-k+1);
\]于是\begin{align}
	C_n^k &= \frac{n(n-1)(n-2)\dotsm(n-k+2)(n-k+1)}{k!} \\
	&= \frac{n!}{k! (n-k)!}.
\end{align}

需要注意到，当\(k=n\)时，有\[
	A_n^n = \frac{n!}{(n-n)!} = \frac{n!}{0!} = n!,
\]\[
	C_n^n = \frac{n!}{n! (n-n)!} = \frac{n!}{n! 0!} = \frac{1}{0!} = 1;
\]
这说明，符号\(0!\)的取值应该等于\(1\).
这就是为什么我们在\hyperref[definition:数列.阶乘的定义]{阶乘的定义}中特别规定\(0!\equiv1\).
%特别地，规定：当\(n < k\)时，\(C_n^k = 0\).

\begin{example}
将\(m+n\)颗小球分为两袋，一袋含\(m\)颗小球，另一袋含\(n\)颗小球，求可能的分法种数.
\begin{solution}
不难看出，这样的分法种数，等于从\(m+n\)颗小球中一次取\(m\)颗的组合数，
如此，可将取出的\(m\)颗小球装入一袋，将剩下的\((m+n)-m=n\)颗小球装入另一袋.
因此，所求的分法种数为\[
	\frac{(m+n)!}{m! n!}.
\]

特别地，当\(m=n\)时，两个袋子中所含小球颗数相同.
如果认为“两个袋子没有次序”或者说“袋子互换，分法种数不变”，那么分法种数为\[
	\frac{(2n)!}{(n!)^2 2!}.
\]
\end{solution}
\end{example}

\begin{example}
将\(m+n+p\)颗小球分为三袋，且各袋分别含\(m,n,p\)颗小球，求可能的分法种数.
\begin{solution}
首先将全部小球分到两个口袋里，各袋分别含\(m,n+p\)颗小球，分法种数为\[
	\frac{(m+n+p)!}{m!(n+p)!};
\]
然后将第二袋中的\(n+p\)颗小球再分为两袋，各袋分别含\(n,p\)颗小球，分法种数为\[
	\frac{(n+p)!}{n! p!};
\]
所以，全部\(m+n+p\)颗小球分成三袋，各袋分别含\(m,n,p\)颗小球的分法种数为\[
	\frac{(m+n+p)!}{m!(n+p)!} \cdot \frac{(n+p)!}{n! p!}
	= \frac{(m+n+p)!}{m! n! p!}.
\]

特别地，当\(m=n=p\)时，三个袋子中所含小球颗数相同.
如果认为“三个袋子有次序”或者说“袋子互换，就得到新的分法”，那么分法种类为\[
	\frac{(3n)!}{(n!)^3};
\]
反之，如果认为“三个袋子没有次序”，那么分法种类为\[
	\frac{(3n)!}{(n!)^3 3!}.
\]
\end{solution}
\end{example}

到目前为止，我们考虑的元素（如小球）常常被看作是不同的；
但有的时候，所给元素中有一部分元素是相同的.
相同的元素是无法区分的，不管怎么排布这些元素，都对排法种数没有影响.

\begin{example}
排列\(n\)颗小球，其中\(p\)颗是红球，\(q\)颗是黄球，\(r\)颗是蓝球，
剩余的\(n-p-q-r\)颗小球具有互不相同的彩色花纹，求可能的排列数.
\begin{solution}
当提到一组小球具有某种特征（如小球是红色的）时，
我们认为这组小球是相同的、无法区分的.
基于这条约定，我们来求解可能的排列数.

设所求排列数为\(x\).
如果用\(p\)颗花纹各异的小球代替上述\(p\)颗红球，
那么对于\(x\)个排列中的任一个，
不改变其他小球的位置，我们可以作\(p!\)个新排列；
于是如果对\(x\)个排列中的每一个，都作这样的替换，
我们就得到\(x \cdot p!\)种排列.
同理，如果在此基础上继续用\(q\)颗花纹各异的小球代替\(q\)颗黄球，会得到\(x \cdot p! \cdot q!\)种排列.
再用\(r\)颗花纹各异的小球代替\(r\)颗蓝球，会得到\(x \cdot p! \cdot q! \cdot r!\)种排列.
现在，这\(n\)颗小球全都互不相同了，它们的全排列数为\(n!\)，于是有\[
	n! = x \cdot p! \cdot q! \cdot r!,
\]即有\[
	x = \frac{n!}{p! q! r!}.
\]
\end{solution}
\end{example}

\begin{example}
用数字\(1,2,3,4,3,2,1\)可以组成多少个七位数，且奇数总在奇数位上.
\begin{solution}
奇数\(1,3,3,1\)有\(\frac{4!}{2! 2!}\)种方式排列在它们的四个位置上；
偶数\(2,4,2\)有\(\frac{3!}{2!}\)种方式排列在它们的三个位置上；
奇数的每一种排列都能与偶数的每一种排列组合，因此，所求排列数为\[
	\frac{4!}{2! 2!} \times \frac{3!}{2!} = 18.
\]
\end{solution}
\end{example}

现在我们来求从\(n\)个元素中一次取出\(k\)个的排列数，
其中，取出的元素可以重复任意多次.
我们可以把这个问题考虑为这样的情况：
有\(n\)个不同的元素，去填满\(k\)个位置，并且每一个元素都可以任意次地重复使用.
这样的排列一共有多少种呢？
显而易见的是，填第一个位置有\(n\)种方式.
当第一个位置填好后，第二个位置仍有\(n\)种填法，
这是因为占据第一个位置的那个元素可以在第二个位置上重复使用.
因此，填满前两个位置的方式一共有\(n \times n = n^2\)种.
同理，填第三个位置还是有\(n\)种方式；
所以，填满前三个位置的方式一共有\(n^3\)种.
按这样的方法进行，我们注意到\(n\)的指数总与剩余位置的个数相同；
由此可知，一共有\(n^k\)种方式填满所给的\(k\)个位置.

\begin{example}
将5件奖品颁发给4位选手，如果每位选手都可以得到全部奖品，
问一共有多少种分发方式.
\begin{solution}
第一件奖品可以有4种颁发方式.
第二件奖品仍有4种颁发方式，
这是因为得到第一件奖品的那位选手仍可以获得第二件奖品.
因此，前两件奖品有\(4^2\)种颁发方式，
前三件奖品有\(4^3\)种颁发方式，以此类推，
全部5件奖品有\(4^5=1024\)种颁发方式.
\end{solution}
\end{example}

我们再来求从\(n\)个元素中一次取出若干个以至于全部元素的所有选择方式的种数.

每一个元素都有两种处理方式，要么取出，要么不取.
并且，任意一个元素的每一种处理方式，都可以与任何另外一个元素的每一种处理方式组合，
所以，\(n\)个元素便有\[
	\underbrace{2 \times 2 \times \dotsm \times 2}_{n\ \text{个}}
	= 2^n
\]种处理方式.
但是这里包括了“\(n\)个元素都不取”这样一种选择，
除去这种情况，\(n\)个元素的取法共有\(2^n-1\)种.
有时候将这称为“\(n\)个元素的\DefineConcept{全组合数}”.

\begin{example}
某人有6位朋友，如果他要邀请至少一位朋友吃饭，有多少种不同的请法.
\begin{solution}
他必从6位朋友中选部分或全部，故有\(2^6-1=63\)种请法.
\end{solution}
\end{example}

\begin{example}
求从\(p+q+r+\dotsb\)个元素中取出至少一个元素的取法种数，
其中\(p\)个元素是相同的一类，\(q\)个元素是相同的另一类，
\(r\)个元素是相同的第三类，等等.
\begin{solution}
这\(p\)个元素可以有\(p+1\)种处理方式，因为我们可以从中取出\(0,1,2,\dotsc,p\)个；
同理，这\(q\)个元素可以有\(q+1\)种处理方式，这\(r\)个元素可以有\(r+1\)种处理方式；以此类推.
因此，所有的元素便有\[
	(p+1)(q+1)(r+1)\dotsm
\]种处理方式.
但这里包括了任何元素都不取的一种选择，
除去这种情况，所求取法种数为\[
	-1+(p+1)(q+1)(r+1)\dotsm.
\]
\end{solution}
\end{example}

%\begin{theorem}[抽屉原理]\label{theorem:排列组合.抽屉原理}
%抽屉原理有以下几种形式：
%\begin{enumerate}
%\item 把\(n+1\)个元素放入\(n\)个集合内，则一定有一个集合里有两个或两个以上的元素.
%\item 把\(m\)个元素任意放入\(n\ (n<m)\)个集合里，则一定有一个集合里至少有\(k\)个元素，其中\[
%k = \left\{ \begin{array}{ll}
%m/n, & m \pmod n = 0, \\
%\floor{m/n}+1, & m \pmod n \neq 0.
%\end{array} \right.
%\]
%\item 把无穷多个元素放入有限个集合里，则一定有一个集合里含有无穷多个元素.
%\end{enumerate}
%\end{theorem}
%\hyperref[theorem:排列组合.抽屉原理]{抽屉原理}有时候也称作\DefineConcept{鸽巢原理}；
%因它最先是由狄利克雷明确地提出来的，因此也可称其为\DefineConcept{狄利克雷原理}.


\subsection{组合数的性质}
\begin{property}\label{theorem:组合数性质1}
\(C_n^k = C_n^{n-k}\).
\begin{proof}
\(
C_n^{n-k}
= \frac{n!}{(n-k)! [n-(n-k)]!}
= \frac{n!}{k! (n-k)!}
= C_n^k
\).
\end{proof}
\end{property}
这就是说，从\(n\)个元素中一次取出\(k\)个的组合数，
等于从\(n\)个元素中一次取出\(n-k\)个的组合数.
像这样的两类组合称为\DefineConcept{互补}.

\cref{theorem:组合数性质1} 对于简化运算有很大用处.

可以注意到，如果我们把所有组合数\(C_n^k\)按照\(n\)相同的写成一行，再按\(k\)从小到大排列，
就能得到一个美妙的三角形，如\cref{figure:排列组合.杨辉三角} 所示.
在这个三角形中，在任意一行中，除开两端的数字1以外，所有“中间”数字都是它“肩上”两个数字的和.
像这样表示组合数的关系的图示叫做\DefineConcept{杨辉三角}或\DefineConcept{帕斯卡三角}.
\begin{figure}
	\centering
	\begin{tikzpicture}[
		bino/.style={
			% The shape:
			circle,
			% The size:
			minimum size=6mm,
			% The border:
			very thick,
			draw=red!50!black!50, % 50% red and 50% black,
			% and that mixed with 50% white
			% The filling:
			top color=white, % a shading that is white at the top...
			bottom color=red!50!black!20, % and something else at the bottom
			% Font
			%font=\itshape
	}, node distance=5mm]
		\node(C00)[bino]{1};
		\node(C10)[bino,below=of C00]{1};
		\node(C11)[bino,right=of C10]{1};
		\node(C20)[bino,below=of C10]{1};
		\node(C21)[bino,right=of C20]{2};
		\node(C22)[bino,right=of C21]{1};
		\node(C30)[bino,below=of C20]{1};
		\node(C31)[bino,right=of C30]{3};
		\node(C32)[bino,right=of C31]{3};
		\node(C33)[bino,right=of C32]{1};
		\node(C40)[bino,below=of C30]{1};
		\node(C41)[bino,right=of C40]{4};
		\node(C42)[bino,right=of C41]{6};
		\node(C43)[bino,right=of C42]{4};
		\node(C44)[bino,right=of C43]{1};
		\draw(C00)--(C10)--(C20)--(C30)--(C40)
			(C00)--(C11)--(C22)--(C33)--(C44);
		\draw(C10)--(C21)--(C11)
			(C20)--(C31)--(C21)--(C32)--(C22)
			(C30)--(C41)--(C31)--(C42)--(C32)--(C43)--(C33);
	\end{tikzpicture}
	\caption{}
	\label{figure:排列组合.杨辉三角}
\end{figure}

下面我们给出对杨辉三角所指出的经验规律的严格证明.
\begin{property}\label{theorem:组合数性质2}
\(C_{n-1}^{k-1} + C_{n-1}^k = C_n^k\).
\begin{proof}
直接计算得
\begin{align*}
	C_{n-1}^{k-1} + C_{n-1}^k
	&= \frac{(n-1)!}{(k-1)! (n-k)!} + \frac{(n-1)!}{k! (n-k-1)!} \\
	&= \frac{(n-1)!}{(k-1)! (n-k-1)!} \left( \frac{1}{n-k} + \frac{1}{k} \right) \\
	&= \frac{(n-1)!}{(k-1)! (n-k-1)!} \cdot \frac{n}{(n-k)k} \\
	&= \frac{n!}{k! (n-k)!}
	= C_n^k. \qedhere
\end{align*}
\end{proof}
\end{property}
因此，在\(n\)不太大的时候，我们可以直接画出杨辉三角，从图中找到\(C_n^k\)的数值.

\begin{property}\label{theorem:组合数性质3}
\(\sum_{i=0}^n C_n^i = 2^n\).
\begin{proof}
当\(n=0\)时，\(\sum_{i=0}^0 C_0^i = C_0^0 = \frac{0!}{0! \cdot 0!} = 1 = 2^0\)成立.
假设\(n=k\)时，结论仍成立，即\[
\sum_{i=0}^k C_k^i
= C_k^0 + C_k^1 + \dotsb + C_k^k = 2^k.
\]那么\[
\begin{array}{*{14}{c}}
& C_k^0 &+& C_k^1 &+& \dotsb &+& C_k^{k-1} &+& C_k^k && &=& 2^k \\
+) & && C_k^0 &+& \dotsb &+& C_k^{k-2} &+& C_k^{k-1} &+& C_k^k &=& 2^k \\ \hline
& C_k^0 &+& C_{k+1}^1 &+& \dotsb &+& C_{k+1}^{k-1} &+& C_{k+1}^k &+& C_k^k &=& 2 \cdot 2^k
\end{array}
\]又因为\(C_k^0 = C_{k+1}^0 = C_k^k = C_{k+1}^{k+1} = 1\)，所以\[
\sum_{i=0}^{k+1} C_{k+1}^i = 2^{k+1}
\]成立.
\end{proof}
\end{property}

\begin{property}\label{theorem:组合数性质4}
\(\sum_{k=0}^n (-1)^k C_n^k = 0\).
\end{property}

\begin{property}\label{theorem:组合数性质5}
\(\sum_{k=0}^{\floor{n/2}} C_n^{2k} = 2^{n-1}\).
\end{property}
\begin{property}\label{theorem:组合数性质6}
\(\sum_{k=0}^{\floor{(n-1)/2}} C_n^{2k+1} = 2^{n-1}\).
\end{property}

\begin{property}\label{theorem:组合数性质7}
\(C_{n+m}^k = \sum_{r=0}^{k} C_n^r C_m^{k-r}\).
\end{property}

\begin{property}\label{theorem:组合数性质8}
\(\sum_{k=0}^n (C_n^k)^2 = C_{2n}^n\).
\end{property}

\begin{property}\label{theorem:组合数性质9}
\(C_n^{r_1} C_{n-r_1}^{r_2} \dotsm C_{n-(r_1+r_2+\dotsb+r_{k-1})}^{r_k}
= \frac{n!}{r_1! r_2! \dotsm r_k!}\).
\end{property}

\begin{example}
求：当\(k\)取何值时，\(C_n^k\)最大.
\begin{solution}
我们首先研究几个特例.
注意到\[
	C_2^0 = 1, \qquad
	C_2^1 = 2, \qquad
	C_2^2 = 1,
\]\[
	C_3^0 = 1, \qquad
	C_3^1 = 3, \qquad
	C_3^2 = 3, \qquad
	C_3^3 = 1,
\]
似乎可以总结出如下两条规律：
\begin{itemize}
	\item 随着\(k\)逐渐增加，\(C_n^k\)先逐渐增大，再逐渐减小.
	\item 有的组合数在取邻近的两个不同的\(k\)值时，可能取得同样的最大值.
\end{itemize}
下面我们为这两条经验规律给出严格的证明.

因为\[
	C_n^k = \frac{n(n-1)(n-2)\dotsm(n-k+2)(n-k+1)}{1\cdot2\cdot3\dotsm(k-1)k},
\]\[
	C_n^{k-1} = \frac{n(n-1)(n-2)\dotsm(n-k+2)}{1\cdot2\cdot3\dotsm(k-1)},
\]
所以\[
	C_n^k = C_n^{k-1} \cdot \frac{n-k+1}{k}
	= C_n^{k-1} \cdot \left( \frac{n+1}{k} - 1 \right).
\]
令\(C_n^k > C_n^{k-1}\)，化简得\[
	\frac{n+1}{k} - 1 > 1,
\]
考虑到\(0 \leq k \leq n\)，
上式又可化简为\(2k < n+1\)，
即\(k < (n+1)/2\).
这就是说，当\(0 \leq k < (n+1)/2\)时，
随着\(k\)逐渐增加，\(C_n^k\)逐渐增加；
当\((n+1)/2 < k \leq n\)时，
随着\(k\)逐渐增加，\(C_n^k\)逐渐减小.
由此可知，当\(k\)取不大于\((n+1)/2\)的最大整数\(\floor{(n+1)/2}\)时，\(C_n^k\)取得最大值.

若\(n\)为偶数，不妨设\(n = 2m\ (m\in\mathbb{N})\)，则\[
	\frac{n+1}{2} = \frac{2m+1}{2}
	= m+\frac{1}{2}.
\]
于是，只要取\(k = m = n/2\)，我们便得\(C_n^k\)的最大值：\[
	C_n^{\frac{n}{2}}.
\]

若\(n\)为奇数，不妨设\(n = 2m+1\ (m\in\mathbb{N})\)，则\[
	\frac{n+1}{2} = \frac{2m+2}{2} = m+1.
\]
于是，只要取\(k = m+1 = (n+1)/2\)，我们便得\(C_n^k\)的最大值；
但是，由\cref{theorem:组合数性质1} 可知，\[
	C_n^{\frac{n+1}{2}}
	= C_n^{n-\frac{n+1}{2}}
	= C_n^{\frac{n-1}{2}};
\]
于是，在取\(k = (n-1)/2 = m\)时，也可取得\(C_n^k\)的最大值.
也就是说，当\(k\)取\((n\pm1)/2\)时，我们便得\(C_n^k\)的最大值：\[
	C_n^{\frac{n+1}{2}}
	= C_n^{\frac{n-1}{2}}.
\]

综上所述，我们有\begin{equation}
	\max_{0 \leq k \leq n} C_n^k = \left\{ \begin{array}{cl}
		C_n^{n/2}, & \text{$n$是偶数}, \\
		C_n^{(n-1)/2} = C_n^{(n+1)/2}, & \text{$n$是奇数}.
	\end{array} \right.
\end{equation}
\end{solution}
\end{example}

\section{杜克路}
%@see: https://doc.sagemath.org/html/en/reference/combinat/sage/combinat/path_tableaux/dyck_path.html
%@see: https://mathweb.ucsd.edu/~duqiu/files/Nankai18.pdf
%@see: https://users.monash.edu/~heikod/cpg2020/CPGparts1and2.pdf
%@see: https://pages.stat.wisc.edu/~callan/papers/polygon_dissections/polygon_dissections.pdf
\begin{definition}
%@see: 《组合数学及其应用》（曾光） P87 定义2.28（格路径）
在二维平面\(\mathbb{Z}^2\)沿整数格点按一定步法行走的路径称为\DefineConcept{格路径}，
把相邻两个格点之间的线段称为格路径的\DefineConcept{步}，
所走的步数称为格路径的\DefineConcept{长度}.
\end{definition}
\begin{definition}
%@see: 《组合数学及其应用》（曾光） P87 定义2.29（Dyck路）
长为\(2n\)的\DefineConcept{杜克路}（Dyck path）
%@see: https://mathworld.wolfram.com/DyckPath.html
是指只用“上步”\((1,1)\)和“下步”\((1,-1)\)，
从\((0,0)\)到\((2n,0)\)的
不允许走到\(x\)轴下方的格路径，
把\(n\)称为杜克路的\DefineConcept{阶}.
\end{definition}
\begin{definition}
把\begin{equation*}
	\frac{(2n)!}{(n+1)! \cdot n!}
	\quad(n=1,2,\dotsc)
\end{equation*}
称为“第\(n\)个\DefineConcept{卡塔兰数}（Catalan number）”，
记作\(C_n\).
%@see: https://mathworld.wolfram.com/CatalanNumber.html
\end{definition}
\begin{table}[htb]
	\centering
	\begin{tblr}{c|*9c}
		\hline
		\(n\) & \(1\) & \(2\) & \(3\) & \(4\) & \(5\) & \(6\) & \(7\) & \(8\) & \(9\) \\
		\hline
		\(C_n\) & \(1\) & \(2\) & \(5\) & \(14\) & \(42\) & \(132\)
		& \(429\) & \(1430\) & \(4862\) \\
		\hline
	\end{tblr}
	\caption{前9个卡塔兰数}
%@Mathematica: Table[CatalanNumber[n], {n, 1, 10}]
\end{table}
\begin{theorem}
%@see: 《组合数学及其应用》（曾光） P88 定理2.26
全体\(n\)阶杜克路的基数等于第\(n\)个卡塔兰数.
\end{theorem}

\section{二项式定理}
利用乘法分配律，我们能够很轻松地得到\DefineConcept{完全平方和公式}%
\begin{equation}
	(a + b)^2 = a^2 + 2ab + b^2,
\end{equation}
和\DefineConcept{完全立方和公式}%
\begin{equation}
	(a + b)^3 = a^3 + 3 a^2 b + 3 a b^2 + b^3.
\end{equation}

我们不禁想要知道一般的二项式\((a+b)^n\)应该如何展开.

\subsection{正整指数}
我们注意到，利用乘法分配律可以得到\begin{align*}
	(x+a_1)(x+a_2)
	&= x(x+a_2) + a_1(x+a_2) \\
	&= x^2 + a_2x + a_1x + a_1a_2 \\
	&= x^2 + (a_1+a_2)x + a_1a_2;
\end{align*}
类似地，有\[
	(x+a_1)(x+a_2)(x+a_3)
	= x^3 + (a_1+a_2+a_3)x^2 + (a_1a_2+a_1a_3+a_2a_3)x + a_1a_2a_3;
\]\begin{align*}
	(x+a_1)(x+a_2)(x+a_3)(x+a_4)
	&= x^4 + (a_1+a_2+a_3+a_4)x^3 \\
		&\hspace{20pt}+ (a_1a_2+a_1a_3+a_1a_4+a_2a_3+a_2a_4+a_3a_4)x^2 \\
		&\hspace{20pt}+ (a_1a_2a_3+a_1a_2a_4+a_1a_3a_4+a_2a_3a_4)x^3 + a_1a_2a_3a_4.
\end{align*}
从这些结果里，我们可以总结出如下经验规律：
\begin{itemize}
	\item 等号右边的项数比左边二项因子的个数多1.
	\item 第一项的\(x\)的指数等于二项因子的个数，
	以后各项\(x\)的指数依次比前面一项小1.
	\item 第一项的系数为1；第二项的系数是数\(a,b,c,\dotsc\)的和；
	第三项的系数是从这\(n\)个数里一次取2个相乘的积的和；
	第四项的系数是从这\(n\)个数里一次取3个相乘的积的和；
	以此类推；最后一项是所有这\(n\)个数的乘积.
\end{itemize}

利用数学归纳法.
假设这些规律在左边有\(n-1\)个二项因子的情况下适用，
即设\[
	(x+a_1)(x+a_2)\dotsm(x+a_{n-1})
	= x^{n-1}+p_1 x^{n-2}+p_2 x^{n-3}+\dotsb+p_{n-1},
\]
其中\[
	p_1 = a_1+a_2+\dotsb+a_{n-1},
	p_2 = a_1a_2+\dotsb+a_2a_3+\dotsb,
	\dotsc,
	p_{n-1} = a_1 a_2 \dotsm a_{n-1}.
\]
在等式两边再乘以一个因子\(x+a_n\)，则有\begin{equation}\label{equation:二项式定理.更一般的二项式的展开式}
	\begin{split}
	(x+a_1)(x+a_2)\dotsm(x+a_{n-1})(x+a_n)
	&= x^n + (p_1+a_n)x^{n-1}
		+ (p_2+p_1a_n)x^{n-2} \\
		&\hspace{20pt}+ (p_3+p_2a_n)x^{n-3}
		+ \dotsb + p_{n-1} a_n.
	\end{split}
\end{equation}
由于\(p_1+a_n = (a_1+a_2+\dotsb+a_{n-1})+a_n\)
是\(n\)个数\(\AutoTuple{a}{n}\)的和，
\(p_2+p_1a_n = p_2+(a_1+a_2+\dotsb+a_{n-1})a_n\)
是\(n\)个数\(\AutoTuple{a}{n}\)一次选两个的乘积的和，
\(p_3+p_2a_n = p_3+(a_1a_2+\dotsb+a_2a_3+\dotsb)a_n\)
是\(n\)个数\(\AutoTuple{a}{n}\)一次选三个的乘积的和；
以此类推；\(p_{n-1} a_n = (a_1 a_2 \dotsm a_{n-1})a_n\)
是所有\(n\)个数\(\AutoTuple{a}{n}\)的乘积.
因此，上述规律对任意多个二项因子的乘积都成立.

在\cref{equation:二项式定理.更一般的二项式的展开式} 中，
它的第一项的系数是\(1 = C_n^0\)；
它的第二项系数\(p_1+a_n\)的项数等于\(n\)，即从\(n\)个元素中取出一个的取法\(C_n^1\)；
它的第三项系数\(p_2+p_1a_n\)的项数等于从\(n\)个元素中取出两个的取法\(C_n^2\)；
它的第四项系数\(p_3+p_2a_n\)的项数等于从\(n\)个元素中取出三个的取法\(C_n^3\)；
以此类推；最后一项的系数\(p_{n-1} a_n\)只有一项，等于从\(n\)个元素中取出全部\(n\)个的取法\(C_n^n\).
因此，如果我们令\[
	a_1 = a_2 = a_3 = \dotsb = a_{n-1} = a_n = a,
\]
那么有
\begin{equation}\label{equation:二项式定理.二项式的展开式}
	(x+a)^n
	= C_n^0 a^0 x^n + C_n^1 a x^{n-1} + C_n^2 a^2 x^{n-2}
	+ \dotsb + C_n^{n-1} a^{n-1} x + C_n^n a^n.
\end{equation}
这就是\DefineConcept{二项式定理}.
我们把\cref{equation:二项式定理.二项式的展开式} 等号右边的部分\[
	\sum_{k=0}^n C_n^k a^k x^{n-k}
\]称为“\((x+a)^n\)的展开式”；
把第\(k+1\)项\[
	C_n^k a^k x^{n-k}
\]称为“\((x+a)^n\)的\DefineConcept{通项}或\DefineConcept{一般项}”.
可以注意到，在展开式的任意一项\[
	C_n^k a^k x^{n-k}
	\quad(k=0,1,2,\dotsc,n)
\]中，\(a\)的指数都等于组合符号\(C_n^k\)的右上标\(k\)，
而\(x\)与\(a\)的指数之和等于组合符号\(C_n^k\)的右下标\(n\).

如果我们用\((-a)\)代替\(a\)，那么\cref{equation:二项式定理.二项式的展开式} 会变为\[
	(x-a)^n = C_n^0 (-a)^0 x^n + C_n^1 (-a) x^{n-1} + C_n^2 (-a)^2 x^{n-2}
	+ \dotsb + C_n^{n-1} (-a)^{n-1} x + C_n^n (-a)^n.
\]
可以看出，\((x+a)^n\)与\((x-a)^n\)的展开式各项在绝对值上是相等的，即\[
	\abs{C_n^k (-a)^k x^{n-k}}
	= \abs{C_n^k a^k x^{n-k}}.
\]
但是在\((x-a)^n\)的展开式里，各项依次地正负交错，
最后一项的正负号则依\(n\)为奇数还是偶数确定.

\begin{example}
求\((1+x)^n\)展开式的各项系数之和.
\begin{solution}
由\cref{equation:二项式定理.二项式的展开式} 有，\[
	(1+x)^n = 1+C_n^1 x+C_n^2 x^2+\dotsb+C_n^n x^n.
\]
令\(x=1\)，上式就变为\[
	1+C_n^1+C_n^2+\dotsb+C_n^n = 2^n.
\]
\end{solution}
这也算是对\cref{theorem:组合数性质3} 的另一种证明方法.
\end{example}

\begin{example}
证明：在\((1+x)^n\)的展开式中，奇位项系数之和等于偶位项系数之和.
\begin{proof}
在恒等式\[
	(1+x)^n = 1+C_n^1 x+C_n^2 x^2+C_n^3 x^3+C_n^4 x^4+C_n^5 x^5+\dotsb+C_n^n x^n
\]中，取\(x=-1\)得\[
	0 = 1-C_n^1+C_n^2-C_n^3+C_n^4-C_n^5\dotsb+(-1)^n C_n^n;
	\eqno(1)
\]
取\(x=1\)得\[
	2^n = 1+C_n^1+C_n^2+C_n^3+C_n^4+C_n^5+\dotsb+C_n^n.
	\eqno(2)
\]

将(1)式与(2)式相加，得\[
	2^n = 2(1+C_n^2+C_n^4+\dotsb)
	= 2 \sum_{\substack{
		0 \leq 2k \leq n \\
		k=0,1,2\dotsc
	}} C_n^{2k},
\]
于是偶位项系数之和为\[
	1+C_n^2+C_n^4+\dotsb = 2^{n-1}.
\]

将(2)式与(1)式相减，得\[
	2^n = 2(C_n^1+C_n^3+C_n^5+\dotsb)
	= 2 \sum_{\substack{
		1 \leq 2k+1 \leq n \\
		k=0,1,2,\dotsc
	}} C_n^{2k+1},
\]
于是奇位项系数之和为\[
	C_n^1+C_n^3+C_n^5+\dotsb = 2^{n-1}.
\]

综上所述，我们有\[
	1+C_n^2+C_n^4+\dotsb
	= C_n^1+C_n^3+C_n^5+\dotsb
	= 2^{n-1},
\]
也就是说，偶位项系数之和、奇位项系数之和两者都等于\(2^{n-1}\).
\end{proof}
\end{example}

\subsection{有理指数}
在上一小节，我们研究了指数为正整数的二项式定理.
现在我们来考虑当指数为负数或分数时，二项式定理是否仍然成立.

设\[
	(1+x)^m
	= 1 + mx + \frac{m(m-1)}{1\cdot2}x^2
	+ \frac{m(m-1)(m-2)}{1\cdot2\cdot3}x^3
	+ \dotsb
\]与\[
	(1+x)^n
	= 1 + nx + \frac{n(n-1)}{1\cdot2}x^2
	+ \frac{n(n-1)(n-2)}{1\cdot2\cdot3}x^3
	+ \dotsb
\]的乘积为\[
	1 + A_1 x + A_2 x^2 + A_3 x^3 + \dotsb.
\]
显然，\(A_1,A_2,A_3,\dotsc\)是\(m\)与\(n\)的函数，
所以，在任何特定的情况下，
\(A_1,A_2,A_3,\dotsc\)的实际取值依赖于\(m\)与\(n\)的值.
但是，在上述两个乘数中，\(x\)的幂的系数结合成\(A_1,A_2,A_3,\dotsc\)的方式，是与\(m,n\)无关的.
换句话说，无论\(m\)与\(n\)取什么值，\(A_1,A_2,A_3,\dotsc\)总保持同样的形式.
所以，如果对任意一组\(m,n\)的值我们能决定\(A_1,A_2,A_3,\dotsc\)的形式，
那么就能做出结论，对于\(m,n\)的所有值，\(A_1,A_2,A_3,\dotsc\)都有同样的形式.

上面阐述的这个原则，作为一个“等价形式的不变性”的例子，经常会被提到.
目前，我们只要承认这样的事实：
在任何代数乘积里，无论所牵涉的量是整数还是分数，是正数还是负数，其结果的形式总不变.
我们将运用这一原理，为有理指数的二项式定理给出一般性的证明.
这一证明是欧拉给出的.

我们先来证明指数为正分数的二项式定理.
%TODO

\section{常见代数公式}

\begin{theorem}[平方差、立方差公式]
\[
a^2 - b^2 = (a-b)(a+b),
\]\[
a^3 - b^3 = (a-b)(a^2+ab+b^2),
\]

推广一下可得，当\(n \in \mathbb{N}^+\)时，有\[
a^n - b^n = (a-b) \sum_{k=0}^{n-1}{a^{n-1-k} b^k}
= (a-b)(a^{n-1} + a^{n-2} b + \dotsb + b^{n-1}).
\]
\end{theorem}

设\(n\)是正整数，则\(x^n-1\)总可被\(x-1\)整除，且\[
	\frac{x^n-1}{x-1}
	= x^{n-1} + \frac{x^{n-1}-1}{x-1}.
\]

\section{初等代数方程}
我们在生活中，经常会遇到这样的问题：
一些量的取值已知，而另一些量的取值未知，
这些已知量和未知量的数量关系已知，
求解未知量的取值范围.
例如，已知一个正常人总有两条腿，
假设一群人站在操场上，
你数出他们的腿共有20条，
要求这群人的人数.
那么你可以用字母\(x\)表示这群人的人数，
因为一个正常人有两条腿，所以这群人的腿一共有\(2x\)条，
也就是说\(2x=20\).
于是我们可以计算得出\(x=\frac{20}{2}=10\)，
那么操场上有10个人.
像这样，我们就可以把很多问题归结为求解未知量的取值范围的问题.

下面，我们给出“方程”的定义.

我们知道，对于任意一条合式公式\(\phi\)，
我们总是可以用受限变元\(x\)代替\(\phi\)中的某个自由变元\(a\)，
得到一个新的公式\(\phi(x)\).
我们把\(\phi(x)\)称为“关于未知量\(x\)的\DefineConcept{方程}（algebraic equation）”，
%@see: https://mathworld.wolfram.com/AlgebraicEquation.html
%@see: https://mathworld.wolfram.com/Unknown.html
把类\[
	\Set{ x \given \phi(x) }
\]称为“方程\(\phi(x)\)的\DefineConcept{解}”.

特别地，如果\(X\)是集合，那么我们把集合\[
	\Set{ x \in X \given \phi(x) }
\]称为“方程\(\phi(x)\)的\(X\)~\DefineConcept{解}”.

例如，对于给定的方程\[
	x(x-1)(x^2-2)(x^2+1)=0,
\]
当\(X=\mathbb{Z}^+\)时，我们可以解出它的\emph{正整数}解\(\{1\}\)；
当\(X=\mathbb{Q}\)时，我们可以解出它的\emph{有理数}解\(\{0,1\}\)；
当\(X=\mathbb{R}\)时，我们可以解出它的\emph{实数}解\(\{0,1,\pm\sqrt2\}\)；
当\(X=\mathbb{C}\)时，我们可以解出它的\emph{复数}解\(\{0,1,\pm\sqrt2,\pm\iu\}\).

如果\[
	\Set{ x \in X \given \phi(x) } = \emptyset,
\]
那么称“方程\(\phi(x)\)没有\(X\)~\DefineConcept{解}”.

%@see: https://mathworld.wolfram.com/VietasFormulas.html
%@see: https://davidaltizio.web.illinois.edu/Vietas%20Formulas.pdf
\subsection{一元二次方程}
一元二次方程的一般形式为：
\begin{equation}\label[quadratic-equation]{equation:一元二次方程.一元二次方程的一般形式}
	ax^2 + bx + c = 0, \quad a \neq 0,
\end{equation}
其中，\(ax^2\)称为\DefineConcept{二次项}，
\(bx\)称为\DefineConcept{一次项}，
\(c\)称为\DefineConcept{常数项}，
把\(a\)、\(b\)、\(c\)统称为“\cref{equation:一元二次方程.一元二次方程的一般形式} 的\DefineConcept{系数}”.

\cref{equation:一元二次方程.一元二次方程的一般形式} 两端同除以\(a\)，得\[
	x^2 + \frac{b}{a} x + \frac{c}{a} = 0,
\]
配方，得\[
	\left( x + \frac{b}{2a} \right)^2 + \left( \frac{c}{a} - \frac{b^2}{4a^2} \right) = 0,
\]
移项，再开方，得\[
	x = -\frac{b}{2a} \pm \sqrt{\frac{b^2}{4a^2} - \frac{c}{a}}
	= -\frac{b}{2a} \pm \sqrt{\frac{b^2-4ac}{4a^2}}
	= \frac{-b \pm \sqrt{b^2-4ac}}{2a}.
\]
于是我们得到一元二次方程\(ax^2 + bx + c = 0\ (a\neq0)\)的两个解\[
	x_1 = \frac{-b + \sqrt{b^2-4ac}}{2a},
	\qquad
	x_2 = \frac{-b - \sqrt{b^2-4ac}}{2a}.
\]

\begin{theorem}
记\(\Delta \defeq b^2-4ac\)，
称之为\cref{equation:一元二次方程.一元二次方程的一般形式}
的\DefineConcept{判别式}（{\rm discriminant}）.
\begin{itemize}
	\item 当\(\Delta > 0\)时，它有两个不同的实根\[
		x = \frac{-b \pm \sqrt{\Delta}}{2a}.
	\]
	\item 当\(\Delta = 0\)时，它有两个相同的实根\[
		x = -\frac{b}{2a}.
	\]
	\item 当\(\Delta < 0\)时，它有一对共轭复根\[
		x = \frac{-b \pm \iu \sqrt{-\Delta}}{2a}.
	\]
\end{itemize}
\end{theorem}

\begin{theorem}[韦达定理]
设\(x_1,x_2\)是\cref{equation:一元二次方程.一元二次方程的一般形式} 的两个根，
则有\[
	x_1 + x_2 = -\frac{b}{a},
	\qquad
	x_1 \cdot x_2 = \frac{c}{a}.
\]
\begin{proof}
因为\(x_1,x_2\)是一元二次方程\(ax^2 + bx + c = 0\)的两个根，
所以原方程可化为\[
	a(x - x_1)(x - x_2) = 0
	\quad\text{或}\quad
	a x^2 - a (x_1 + x_2) x + a x_1 x_2 = 0.
\]
将上式与\cref{equation:一元二次方程.一元二次方程的一般形式} 比较可得\[
	b = -a (x_1 + x_2),
	\qquad
	c = a x_1 x_2.
\]
整理得\(x_1 + x_2 = -\frac{b}{a}, x_1 \cdot x_2 = \frac{c}{a}\).
\end{proof}
\end{theorem}

\subsection{一元三次方程}
对于一般的一元三次方程\begin{equation}\label[cubic-equation]{equation:一元三次方程.一元三次方程的一般形式}
	ax^3+bx^2+cx+d=0 \quad(a\neq0),
\end{equation}
我们总可通过以下步骤将其化为标准形式.

首先在等号两边同除以\(a\)，得\[
	x^3+\frac{b}{a}x^2+\frac{c}{a}x+\frac{d}{a}=0,
\]
再令\(x=y-\frac{b}{3a}\)，得\[
	\left(y-\frac{b}{3a}\right)^3+\frac{b}{a}\left(y-\frac{b}{3a}\right)^2+\frac{c}{a}\left(y-\frac{b}{3a}\right)+\frac{d}{a}=0,
\]
整理得\begin{equation}
	y^3+py+q=0,
\end{equation}
其中\[
	p = \frac{3ac-b^2}{3a^2}, \qquad
	q = \frac{2b^3}{27a^3}-\frac{bc}{3a^2}+\frac{d}{a}.
\]

\begin{theorem}[卡丹公式]
\def\a{-\frac{q}{2}}%
\def\d{\frac{q^2}{4}+\frac{p^3}{27}}
\def\b{\sqrt{\d}}%
\def\c#1{\sqrt[3]{\a#1\b}}%
形如\[
	x^3 + px + q = 0 \quad (p,q \in \mathbb{C})
\]的一元三次方程的解为\[
	x = \c{+}+\c{-}.
\]

令\[
	\alpha=\c{+}, \qquad \beta=\c{-}.
\]
总成立\[
	\alpha \beta = -\frac{p}{3}.
\]

当\(p,q\in\mathbb{R}\)时，判别式\[
	\Delta \defeq -108\left(\d\right) = -27q^2-4p^3
\]的正负号决定了\(x^3+px+q=0\)的根的性质：\begin{enumerate}
	\item 当\(\Delta>0\)时，方程的三个根是各不相同的实根.
	\item 当\(\Delta=0\)时，\begin{enumerate}
		\item 如果\(p=q=0\)，则方程有三重实根；
		\item 如果\(p\neq0\)且\(q\neq0\)，则方程有一个二重实根和一个与之不同的实根.
		\end{enumerate}
	\item 当\(\Delta<0\)时，方程的三个根各不相同，其中一个是实根，两个是共轭复根.
\end{enumerate}
\end{theorem}

\begin{theorem}[韦达定理]
设\(x_1,x_2,x_3\)是\cref{equation:一元三次方程.一元三次方程的一般形式} 的三个根，
则有\[
	x_1 + x_2 + x_3 = -\frac{b}{a},
	\qquad
	x_1 x_2 + x_2 x_3 + x_3 x_1 = \frac{c}{a},
	\qquad
	x_1 x_2 x_3 = -\frac{d}{a}.
\]
\end{theorem}
